{"ast":null,"code":"import React from'react';import{Filter,Users,Activity,TrendingDown,Clock,Target,Database,Split}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CohortFilteringStats=_ref=>{var _data$data,_data$data2,_data$data3;let{data}=_ref;if(!data){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:\"No cohort data available. Run an analysis to see filtering statistics.\"})});}// Extract data from the pipeline response with robust fallbacks\nconst legacyFormat=data.legacy_format||((_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.legacy_format);const structuredFormat=data.structured_format||((_data$data2=data.data)===null||_data$data2===void 0?void 0:_data$data2.structured_format);const summary=data.summary||((_data$data3=data.data)===null||_data$data3===void 0?void 0:_data$data3.summary);// ROBUST DATA EXTRACTION with clear priorities\nlet filteringSteps=[];let baseCohortCount=0;let finalCohortCount=0;let totalEvents=0;// Extended cohort information (base vs lookback breakdown)\nlet comprehensiveCohortSize=0;let baseUsers=0;let lookbackUsers=0;let lookbackDaysUsed=60;// Default from unified pipeline\nlet baseEvents=0;let lookbackEvents=0;let extendedCohortSize=0;// Track initial extended cohort size\n// Priority 1: Extract from summary (most reliable for unified pipeline)\nif(summary){extendedCohortSize=summary.extended_cohort_count||0;finalCohortCount=summary.final_cohort_count||0;comprehensiveCohortSize=finalCohortCount;baseUsers=summary.base_user_count||0;lookbackUsers=summary.lookback_user_count||0;totalEvents=summary.total_event_count||0;baseEvents=summary.base_event_count||0;lookbackEvents=summary.lookback_event_count||0;}// Priority 2: Extract from legacy format (fallback)\nif(legacyFormat){var _legacyFormat$metadat;if(finalCohortCount===0)finalCohortCount=legacyFormat.cohort_size||0;if(comprehensiveCohortSize===0)comprehensiveCohortSize=legacyFormat.comprehensive_cohort_size||finalCohortCount;if(baseUsers===0)baseUsers=legacyFormat.base_users||0;if(lookbackUsers===0)lookbackUsers=legacyFormat.lookback_users||0;if(extendedCohortSize===0)extendedCohortSize=legacyFormat.extended_cohort_size||0;if(totalEvents===0)totalEvents=legacyFormat.total_events||legacyFormat.event_count||0;if(baseEvents===0)baseEvents=legacyFormat.base_events||0;if(lookbackEvents===0)lookbackEvents=legacyFormat.lookback_events||0;// Extract lookback days\nif((_legacyFormat$metadat=legacyFormat.metadata)!==null&&_legacyFormat$metadat!==void 0&&_legacyFormat$metadat.lookback_days_used){lookbackDaysUsed=legacyFormat.metadata.lookback_days_used;}// Extract filter stats from legacy format\nif(legacyFormat.filter_stats){const fs=legacyFormat.filter_stats;filteringSteps=fs.filtering_steps||[];baseCohortCount=fs.base_cohort_count||fs.extended_cohort_size||0;if(finalCohortCount===0)finalCohortCount=fs.final_cohort_count||fs.final_cohort_size||0;if(extendedCohortSize===0)extendedCohortSize=fs.extended_cohort_size||0;}}// Priority 3: Extract from structured format (unified pipeline data)\nif(structuredFormat!==null&&structuredFormat!==void 0&&structuredFormat.unified_pipeline_data){const unifiedData=structuredFormat.unified_pipeline_data;// Extract from unified cohort data\nif(unifiedData.unified_cohort){const cohortData=unifiedData.unified_cohort;if(finalCohortCount===0)finalCohortCount=cohortData.size||0;if(comprehensiveCohortSize===0)comprehensiveCohortSize=finalCohortCount;if(baseUsers===0)baseUsers=cohortData.base_size||0;if(lookbackUsers===0)lookbackUsers=cohortData.lookback_size||0;if(extendedCohortSize===0)extendedCohortSize=cohortData.extended_size||0;// Extract metadata\nif(cohortData.metadata){if(lookbackDaysUsed===60)lookbackDaysUsed=cohortData.metadata.lookback_days_used||60;if(extendedCohortSize===0)extendedCohortSize=cohortData.metadata.extended_cohort_size||0;// Extract filter stats from unified cohort metadata\nif(cohortData.metadata.filter_stats&&filteringSteps.length===0){const fs=cohortData.metadata.filter_stats;filteringSteps=fs.filtering_steps||[];if(baseCohortCount===0)baseCohortCount=fs.base_cohort_count||fs.extended_cohort_size||0;if(extendedCohortSize===0)extendedCohortSize=fs.extended_cohort_size||0;}}}// Extract from unified events data\nif(unifiedData.unified_events){const eventData=unifiedData.unified_events;if(totalEvents===0)totalEvents=eventData.size||0;if(baseEvents===0)baseEvents=eventData.base_size||0;if(lookbackEvents===0)lookbackEvents=eventData.lookback_size||0;}// Extract from categorized data\nif(unifiedData.categorized_data){const catData=unifiedData.categorized_data;if(finalCohortCount===0)finalCohortCount=catData.total_cohort_size||0;if(baseUsers===0)baseUsers=catData.base_cohort_size||0;if(totalEvents===0)totalEvents=catData.total_events_count||0;if(baseEvents===0)baseEvents=catData.base_events_count||0;}}// Fallback: Extract from old structured format\nif(structuredFormat!==null&&structuredFormat!==void 0&&structuredFormat.cohort_data&&!(structuredFormat!==null&&structuredFormat!==void 0&&structuredFormat.unified_pipeline_data)){var _structuredFormat$coh;const cohortBreakdown=(_structuredFormat$coh=structuredFormat.cohort_analysis)===null||_structuredFormat$coh===void 0?void 0:_structuredFormat$coh.cohort_breakdown;if(cohortBreakdown){if(comprehensiveCohortSize===0)comprehensiveCohortSize=cohortBreakdown.total_users||0;if(baseUsers===0)baseUsers=cohortBreakdown.base_users||0;if(lookbackUsers===0)lookbackUsers=cohortBreakdown.lookback_users||0;}const eventData=structuredFormat.event_data;if(eventData){if(baseEvents===0)baseEvents=eventData.base_size||0;if(lookbackEvents===0)lookbackEvents=eventData.lookback_size||0;if(totalEvents===0)totalEvents=baseEvents+lookbackEvents;}}// VALIDATION: Ensure math consistency\nconst mathCheck={userMathCorrect:baseUsers+lookbackUsers===comprehensiveCohortSize,eventMathCorrect:baseEvents+lookbackEvents===totalEvents,basePriorityApplied:baseUsers>0&&lookbackUsers>=0,extendedToFinalFlow:extendedCohortSize>=comprehensiveCohortSize};// Calculate percentages\nconst calculatePercentage=(count,total)=>{if(!total)return 0;return(count/total*100).toFixed(1);};// Get event type breakdown if available\nconst eventTypeBreakdown=(legacyFormat===null||legacyFormat===void 0?void 0:legacyFormat.event_type_breakdown)||{};const getEventTypeStats=()=>{if(!eventTypeBreakdown||Object.keys(eventTypeBreakdown).length===0){return null;}return Object.entries(eventTypeBreakdown).map(_ref2=>{let[eventType,count]=_ref2;return{eventType,count,percentage:calculatePercentage(count,finalCohortCount)};});};const eventTypeStats=getEventTypeStats();return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-6\",children:[/*#__PURE__*/_jsx(Filter,{size:24,className:\"text-blue-600 dark:text-blue-400\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 dark:text-white\",children:\"Unified Cohort Pipeline\"}),mathCheck.userMathCorrect&&mathCheck.basePriorityApplied&&/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex items-center gap-1 text-green-600 dark:text-green-400 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Three-Phase Unified Approach\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Database,{size:20,className:\"text-blue-600 dark:text-blue-400\"}),\"Unified Three-Phase Approach\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-white dark:bg-gray-800 rounded border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-blue-600 dark:text-blue-400 mb-1\",children:\"Phase 1: Extended Collection\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-700 dark:text-gray-300\",children:[\"Collect maximum dataset (+\",lookbackDaysUsed,\" days lookback)\"]}),extendedCohortSize>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:[\"Extended cohort: \",extendedCohortSize.toLocaleString(),\" users\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-white dark:bg-gray-800 rounded border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-green-600 dark:text-green-400 mb-1\",children:\"Phase 2: Unified Filtering\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700 dark:text-gray-300\",children:\"Apply all filters to extended dataset\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:[\"Filtered cohort: \",comprehensiveCohortSize.toLocaleString(),\" users\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-white dark:bg-gray-800 rounded border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-purple-600 dark:text-purple-400 mb-1\",children:\"Phase 3: Categorization\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700 dark:text-gray-300\",children:\"Split by timeline with base priority\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:[\"Base: \",baseUsers.toLocaleString(),\", Lookback: \",lookbackUsers.toLocaleString()]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(Users,{size:20,className:\"text-blue-600 dark:text-blue-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-blue-900 dark:text-blue-200\",children:\"Final Cohort Size\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-300\",children:comprehensiveCohortSize.toLocaleString()}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-700 dark:text-blue-400\",children:\"Users after unified filtering\"}),(baseUsers>0||lookbackUsers>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs font-medium text-blue-800 dark:text-blue-300 mb-2\",children:[/*#__PURE__*/_jsx(Split,{size:12,className:\"inline mr-1\"}),\"Timeline Categorization:\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600 dark:text-blue-400\",children:[/*#__PURE__*/_jsx(Target,{size:12,className:\"inline mr-1\"}),\"Base Period:\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-blue-700 dark:text-blue-300\",children:[baseUsers.toLocaleString(),\" (\",calculatePercentage(baseUsers,comprehensiveCohortSize),\"%)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-500 dark:text-blue-500\",children:[/*#__PURE__*/_jsx(Clock,{size:12,className:\"inline mr-1\"}),\"Lookback Only:\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600 dark:text-blue-400\",children:[lookbackUsers.toLocaleString(),\" (\",calculatePercentage(lookbackUsers,comprehensiveCohortSize),\"%)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs font-medium border-t border-blue-200 dark:border-blue-700 pt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-700 dark:text-blue-300\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-700 dark:text-blue-300\",children:[(baseUsers+lookbackUsers).toLocaleString(),mathCheck.userMathCorrect?' ✓':' ⚠️']})]}),lookbackDaysUsed>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-blue-500 dark:text-blue-500 mt-1\",children:[\"Extended by \",lookbackDaysUsed,\" days\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(Activity,{size:20,className:\"text-green-600 dark:text-green-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-green-900 dark:text-green-200\",children:\"Events in Cohort\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-600 dark:text-green-300\",children:totalEvents>0?totalEvents.toLocaleString():'N/A'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-700 dark:text-green-400\",children:\"Total events analyzed\"}),(baseEvents>0||lookbackEvents>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 pt-3 border-t border-green-200 dark:border-green-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs font-medium text-green-800 dark:text-green-300 mb-2\",children:[/*#__PURE__*/_jsx(Split,{size:12,className:\"inline mr-1\"}),\"Event Timeline Categorization:\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 dark:text-green-400\",children:[/*#__PURE__*/_jsx(Target,{size:12,className:\"inline mr-1\"}),\"Base Period:\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-green-700 dark:text-green-300\",children:[baseEvents.toLocaleString(),\" (\",calculatePercentage(baseEvents,totalEvents),\"%)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-500 dark:text-green-500\",children:[/*#__PURE__*/_jsx(Clock,{size:12,className:\"inline mr-1\"}),\"Lookback Only:\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 dark:text-green-400\",children:[lookbackEvents.toLocaleString(),\" (\",calculatePercentage(lookbackEvents,totalEvents),\"%)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs font-medium border-t border-green-200 dark:border-green-700 pt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-700 dark:text-green-300\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-700 dark:text-green-300\",children:[(baseEvents+lookbackEvents).toLocaleString(),mathCheck.eventMathCorrect?' ✓':' ⚠️']})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(TrendingDown,{size:20,className:\"text-purple-600 dark:text-purple-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-purple-900 dark:text-purple-200\",children:\"Filter Efficiency\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-300\",children:[extendedCohortSize>0?calculatePercentage(comprehensiveCohortSize,extendedCohortSize):'0',\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-700 dark:text-purple-400\",children:\"Users retained from extended cohort\"}),extendedCohortSize>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 pt-3 border-t border-purple-200 dark:border-purple-700\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-xs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-600 dark:text-purple-400\",children:\"Extended cohort:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-700 dark:text-purple-300\",children:extendedCohortSize.toLocaleString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-600 dark:text-purple-400\",children:\"Filtered out:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-700 dark:text-purple-300\",children:(extendedCohortSize-comprehensiveCohortSize).toLocaleString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between font-medium border-t border-purple-200 dark:border-purple-700 pt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-700 dark:text-purple-300\",children:\"Final:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-700 dark:text-purple-300\",children:comprehensiveCohortSize.toLocaleString()})]})]})})]})]}),filteringSteps&&filteringSteps.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-4\",children:\"Unified Pipeline Flow\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row items-center justify-between mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center min-w-0 flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-600 dark:text-blue-400 mb-1 font-medium\",children:\"Extended Collection\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-bold text-gray-900 dark:text-white mb-1\",children:extendedCohortSize>0?extendedCohortSize.toLocaleString():'N/A'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[\"Base + \",lookbackDaysUsed,\" days\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden md:block text-gray-400 mx-2\",children:\"\\u2192\"}),filteringSteps.slice(1).map((step,index)=>{const usersRemaining=step.users_after||step.users_count||0;const isLastFilterStep=index===filteringSteps.slice(1).length-1;return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center min-w-0 flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-600 dark:text-green-400 mb-1\",children:step.step_name||step.step}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-bold text-gray-900 dark:text-white mb-1\",children:usersRemaining.toLocaleString()}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[extendedCohortSize>0?calculatePercentage(usersRemaining,extendedCohortSize):'0',\"% retained\"]})]}),!isLastFilterStep&&/*#__PURE__*/_jsx(\"div\",{className:\"hidden md:block text-gray-400 mx-2\",children:\"\\u2192\"})]},index);}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden md:block text-gray-400 mx-2\",children:\"\\u2192\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center min-w-0 flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-600 dark:text-purple-400 mb-1 font-medium\",children:\"Timeline Categorization\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-gray-900 dark:text-white mb-1\",children:[baseUsers.toLocaleString(),\" + \",lookbackUsers.toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs space-y-0.5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-blue-600 dark:text-blue-400\",children:[\"Base: \",calculatePercentage(baseUsers,comprehensiveCohortSize),\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-green-600 dark:text-green-400\",children:[\"Lookback: \",calculatePercentage(lookbackUsers,comprehensiveCohortSize),\"%\"]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm border dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-700\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",children:\"Pipeline Step\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",children:\"Users After Step\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",children:\"Users Filtered\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",children:\"% Retained\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",children:\"Phase\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{className:\"bg-white dark:bg-gray-800\",children:[filteringSteps.map((step,index)=>{const usersRemaining=step.users_after||step.users_count||0;const usersFiltered=step.users_filtered||0;const stepName=step.step_name||step.step||'';// Determine phase based on step name and type\nlet phaseLabel='Filtering';let phaseColor='text-green-600 dark:text-green-400';if(stepName.includes('extended_cohort_selection')){phaseLabel='Extended Collection';phaseColor='text-blue-600 dark:text-blue-400';}else if(stepName==='Timeline Split'||stepName.includes('timeline_split')){phaseLabel='Categorization';phaseColor='text-purple-600 dark:text-purple-400';}// All other steps (primary_user_filter, secondary_filters, product_filtering, orphan_removal) are \"Filtering\"\nreturn/*#__PURE__*/_jsxs(\"tr\",{className:index%2===0?'':'bg-gray-50 dark:bg-gray-700',children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",children:step.step_name||step.step}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",children:step.description}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 font-medium\",children:usersRemaining.toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\",children:stepName.includes('extended_cohort_selection')?'N/A':usersFiltered.toLocaleString()}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\",children:[extendedCohortSize>0?calculatePercentage(usersRemaining,extendedCohortSize):'0',\"%\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center font-medium \".concat(phaseColor),children:phaseLabel})]},index);}),(baseUsers>0||lookbackUsers>0)&&/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-purple-50 dark:bg-purple-900/20\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 font-medium text-purple-700 dark:text-purple-300\",children:\"Timeline Split\"}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-purple-700 dark:text-purple-300\",children:[\"Base period: \",baseUsers.toLocaleString(),\" users, Lookback only: \",lookbackUsers.toLocaleString(),\" users\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300 font-medium\",children:(baseUsers+lookbackUsers).toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300\",children:\"Split only\"}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300\",children:\"100%\"}),/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b dark:border-gray-600 text-center font-medium text-purple-600 dark:text-purple-400\",children:\"Categorization\"})]})]})]})})]}),eventTypeStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-4\",children:\"Unique Users by Event Type\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:eventTypeStats.map(_ref3=>{let{eventType,count,percentage}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 dark:text-white text-sm\",children:eventType.replace('RC ','')}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[percentage,\"%\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-gray-700 dark:text-gray-300\",children:count.toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 bg-gray-200 dark:bg-gray-600 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-500 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(Math.min(percentage,100),\"%\")}})})]},eventType);})})]}),(!filteringSteps||filteringSteps.length===0)&&!eventTypeStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg\",children:[/*#__PURE__*/_jsx(Filter,{size:48,className:\"mx-auto text-gray-400 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400 mb-2\",children:\"No detailed filtering statistics available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-500\",children:\"Run a full analysis to see the complete unified pipeline breakdown\"})]})]});};export default CohortFilteringStats;","map":{"version":3,"names":["React","Filter","Users","Activity","TrendingDown","Clock","Target","Database","Split","jsx","_jsx","jsxs","_jsxs","CohortFilteringStats","_ref","_data$data","_data$data2","_data$data3","data","className","children","legacyFormat","legacy_format","structuredFormat","structured_format","summary","filteringSteps","baseCohortCount","finalCohortCount","totalEvents","comprehensiveCohortSize","baseUsers","lookbackUsers","lookbackDaysUsed","baseEvents","lookbackEvents","extendedCohortSize","extended_cohort_count","final_cohort_count","base_user_count","lookback_user_count","total_event_count","base_event_count","lookback_event_count","_legacyFormat$metadat","cohort_size","comprehensive_cohort_size","base_users","lookback_users","extended_cohort_size","total_events","event_count","base_events","lookback_events","metadata","lookback_days_used","filter_stats","fs","filtering_steps","base_cohort_count","final_cohort_size","unified_pipeline_data","unifiedData","unified_cohort","cohortData","size","base_size","lookback_size","extended_size","length","unified_events","eventData","categorized_data","catData","total_cohort_size","base_cohort_size","total_events_count","base_events_count","cohort_data","_structuredFormat$coh","cohortBreakdown","cohort_analysis","cohort_breakdown","total_users","event_data","mathCheck","userMathCorrect","eventMathCorrect","basePriorityApplied","extendedToFinalFlow","calculatePercentage","count","total","toFixed","eventTypeBreakdown","event_type_breakdown","getEventTypeStats","Object","keys","entries","map","_ref2","eventType","percentage","eventTypeStats","toLocaleString","slice","step","index","usersRemaining","users_after","users_count","isLastFilterStep","Fragment","step_name","usersFiltered","users_filtered","stepName","phaseLabel","phaseColor","includes","description","concat","_ref3","replace","style","width","Math","min"],"sources":["/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/cohort-pipeline/components/CohortFilteringStats.js"],"sourcesContent":["import React from 'react';\nimport { Filter, Users, Activity, TrendingDown, Clock, Target, Database, Split } from 'lucide-react';\n\nconst CohortFilteringStats = ({ data }) => {\n    if (!data) {\n        return (\n            <div className=\"text-center py-8\">\n                <p className=\"text-gray-500 dark:text-gray-400\">\n                    No cohort data available. Run an analysis to see filtering statistics.\n                </p>\n            </div>\n        );\n    }\n\n    // Extract data from the pipeline response with robust fallbacks\n    const legacyFormat = data.legacy_format || data.data?.legacy_format;\n    const structuredFormat = data.structured_format || data.data?.structured_format;\n    const summary = data.summary || data.data?.summary;\n    \n    // ROBUST DATA EXTRACTION with clear priorities\n    let filteringSteps = [];\n    let baseCohortCount = 0;\n    let finalCohortCount = 0;\n    let totalEvents = 0;\n    \n    // Extended cohort information (base vs lookback breakdown)\n    let comprehensiveCohortSize = 0;\n    let baseUsers = 0;\n    let lookbackUsers = 0;\n    let lookbackDaysUsed = 60; // Default from unified pipeline\n    let baseEvents = 0;\n    let lookbackEvents = 0;\n    let extendedCohortSize = 0; // Track initial extended cohort size\n    \n    // Priority 1: Extract from summary (most reliable for unified pipeline)\n    if (summary) {\n        extendedCohortSize = summary.extended_cohort_count || 0;\n        finalCohortCount = summary.final_cohort_count || 0;\n        comprehensiveCohortSize = finalCohortCount;\n        baseUsers = summary.base_user_count || 0;\n        lookbackUsers = summary.lookback_user_count || 0;\n        totalEvents = summary.total_event_count || 0;\n        baseEvents = summary.base_event_count || 0;\n        lookbackEvents = summary.lookback_event_count || 0;\n    }\n    \n    // Priority 2: Extract from legacy format (fallback)\n    if (legacyFormat) {\n        if (finalCohortCount === 0) finalCohortCount = legacyFormat.cohort_size || 0;\n        if (comprehensiveCohortSize === 0) comprehensiveCohortSize = legacyFormat.comprehensive_cohort_size || finalCohortCount;\n        if (baseUsers === 0) baseUsers = legacyFormat.base_users || 0;\n        if (lookbackUsers === 0) lookbackUsers = legacyFormat.lookback_users || 0;\n        if (extendedCohortSize === 0) extendedCohortSize = legacyFormat.extended_cohort_size || 0;\n        if (totalEvents === 0) totalEvents = legacyFormat.total_events || legacyFormat.event_count || 0;\n        if (baseEvents === 0) baseEvents = legacyFormat.base_events || 0;\n        if (lookbackEvents === 0) lookbackEvents = legacyFormat.lookback_events || 0;\n        \n        // Extract lookback days\n        if (legacyFormat.metadata?.lookback_days_used) {\n            lookbackDaysUsed = legacyFormat.metadata.lookback_days_used;\n        }\n        \n        // Extract filter stats from legacy format\n        if (legacyFormat.filter_stats) {\n            const fs = legacyFormat.filter_stats;\n            filteringSteps = fs.filtering_steps || [];\n            baseCohortCount = fs.base_cohort_count || fs.extended_cohort_size || 0;\n            if (finalCohortCount === 0) finalCohortCount = fs.final_cohort_count || fs.final_cohort_size || 0;\n            if (extendedCohortSize === 0) extendedCohortSize = fs.extended_cohort_size || 0;\n        }\n    }\n    \n    // Priority 3: Extract from structured format (unified pipeline data)\n    if (structuredFormat?.unified_pipeline_data) {\n        const unifiedData = structuredFormat.unified_pipeline_data;\n        \n        // Extract from unified cohort data\n        if (unifiedData.unified_cohort) {\n            const cohortData = unifiedData.unified_cohort;\n            if (finalCohortCount === 0) finalCohortCount = cohortData.size || 0;\n            if (comprehensiveCohortSize === 0) comprehensiveCohortSize = finalCohortCount;\n            if (baseUsers === 0) baseUsers = cohortData.base_size || 0;\n            if (lookbackUsers === 0) lookbackUsers = cohortData.lookback_size || 0;\n            if (extendedCohortSize === 0) extendedCohortSize = cohortData.extended_size || 0;\n            \n            // Extract metadata\n            if (cohortData.metadata) {\n                if (lookbackDaysUsed === 60) lookbackDaysUsed = cohortData.metadata.lookback_days_used || 60;\n                if (extendedCohortSize === 0) extendedCohortSize = cohortData.metadata.extended_cohort_size || 0;\n                \n                // Extract filter stats from unified cohort metadata\n                if (cohortData.metadata.filter_stats && filteringSteps.length === 0) {\n                    const fs = cohortData.metadata.filter_stats;\n                    filteringSteps = fs.filtering_steps || [];\n                    if (baseCohortCount === 0) baseCohortCount = fs.base_cohort_count || fs.extended_cohort_size || 0;\n                    if (extendedCohortSize === 0) extendedCohortSize = fs.extended_cohort_size || 0;\n                }\n            }\n        }\n        \n        // Extract from unified events data\n        if (unifiedData.unified_events) {\n            const eventData = unifiedData.unified_events;\n            if (totalEvents === 0) totalEvents = eventData.size || 0;\n            if (baseEvents === 0) baseEvents = eventData.base_size || 0;\n            if (lookbackEvents === 0) lookbackEvents = eventData.lookback_size || 0;\n        }\n        \n        // Extract from categorized data\n        if (unifiedData.categorized_data) {\n            const catData = unifiedData.categorized_data;\n            if (finalCohortCount === 0) finalCohortCount = catData.total_cohort_size || 0;\n            if (baseUsers === 0) baseUsers = catData.base_cohort_size || 0;\n            if (totalEvents === 0) totalEvents = catData.total_events_count || 0;\n            if (baseEvents === 0) baseEvents = catData.base_events_count || 0;\n        }\n    }\n    \n    // Fallback: Extract from old structured format\n    if (structuredFormat?.cohort_data && !structuredFormat?.unified_pipeline_data) {\n        const cohortBreakdown = structuredFormat.cohort_analysis?.cohort_breakdown;\n        if (cohortBreakdown) {\n            if (comprehensiveCohortSize === 0) comprehensiveCohortSize = cohortBreakdown.total_users || 0;\n            if (baseUsers === 0) baseUsers = cohortBreakdown.base_users || 0;\n            if (lookbackUsers === 0) lookbackUsers = cohortBreakdown.lookback_users || 0;\n        }\n        \n        const eventData = structuredFormat.event_data;\n        if (eventData) {\n            if (baseEvents === 0) baseEvents = eventData.base_size || 0;\n            if (lookbackEvents === 0) lookbackEvents = eventData.lookback_size || 0;\n            if (totalEvents === 0) totalEvents = baseEvents + lookbackEvents;\n        }\n    }\n    \n    // VALIDATION: Ensure math consistency\n    const mathCheck = {\n        userMathCorrect: (baseUsers + lookbackUsers) === comprehensiveCohortSize,\n        eventMathCorrect: (baseEvents + lookbackEvents) === totalEvents,\n        basePriorityApplied: baseUsers > 0 && lookbackUsers >= 0,\n        extendedToFinalFlow: extendedCohortSize >= comprehensiveCohortSize\n    };\n    \n    // Calculate percentages\n    const calculatePercentage = (count, total) => {\n        if (!total) return 0;\n        return ((count / total) * 100).toFixed(1);\n    };\n\n    // Get event type breakdown if available\n    const eventTypeBreakdown = legacyFormat?.event_type_breakdown || {};\n    const getEventTypeStats = () => {\n        if (!eventTypeBreakdown || Object.keys(eventTypeBreakdown).length === 0) {\n            return null;\n        }\n        \n        return Object.entries(eventTypeBreakdown).map(([eventType, count]) => ({\n            eventType,\n            count,\n            percentage: calculatePercentage(count, finalCohortCount)\n        }));\n    };\n    const eventTypeStats = getEventTypeStats();\n\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\">\n            <div className=\"flex items-center gap-2 mb-6\">\n                <Filter size={24} className=\"text-blue-600 dark:text-blue-400\" />\n                <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                    Unified Cohort Pipeline\n                </h2>\n                {/* Math validation indicator */}\n                {mathCheck.userMathCorrect && mathCheck.basePriorityApplied && (\n                    <div className=\"ml-auto flex items-center gap-1 text-green-600 dark:text-green-400 text-sm\">\n                        <span>✓</span>\n                        <span>Three-Phase Unified Approach</span>\n                    </div>\n                )}\n            </div>\n\n            {/* NEW: Three-Phase Pipeline Overview */}\n            <div className=\"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\n                    <Database size={20} className=\"text-blue-600 dark:text-blue-400\" />\n                    Unified Three-Phase Approach\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n                    <div className=\"p-3 bg-white dark:bg-gray-800 rounded border\">\n                        <div className=\"font-medium text-blue-600 dark:text-blue-400 mb-1\">Phase 1: Extended Collection</div>\n                        <div className=\"text-gray-700 dark:text-gray-300\">\n                            Collect maximum dataset (+{lookbackDaysUsed} days lookback)\n                        </div>\n                        {extendedCohortSize > 0 && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                                Extended cohort: {extendedCohortSize.toLocaleString()} users\n                            </div>\n                        )}\n                    </div>\n                    <div className=\"p-3 bg-white dark:bg-gray-800 rounded border\">\n                        <div className=\"font-medium text-green-600 dark:text-green-400 mb-1\">Phase 2: Unified Filtering</div>\n                        <div className=\"text-gray-700 dark:text-gray-300\">\n                            Apply all filters to extended dataset\n                        </div>\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            Filtered cohort: {comprehensiveCohortSize.toLocaleString()} users\n                        </div>\n                    </div>\n                    <div className=\"p-3 bg-white dark:bg-gray-800 rounded border\">\n                        <div className=\"font-medium text-purple-600 dark:text-purple-400 mb-1\">Phase 3: Categorization</div>\n                        <div className=\"text-gray-700 dark:text-gray-300\">\n                            Split by timeline with base priority\n                        </div>\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            Base: {baseUsers.toLocaleString()}, Lookback: {lookbackUsers.toLocaleString()}\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* High-level Summary Cards with Base/Lookback Breakdown */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                {/* Final Cohort Size Card */}\n                <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Users size={20} className=\"text-blue-600 dark:text-blue-400\" />\n                        <h3 className=\"font-semibold text-blue-900 dark:text-blue-200\">Final Cohort Size</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-blue-600 dark:text-blue-300\">\n                        {comprehensiveCohortSize.toLocaleString()}\n                    </p>\n                    <p className=\"text-sm text-blue-700 dark:text-blue-400\">\n                        Users after unified filtering\n                    </p>\n                    \n                    {/* Base vs Lookback Breakdown */}\n                    {(baseUsers > 0 || lookbackUsers > 0) && (\n                        <div className=\"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700\">\n                            <div className=\"text-xs font-medium text-blue-800 dark:text-blue-300 mb-2\">\n                                <Split size={12} className=\"inline mr-1\" />\n                                Timeline Categorization:\n                            </div>\n                            <div className=\"space-y-1\">\n                                <div className=\"flex justify-between text-xs\">\n                                    <span className=\"text-blue-600 dark:text-blue-400\">\n                                        <Target size={12} className=\"inline mr-1\" />\n                                        Base Period:\n                                    </span>\n                                    <span className=\"font-medium text-blue-700 dark:text-blue-300\">\n                                        {baseUsers.toLocaleString()} ({calculatePercentage(baseUsers, comprehensiveCohortSize)}%)\n                                    </span>\n                                </div>\n                                <div className=\"flex justify-between text-xs\">\n                                    <span className=\"text-blue-500 dark:text-blue-500\">\n                                        <Clock size={12} className=\"inline mr-1\" />\n                                        Lookback Only:\n                                    </span>\n                                    <span className=\"text-blue-600 dark:text-blue-400\">\n                                        {lookbackUsers.toLocaleString()} ({calculatePercentage(lookbackUsers, comprehensiveCohortSize)}%)\n                                    </span>\n                                </div>\n                                <div className=\"flex justify-between text-xs font-medium border-t border-blue-200 dark:border-blue-700 pt-1\">\n                                    <span className=\"text-blue-700 dark:text-blue-300\">Total:</span>\n                                    <span className=\"text-blue-700 dark:text-blue-300\">\n                                        {(baseUsers + lookbackUsers).toLocaleString()}\n                                        {mathCheck.userMathCorrect ? ' ✓' : ' ⚠️'}\n                                    </span>\n                                </div>\n                                {lookbackDaysUsed > 0 && (\n                                    <div className=\"text-xs text-blue-500 dark:text-blue-500 mt-1\">\n                                        Extended by {lookbackDaysUsed} days\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* Events in Cohort Card with Base/Lookback Breakdown */}\n                <div className=\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Activity size={20} className=\"text-green-600 dark:text-green-400\" />\n                        <h3 className=\"font-semibold text-green-900 dark:text-green-200\">Events in Cohort</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-green-600 dark:text-green-300\">\n                        {totalEvents > 0 ? totalEvents.toLocaleString() : 'N/A'}\n                    </p>\n                    <p className=\"text-sm text-green-700 dark:text-green-400\">\n                        Total events analyzed\n                    </p>\n                    \n                    {/* Base vs Lookback Event Breakdown */}\n                    {(baseEvents > 0 || lookbackEvents > 0) && (\n                        <div className=\"mt-3 pt-3 border-t border-green-200 dark:border-green-700\">\n                            <div className=\"text-xs font-medium text-green-800 dark:text-green-300 mb-2\">\n                                <Split size={12} className=\"inline mr-1\" />\n                                Event Timeline Categorization:\n                            </div>\n                            <div className=\"space-y-1\">\n                                <div className=\"flex justify-between text-xs\">\n                                    <span className=\"text-green-600 dark:text-green-400\">\n                                        <Target size={12} className=\"inline mr-1\" />\n                                        Base Period:\n                                    </span>\n                                    <span className=\"font-medium text-green-700 dark:text-green-300\">\n                                        {baseEvents.toLocaleString()} ({calculatePercentage(baseEvents, totalEvents)}%)\n                                    </span>\n                                </div>\n                                <div className=\"flex justify-between text-xs\">\n                                    <span className=\"text-green-500 dark:text-green-500\">\n                                        <Clock size={12} className=\"inline mr-1\" />\n                                        Lookback Only:\n                                    </span>\n                                    <span className=\"text-green-600 dark:text-green-400\">\n                                        {lookbackEvents.toLocaleString()} ({calculatePercentage(lookbackEvents, totalEvents)}%)\n                                    </span>\n                                </div>\n                                <div className=\"flex justify-between text-xs font-medium border-t border-green-200 dark:border-green-700 pt-1\">\n                                    <span className=\"text-green-700 dark:text-green-300\">Total:</span>\n                                    <span className=\"text-green-700 dark:text-green-300\">\n                                        {(baseEvents + lookbackEvents).toLocaleString()}\n                                        {mathCheck.eventMathCorrect ? ' ✓' : ' ⚠️'}\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* Filter Efficiency Card */}\n                <div className=\"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <TrendingDown size={20} className=\"text-purple-600 dark:text-purple-400\" />\n                        <h3 className=\"font-semibold text-purple-900 dark:text-purple-200\">Filter Efficiency</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-purple-600 dark:text-purple-300\">\n                        {extendedCohortSize > 0 ? calculatePercentage(comprehensiveCohortSize, extendedCohortSize) : '0'}%\n                    </p>\n                    <p className=\"text-sm text-purple-700 dark:text-purple-400\">\n                        Users retained from extended cohort\n                    </p>\n                    \n                    {/* Filtering Summary */}\n                    {extendedCohortSize > 0 && (\n                        <div className=\"mt-3 pt-3 border-t border-purple-200 dark:border-purple-700\">\n                            <div className=\"space-y-1 text-xs\">\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-purple-600 dark:text-purple-400\">Extended cohort:</span>\n                                    <span className=\"text-purple-700 dark:text-purple-300\">{extendedCohortSize.toLocaleString()}</span>\n                                </div>\n                                <div className=\"flex justify-between\">\n                                    <span className=\"text-purple-600 dark:text-purple-400\">Filtered out:</span>\n                                    <span className=\"text-purple-700 dark:text-purple-300\">{(extendedCohortSize - comprehensiveCohortSize).toLocaleString()}</span>\n                                </div>\n                                <div className=\"flex justify-between font-medium border-t border-purple-200 dark:border-purple-700 pt-1\">\n                                    <span className=\"text-purple-700 dark:text-purple-300\">Final:</span>\n                                    <span className=\"text-purple-700 dark:text-purple-300\">{comprehensiveCohortSize.toLocaleString()}</span>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* NEW: Unified Pipeline Flow Visualization */}\n            {filteringSteps && filteringSteps.length > 0 && (\n                <div className=\"mb-6\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                        Unified Pipeline Flow\n                    </h3>\n                    \n                    {/* Visual Flow showing Extended Collection → Filtering → Categorization */}\n                    <div className=\"flex flex-col md:flex-row items-center justify-between mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg overflow-x-auto\">\n                        {/* Phase 1: Extended Collection */}\n                        <div className=\"text-center min-w-0 flex-shrink-0\">\n                            <div className=\"text-sm text-blue-600 dark:text-blue-400 mb-1 font-medium\">\n                                Extended Collection\n                            </div>\n                            <div className=\"text-xl font-bold text-gray-900 dark:text-white mb-1\">\n                                {extendedCohortSize > 0 ? extendedCohortSize.toLocaleString() : 'N/A'}\n                            </div>\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                Base + {lookbackDaysUsed} days\n                            </div>\n                        </div>\n                        \n                        <div className=\"hidden md:block text-gray-400 mx-2\">→</div>\n                        \n                        {/* Phase 2: Filtering Steps */}\n                        {filteringSteps.slice(1).map((step, index) => {\n                            const usersRemaining = step.users_after || step.users_count || 0;\n                            const isLastFilterStep = index === filteringSteps.slice(1).length - 1;\n                            \n                            return (\n                                <React.Fragment key={index}>\n                                    <div className=\"text-center min-w-0 flex-shrink-0\">\n                                        <div className=\"text-sm text-green-600 dark:text-green-400 mb-1\">\n                                            {step.step_name || step.step}\n                                        </div>\n                                        <div className=\"text-xl font-bold text-gray-900 dark:text-white mb-1\">\n                                            {usersRemaining.toLocaleString()}\n                                        </div>\n                                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                            {extendedCohortSize > 0 ? \n                                                calculatePercentage(usersRemaining, extendedCohortSize) : '0'\n                                            }% retained\n                                        </div>\n                                    </div>\n                                    \n                                    {!isLastFilterStep && (\n                                        <div className=\"hidden md:block text-gray-400 mx-2\">→</div>\n                                    )}\n                                </React.Fragment>\n                            );\n                        })}\n                        \n                        <div className=\"hidden md:block text-gray-400 mx-2\">→</div>\n                        \n                        {/* Phase 3: Categorization */}\n                        <div className=\"text-center min-w-0 flex-shrink-0\">\n                            <div className=\"text-sm text-purple-600 dark:text-purple-400 mb-1 font-medium\">\n                                Timeline Categorization\n                            </div>\n                            <div className=\"text-lg font-bold text-gray-900 dark:text-white mb-1\">\n                                {baseUsers.toLocaleString()} + {lookbackUsers.toLocaleString()}\n                            </div>\n                            <div className=\"text-xs space-y-0.5\">\n                                <div className=\"text-blue-600 dark:text-blue-400\">\n                                    Base: {calculatePercentage(baseUsers, comprehensiveCohortSize)}%\n                                </div>\n                                <div className=\"text-green-600 dark:text-green-400\">\n                                    Lookback: {calculatePercentage(lookbackUsers, comprehensiveCohortSize)}%\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Detailed Table with Updated Structure */}\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                <tr>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">\n                                        Pipeline Step\n                                    </th>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">\n                                        Description\n                                    </th>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">\n                                        Users After Step\n                                    </th>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">\n                                        Users Filtered\n                                    </th>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">\n                                        % Retained\n                                    </th>\n                                    <th className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">\n                                        Phase\n                                    </th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"bg-white dark:bg-gray-800\">\n                                {filteringSteps.map((step, index) => {\n                                    const usersRemaining = step.users_after || step.users_count || 0;\n                                    const usersFiltered = step.users_filtered || 0;\n                                    const stepName = step.step_name || step.step || '';\n                                    \n                                    // Determine phase based on step name and type\n                                    let phaseLabel = 'Filtering';\n                                    let phaseColor = 'text-green-600 dark:text-green-400';\n                                    \n                                    if (stepName.includes('extended_cohort_selection')) {\n                                        phaseLabel = 'Extended Collection';\n                                        phaseColor = 'text-blue-600 dark:text-blue-400';\n                                    } else if (stepName === 'Timeline Split' || stepName.includes('timeline_split')) {\n                                        phaseLabel = 'Categorization';\n                                        phaseColor = 'text-purple-600 dark:text-purple-400';\n                                    }\n                                    // All other steps (primary_user_filter, secondary_filters, product_filtering, orphan_removal) are \"Filtering\"\n                                    \n                                    return (\n                                        <tr key={index} className={index % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700'}>\n                                            <td className=\"p-3 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">\n                                                {step.step_name || step.step}\n                                            </td>\n                                            <td className=\"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {step.description}\n                                            </td>\n                                            <td className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 font-medium\">\n                                                {usersRemaining.toLocaleString()}\n                                            </td>\n                                            <td className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\">\n                                                {stepName.includes('extended_cohort_selection') ? 'N/A' : usersFiltered.toLocaleString()}\n                                            </td>\n                                            <td className=\"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\">\n                                                {extendedCohortSize > 0 ? calculatePercentage(usersRemaining, extendedCohortSize) : '0'}%\n                                            </td>\n                                            <td className={`p-3 border-b dark:border-gray-600 text-center font-medium ${phaseColor}`}>\n                                                {phaseLabel}\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                                \n                                {/* Add categorization breakdown row */}\n                                {(baseUsers > 0 || lookbackUsers > 0) && (\n                                    <tr className=\"bg-purple-50 dark:bg-purple-900/20\">\n                                        <td className=\"p-3 border-b dark:border-gray-600 font-medium text-purple-700 dark:text-purple-300\">\n                                            Timeline Split\n                                        </td>\n                                        <td className=\"p-3 border-b dark:border-gray-600 text-purple-700 dark:text-purple-300\">\n                                            Base period: {baseUsers.toLocaleString()} users, Lookback only: {lookbackUsers.toLocaleString()} users\n                                        </td>\n                                        <td className=\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300 font-medium\">\n                                            {(baseUsers + lookbackUsers).toLocaleString()}\n                                        </td>\n                                        <td className=\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300\">\n                                            Split only\n                                        </td>\n                                        <td className=\"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300\">\n                                            100%\n                                        </td>\n                                        <td className=\"p-3 border-b dark:border-gray-600 text-center font-medium text-purple-600 dark:text-purple-400\">\n                                            Categorization\n                                        </td>\n                                    </tr>\n                                )}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            )}\n\n            {/* Event Type Breakdown */}\n            {eventTypeStats && (\n                <div className=\"mb-6\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                        Unique Users by Event Type\n                    </h3>\n                    \n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                        {eventTypeStats.map(({ eventType, count, percentage }) => (\n                            <div key={eventType} className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border\">\n                                <div className=\"flex items-center justify-between mb-2\">\n                                    <h4 className=\"font-medium text-gray-900 dark:text-white text-sm\">\n                                        {eventType.replace('RC ', '')}\n                                    </h4>\n                                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                        {percentage}%\n                                    </span>\n                                </div>\n                                <p className=\"text-xl font-bold text-gray-700 dark:text-gray-300\">\n                                    {count.toLocaleString()}\n                                </p>\n                                <div className=\"mt-2 bg-gray-200 dark:bg-gray-600 rounded-full h-2\">\n                                    <div \n                                        className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\n                                        style={{ width: `${Math.min(percentage, 100)}%` }}\n                                    />\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            )}\n\n            {/* No Data Message */}\n            {(!filteringSteps || filteringSteps.length === 0) && !eventTypeStats && (\n                <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                    <Filter size={48} className=\"mx-auto text-gray-400 mb-4\" />\n                    <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\n                        No detailed filtering statistics available\n                    </p>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-500\">\n                        Run a full analysis to see the complete unified pipeline breakdown\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default CohortFilteringStats; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}