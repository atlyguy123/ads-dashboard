{"ast":null,"code":"import _objectSpread from\"/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{ChevronDown,ChevronRight,CheckCircle,Globe,Package,Info,TrendingUp}from'lucide-react';import{formatPercentage,buildHierarchicalStructure,getStatusIndicator,formatSegmentId,getSegmentIdBadge,getRollupTargetIdBadge,formatAppStore}from'./utils/conversionUtils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PropertyAnalysisResults=_ref=>{var _propertyAnalysis$use,_propertyAnalysis$use2,_propertyAnalysis$use3,_propertyAnalysis$use4,_propertyAnalysis$use5,_propertyAnalysis$use6,_propertyAnalysis$use7,_propertyAnalysis$use8;let{propertyAnalysis,expandedSections,onToggleSection,config}=_ref;const[expandedItems,setExpandedItems]=useState({});const[showFullDetails,setShowFullDetails]=useState(false);const toggleExpanded=key=>{setExpandedItems(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:!prev[key]}));};if(!propertyAnalysis)return null;// Build hierarchical structure - user_segments is an object with productId keys\n// We need to flatten all segments from all products into a single array\nconst allSegments=[];if(propertyAnalysis.user_segments){Object.values(propertyAnalysis.user_segments).forEach(productSegments=>{if(Array.isArray(productSegments)){allSegments.push(...productSegments);}});}const hierarchicalData=buildHierarchicalStructure(allSegments,config.min_cohort_size);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b border-gray-200 dark:border-gray-700\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onToggleSection('propertyAnalysis'),className:\"flex items-center justify-between w-full text-left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-white\",children:\"Step 2: Data Structure Discovery Results\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200\",children:\"\\u2713 Complete\"})]}),expandedSections.propertyAnalysis?/*#__PURE__*/_jsx(ChevronDown,{className:\"h-5 w-5 text-gray-500\"}):/*#__PURE__*/_jsx(ChevronRight,{className:\"h-5 w-5 text-gray-500\"})]})}),expandedSections.propertyAnalysis&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-sm font-semibold text-green-900 dark:text-green-200 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 mr-2\"}),\"What This Analysis Discovered\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-800 dark:text-green-300 mb-3\",children:\"We analyzed your actual users and grouped them into meaningful segments. Here's what we found:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-green-800 dark:text-green-300 space-y-1 list-disc list-inside\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[propertyAnalysis.products_analyzed,\" products\"]}),\" with sufficient data for analysis (at least \",propertyAnalysis.min_price_samples_used||100,\" price samples each)\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[propertyAnalysis.total_combinations.toLocaleString(),\" viable user segments\"]}),\" based on actual user data\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[((_propertyAnalysis$use=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use===void 0?void 0:(_propertyAnalysis$use2=_propertyAnalysis$use.total_users_analyzed)===null||_propertyAnalysis$use2===void 0?void 0:_propertyAnalysis$use2.toLocaleString())||0,\" total users\"]}),\" analyzed across all segments\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Geographic coverage:\"}),\" \",((_propertyAnalysis$use3=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use3===void 0?void 0:_propertyAnalysis$use3.total_countries_found)||0,\" countries and \",((_propertyAnalysis$use4=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use4===void 0?void 0:_propertyAnalysis$use4.total_regions_found)||0,\" regions with active users\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"App stores:\"}),\" \",((_propertyAnalysis$use5=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use5===void 0?void 0:(_propertyAnalysis$use6=_propertyAnalysis$use5.app_stores)===null||_propertyAnalysis$use6===void 0?void 0:_propertyAnalysis$use6.length)||0,\" different stores\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-blue-600 dark:text-blue-400\",children:propertyAnalysis.products_analyzed}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-800 dark:text-blue-300 font-medium\",children:\"Products Found\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-blue-600 dark:text-blue-400 mt-1\",children:\"Products with enough data for reliable analysis\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-purple-600 dark:text-purple-400\",children:Object.values(propertyAnalysis.price_buckets||{}).reduce((total,buckets)=>total+buckets.length,0)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-800 dark:text-purple-300 font-medium\",children:\"Price Groups\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-purple-600 dark:text-purple-400 mt-1\",children:\"Intelligent price ranges created for analysis\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-green-600 dark:text-green-400\",children:((_propertyAnalysis$use7=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use7===void 0?void 0:_propertyAnalysis$use7.total_countries_found)||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-800 dark:text-green-300 font-medium\",children:\"Countries\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-600 dark:text-green-400 mt-1\",children:\"Countries with active users\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl font-bold text-orange-600 dark:text-orange-400\",children:propertyAnalysis.total_combinations.toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-orange-800 dark:text-orange-300 font-medium\",children:\"User Segments\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-orange-600 dark:text-orange-400 mt-1\",children:\"Viable segments found in your data\"})]})]}),((_propertyAnalysis$use8=propertyAnalysis.user_analysis)===null||_propertyAnalysis$use8===void 0?void 0:_propertyAnalysis$use8.geographic_structure)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Globe,{className:\"h-5 w-5 mr-2\"}),\"Global Market Overview\"]}),(()=>{const geoData=propertyAnalysis.user_analysis.geographic_structure;const countries=Object.entries(geoData).map(_ref2=>{let[country,data]=_ref2;return{name:country,users:data.total_users,regions:Object.keys(data.regions).length,viableRegions:Object.values(data.regions).filter(r=>r.user_count>=50).length};}).sort((a,b)=>b.users-a.users);const topCountries=countries.slice(0,10);const totalUsers=countries.reduce((sum,c)=>sum+c.users,0);const totalRegions=countries.reduce((sum,c)=>sum+c.regions,0);const viableRegions=countries.reduce((sum,c)=>sum+c.viableRegions,0);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-400\",children:countries.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-800 dark:text-blue-300\",children:\"Total Countries\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-indigo-600 dark:text-indigo-400\",children:totalRegions}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-indigo-800 dark:text-indigo-300\",children:\"Total Regions\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600 dark:text-green-400\",children:viableRegions}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-800 dark:text-green-300\",children:\"Viable Regions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-600 dark:text-green-400\",children:\"\\u226550 users each\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-400\",children:[Math.round(viableRegions/totalRegions*100),\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-800 dark:text-purple-300\",children:\"Data Coverage\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-purple-600 dark:text-purple-400\",children:\"Regions with sufficient data\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-600\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-semibold text-gray-900 dark:text-white\",children:\"Top Markets by User Count\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-800\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\",children:\"Country\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\",children:\"Users\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\",children:\"Market Share\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\",children:\"Regions\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\",children:\"Data Quality\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\",children:topCountries.map((country,idx)=>/*#__PURE__*/_jsxs(\"tr\",{className:idx%2===0?'bg-white dark:bg-gray-700':'bg-gray-50 dark:bg-gray-800',children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-900 dark:text-white\",children:country.name}),idx<3&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200\",children:[\"Top \",idx+1]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-white font-medium\",children:country.users.toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-2 mr-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full\",style:{width:\"\".concat(country.users/totalUsers*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:[Math.round(country.users/totalUsers*100),\"%\"]})]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\",children:[country.regions,\" total\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium \".concat(country.viableRegions/country.regions>=0.5?'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200':country.viableRegions/country.regions>=0.25?'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200':'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'),children:[country.viableRegions,\"/\",country.regions,\" viable\"]})})})]},country.name))})]})}),countries.length>10&&/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-600 text-sm text-gray-500 dark:text-gray-400\",children:[\"Showing top 10 of \",countries.length,\" countries. \",countries.length-10,\" additional countries with smaller user bases.\"]})]})]});})()]}),propertyAnalysis.user_segments&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Package,{className:\"h-5 w-5 mr-2\"}),\"Product Segment Analysis - Hierarchical View\"]}),(()=>{const productSegments=Object.entries(propertyAnalysis.user_segments);const totalSegments=productSegments.reduce((sum,_ref3)=>{let[_,segments]=_ref3;return sum+segments.length;},0);const viableSegments=productSegments.reduce((sum,_ref4)=>{let[_,segments]=_ref4;return sum+segments.filter(s=>s.has_sufficient_data).length;},0);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[propertyAnalysis.rollup_stats&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"text-lg font-semibold text-green-900 dark:text-green-200 mb-3 flex items-center\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"h-5 w-5 mr-2\"}),\"Intelligent Rollup Efficiency\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 text-sm text-green-800 dark:text-green-300\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"How it works:\"}),\" When user segments have too few people for reliable statistics, we intelligently combine them with similar segments (same price range, similar economic regions) to reach the minimum group size of \",config.min_cohort_size,\" users. This ensures all analysis results are statistically meaningful.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-gray-600 dark:text-gray-400\",children:propertyAnalysis.rollup_stats.total_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-700 dark:text-gray-300\",children:\"Original Segments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600 dark:text-green-400\",children:propertyAnalysis.rollup_stats.viable_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-700 dark:text-green-300\",children:\"Viable Segments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-400\",children:propertyAnalysis.rollup_stats.rolled_up_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-700 dark:text-blue-300\",children:\"Rolled Up\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-400\",children:propertyAnalysis.rollup_stats.rolled_up_segments>0?\"\".concat((propertyAnalysis.rollup_stats.rolled_up_segments/propertyAnalysis.rollup_stats.total_segments*100).toFixed(1),\"%\"):'0%'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-700 dark:text-purple-300\",children:\"Segments Optimized\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-purple-600 dark:text-purple-400 mt-1\",children:propertyAnalysis.rollup_stats.rolled_up_segments>0?\"\".concat(propertyAnalysis.rollup_stats.rolled_up_segments,\" segments combined for efficiency\"):'All segments had sufficient data'})]})]}),propertyAnalysis.rollup_stats.accuracy_distribution&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-green-200 dark:border-green-700\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-sm font-medium text-green-800 dark:text-green-200 mb-2\",children:\"Accuracy Score Distribution:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\",children:['very_high','high','medium','low','very_low'].map(score=>{const count=propertyAnalysis.rollup_stats.accuracy_distribution[score]||0;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-2 bg-white dark:bg-gray-800 rounded border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-gray-900 dark:text-white\",children:count}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600 dark:text-gray-400 capitalize\",children:score.replace('_',' ')})]},score);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg border border-purple-200 dark:border-purple-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-400\",children:productSegments.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-800 dark:text-purple-300\",children:\"Products Analyzed\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-pink-600 dark:text-pink-400\",children:totalSegments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-pink-800 dark:text-pink-300\",children:\"Total Segments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600 dark:text-green-400\",children:viableSegments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-800 dark:text-green-300\",children:\"Ready for Analysis\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-green-600 dark:text-green-400\",children:[\"\\u2265\",config.min_cohort_size,\" users each\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-semibold text-gray-900 dark:text-white mb-3\",children:\"Understanding the Hierarchy View\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-medium text-gray-800 dark:text-gray-200 mb-2\",children:\"Status Indicators:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 mr-2\",children:\"\\u2705 PASSES\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:[\"Has enough users (\\u2265\",config.min_cohort_size,\") for reliable analysis\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2\",children:\"\\u26A0\\uFE0F HAS ROLLUPS\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Contains segments that roll up to broader categories (hover for details)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 mr-2\",children:\"\\u274C COMBINES\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Entire level needs to combine with others (hover for details)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2\",children:\"\\u2192 Target\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:\"Rollup target destination (hover for details)\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-medium text-gray-800 dark:text-gray-200 mb-2\",children:\"4-Level Hierarchy & Rollup Strategy:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-gray-600 dark:text-gray-400\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"1. \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83C\\uDFE2\\uD83D\\uDCF1\\uD83D\\uDCB0 Product+Store+Price\"}),\" (Level 1)\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"2. \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83C\\uDF0D Economic Tier\"}),\" (+ Economic grouping)\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"3. \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83C\\uDFC1 Country\"}),\" (+ Specific country)\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"4. \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCCD Region\"}),\" (+ Regional detail)\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 pt-2 border-t border-gray-300 dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rollup ceiling:\"}),\" Cannot roll up beyond Product+Store+Price level. Even if Level 1 fails, everything rolls up to that specific Product+Store+Price combination.\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-xs italic\",children:\"\\uD83D\\uDCA1 Hover over any status indicator for detailed rollup information\"})]})]})]})]}),productSegments.map(_ref5=>{var _propertyAnalysis$pri;let[productId,segments]=_ref5;// Build hierarchical structure\nconst hierarchy=buildHierarchicalStructure(segments,config.min_cohort_size);const priceBuckets=((_propertyAnalysis$pri=propertyAnalysis.price_buckets)===null||_propertyAnalysis$pri===void 0?void 0:_propertyAnalysis$pri[productId])||[];return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 border-b border-gray-200 dark:border-gray-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Package,{className:\"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-lg font-semibold text-gray-900 dark:text-white\",children:productId}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:\"Complete rollup hierarchy showing what passes and what combines\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-indigo-600 dark:text-indigo-400\",children:segments.reduce((sum,s)=>sum+s.user_count,0).toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:\"Total Users\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:Object.entries(hierarchy).map(_ref6=>{let[level1Key,level1Data]=_ref6;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 last:mb-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 bg-purple-500 rounded mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-semibold text-gray-900 dark:text-white\",children:[\"\\uD83C\\uDFE2 \",level1Data.productId,\" | \\uD83D\\uDCF1 \",formatAppStore(level1Data.appStore),\" | \\uD83D\\uDCB0 \",level1Data.priceRange]}),level1Data.segmentId&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[getSegmentIdBadge(level1Data.segmentId,'ID'),level1Data.rollupTargetSegmentId&&getRollupTargetIdBadge(level1Data.rollupTargetSegmentId)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[level1Data.totalUsers.toLocaleString(),\" users\"]}),getStatusIndicator(level1Data.passesThreshold,level1Data.rollupInfo,'product_store_price',level1Data.rollupInfo.rollupTarget)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-6 space-y-4\",children:Object.entries(level1Data.economicTiers).map(_ref7=>{let[tierName,tierData]=_ref7;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-indigo-500 rounded mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-md font-medium text-gray-700 dark:text-gray-300\",children:[\"\\uD83C\\uDF0D \",tierName]}),tierData.segmentId&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[getSegmentIdBadge(tierData.segmentId,'ID'),tierData.rollupTargetSegmentId&&getRollupTargetIdBadge(tierData.rollupTargetSegmentId)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[tierData.totalUsers.toLocaleString(),\" users\"]}),getStatusIndicator(tierData.passesThreshold,tierData.rollupInfo,'economic_tier',tierData.rollupInfo.rollupTarget)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-6 space-y-3\",children:Object.entries(tierData.countries).map(_ref8=>{let[country,countryData]=_ref8;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2.5 h-2.5 bg-blue-500 rounded mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-gray-700 dark:text-gray-300\",children:[\"\\uD83C\\uDFC1 \",country]}),countryData.segmentId&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[getSegmentIdBadge(countryData.segmentId,'ID'),countryData.rollupTargetSegmentId&&getRollupTargetIdBadge(countryData.rollupTargetSegmentId)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[countryData.totalUsers.toLocaleString(),\" users\"]}),getStatusIndicator(countryData.passesThreshold,countryData.rollupInfo,'country',countryData.rollupInfo.rollupTarget)]})]}),countryData.regions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"ml-6 space-y-1\",children:countryData.regions.map((region,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded mr-2\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:[\"\\uD83D\\uDCCD \",region.name]}),region.segmentId&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[getSegmentIdBadge(region.segmentId,'ID'),region.rollupTargetSegmentId&&getRollupTargetIdBadge(region.rollupTargetSegmentId)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-500\",children:[region.users.toLocaleString(),\" users\"]}),region.passes?/*#__PURE__*/_jsx(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300\",children:\"\\u2705 PASSES\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 cursor-help\",children:[\"\\u2192 \",region.rollupTarget]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10 whitespace-nowrap max-w-xs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium mb-1\",children:\"Rollup Details:\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Target: \",region.rollupTarget]}),region.rollupReason&&/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Reason: \",region.rollupReason]}),region.propertiesDropped&&region.propertiesDropped.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Properties dropped: \",region.propertiesDropped.join(', ')]}),region.finalUserCount&&region.finalUserCount!==region.originalUserCount&&/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Final user count: \",region.finalUserCount.toLocaleString()]}),region.rollupTargetSegmentId&&/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Target Segment ID: \",formatSegmentId(region.rollupTargetSegmentId)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full right-4 transform border-4 border-transparent border-t-gray-900 dark:border-t-gray-100\"})]})]})]})]},idx))})]},country);})})]},tierName);})})]},level1Key);})})]},productId);})]})]});})()]}),propertyAnalysis.rollup_stats&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Package,{className:\"h-5 w-5 mr-2\"}),\"Segment Optimization Summary\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-gray-600 dark:text-gray-400\",children:propertyAnalysis.rollup_stats.total_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-700 dark:text-gray-300\",children:\"Original Segments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600 dark:text-green-400\",children:propertyAnalysis.rollup_stats.viable_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-700 dark:text-green-300\",children:\"Viable Segments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-400\",children:propertyAnalysis.rollup_stats.rolled_up_segments}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-700 dark:text-blue-300\",children:\"Rolled Up\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-400\",children:propertyAnalysis.rollup_stats.rolled_up_segments>0?\"\".concat((propertyAnalysis.rollup_stats.rolled_up_segments/propertyAnalysis.rollup_stats.total_segments*100).toFixed(1),\"%\"):'0%'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-purple-700 dark:text-purple-300\",children:\"Segments Optimized\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-4 w-4 mr-2\"}),\"Analysis Methodology\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-blue-800 dark:text-blue-300 space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"User-Centric Analysis:\"}),\" Instead of generating theoretical combinations, we analyze your actual users and group them based on their real properties (product purchases, geographic location, app store). This ensures every segment represents real user behavior.\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Intelligent Grouping:\"}),\" When segments have insufficient users, we use a smart rollup strategy that combines related segments while preserving meaningful distinctions.\"]}),propertyAnalysis.bucketing_methodology&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price Bucketing:\"}),\" \",propertyAnalysis.bucketing_methodology.description]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 dark:text-white mb-3\",children:\"Hierarchical Rollup Analysis\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 dark:text-gray-400\",children:[\"Shows how segments are grouped and rolled up when they don't meet the minimum threshold of \",config.min_cohort_size,\" users\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFullDetails(!showFullDetails),className:\"px-3 py-1 text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors\",children:showFullDetails?'Hide Details':'Show Full Details'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:Object.entries(hierarchicalData).map(_ref9=>{let[level1Key,level1Data]=_ref9;return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 dark:border-gray-700 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-t-lg\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>toggleExpanded(level1Key),className:\"flex items-center justify-between w-full text-left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 transform transition-transform \".concat(expandedItems[level1Key]?'rotate-90':''),fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 5l7 7-7 7\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-gray-900 dark:text-white\",children:[level1Data.productId,\" \\u2022 \",level1Data.appStore,\" \\u2022 \",level1Data.priceRange]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:[level1Data.totalUsers.toLocaleString(),\" total users across \",level1Data.rollupInfo.totalSegments,\" segments\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[getStatusIndicator(level1Data.passesThreshold,level1Data.rollupInfo,'product',level1Data.rollupInfo.rollupTarget),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:level1Data.rollupInfo.rolledUpSegments>0&&\"\".concat(level1Data.rollupInfo.rolledUpSegments,\" rolled up\")})]})]})}),expandedItems[level1Key]&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 space-y-3\",children:Object.entries(level1Data.economicTiers).map(_ref0=>{let[tierName,tierData]=_ref0;return/*#__PURE__*/_jsxs(\"div\",{className:\"border-l-2 border-gray-300 dark:border-gray-600 pl-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>toggleExpanded(\"\".concat(level1Key,\"-\").concat(tierName)),className:\"flex items-center justify-between w-full text-left mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-3 h-3 transform transition-transform \".concat(expandedItems[\"\".concat(level1Key,\"-\").concat(tierName)]?'rotate-90':''),fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 5l7 7-7 7\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800 dark:text-gray-200\",children:tierName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[tierData.totalUsers.toLocaleString(),\" users across \",Object.keys(tierData.countries).length,\" countries\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:getStatusIndicator(tierData.passesThreshold,tierData.rollupInfo,'tier',tierData.rollupInfo.rollupTarget)})]}),expandedItems[\"\".concat(level1Key,\"-\").concat(tierName)]&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 ml-4\",children:Object.entries(tierData.countries).map(_ref1=>{let[country,countryData]=_ref1;return/*#__PURE__*/_jsxs(\"div\",{className:\"border-l border-gray-200 dark:border-gray-600 pl-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700 dark:text-gray-300 text-sm\",children:country}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[\"(\",countryData.totalUsers.toLocaleString(),\" users)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:getStatusIndicator(countryData.passesThreshold,countryData.rollupInfo,'country',countryData.rollupInfo.rollupTarget)})]}),showFullDetails&&countryData.regions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"ml-4 mt-1 space-y-1\",children:countryData.regions.map((region,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs py-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600 dark:text-gray-400\",children:[\"\\uD83D\\uDCCD \",region.name]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500 dark:text-gray-500\",children:[\"(\",region.users.toLocaleString(),\" users)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-1\",children:getStatusIndicator(region.passes,{rollupTarget:region.rollupTarget,rollupReasons:region.rollupReason?[region.rollupReason]:[],finalUserCount:region.finalUserCount,propertiesDropped:region.propertiesDropped},'region',region.rollupTarget)})]},idx))})]},\"\".concat(level1Key,\"-\").concat(tierName,\"-\").concat(country));})})]},\"\".concat(level1Key,\"-\").concat(tierName));})})]},level1Key);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 dark:text-white mb-3\",children:\"Rollup Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Total Product Combinations\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 dark:text-white\",children:Object.keys(hierarchicalData).length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Segments Meeting Threshold\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-green-600 dark:text-green-400\",children:Object.values(hierarchicalData).filter(d=>d.passesThreshold).length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Segments Requiring Rollup\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-orange-600 dark:text-orange-400\",children:Object.values(hierarchicalData).filter(d=>!d.passesThreshold).length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Total Users Analyzed\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 dark:text-white\",children:Object.values(hierarchicalData).reduce((sum,d)=>sum+d.totalUsers,0).toLocaleString()})]})]})]})]})]})]});};export default PropertyAnalysisResults;","map":{"version":3,"names":["React","useState","ChevronDown","ChevronRight","CheckCircle","Globe","Package","Info","TrendingUp","formatPercentage","buildHierarchicalStructure","getStatusIndicator","formatSegmentId","getSegmentIdBadge","getRollupTargetIdBadge","formatAppStore","jsx","_jsx","jsxs","_jsxs","PropertyAnalysisResults","_ref","_propertyAnalysis$use","_propertyAnalysis$use2","_propertyAnalysis$use3","_propertyAnalysis$use4","_propertyAnalysis$use5","_propertyAnalysis$use6","_propertyAnalysis$use7","_propertyAnalysis$use8","propertyAnalysis","expandedSections","onToggleSection","config","expandedItems","setExpandedItems","showFullDetails","setShowFullDetails","toggleExpanded","key","prev","_objectSpread","allSegments","user_segments","Object","values","forEach","productSegments","Array","isArray","push","hierarchicalData","min_cohort_size","className","children","onClick","products_analyzed","min_price_samples_used","total_combinations","toLocaleString","user_analysis","total_users_analyzed","total_countries_found","total_regions_found","app_stores","length","price_buckets","reduce","total","buckets","geographic_structure","geoData","countries","entries","map","_ref2","country","data","name","users","total_users","regions","keys","viableRegions","filter","r","user_count","sort","a","b","topCountries","slice","totalUsers","sum","c","totalRegions","Math","round","idx","style","width","concat","totalSegments","_ref3","_","segments","viableSegments","_ref4","s","has_sufficient_data","rollup_stats","total_segments","viable_segments","rolled_up_segments","toFixed","accuracy_distribution","score","count","replace","_ref5","_propertyAnalysis$pri","productId","hierarchy","priceBuckets","_ref6","level1Key","level1Data","appStore","priceRange","segmentId","rollupTargetSegmentId","passesThreshold","rollupInfo","rollupTarget","economicTiers","_ref7","tierName","tierData","_ref8","countryData","region","passes","rollupReason","propertiesDropped","join","finalUserCount","originalUserCount","bucketing_methodology","description","_ref9","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","rolledUpSegments","_ref0","_ref1","rollupReasons"],"sources":["/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/components/conversion_probability/PropertyAnalysisResults.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { ChevronDown, ChevronRight, CheckCircle, Globe, Package, Info, TrendingUp } from 'lucide-react';\nimport { formatPercentage, buildHierarchicalStructure, getStatusIndicator, formatSegmentId, getSegmentIdBadge, getRollupTargetIdBadge, formatAppStore } from './utils/conversionUtils';\n\nconst PropertyAnalysisResults = ({\n  propertyAnalysis,\n  expandedSections,\n  onToggleSection,\n  config\n}) => {\n  const [expandedItems, setExpandedItems] = useState({});\n  const [showFullDetails, setShowFullDetails] = useState(false);\n\n  const toggleExpanded = (key) => {\n    setExpandedItems(prev => ({\n      ...prev,\n      [key]: !prev[key]\n    }));\n  };\n\n  if (!propertyAnalysis) return null;\n\n  // Build hierarchical structure - user_segments is an object with productId keys\n  // We need to flatten all segments from all products into a single array\n  const allSegments = [];\n  if (propertyAnalysis.user_segments) {\n    Object.values(propertyAnalysis.user_segments).forEach(productSegments => {\n      if (Array.isArray(productSegments)) {\n        allSegments.push(...productSegments);\n      }\n    });\n  }\n  \n  const hierarchicalData = buildHierarchicalStructure(allSegments, config.min_cohort_size);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6\">\n      <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\n        <button\n          onClick={() => onToggleSection('propertyAnalysis')}\n          className=\"flex items-center justify-between w-full text-left\"\n        >\n          <div className=\"flex items-center\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n              Step 2: Data Structure Discovery Results\n            </h3>\n            <span className=\"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200\">\n              âœ“ Complete\n            </span>\n          </div>\n          {expandedSections.propertyAnalysis ? (\n            <ChevronDown className=\"h-5 w-5 text-gray-500\" />\n          ) : (\n            <ChevronRight className=\"h-5 w-5 text-gray-500\" />\n          )}\n        </button>\n      </div>\n      \n      {expandedSections.propertyAnalysis && (\n        <div className=\"p-6\">\n          {/* Overview Summary */}\n          <div className=\"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\n            <h4 className=\"text-sm font-semibold text-green-900 dark:text-green-200 mb-2 flex items-center\">\n              <CheckCircle className=\"h-4 w-4 mr-2\" />\n              What This Analysis Discovered\n            </h4>\n            <p className=\"text-sm text-green-800 dark:text-green-300 mb-3\">\n              We analyzed your actual users and grouped them into meaningful segments. Here's what we found:\n            </p>\n            <ul className=\"text-sm text-green-800 dark:text-green-300 space-y-1 list-disc list-inside\">\n              <li><strong>{propertyAnalysis.products_analyzed} products</strong> with sufficient data for analysis (at least {propertyAnalysis.min_price_samples_used || 100} price samples each)</li>\n              <li><strong>{propertyAnalysis.total_combinations.toLocaleString()} viable user segments</strong> based on actual user data</li>\n              <li><strong>{propertyAnalysis.user_analysis?.total_users_analyzed?.toLocaleString() || 0} total users</strong> analyzed across all segments</li>\n              <li><strong>Geographic coverage:</strong> {propertyAnalysis.user_analysis?.total_countries_found || 0} countries and {propertyAnalysis.user_analysis?.total_regions_found || 0} regions with active users</li>\n              <li><strong>App stores:</strong> {propertyAnalysis.user_analysis?.app_stores?.length || 0} different stores</li>\n            </ul>\n          </div>\n          \n          {/* Key Metrics */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\">\n            <div className=\"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\n              <div className=\"text-3xl font-bold text-blue-600 dark:text-blue-400\">\n                {propertyAnalysis.products_analyzed}\n              </div>\n              <div className=\"text-sm text-blue-800 dark:text-blue-300 font-medium\">Products Found</div>\n              <div className=\"text-xs text-blue-600 dark:text-blue-400 mt-1\">\n                Products with enough data for reliable analysis\n              </div>\n            </div>\n            \n            <div className=\"text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg\">\n              <div className=\"text-3xl font-bold text-purple-600 dark:text-purple-400\">\n                {Object.values(propertyAnalysis.price_buckets || {}).reduce((total, buckets) => total + buckets.length, 0)}\n              </div>\n              <div className=\"text-sm text-purple-800 dark:text-purple-300 font-medium\">Price Groups</div>\n              <div className=\"text-xs text-purple-600 dark:text-purple-400 mt-1\">\n                Intelligent price ranges created for analysis\n              </div>\n            </div>\n            \n            <div className=\"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n              <div className=\"text-3xl font-bold text-green-600 dark:text-green-400\">\n                {propertyAnalysis.user_analysis?.total_countries_found || 0}\n              </div>\n              <div className=\"text-sm text-green-800 dark:text-green-300 font-medium\">Countries</div>\n              <div className=\"text-xs text-green-600 dark:text-green-400 mt-1\">\n                Countries with active users\n              </div>\n            </div>\n            \n            <div className=\"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg\">\n              <div className=\"text-3xl font-bold text-orange-600 dark:text-orange-400\">\n                {propertyAnalysis.total_combinations.toLocaleString()}\n              </div>\n              <div className=\"text-sm text-orange-800 dark:text-orange-300 font-medium\">User Segments</div>\n              <div className=\"text-xs text-orange-600 dark:text-orange-400 mt-1\">\n                Viable segments found in your data\n              </div>\n            </div>\n          </div>\n\n          {/* Geographic Market Overview */}\n          {propertyAnalysis.user_analysis?.geographic_structure && (\n            <div className=\"mb-6\">\n              <h4 className=\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Globe className=\"h-5 w-5 mr-2\" />\n                Global Market Overview\n              </h4>\n              \n              {(() => {\n                const geoData = propertyAnalysis.user_analysis.geographic_structure;\n                const countries = Object.entries(geoData).map(([country, data]) => ({\n                  name: country,\n                  users: data.total_users,\n                  regions: Object.keys(data.regions).length,\n                  viableRegions: Object.values(data.regions).filter(r => r.user_count >= 50).length\n                })).sort((a, b) => b.users - a.users);\n                \n                const topCountries = countries.slice(0, 10);\n                const totalUsers = countries.reduce((sum, c) => sum + c.users, 0);\n                const totalRegions = countries.reduce((sum, c) => sum + c.regions, 0);\n                const viableRegions = countries.reduce((sum, c) => sum + c.viableRegions, 0);\n                \n                return (\n                  <div className=\"space-y-4\">\n                    {/* Summary Stats */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{countries.length}</div>\n                        <div className=\"text-sm text-blue-800 dark:text-blue-300\">Total Countries</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-indigo-600 dark:text-indigo-400\">{totalRegions}</div>\n                        <div className=\"text-sm text-indigo-800 dark:text-indigo-300\">Total Regions</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{viableRegions}</div>\n                        <div className=\"text-sm text-green-800 dark:text-green-300\">Viable Regions</div>\n                        <div className=\"text-xs text-green-600 dark:text-green-400\">â‰¥50 users each</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">{Math.round((viableRegions / totalRegions) * 100)}%</div>\n                        <div className=\"text-sm text-purple-800 dark:text-purple-300\">Data Coverage</div>\n                        <div className=\"text-xs text-purple-600 dark:text-purple-400\">Regions with sufficient data</div>\n                      </div>\n                    </div>\n                    \n                    {/* Top Countries Table */}\n                    <div className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden\">\n                      <div className=\"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-600\">\n                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">Top Markets by User Count</h5>\n                      </div>\n                      <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\">\n                          <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                            <tr>\n                              <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Country</th>\n                              <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Users</th>\n                              <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Market Share</th>\n                              <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Regions</th>\n                              <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Data Quality</th>\n                            </tr>\n                          </thead>\n                          <tbody className=\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\">\n                            {topCountries.map((country, idx) => (\n                              <tr key={country.name} className={idx % 2 === 0 ? 'bg-white dark:bg-gray-700' : 'bg-gray-50 dark:bg-gray-800'}>\n                                <td className=\"px-4 py-3 whitespace-nowrap\">\n                                  <div className=\"flex items-center\">\n                                    <span className=\"text-sm font-medium text-gray-900 dark:text-white\">{country.name}</span>\n                                    {idx < 3 && (\n                                      <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200\">\n                                        Top {idx + 1}\n                                      </span>\n                                    )}\n                                  </div>\n                                </td>\n                                <td className=\"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-white font-medium\">\n                                  {country.users.toLocaleString()}\n                                </td>\n                                <td className=\"px-4 py-3 whitespace-nowrap\">\n                                  <div className=\"flex items-center\">\n                                    <div className=\"w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-2 mr-2\">\n                                      <div \n                                        className=\"bg-blue-600 h-2 rounded-full\" \n                                        style={{ width: `${(country.users / totalUsers) * 100}%` }}\n                                      ></div>\n                                    </div>\n                                    <span className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                      {Math.round((country.users / totalUsers) * 100)}%\n                                    </span>\n                                  </div>\n                                </td>\n                                <td className=\"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\">\n                                  {country.regions} total\n                                </td>\n                                <td className=\"px-4 py-3 whitespace-nowrap\">\n                                  <div className=\"flex items-center\">\n                                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\n                                      country.viableRegions / country.regions >= 0.5\n                                        ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n                                        : country.viableRegions / country.regions >= 0.25\n                                        ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'\n                                        : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n                                    }`}>\n                                      {country.viableRegions}/{country.regions} viable\n                                    </span>\n                                  </div>\n                                </td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                      {countries.length > 10 && (\n                        <div className=\"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-600 text-sm text-gray-500 dark:text-gray-400\">\n                          Showing top 10 of {countries.length} countries. {countries.length - 10} additional countries with smaller user bases.\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                );\n              })()}\n            </div>\n          )}\n\n          {/* Product Segment Analysis */}\n          {propertyAnalysis.user_segments && (\n            <div className=\"mb-6\">\n              <h4 className=\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Package className=\"h-5 w-5 mr-2\" />\n                Product Segment Analysis - Hierarchical View\n              </h4>\n              \n              {(() => {\n                const productSegments = Object.entries(propertyAnalysis.user_segments);\n                const totalSegments = productSegments.reduce((sum, [_, segments]) => sum + segments.length, 0);\n                const viableSegments = productSegments.reduce((sum, [_, segments]) => \n                  sum + segments.filter(s => s.has_sufficient_data).length, 0);\n                \n                return (\n                  <div className=\"space-y-6\">\n                    {/* Rollup Efficiency Summary */}\n                    {propertyAnalysis.rollup_stats && (\n                      <div className=\"p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                        <h5 className=\"text-lg font-semibold text-green-900 dark:text-green-200 mb-3 flex items-center\">\n                          <TrendingUp className=\"h-5 w-5 mr-2\" />\n                          Intelligent Rollup Efficiency\n                        </h5>\n                        <div className=\"mb-3 text-sm text-green-800 dark:text-green-300\">\n                          <strong>How it works:</strong> When user segments have too few people for reliable statistics, \n                          we intelligently combine them with similar segments (same price range, similar economic regions) \n                          to reach the minimum group size of {config.min_cohort_size} users. This ensures all analysis \n                          results are statistically meaningful.\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                          <div className=\"text-center\">\n                            <div className=\"text-2xl font-bold text-gray-600 dark:text-gray-400\">{propertyAnalysis.rollup_stats.total_segments}</div>\n                            <div className=\"text-sm text-gray-700 dark:text-gray-300\">Original Segments</div>\n                          </div>\n                          <div className=\"text-center\">\n                            <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{propertyAnalysis.rollup_stats.viable_segments}</div>\n                            <div className=\"text-sm text-green-700 dark:text-green-300\">Viable Segments</div>\n                          </div>\n                          <div className=\"text-center\">\n                            <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{propertyAnalysis.rollup_stats.rolled_up_segments}</div>\n                            <div className=\"text-sm text-blue-700 dark:text-blue-300\">Rolled Up</div>\n                          </div>\n                          <div className=\"text-center\">\n                            <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\n                              {propertyAnalysis.rollup_stats.rolled_up_segments > 0 ? \n                                `${((propertyAnalysis.rollup_stats.rolled_up_segments / propertyAnalysis.rollup_stats.total_segments) * 100).toFixed(1)}%` :\n                                '0%'\n                              }\n                            </div>\n                            <div className=\"text-sm text-purple-700 dark:text-purple-300\">Segments Optimized</div>\n                            <div className=\"text-xs text-purple-600 dark:text-purple-400 mt-1\">\n                              {propertyAnalysis.rollup_stats.rolled_up_segments > 0 ? \n                                `${propertyAnalysis.rollup_stats.rolled_up_segments} segments combined for efficiency` :\n                                'All segments had sufficient data'\n                              }\n                            </div>\n                          </div>\n                        </div>\n                        \n                        {/* Accuracy Distribution */}\n                        {propertyAnalysis.rollup_stats.accuracy_distribution && (\n                          <div className=\"mt-4 pt-4 border-t border-green-200 dark:border-green-700\">\n                            <h6 className=\"text-sm font-medium text-green-800 dark:text-green-200 mb-2\">Accuracy Score Distribution:</h6>\n                            <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\">\n                              {/* Order accuracy scores from Very High to Very Low */}\n                              {['very_high', 'high', 'medium', 'low', 'very_low'].map(score => {\n                                const count = propertyAnalysis.rollup_stats.accuracy_distribution[score] || 0;\n                                return (\n                                  <div key={score} className=\"text-center p-2 bg-white dark:bg-gray-800 rounded border\">\n                                    <div className=\"font-semibold text-gray-900 dark:text-white\">{count}</div>\n                                    <div className=\"text-gray-600 dark:text-gray-400 capitalize\">{score.replace('_', ' ')}</div>\n                                  </div>\n                                );\n                              })}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                    \n                    {/* Summary */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg border border-purple-200 dark:border-purple-800\">\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">{productSegments.length}</div>\n                        <div className=\"text-sm text-purple-800 dark:text-purple-300\">Products Analyzed</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-pink-600 dark:text-pink-400\">{totalSegments}</div>\n                        <div className=\"text-sm text-pink-800 dark:text-pink-300\">Total Segments</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{viableSegments}</div>\n                        <div className=\"text-sm text-green-800 dark:text-green-300\">Ready for Analysis</div>\n                        <div className=\"text-xs text-green-600 dark:text-green-400\">â‰¥{config.min_cohort_size} users each</div>\n                      </div>\n                    </div>\n                    \n                    {/* Hierarchical Tree View for each Product */}\n                    <div className=\"space-y-8\">\n                      {/* Legend */}\n                      <div className=\"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-600\">\n                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">Understanding the Hierarchy View</h5>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs\">\n                          <div>\n                            <h6 className=\"font-medium text-gray-800 dark:text-gray-200 mb-2\">Status Indicators:</h6>\n                            <div className=\"space-y-1\">\n                              <div className=\"flex items-center\">\n                                <span className=\"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 mr-2\">âœ… PASSES</span>\n                                <span className=\"text-gray-600 dark:text-gray-400\">Has enough users (â‰¥{config.min_cohort_size}) for reliable analysis</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <span className=\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2\">âš ï¸ HAS ROLLUPS</span>\n                                <span className=\"text-gray-600 dark:text-gray-400\">Contains segments that roll up to broader categories (hover for details)</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <span className=\"px-1 py-0.5 rounded text-xs bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 mr-2\">âŒ COMBINES</span>\n                                <span className=\"text-gray-600 dark:text-gray-400\">Entire level needs to combine with others (hover for details)</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <span className=\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2\">â†’ Target</span>\n                                <span className=\"text-gray-600 dark:text-gray-400\">Rollup target destination (hover for details)</span>\n                              </div>\n                            </div>\n                          </div>\n                          <div>\n                            <h6 className=\"font-medium text-gray-800 dark:text-gray-200 mb-2\">4-Level Hierarchy & Rollup Strategy:</h6>\n                            <div className=\"space-y-1 text-gray-600 dark:text-gray-400\">\n                              <div>1. <strong>ðŸ¢ðŸ“±ðŸ’° Product+Store+Price</strong> (Level 1)</div>\n                              <div>2. <strong>ðŸŒ Economic Tier</strong> (+ Economic grouping)</div>\n                              <div>3. <strong>ðŸ Country</strong> (+ Specific country)</div>\n                              <div>4. <strong>ðŸ“ Region</strong> (+ Regional detail)</div>\n                              <div className=\"mt-2 pt-2 border-t border-gray-300 dark:border-gray-600\">\n                                <strong>Rollup ceiling:</strong> Cannot roll up beyond Product+Store+Price level. Even if Level 1 fails, everything rolls up to that specific Product+Store+Price combination.\n                              </div>\n                              <div className=\"mt-2 text-xs italic\">ðŸ’¡ Hover over any status indicator for detailed rollup information</div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {productSegments.map(([productId, segments]) => {\n                        // Build hierarchical structure\n                        const hierarchy = buildHierarchicalStructure(segments, config.min_cohort_size);\n                        const priceBuckets = propertyAnalysis.price_buckets?.[productId] || [];\n                        \n                        return (\n                          <div key={productId} className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden\">\n                            {/* Product Header */}\n                            <div className=\"px-6 py-4 bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 border-b border-gray-200 dark:border-gray-600\">\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"flex items-center\">\n                                  <Package className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-3\" />\n                                  <div>\n                                    <h5 className=\"text-lg font-semibold text-gray-900 dark:text-white\">{productId}</h5>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                      Complete rollup hierarchy showing what passes and what combines\n                                    </p>\n                                  </div>\n                                </div>\n                                <div className=\"text-right\">\n                                  <div className=\"text-2xl font-bold text-indigo-600 dark:text-indigo-400\">\n                                    {segments.reduce((sum, s) => sum + s.user_count, 0).toLocaleString()}\n                                  </div>\n                                  <div className=\"text-sm text-gray-600 dark:text-gray-400\">Total Users</div>\n                                </div>\n                              </div>\n                            </div>\n                            \n                            {/* Hierarchical Tree */}\n                            <div className=\"p-6\">\n                              {Object.entries(hierarchy).map(([level1Key, level1Data]) => (\n                                <div key={level1Key} className=\"mb-8 last:mb-0\">\n                                  {/* Product + Store + Price Level (Level 1) */}\n                                  <div className=\"flex items-center mb-4\">\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-4 h-4 bg-purple-500 rounded mr-3\"></div>\n                                      <div className=\"flex items-center space-x-2\">\n                                        <span className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                          ðŸ¢ {level1Data.productId} | ðŸ“± {formatAppStore(level1Data.appStore)} | ðŸ’° {level1Data.priceRange}\n                                        </span>\n                                        {/* Add segment ID for Product+Store+Price level */}\n                                        {level1Data.segmentId && (\n                                          <div className=\"flex items-center space-x-1\">\n                                            {getSegmentIdBadge(level1Data.segmentId, 'ID')}\n                                            {level1Data.rollupTargetSegmentId && getRollupTargetIdBadge(level1Data.rollupTargetSegmentId)}\n                                          </div>\n                                        )}\n                                      </div>\n                                    </div>\n                                    <div className=\"ml-auto flex items-center space-x-4\">\n                                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                        {level1Data.totalUsers.toLocaleString()} users\n                                      </span>\n                                      {getStatusIndicator(level1Data.passesThreshold, level1Data.rollupInfo, 'product_store_price', level1Data.rollupInfo.rollupTarget)}\n                                    </div>\n                                  </div>\n                                  \n                                  {/* Economic Tiers (Level 2) */}\n                                  <div className=\"ml-6 space-y-4\">\n                                    {Object.entries(level1Data.economicTiers).map(([tierName, tierData]) => (\n                                      <div key={tierName}>\n                                        {/* Economic Tier Level */}\n                                        <div className=\"flex items-center mb-3\">\n                                          <div className=\"flex items-center\">\n                                            <div className=\"w-3 h-3 bg-indigo-500 rounded mr-3\"></div>\n                                            <div className=\"flex items-center space-x-2\">\n                                              <span className=\"text-md font-medium text-gray-700 dark:text-gray-300\">\n                                                ðŸŒ {tierName}\n                                              </span>\n                                              {/* Add segment ID for Economic Tier level */}\n                                              {tierData.segmentId && (\n                                                <div className=\"flex items-center space-x-1\">\n                                                  {getSegmentIdBadge(tierData.segmentId, 'ID')}\n                                                  {tierData.rollupTargetSegmentId && getRollupTargetIdBadge(tierData.rollupTargetSegmentId)}\n                                                </div>\n                                              )}\n                                            </div>\n                                          </div>\n                                          <div className=\"ml-auto flex items-center space-x-3\">\n                                            <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                              {tierData.totalUsers.toLocaleString()} users\n                                            </span>\n                                            {getStatusIndicator(tierData.passesThreshold, tierData.rollupInfo, 'economic_tier', tierData.rollupInfo.rollupTarget)}\n                                          </div>\n                                        </div>\n                                        \n                                        {/* Countries (Level 3) */}\n                                        <div className=\"ml-6 space-y-3\">\n                                          {Object.entries(tierData.countries).map(([country, countryData]) => (\n                                            <div key={country}>\n                                              {/* Country Level */}\n                                              <div className=\"flex items-center mb-2\">\n                                                <div className=\"flex items-center\">\n                                                  <div className=\"w-2.5 h-2.5 bg-blue-500 rounded mr-3\"></div>\n                                                  <div className=\"flex items-center space-x-2\">\n                                                    <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                                      ðŸ {country}\n                                                    </span>\n                                                    {/* Add segment ID for Country level */}\n                                                    {countryData.segmentId && (\n                                                      <div className=\"flex items-center space-x-1\">\n                                                        {getSegmentIdBadge(countryData.segmentId, 'ID')}\n                                                        {countryData.rollupTargetSegmentId && getRollupTargetIdBadge(countryData.rollupTargetSegmentId)}\n                                                      </div>\n                                                    )}\n                                                  </div>\n                                                </div>\n                                                <div className=\"ml-auto flex items-center space-x-3\">\n                                                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                    {countryData.totalUsers.toLocaleString()} users\n                                                  </span>\n                                                  {getStatusIndicator(countryData.passesThreshold, countryData.rollupInfo, 'country', countryData.rollupInfo.rollupTarget)}\n                                                </div>\n                                              </div>\n                                              \n                                              {/* Regions (Level 4) */}\n                                              {countryData.regions.length > 0 && (\n                                                <div className=\"ml-6 space-y-1\">\n                                                  {countryData.regions.map((region, idx) => (\n                                                    <div key={idx} className=\"flex items-center justify-between py-1\">\n                                                      <div className=\"flex items-center\">\n                                                        <div className=\"w-2 h-2 bg-green-500 rounded mr-2\"></div>\n                                                        <div className=\"flex items-center space-x-2\">\n                                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\">\n                                                            ðŸ“ {region.name}\n                                                          </span>\n                                                          {/* Add segment ID for region */}\n                                                          {region.segmentId && (\n                                                            <div className=\"flex items-center space-x-1\">\n                                                              {getSegmentIdBadge(region.segmentId, 'ID')}\n                                                              {region.rollupTargetSegmentId && getRollupTargetIdBadge(region.rollupTargetSegmentId)}\n                                                            </div>\n                                                          )}\n                                                        </div>\n                                                      </div>\n                                                      <div className=\"flex items-center space-x-2\">\n                                                        <span className=\"text-xs text-gray-500 dark:text-gray-500\">\n                                                          {region.users.toLocaleString()} users\n                                                        </span>\n                                                        {region.passes ? (\n                                                          <span className=\"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300\">\n                                                            âœ… PASSES\n                                                          </span>\n                                                        ) : (\n                                                          <div className=\"relative group\">\n                                                            <span className=\"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 cursor-help\">\n                                                              â†’ {region.rollupTarget}\n                                                            </span>\n                                                            \n                                                            {/* Hover tooltip for region rollup details */}\n                                                            <div className=\"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10 whitespace-nowrap max-w-xs\">\n                                                              <div className=\"text-xs\">\n                                                                <div className=\"font-medium mb-1\">Rollup Details:</div>\n                                                                <div>â€¢ Target: {region.rollupTarget}</div>\n                                                                {region.rollupReason && (\n                                                                  <div>â€¢ Reason: {region.rollupReason}</div>\n                                                                )}\n                                                                {region.propertiesDropped && region.propertiesDropped.length > 0 && (\n                                                                  <div>â€¢ Properties dropped: {region.propertiesDropped.join(', ')}</div>\n                                                                )}\n                                                                {region.finalUserCount && region.finalUserCount !== region.originalUserCount && (\n                                                                  <div>â€¢ Final user count: {region.finalUserCount.toLocaleString()}</div>\n                                                                )}\n                                                                {region.rollupTargetSegmentId && (\n                                                                  <div>â€¢ Target Segment ID: {formatSegmentId(region.rollupTargetSegmentId)}</div>\n                                                                )}\n                                                              </div>\n                                                              <div className=\"absolute top-full right-4 transform border-4 border-transparent border-t-gray-900 dark:border-t-gray-100\"></div>\n                                                            </div>\n                                                          </div>\n                                                        )}\n                                                      </div>\n                                                    </div>\n                                                  ))}\n                                                </div>\n                                              )}\n                                            </div>\n                                          ))}\n                                        </div>\n                                      </div>\n                                    ))}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                );\n              })()}\n            </div>\n          )}\n\n          {/* Rollup Statistics */}\n          {propertyAnalysis.rollup_stats && (\n            <div className=\"mb-6\">\n              <h4 className=\"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Package className=\"h-5 w-5 mr-2\" />\n                Segment Optimization Summary\n              </h4>\n              <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-gray-600 dark:text-gray-400\">{propertyAnalysis.rollup_stats.total_segments}</div>\n                    <div className=\"text-sm text-gray-700 dark:text-gray-300\">Original Segments</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{propertyAnalysis.rollup_stats.viable_segments}</div>\n                    <div className=\"text-sm text-green-700 dark:text-green-300\">Viable Segments</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{propertyAnalysis.rollup_stats.rolled_up_segments}</div>\n                    <div className=\"text-sm text-blue-700 dark:text-blue-300\">Rolled Up</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\n                      {propertyAnalysis.rollup_stats.rolled_up_segments > 0 ? \n                        `${((propertyAnalysis.rollup_stats.rolled_up_segments / propertyAnalysis.rollup_stats.total_segments) * 100).toFixed(1)}%` :\n                        '0%'\n                      }\n                    </div>\n                    <div className=\"text-sm text-purple-700 dark:text-purple-300\">Segments Optimized</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Methodology Summary */}\n          <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n            <h4 className=\"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-2 flex items-center\">\n              <Info className=\"h-4 w-4 mr-2\" />\n              Analysis Methodology\n            </h4>\n            <div className=\"text-sm text-blue-800 dark:text-blue-300 space-y-2\">\n              <div>\n                <strong>User-Centric Analysis:</strong> Instead of generating theoretical combinations, we analyze your actual users \n                and group them based on their real properties (product purchases, geographic location, app store). This ensures \n                every segment represents real user behavior.\n              </div>\n              <div>\n                <strong>Intelligent Grouping:</strong> When segments have insufficient users, we use a smart rollup strategy \n                that combines related segments while preserving meaningful distinctions.\n              </div>\n              {propertyAnalysis.bucketing_methodology && (\n                <div>\n                  <strong>Price Bucketing:</strong> {propertyAnalysis.bucketing_methodology.description}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Hierarchical Rollup Analysis */}\n          <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n            <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">Hierarchical Rollup Analysis</h4>\n            <div className=\"mb-4 flex items-center justify-between\">\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Shows how segments are grouped and rolled up when they don't meet the minimum threshold of {config.min_cohort_size} users\n              </div>\n              <button\n                onClick={() => setShowFullDetails(!showFullDetails)}\n                className=\"px-3 py-1 text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors\"\n              >\n                {showFullDetails ? 'Hide Details' : 'Show Full Details'}\n              </button>\n            </div>\n\n            <div className=\"space-y-4\">\n              {Object.entries(hierarchicalData).map(([level1Key, level1Data]) => (\n                <div key={level1Key} className=\"border border-gray-200 dark:border-gray-700 rounded-lg\">\n                  {/* Level 1: Product + Store + Price */}\n                  <div className=\"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-t-lg\">\n                    <button\n                      onClick={() => toggleExpanded(level1Key)}\n                      className=\"flex items-center justify-between w-full text-left\"\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        <svg\n                          className={`w-4 h-4 transform transition-transform ${expandedItems[level1Key] ? 'rotate-90' : ''}`}\n                          fill=\"none\"\n                          stroke=\"currentColor\"\n                          viewBox=\"0 0 24 24\"\n                        >\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                        </svg>\n                        <div>\n                          <div className=\"font-medium text-gray-900 dark:text-white\">\n                            {level1Data.productId} â€¢ {level1Data.appStore} â€¢ {level1Data.priceRange}\n                          </div>\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {level1Data.totalUsers.toLocaleString()} total users across {level1Data.rollupInfo.totalSegments} segments\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        {getStatusIndicator(level1Data.passesThreshold, level1Data.rollupInfo, 'product', level1Data.rollupInfo.rollupTarget)}\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                          {level1Data.rollupInfo.rolledUpSegments > 0 && `${level1Data.rollupInfo.rolledUpSegments} rolled up`}\n                        </span>\n                      </div>\n                    </button>\n                  </div>\n\n                  {expandedItems[level1Key] && (\n                    <div className=\"p-3 space-y-3\">\n                      {Object.entries(level1Data.economicTiers).map(([tierName, tierData]) => (\n                        <div key={`${level1Key}-${tierName}`} className=\"border-l-2 border-gray-300 dark:border-gray-600 pl-4\">\n                          {/* Level 2: Economic Tier */}\n                          <button\n                            onClick={() => toggleExpanded(`${level1Key}-${tierName}`)}\n                            className=\"flex items-center justify-between w-full text-left mb-2\"\n                          >\n                            <div className=\"flex items-center space-x-3\">\n                              <svg\n                                className={`w-3 h-3 transform transition-transform ${expandedItems[`${level1Key}-${tierName}`] ? 'rotate-90' : ''}`}\n                                fill=\"none\"\n                                stroke=\"currentColor\"\n                                viewBox=\"0 0 24 24\"\n                              >\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                              </svg>\n                              <div>\n                                <div className=\"font-medium text-gray-800 dark:text-gray-200\">\n                                  {tierName}\n                                </div>\n                                <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                  {tierData.totalUsers.toLocaleString()} users across {Object.keys(tierData.countries).length} countries\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"flex items-center space-x-2\">\n                              {getStatusIndicator(tierData.passesThreshold, tierData.rollupInfo, 'tier', tierData.rollupInfo.rollupTarget)}\n                            </div>\n                          </button>\n\n                          {expandedItems[`${level1Key}-${tierName}`] && (\n                            <div className=\"space-y-2 ml-4\">\n                              {Object.entries(tierData.countries).map(([country, countryData]) => (\n                                <div key={`${level1Key}-${tierName}-${country}`} className=\"border-l border-gray-200 dark:border-gray-600 pl-3\">\n                                  {/* Level 3: Country */}\n                                  <div className=\"flex items-center justify-between py-1\">\n                                    <div className=\"flex items-center space-x-2\">\n                                      <span className=\"font-medium text-gray-700 dark:text-gray-300 text-sm\">\n                                        {country}\n                                      </span>\n                                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                        ({countryData.totalUsers.toLocaleString()} users)\n                                      </span>\n                                    </div>\n                                    <div className=\"flex items-center space-x-2\">\n                                      {getStatusIndicator(countryData.passesThreshold, countryData.rollupInfo, 'country', countryData.rollupInfo.rollupTarget)}\n                                    </div>\n                                  </div>\n\n                                  {/* Level 4: Regions (if any) */}\n                                  {showFullDetails && countryData.regions.length > 0 && (\n                                    <div className=\"ml-4 mt-1 space-y-1\">\n                                      {countryData.regions.map((region, idx) => (\n                                        <div key={idx} className=\"flex items-center justify-between text-xs py-1\">\n                                          <div className=\"flex items-center space-x-2\">\n                                            <span className=\"text-gray-600 dark:text-gray-400\">\n                                              ðŸ“ {region.name}\n                                            </span>\n                                            <span className=\"text-gray-500 dark:text-gray-500\">\n                                              ({region.users.toLocaleString()} users)\n                                            </span>\n                                          </div>\n                                          <div className=\"flex items-center space-x-1\">\n                                            {getStatusIndicator(region.passes, {\n                                              rollupTarget: region.rollupTarget,\n                                              rollupReasons: region.rollupReason ? [region.rollupReason] : [],\n                                              finalUserCount: region.finalUserCount,\n                                              propertiesDropped: region.propertiesDropped\n                                            }, 'region', region.rollupTarget)}\n                                          </div>\n                                        </div>\n                                      ))}\n                                    </div>\n                                  )}\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n\n            {/* Summary Statistics */}\n            <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\n              <h4 className=\"font-medium text-gray-900 dark:text-white mb-3\">Rollup Summary</h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                <div>\n                  <div className=\"text-gray-500 dark:text-gray-400\">Total Product Combinations</div>\n                  <div className=\"font-medium text-gray-900 dark:text-white\">\n                    {Object.keys(hierarchicalData).length}\n                  </div>\n                </div>\n                <div>\n                  <div className=\"text-gray-500 dark:text-gray-400\">Segments Meeting Threshold</div>\n                  <div className=\"font-medium text-green-600 dark:text-green-400\">\n                    {Object.values(hierarchicalData).filter(d => d.passesThreshold).length}\n                  </div>\n                </div>\n                <div>\n                  <div className=\"text-gray-500 dark:text-gray-400\">Segments Requiring Rollup</div>\n                  <div className=\"font-medium text-orange-600 dark:text-orange-400\">\n                    {Object.values(hierarchicalData).filter(d => !d.passesThreshold).length}\n                  </div>\n                </div>\n                <div>\n                  <div className=\"text-gray-500 dark:text-gray-400\">Total Users Analyzed</div>\n                  <div className=\"font-medium text-gray-900 dark:text-white\">\n                    {Object.values(hierarchicalData).reduce((sum, d) => sum + d.totalUsers, 0).toLocaleString()}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PropertyAnalysisResults; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}