{"ast":null,"code":"var _jsxFileName = \"/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/cohort-pipeline/components/Stage3RevenueResultsV3.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from 'react';\nimport { TrendingUp, Users, DollarSign, Clock, Activity, AlertCircle, Database, Calculator, Target, User, Globe, Package } from 'lucide-react';\nimport EventTimelineTableV3 from './EventTimelineTableV3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Stage3RevenueResultsV3 = ({\n  data\n}) => {\n  _s();\n  var _data$stage_results, _data$data, _data$data$stage_resu, _stage3Data, _userTimelines$select3, _userTimelines$select4, _userTimelines$select5, _userTimelines$select6, _userTimelines$select7;\n  const [selectedUser, setSelectedUser] = useState(''); // Empty string means aggregate view\n  const [userSearchTerm, setUserSearchTerm] = useState('');\n  const [selectedProductId, setSelectedProductId] = useState(''); // NEW: Product selector state\n\n  // Handle multiple API response formats for data access\n  let stage3Data = null;\n  if (data !== null && data !== void 0 && (_data$stage_results = data.stage_results) !== null && _data$stage_results !== void 0 && _data$stage_results.stage3) {\n    // Direct format: pipelineData.stage_results.stage3\n    stage3Data = data.stage_results.stage3;\n  } else if (data !== null && data !== void 0 && (_data$data = data.data) !== null && _data$data !== void 0 && (_data$data$stage_resu = _data$data.stage_results) !== null && _data$data$stage_resu !== void 0 && _data$data$stage_resu.stage3) {\n    // Nested format: pipelineData.data.stage_results.stage3\n    stage3Data = data.data.stage_results.stage3;\n  }\n  const timelineResults = ((_stage3Data = stage3Data) === null || _stage3Data === void 0 ? void 0 : _stage3Data.timeline_results) || {};\n  const aggregateStats = timelineResults.aggregate_stats || {};\n  const userTimelines = timelineResults.user_timelines || {};\n\n  // NEW: Backend now provides EventTimelineTable format data directly\n  const backendTimelineData = timelineResults.timeline_data || {};\n  const backendUserDailyMetrics = timelineResults.user_daily_metrics || {};\n  const backendUserTimelinesEvents = timelineResults.user_timelines_events || {};\n\n  // 🔍 FRONTEND TIMELINE DEBUG: Log the data received from backend\n  if (Object.keys(timelineResults).length > 0) {\n    console.log('🔍 [FRONTEND TIMELINE DEBUG] Data received from backend:');\n    console.log('🔍   - timeline_data dates:', backendTimelineData ? Object.keys(backendTimelineData).length : 0);\n    console.log('🔍   - user_daily_metrics users:', backendUserDailyMetrics ? Object.keys(backendUserDailyMetrics).length : 0);\n    console.log('🔍   - user_timelines_events users:', backendUserTimelinesEvents ? Object.keys(backendUserTimelinesEvents).length : 0);\n\n    // ***** SEND THIS TO AI - DEBUG LOG #1 *****\n    console.log('***** SEND THIS TO AI - DEBUG LOG #1 *****');\n    console.log('ISSUE 2 DEBUG - Specific User Daily Metrics Check:');\n    const debugUserId = '$device:07BDA330-D882-45B2-946E-A2E81B011718';\n    console.log('Target User ID:', debugUserId);\n    console.log('User found in backendUserDailyMetrics:', debugUserId in backendUserDailyMetrics);\n    if (backendUserDailyMetrics[debugUserId]) {\n      const userData = backendUserDailyMetrics[debugUserId];\n      console.log('Available dates for user:', Object.keys(userData));\n      const may27Data = userData['2025-05-27'];\n      console.log('May 27th data exists:', may27Data ? 'YES' : 'NO');\n      if (may27Data) {\n        console.log('May 27th COMPLETE data:', may27Data);\n        console.log('trial_started:', may27Data.trial_started);\n        console.log('trial_ended:', may27Data.trial_ended, '← Should be 1');\n        console.log('trial_cancelled:', may27Data.trial_cancelled, '← Should be 1');\n        console.log('trial_converted:', may27Data.trial_converted);\n        console.log('trial_pending:', may27Data.trial_pending);\n      }\n    } else {\n      console.log('User NOT FOUND in backendUserDailyMetrics!');\n      console.log('Available users (first 5):', Object.keys(backendUserDailyMetrics).slice(0, 5));\n    }\n    console.log('***** END DEBUG LOG #1 *****');\n\n    // ***** SEND THIS TO AI - DEBUG LOG #2 *****\n    console.log('***** SEND THIS TO AI - DEBUG LOG #2 *****');\n    console.log('ISSUE 1 DEBUG - Product Selector Data Check:');\n    console.log('User found in backendUserTimelinesEvents:', debugUserId in backendUserTimelinesEvents);\n    if (backendUserTimelinesEvents[debugUserId]) {\n      const userData = backendUserTimelinesEvents[debugUserId];\n      console.log('User timeline events structure keys:', Object.keys(userData));\n      console.log('Has summary:', 'summary' in userData);\n      if (userData.summary) {\n        console.log('Summary keys:', Object.keys(userData.summary));\n        console.log('Has product_summaries:', 'product_summaries' in userData.summary);\n        if (userData.summary.product_summaries) {\n          console.log('Product summaries keys:', Object.keys(userData.summary.product_summaries));\n          console.log('Number of products:', Object.keys(userData.summary.product_summaries).length);\n          console.log('COMPLETE product_summaries data:', userData.summary.product_summaries);\n        } else {\n          console.log('ERROR: product_summaries is missing from summary!');\n        }\n      } else {\n        console.log('ERROR: summary is missing from user timeline events!');\n      }\n    } else {\n      console.log('User NOT FOUND in backendUserTimelinesEvents!');\n      console.log('Available users in backendUserTimelinesEvents (first 5):', Object.keys(backendUserTimelinesEvents).slice(0, 5));\n    }\n    console.log('***** END DEBUG LOG #2 *****');\n\n    // ***** SEND THIS TO AI - DEBUG LOG #3 *****\n    console.log('***** SEND THIS TO AI - DEBUG LOG #3 *****');\n    console.log('GENERAL DATA STRUCTURE CHECK:');\n    console.log('backendTimelineData exists:', !!backendTimelineData);\n    console.log('backendUserDailyMetrics exists:', !!backendUserDailyMetrics);\n    console.log('backendUserTimelinesEvents exists:', !!backendUserTimelinesEvents);\n    console.log('Number of users in backendUserDailyMetrics:', Object.keys(backendUserDailyMetrics).length);\n    console.log('Number of users in backendUserTimelinesEvents:', Object.keys(backendUserTimelinesEvents).length);\n    if (Object.keys(backendUserDailyMetrics).length > 0) {\n      const firstUser = Object.keys(backendUserDailyMetrics)[0];\n      const firstUserData = backendUserDailyMetrics[firstUser];\n      const firstDate = Object.keys(firstUserData)[0];\n      console.log('Sample user daily metrics structure:', {\n        userId: firstUser,\n        date: firstDate,\n        metrics: firstUserData[firstDate]\n      });\n    }\n    console.log('***** END DEBUG LOG #3 *****');\n    if (backendTimelineData && Object.keys(backendTimelineData).length > 0) {\n      const sampleDate = Object.keys(backendTimelineData)[0];\n      const sampleData = backendTimelineData[sampleDate];\n      console.log(`🔍   - Sample timeline_data[${sampleDate}]:`);\n      console.log('🔍     - trial_started:', sampleData.trial_started || 0);\n      console.log('🔍     - trial_converted:', sampleData.trial_converted || 0);\n      console.log('🔍     - revenue:', sampleData.revenue || 0);\n      console.log('🔍     - estimated_revenue:', sampleData.estimated_revenue || 0);\n    }\n    if (backendUserDailyMetrics && Object.keys(backendUserDailyMetrics).length > 0) {\n      const sampleUser = Object.keys(backendUserDailyMetrics)[0];\n      const sampleUserData = backendUserDailyMetrics[sampleUser];\n      console.log(`🔍   - Sample user_daily_metrics[${sampleUser}]:`);\n      console.log('🔍     - Dates available:', Object.keys(sampleUserData).length);\n      if (Object.keys(sampleUserData).length > 0) {\n        const sampleDate = Object.keys(sampleUserData)[0];\n        const sampleDayData = sampleUserData[sampleDate];\n        console.log(`🔍     - Sample date[${sampleDate}]:`);\n        console.log('🔍       - trial_started:', sampleDayData.trial_started || 0);\n        console.log('🔍       - trial_converted:', sampleDayData.trial_converted || 0);\n        console.log('🔍       - revenue:', sampleDayData.revenue || 0);\n        console.log('🔍       - estimated_revenue:', sampleDayData.estimated_revenue || 0);\n      }\n    }\n    if (backendUserTimelinesEvents && Object.keys(backendUserTimelinesEvents).length > 0) {\n      const sampleEventsUser = Object.keys(backendUserTimelinesEvents)[0];\n      const sampleEventsData = backendUserTimelinesEvents[sampleEventsUser];\n      console.log(`🔍   - Sample user_timelines_events[${sampleEventsUser}]:`);\n      console.log('🔍     - Structure keys:', Object.keys(sampleEventsData));\n      console.log('🔍     - Events count:', sampleEventsData.events ? sampleEventsData.events.length : 0);\n      console.log('🔍     - Products count:', sampleEventsData.products ? Object.keys(sampleEventsData.products).length : 0);\n      if (sampleEventsData.summary) {\n        console.log('🔍     - Summary total_estimated_revenue:', sampleEventsData.summary.total_estimated_revenue || 0);\n        console.log('🔍     - Summary total_actual_revenue:', sampleEventsData.summary.total_actual_revenue || 0);\n      }\n    }\n  }\n\n  // NEW: Detect users with multiple products\n  const usersWithMultipleProducts = useMemo(() => {\n    const multiProductUsers = {};\n    Object.entries(backendUserTimelinesEvents).forEach(([userId, userData]) => {\n      if (userData.summary && userData.summary.product_summaries) {\n        const productIds = Object.keys(userData.summary.product_summaries);\n        if (productIds.length > 1) {\n          multiProductUsers[userId] = productIds;\n        }\n      }\n    });\n    return multiProductUsers;\n  }, [backendUserTimelinesEvents]);\n\n  // NEW: Get available products for selected user\n  const availableProductsForUser = useMemo(() => {\n    if (!selectedUser || !backendUserTimelinesEvents[selectedUser]) {\n      return [];\n    }\n    const userData = backendUserTimelinesEvents[selectedUser];\n    if (userData.summary && userData.summary.product_summaries) {\n      return Object.keys(userData.summary.product_summaries);\n    }\n    return [];\n  }, [selectedUser, backendUserTimelinesEvents]);\n\n  // NEW: Check if current user has multiple products\n  const selectedUserHasMultipleProducts = availableProductsForUser.length > 1;\n\n  // Process user list for dropdown with search filtering\n  const userList = useMemo(() => {\n    // FIXED: Use user_timelines_events for user list, which has consolidated user data\n    const usersSource = backendUserTimelinesEvents && Object.keys(backendUserTimelinesEvents).length > 0 ? backendUserTimelinesEvents : userTimelines;\n    const users = Object.entries(usersSource).map(([userId, timelineData]) => {\n      // Handle both old and new data formats\n      let outcomeType = 'pending';\n      let estimatedRevenue = 0;\n      let actualRevenue = 0;\n      if (timelineData.summary) {\n        // New consolidated format from backend fix\n        outcomeType = timelineData.summary.outcome_type || 'pending';\n        estimatedRevenue = timelineData.summary.total_estimated_revenue || 0;\n        actualRevenue = timelineData.summary.total_actual_revenue || 0;\n      } else if (timelineData.outcome_type !== undefined) {\n        // Original format (user#product composite keys)\n        outcomeType = timelineData.outcome_type || 'pending';\n        estimatedRevenue = timelineData.total_estimated_revenue || 0;\n        actualRevenue = timelineData.total_actual_revenue || 0;\n      }\n\n      // NEW: Add indicator for multi-product users\n      const hasMultipleProducts = usersWithMultipleProducts[userId] ? true : false;\n      const productIndicator = hasMultipleProducts ? ' 📦' : '';\n      return {\n        userId,\n        timeline: timelineData,\n        displayName: `${userId.substring(0, 8)}... (${outcomeType})${productIndicator}`,\n        fullId: userId,\n        outcomeType,\n        estimatedRevenue,\n        actualRevenue,\n        hasMultipleProducts\n      };\n    });\n\n    // Filter based on search term\n    if (userSearchTerm) {\n      return users.filter(user => user.userId.toLowerCase().includes(userSearchTerm.toLowerCase()) || user.outcomeType.toLowerCase().includes(userSearchTerm.toLowerCase()));\n    }\n    return users;\n  }, [userTimelines, backendUserTimelinesEvents, userSearchTerm, usersWithMultipleProducts]);\n  if (!stage3Data) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-8\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500 dark:text-gray-400\",\n        children: \"No Stage 3 data available. Run analysis to see revenue timeline results.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 13\n    }, this);\n  }\n\n  // Helper function to format numbers\n  const formatNumber = num => {\n    if (typeof num !== 'number') return '0';\n    return num.toLocaleString();\n  };\n\n  // Helper function to format currency\n  const formatCurrency = num => {\n    if (typeof num !== 'number') return '$0';\n    return '$' + num.toLocaleString(undefined, {\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    });\n  };\n\n  // Helper function to format percentages\n  const formatPercentage = (num, total) => {\n    if (!total || typeof num !== 'number') return '0.0%';\n    return (num / total * 100).toFixed(1) + '%';\n  };\n\n  // Get the appropriate data for EventTimelineTable - backend provides it directly now\n  const getTimelineTableData = () => {\n    if (selectedUser && backendUserDailyMetrics[selectedUser]) {\n      var _userTimelines$select, _userTimelines$select2;\n      // Individual user view - create data structure for single user\n      const userDates = Object.keys(backendUserDailyMetrics[selectedUser]).sort();\n      const userDailyData = {};\n      const userCumulativeData = {};\n\n      // Build daily metrics for selected user only\n      userDates.forEach(date => {\n        userDailyData[date] = backendUserDailyMetrics[selectedUser][date];\n      });\n\n      // Calculate cumulative metrics for individual user\n      let cumulativeCounters = {\n        trial_started: 0,\n        trial_ended: 0,\n        trial_converted: 0,\n        trial_cancelled: 0,\n        initial_purchase: 0,\n        subscription_cancelled: 0,\n        revenue: 0,\n        refund: 0,\n        refund_count: 0,\n        estimated_revenue: 0\n      };\n      userDates.forEach(date => {\n        const dayData = userDailyData[date];\n\n        // Update cumulative counters\n        Object.keys(cumulativeCounters).forEach(key => {\n          if (key === 'trial_pending' || key === 'subscription_active') {\n            // State-based metrics use current value, not cumulative\n            userCumulativeData[date] = userCumulativeData[date] || {};\n            userCumulativeData[date][`cumulative_${key}`] = dayData[key] || 0;\n          } else {\n            cumulativeCounters[key] += dayData[key] || 0;\n            userCumulativeData[date] = userCumulativeData[date] || {};\n            userCumulativeData[date][`cumulative_${key}`] = cumulativeCounters[key];\n          }\n        });\n\n        // Add net revenue\n        userCumulativeData[date]['cumulative_revenue_net'] = cumulativeCounters['revenue'] - cumulativeCounters['refund'];\n      });\n      const individualResult = {\n        data: {\n          dates: userDates,\n          daily_metrics: userDailyData,\n          cumulative_metrics: userCumulativeData,\n          user_timelines: backendUserTimelinesEvents,\n          user_daily_metrics: {\n            [selectedUser]: backendUserDailyMetrics[selectedUser]\n          },\n          summary_stats: {\n            total_users: 1,\n            total_estimated_revenue: ((_userTimelines$select = userTimelines[selectedUser]) === null || _userTimelines$select === void 0 ? void 0 : _userTimelines$select.total_estimated_revenue) || 0,\n            total_actual_revenue: ((_userTimelines$select2 = userTimelines[selectedUser]) === null || _userTimelines$select2 === void 0 ? void 0 : _userTimelines$select2.total_actual_revenue) || 0\n          }\n        }\n      };\n      return individualResult;\n    }\n\n    // Aggregate view - calculate cumulative metrics from daily metrics\n    const aggregateDates = Object.keys(backendTimelineData).sort();\n    const aggregateCumulativeMetrics = {};\n\n    // Initialize cumulative counters for aggregate view\n    let cumulativeCounters = {\n      trial_started: 0,\n      trial_ended: 0,\n      trial_converted: 0,\n      trial_cancelled: 0,\n      initial_purchase: 0,\n      subscription_cancelled: 0,\n      revenue: 0,\n      refund: 0,\n      refund_count: 0\n    };\n\n    // Calculate cumulative metrics for each date\n    aggregateDates.forEach(date => {\n      const dayData = backendTimelineData[date] || {};\n\n      // Update cumulative counters (for event-based metrics)\n      Object.keys(cumulativeCounters).forEach(key => {\n        if (key in dayData && typeof dayData[key] === 'number') {\n          cumulativeCounters[key] += dayData[key];\n        }\n      });\n\n      // Store cumulative data for this date\n      aggregateCumulativeMetrics[date] = {\n        // State-based metrics use current daily value (not cumulative)\n        trial_pending: dayData.trial_pending || 0,\n        subscription_active: dayData.subscription_active || 0,\n        estimated_revenue: dayData.estimated_revenue || 0,\n        // Event-based metrics use cumulative values\n        cumulative_trial_started: cumulativeCounters.trial_started,\n        cumulative_trial_ended: cumulativeCounters.trial_ended,\n        cumulative_trial_converted: cumulativeCounters.trial_converted,\n        cumulative_trial_cancelled: cumulativeCounters.trial_cancelled,\n        cumulative_initial_purchase: cumulativeCounters.initial_purchase,\n        cumulative_subscription_cancelled: cumulativeCounters.subscription_cancelled,\n        cumulative_revenue: cumulativeCounters.revenue,\n        cumulative_refund: cumulativeCounters.refund,\n        cumulative_refund_count: cumulativeCounters.refund_count,\n        cumulative_revenue_net: cumulativeCounters.revenue - cumulativeCounters.refund\n      };\n    });\n    const aggregateResult = {\n      data: {\n        dates: aggregateDates,\n        daily_metrics: backendTimelineData,\n        cumulative_metrics: aggregateCumulativeMetrics,\n        user_timelines: backendUserTimelinesEvents,\n        user_daily_metrics: backendUserDailyMetrics,\n        summary_stats: aggregateStats\n      }\n    };\n    return aggregateResult;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(TrendingUp, {\n        size: 24,\n        className: \"text-purple-600 dark:text-purple-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-gray-900 dark:text-white\",\n        children: \"Stage 3: Revenue Timeline Generation Results\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-auto flex items-center gap-1 text-purple-600 dark:text-purple-400 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2713\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Revenue Estimation & Timeline Projection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(User, {\n          size: 20,\n          className: \"text-blue-600 dark:text-blue-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-gray-900 dark:text-white\",\n          children: \"View Selection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n            children: \"Select User (or leave empty for aggregate)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Search by User ID or outcome...\",\n              value: userSearchTerm,\n              onChange: e => setUserSearchTerm(e.target.value),\n              className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: selectedUser,\n              onChange: e => {\n                setSelectedUser(e.target.value);\n                setSelectedProductId(''); // Reset product selection when user changes\n              },\n              className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\uD83C\\uDF0D Aggregate View (All Users)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 33\n              }, this), userList.map(user => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: user.userId,\n                children: [\"\\uD83D\\uDC64 \", user.displayName, \" - Est: \", formatCurrency(user.estimatedRevenue)]\n              }, user.userId, true, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 25\n          }, this), selectedUser && selectedUserHasMultipleProducts && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(Package, {\n                size: 16,\n                className: \"text-yellow-600 dark:text-yellow-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium text-yellow-800 dark:text-yellow-200\",\n                children: \"Multiple Products Detected\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: selectedProductId,\n              onChange: e => setSelectedProductId(e.target.value),\n              className: \"w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\uD83D\\uDCCA All Products (Combined)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 462,\n                columnNumber: 37\n              }, this), availableProductsForUser.map(productId => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: productId,\n                children: [\"\\uD83D\\uDCE6 \", productId]\n              }, productId, true, {\n                fileName: _jsxFileName,\n                lineNumber: 464,\n                columnNumber: 41\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-yellow-700 dark:text-yellow-300 mt-1\",\n              children: [\"This user has trials for \", availableProductsForUser.length, \" different products. Select a specific product or view combined data.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n            children: \"Current View\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700\",\n            children: selectedUser ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-2 mb-1\",\n                children: [/*#__PURE__*/_jsxDEV(User, {\n                  size: 16,\n                  className: \"text-blue-600 dark:text-blue-400\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 486,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium text-gray-900 dark:text-white\",\n                  children: \"Individual User\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 485,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 dark:text-gray-400 break-all\",\n                children: [\"ID: \", selectedUser]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 dark:text-gray-400\",\n                children: [\"Status: \", ((_userTimelines$select3 = userTimelines[selectedUser]) === null || _userTimelines$select3 === void 0 ? void 0 : _userTimelines$select3.outcome_type) || 'pending']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 37\n              }, this), selectedUserHasMultipleProducts && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-orange-600 dark:text-orange-400\",\n                children: [\"Products: \", availableProductsForUser.length, \" (\", selectedProductId || 'All', \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 496,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 484,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-2 mb-1\",\n                children: [/*#__PURE__*/_jsxDEV(Globe, {\n                  size: 16,\n                  className: \"text-green-600 dark:text-green-400\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium text-gray-900 dark:text-white\",\n                  children: \"Aggregate View\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 dark:text-gray-400\",\n                children: [\"Showing data for all \", Object.keys(userTimelines).length, \" users\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 507,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-blue-600 dark:text-blue-400\",\n                children: [\"Multi-product users: \", Object.keys(usersWithMultipleProducts).length]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 510,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(Users, {\n            size: 20,\n            className: \"text-purple-600 dark:text-purple-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-purple-900 dark:text-purple-200\",\n            children: \"Users with Timelines\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-2xl font-bold text-purple-600 dark:text-purple-300\",\n          children: selectedUser ? '1' : formatNumber(stage3Data.users_with_timelines || 0)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-purple-700 dark:text-purple-400\",\n          children: selectedUser ? 'Individual view' : 'Revenue projections generated'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(DollarSign, {\n            size: 20,\n            className: \"text-green-600 dark:text-green-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-green-900 dark:text-green-200\",\n            children: \"Estimated Revenue\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-2xl font-bold text-green-600 dark:text-green-300\",\n          children: selectedUser ? formatCurrency(((_userTimelines$select4 = userTimelines[selectedUser]) === null || _userTimelines$select4 === void 0 ? void 0 : _userTimelines$select4.total_estimated_revenue) || 0) : formatCurrency(aggregateStats.total_estimated_revenue || 0)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-green-700 dark:text-green-400\",\n          children: \"Based on conversion probabilities\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 535,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(Activity, {\n            size: 20,\n            className: \"text-blue-600 dark:text-blue-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-blue-900 dark:text-blue-200\",\n            children: \"Actual Revenue\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 554,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-2xl font-bold text-blue-600 dark:text-blue-300\",\n          children: selectedUser ? formatCurrency(((_userTimelines$select5 = userTimelines[selectedUser]) === null || _userTimelines$select5 === void 0 ? void 0 : _userTimelines$select5.total_actual_revenue) || 0) : formatCurrency(aggregateStats.total_actual_revenue || 0)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-blue-700 dark:text-blue-400\",\n          children: \"From confirmed outcomes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 551,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(Clock, {\n            size: 20,\n            className: \"text-orange-600 dark:text-orange-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-orange-900 dark:text-orange-200\",\n            children: \"Timeline End\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 570,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-lg font-bold text-orange-600 dark:text-orange-300\",\n          children: stage3Data.timeline_end_date || 'N/A'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 572,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-orange-700 dark:text-orange-400\",\n          children: \"Projection end date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(Calculator, {\n            size: 20,\n            className: \"text-green-600 dark:text-green-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 25\n          }, this), \"Revenue Calculation Using Event State Tracker\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white dark:bg-gray-800 rounded-lg p-4 font-mono text-sm mb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-lg font-bold text-gray-900 dark:text-white mb-2\",\n                children: \"\\uD83D\\uDD35 Pre-Outcome (Trial Pending)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 592,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-base text-blue-600 dark:text-blue-400\",\n                children: \"estimated_revenue = conversion_probability \\xD7 (1 - refund_rate) \\xD7 price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 595,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-lg font-bold text-gray-900 dark:text-white mb-2\",\n                children: \"\\uD83D\\uDFE2 Post-Conversion (Subscription Active)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 601,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-base text-green-600 dark:text-green-400\",\n                children: \"revenue = price \\xD7 (1 - current_refund_rate)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 604,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-500 dark:text-gray-400\",\n                children: \"current_refund_rate degrades linearly to 0% over 30 days\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 607,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 600,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-lg font-bold text-gray-900 dark:text-white mb-2\",\n                children: \"\\uD83D\\uDD34 Post-Cancellation (Subscription Cancelled)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 613,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-base text-red-600 dark:text-red-400\",\n                children: \"revenue = $0.00\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 616,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"\\uD83D\\uDCC8 State Tracking:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 624,\n            columnNumber: 25\n          }, this), \"\\u2022 Backend uses event_state_tracker.py for proper event state management \\u2022 Trial states: started \\u2192 pending \\u2192 ended (converted/cancelled) \\u2022 Subscription states: active \\u2192 cancelled \\u2022 Revenue tracking includes actual event revenue and refunds\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-800\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Target, {\n          size: 20,\n          className: \"text-purple-600 dark:text-purple-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 21\n        }, this), \"User & Segment Details\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 635,\n        columnNumber: 17\n      }, this), selectedUser ? (() => {\n        // --- START: REPLACEMENT LOGIC ---\n\n        // Get the complete, consolidated data for the selected user\n        const userEventsData = backendUserTimelinesEvents[selectedUser];\n\n        // If there's no data for the selected user, show an error state.\n        if (!userEventsData) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-500 text-center\",\n            children: [\"Error: No timeline event data found for user \", selectedUser, \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 649,\n            columnNumber: 36\n          }, this);\n        }\n\n        // Extract segment info and properties directly from the new, correct data structure.\n        const segmentInfo = userEventsData.segment_info || {};\n        const userProperties = segmentInfo.user_properties || {};\n\n        // Extract metrics directly from the segment info\n        const effectiveSegmentMetrics = segmentInfo.conversion_metrics || {};\n\n        // The rest of your display logic can now use these variables directly.\n        // For example, to get the matched segment ID:\n        const matchedSegmentId = segmentInfo.matched_segment_id || segmentInfo.segment_id;\n        // To get the final segment ID after rollup:\n        const finalSegmentId = segmentInfo.final_viable_segment_id || segmentInfo.segment_id;\n\n        // To check if a rollup occurred:\n        const hasActualRollup = matchedSegmentId && finalSegmentId && matchedSegmentId !== finalSegmentId;\n\n        // Extract segment properties from the correct sources\n        let matchedSegmentProperties = userProperties;\n        let finalSegmentProperties = userProperties;\n        let matchedLevel = 0;\n        let matchedUserCount = effectiveSegmentMetrics.sample_size || effectiveSegmentMetrics.cohort_size || 'Unknown';\n        let finalLevel = 0;\n        let finalUserCount = matchedUserCount;\n\n        // --- END: REPLACEMENT LOGIC ---\n\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 lg:grid-cols-5 gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 text-white p-4 rounded-lg text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-mono text-xs mb-3 text-blue-300 break-all\",\n                children: selectedUser\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 683,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-400 mb-3\",\n                children: [\"Short: \", selectedUser.substring(0, 8), \"...\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 686,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-1 text-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Product:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 690,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.product_id || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 690,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Store:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 691,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.app_store || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 691,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Price:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 692,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.price_bucket || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 692,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Country:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 693,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.country || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 693,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Economic Tier:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 694,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.economic_tier || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 694,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Region:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 695,\n                    columnNumber: 50\n                  }, this), \" \", userProperties.region || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 695,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 689,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 text-white p-4 rounded-lg text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-medium text-blue-300 mb-2 text-xs\",\n                children: [\"ID: \", matchedSegmentId ? matchedSegmentId.substring(0, 8) + '...' : 'Unknown']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 701,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-1 text-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Product:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 705,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.product_id || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 705,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Store:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 706,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.app_store || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 706,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Price:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 707,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.price_bucket || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 707,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Country:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 708,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.country || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 708,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Economic Tier:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 709,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.economic_tier || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 709,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Region:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 710,\n                    columnNumber: 50\n                  }, this), \" \", matchedSegmentProperties.region || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 710,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Level:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 711,\n                    columnNumber: 50\n                  }, this), \" \", matchedLevel]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 711,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Users:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 712,\n                    columnNumber: 50\n                  }, this), \" \", matchedUserCount]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 712,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 704,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 700,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 text-white p-4 rounded-lg text-sm\",\n              children: hasActualRollup ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium text-green-300 mb-2 text-xs\",\n                  children: [\"ID: \", finalSegmentId ? finalSegmentId.substring(0, 8) + '...' : 'Unknown']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 720,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-1 text-xs\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Product:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 724,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.product_id || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 724,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Store:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 725,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.app_store || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 725,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Price:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 726,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.price_bucket || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 726,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Country:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 727,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.country || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 727,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Economic Tier:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 728,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.economic_tier || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 728,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Region:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 729,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.region || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 729,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Level:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 730,\n                      columnNumber: 58\n                    }, this), \" \", finalLevel]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 730,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Users:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 731,\n                      columnNumber: 58\n                    }, this), \" \", finalUserCount]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 731,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 723,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 45\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium text-blue-300 mb-2 text-xs\",\n                  children: [\"ID: \", finalSegmentId ? finalSegmentId.substring(0, 8) + '...' : 'Same as matched']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 736,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-1 text-xs\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Product:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 740,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.product_id || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 740,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Store:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 741,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.app_store || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 741,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Price:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 742,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.price_bucket || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 742,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Country:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 743,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.country || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 743,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Economic Tier:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 744,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.economic_tier || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 744,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Region:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 745,\n                      columnNumber: 58\n                    }, this), \" \", finalSegmentProperties.region || 'N/A']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 745,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Level:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 746,\n                      columnNumber: 58\n                    }, this), \" \", finalLevel]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 746,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-400\",\n                      children: \"Users:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 747,\n                      columnNumber: 58\n                    }, this), \" \", finalUserCount]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 747,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 739,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-gray-500 mt-2 italic\",\n                  children: \"Direct match - no rollup applied\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 749,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 735,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 717,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 text-white p-4 rounded-lg text-sm\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2 text-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Trial Conv.:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 760,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"ml-1 text-green-300\",\n                    children: [((effectiveSegmentMetrics.trial_conversion_rate || 0) * 100).toFixed(1), \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 761,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 759,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Refund:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 766,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"ml-1 text-red-300\",\n                    children: [((effectiveSegmentMetrics.trial_converted_to_refund_rate || 0) * 100).toFixed(1), \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 767,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 765,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Init. Refund:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 772,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"ml-1 text-red-300\",\n                    children: [((effectiveSegmentMetrics.initial_purchase_to_refund_rate || 0) * 100).toFixed(1), \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 773,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 771,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Renewal Refund:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 778,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"ml-1 text-red-300\",\n                    children: [((effectiveSegmentMetrics.renewal_to_refund_rate || 0) * 100).toFixed(1), \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 779,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 777,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-400\",\n                    children: \"Sample size:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 784,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"ml-1 text-blue-300\",\n                    children: finalUserCount\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 785,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 783,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 758,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 757,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 text-white p-4 rounded-lg text-sm\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `\n                                                px-3 py-2 rounded-full text-xs font-medium\n                                                ${segmentInfo.accuracy_score === 'high' ? 'bg-green-600 text-white' : segmentInfo.accuracy_score === 'medium' ? 'bg-yellow-600 text-white' : 'bg-red-600 text-white'}\n                                            `,\n                  children: (segmentInfo.accuracy_score || 'Unknown').toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 795,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-gray-400 mt-2\",\n                  children: \"Prediction Accuracy\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 803,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 794,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 793,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 29\n        }, this);\n      })() : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-gray-600 dark:text-gray-400 italic text-center py-8\",\n        children: \"Select an individual user to view segment details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 813,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 13\n    }, this), stage3Data && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-semibold text-gray-900 dark:text-white mb-4\",\n        children: [selectedUser ? `Revenue Timeline for User ${selectedUser.substring(0, 16)}...` : 'Aggregate Revenue Timeline', selectedUser && selectedProductId && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-500 dark:text-gray-400 ml-2\",\n          children: [\"(Product: \", selectedProductId, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 825,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 822,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(EventTimelineTableV3, {\n        data: getTimelineTableData(),\n        selectedUserId: selectedUser,\n        selectedProductId: selectedProductId || (selectedUser ? (_userTimelines$select6 = userTimelines[selectedUser]) === null || _userTimelines$select6 === void 0 ? void 0 : (_userTimelines$select7 = _userTimelines$select6.user_properties) === null || _userTimelines$select7 === void 0 ? void 0 : _userTimelines$select7.product_id : null)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 830,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 821,\n      columnNumber: 17\n    }, this), stage3Data.error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-8 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800\",\n      children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n        size: 48,\n        className: \"mx-auto text-red-400 mb-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 841,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-600 dark:text-red-400 mb-2\",\n        children: [\"Stage 3 Error: \", stage3Data.error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 842,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 840,\n      columnNumber: 17\n    }, this), Object.keys(userTimelines).length === 0 && !stage3Data.error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(TrendingUp, {\n        size: 48,\n        className: \"mx-auto text-gray-400 mb-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 851,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 dark:text-gray-400 mb-2\",\n        children: \"No revenue timeline data available\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 852,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-500 dark:text-gray-500\",\n        children: \"Run Stage 3 analysis to see revenue timeline projections\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 855,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 850,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 398,\n    columnNumber: 9\n  }, this);\n};\n_s(Stage3RevenueResultsV3, \"tuFQ2NVF8sI1fEmuwVvjRohzSBw=\");\n_c = Stage3RevenueResultsV3;\nexport default Stage3RevenueResultsV3;\nvar _c;\n$RefreshReg$(_c, \"Stage3RevenueResultsV3\");","map":{"version":3,"names":["React","useState","useMemo","TrendingUp","Users","DollarSign","Clock","Activity","AlertCircle","Database","Calculator","Target","User","Globe","Package","EventTimelineTableV3","jsxDEV","_jsxDEV","Stage3RevenueResultsV3","data","_s","_data$stage_results","_data$data","_data$data$stage_resu","_stage3Data","_userTimelines$select3","_userTimelines$select4","_userTimelines$select5","_userTimelines$select6","_userTimelines$select7","selectedUser","setSelectedUser","userSearchTerm","setUserSearchTerm","selectedProductId","setSelectedProductId","stage3Data","stage_results","stage3","timelineResults","timeline_results","aggregateStats","aggregate_stats","userTimelines","user_timelines","backendTimelineData","timeline_data","backendUserDailyMetrics","user_daily_metrics","backendUserTimelinesEvents","user_timelines_events","Object","keys","length","console","log","debugUserId","userData","may27Data","trial_started","trial_ended","trial_cancelled","trial_converted","trial_pending","slice","summary","product_summaries","firstUser","firstUserData","firstDate","userId","date","metrics","sampleDate","sampleData","revenue","estimated_revenue","sampleUser","sampleUserData","sampleDayData","sampleEventsUser","sampleEventsData","events","products","total_estimated_revenue","total_actual_revenue","usersWithMultipleProducts","multiProductUsers","entries","forEach","productIds","availableProductsForUser","selectedUserHasMultipleProducts","userList","usersSource","users","map","timelineData","outcomeType","estimatedRevenue","actualRevenue","outcome_type","undefined","hasMultipleProducts","productIndicator","timeline","displayName","substring","fullId","filter","user","toLowerCase","includes","className","children","fileName","_jsxFileName","lineNumber","columnNumber","formatNumber","num","toLocaleString","formatCurrency","minimumFractionDigits","maximumFractionDigits","formatPercentage","total","toFixed","getTimelineTableData","_userTimelines$select","_userTimelines$select2","userDates","sort","userDailyData","userCumulativeData","cumulativeCounters","initial_purchase","subscription_cancelled","refund","refund_count","dayData","key","individualResult","dates","daily_metrics","cumulative_metrics","summary_stats","total_users","aggregateDates","aggregateCumulativeMetrics","subscription_active","cumulative_trial_started","cumulative_trial_ended","cumulative_trial_converted","cumulative_trial_cancelled","cumulative_initial_purchase","cumulative_subscription_cancelled","cumulative_revenue","cumulative_refund","cumulative_refund_count","cumulative_revenue_net","aggregateResult","size","type","placeholder","value","onChange","e","target","productId","users_with_timelines","timeline_end_date","userEventsData","segmentInfo","segment_info","userProperties","user_properties","effectiveSegmentMetrics","conversion_metrics","matchedSegmentId","matched_segment_id","segment_id","finalSegmentId","final_viable_segment_id","hasActualRollup","matchedSegmentProperties","finalSegmentProperties","matchedLevel","matchedUserCount","sample_size","cohort_size","finalLevel","finalUserCount","product_id","app_store","price_bucket","country","economic_tier","region","trial_conversion_rate","trial_converted_to_refund_rate","initial_purchase_to_refund_rate","renewal_to_refund_rate","accuracy_score","toUpperCase","selectedUserId","error","_c","$RefreshReg$"],"sources":["/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/cohort-pipeline/components/Stage3RevenueResultsV3.js"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport { TrendingUp, Users, DollarSign, Clock, Activity, AlertCircle, Database, Calculator, Target, User, Globe, Package } from 'lucide-react';\nimport EventTimelineTableV3 from './EventTimelineTableV3';\n\nconst Stage3RevenueResultsV3 = ({ data }) => {\n    const [selectedUser, setSelectedUser] = useState(''); // Empty string means aggregate view\n    const [userSearchTerm, setUserSearchTerm] = useState('');\n    const [selectedProductId, setSelectedProductId] = useState(''); // NEW: Product selector state\n    \n    // Handle multiple API response formats for data access\n    let stage3Data = null;\n    \n    if (data?.stage_results?.stage3) {\n        // Direct format: pipelineData.stage_results.stage3\n        stage3Data = data.stage_results.stage3;\n    } else if (data?.data?.stage_results?.stage3) {\n        // Nested format: pipelineData.data.stage_results.stage3\n        stage3Data = data.data.stage_results.stage3;\n    }\n\n    const timelineResults = stage3Data?.timeline_results || {};\n    const aggregateStats = timelineResults.aggregate_stats || {};\n    const userTimelines = timelineResults.user_timelines || {};\n    \n    // NEW: Backend now provides EventTimelineTable format data directly\n    const backendTimelineData = timelineResults.timeline_data || {};\n    const backendUserDailyMetrics = timelineResults.user_daily_metrics || {};\n    const backendUserTimelinesEvents = timelineResults.user_timelines_events || {};\n    \n    // 🔍 FRONTEND TIMELINE DEBUG: Log the data received from backend\n    if (Object.keys(timelineResults).length > 0) {\n        console.log('🔍 [FRONTEND TIMELINE DEBUG] Data received from backend:');\n        console.log('🔍   - timeline_data dates:', backendTimelineData ? Object.keys(backendTimelineData).length : 0);\n        console.log('🔍   - user_daily_metrics users:', backendUserDailyMetrics ? Object.keys(backendUserDailyMetrics).length : 0);\n        console.log('🔍   - user_timelines_events users:', backendUserTimelinesEvents ? Object.keys(backendUserTimelinesEvents).length : 0);\n        \n        // ***** SEND THIS TO AI - DEBUG LOG #1 *****\n        console.log('***** SEND THIS TO AI - DEBUG LOG #1 *****');\n        console.log('ISSUE 2 DEBUG - Specific User Daily Metrics Check:');\n        const debugUserId = '$device:07BDA330-D882-45B2-946E-A2E81B011718';\n        console.log('Target User ID:', debugUserId);\n        console.log('User found in backendUserDailyMetrics:', debugUserId in backendUserDailyMetrics);\n        \n        if (backendUserDailyMetrics[debugUserId]) {\n            const userData = backendUserDailyMetrics[debugUserId];\n            console.log('Available dates for user:', Object.keys(userData));\n            \n            const may27Data = userData['2025-05-27'];\n            console.log('May 27th data exists:', may27Data ? 'YES' : 'NO');\n            \n            if (may27Data) {\n                console.log('May 27th COMPLETE data:', may27Data);\n                console.log('trial_started:', may27Data.trial_started);\n                console.log('trial_ended:', may27Data.trial_ended, '← Should be 1');\n                console.log('trial_cancelled:', may27Data.trial_cancelled, '← Should be 1');\n                console.log('trial_converted:', may27Data.trial_converted);\n                console.log('trial_pending:', may27Data.trial_pending);\n            }\n        } else {\n            console.log('User NOT FOUND in backendUserDailyMetrics!');\n            console.log('Available users (first 5):', Object.keys(backendUserDailyMetrics).slice(0, 5));\n        }\n        console.log('***** END DEBUG LOG #1 *****');\n        \n        // ***** SEND THIS TO AI - DEBUG LOG #2 *****\n        console.log('***** SEND THIS TO AI - DEBUG LOG #2 *****');\n        console.log('ISSUE 1 DEBUG - Product Selector Data Check:');\n        console.log('User found in backendUserTimelinesEvents:', debugUserId in backendUserTimelinesEvents);\n        \n        if (backendUserTimelinesEvents[debugUserId]) {\n            const userData = backendUserTimelinesEvents[debugUserId];\n            console.log('User timeline events structure keys:', Object.keys(userData));\n            console.log('Has summary:', 'summary' in userData);\n            \n            if (userData.summary) {\n                console.log('Summary keys:', Object.keys(userData.summary));\n                console.log('Has product_summaries:', 'product_summaries' in userData.summary);\n                \n                if (userData.summary.product_summaries) {\n                    console.log('Product summaries keys:', Object.keys(userData.summary.product_summaries));\n                    console.log('Number of products:', Object.keys(userData.summary.product_summaries).length);\n                    console.log('COMPLETE product_summaries data:', userData.summary.product_summaries);\n                } else {\n                    console.log('ERROR: product_summaries is missing from summary!');\n                }\n            } else {\n                console.log('ERROR: summary is missing from user timeline events!');\n            }\n        } else {\n            console.log('User NOT FOUND in backendUserTimelinesEvents!');\n            console.log('Available users in backendUserTimelinesEvents (first 5):', Object.keys(backendUserTimelinesEvents).slice(0, 5));\n        }\n        console.log('***** END DEBUG LOG #2 *****');\n        \n        // ***** SEND THIS TO AI - DEBUG LOG #3 *****\n        console.log('***** SEND THIS TO AI - DEBUG LOG #3 *****');\n        console.log('GENERAL DATA STRUCTURE CHECK:');\n        console.log('backendTimelineData exists:', !!backendTimelineData);\n        console.log('backendUserDailyMetrics exists:', !!backendUserDailyMetrics);\n        console.log('backendUserTimelinesEvents exists:', !!backendUserTimelinesEvents);\n        console.log('Number of users in backendUserDailyMetrics:', Object.keys(backendUserDailyMetrics).length);\n        console.log('Number of users in backendUserTimelinesEvents:', Object.keys(backendUserTimelinesEvents).length);\n        \n        if (Object.keys(backendUserDailyMetrics).length > 0) {\n            const firstUser = Object.keys(backendUserDailyMetrics)[0];\n            const firstUserData = backendUserDailyMetrics[firstUser];\n            const firstDate = Object.keys(firstUserData)[0];\n            console.log('Sample user daily metrics structure:', {\n                userId: firstUser,\n                date: firstDate,\n                metrics: firstUserData[firstDate]\n            });\n        }\n        console.log('***** END DEBUG LOG #3 *****');\n        \n        if (backendTimelineData && Object.keys(backendTimelineData).length > 0) {\n            const sampleDate = Object.keys(backendTimelineData)[0];\n            const sampleData = backendTimelineData[sampleDate];\n            console.log(`🔍   - Sample timeline_data[${sampleDate}]:`);\n            console.log('🔍     - trial_started:', sampleData.trial_started || 0);\n            console.log('🔍     - trial_converted:', sampleData.trial_converted || 0);\n            console.log('🔍     - revenue:', sampleData.revenue || 0);\n            console.log('🔍     - estimated_revenue:', sampleData.estimated_revenue || 0);\n        }\n        \n        if (backendUserDailyMetrics && Object.keys(backendUserDailyMetrics).length > 0) {\n            const sampleUser = Object.keys(backendUserDailyMetrics)[0];\n            const sampleUserData = backendUserDailyMetrics[sampleUser];\n            console.log(`🔍   - Sample user_daily_metrics[${sampleUser}]:`);\n            console.log('🔍     - Dates available:', Object.keys(sampleUserData).length);\n            if (Object.keys(sampleUserData).length > 0) {\n                const sampleDate = Object.keys(sampleUserData)[0];\n                const sampleDayData = sampleUserData[sampleDate];\n                console.log(`🔍     - Sample date[${sampleDate}]:`);\n                console.log('🔍       - trial_started:', sampleDayData.trial_started || 0);\n                console.log('🔍       - trial_converted:', sampleDayData.trial_converted || 0);\n                console.log('🔍       - revenue:', sampleDayData.revenue || 0);\n                console.log('🔍       - estimated_revenue:', sampleDayData.estimated_revenue || 0);\n            }\n        }\n        \n        if (backendUserTimelinesEvents && Object.keys(backendUserTimelinesEvents).length > 0) {\n            const sampleEventsUser = Object.keys(backendUserTimelinesEvents)[0];\n            const sampleEventsData = backendUserTimelinesEvents[sampleEventsUser];\n            console.log(`🔍   - Sample user_timelines_events[${sampleEventsUser}]:`);\n            console.log('🔍     - Structure keys:', Object.keys(sampleEventsData));\n            console.log('🔍     - Events count:', sampleEventsData.events ? sampleEventsData.events.length : 0);\n            console.log('🔍     - Products count:', sampleEventsData.products ? Object.keys(sampleEventsData.products).length : 0);\n            if (sampleEventsData.summary) {\n                console.log('🔍     - Summary total_estimated_revenue:', sampleEventsData.summary.total_estimated_revenue || 0);\n                console.log('🔍     - Summary total_actual_revenue:', sampleEventsData.summary.total_actual_revenue || 0);\n            }\n        }\n    }\n    \n    // NEW: Detect users with multiple products\n    const usersWithMultipleProducts = useMemo(() => {\n        const multiProductUsers = {};\n        \n        Object.entries(backendUserTimelinesEvents).forEach(([userId, userData]) => {\n            if (userData.summary && userData.summary.product_summaries) {\n                const productIds = Object.keys(userData.summary.product_summaries);\n                if (productIds.length > 1) {\n                    multiProductUsers[userId] = productIds;\n                }\n            }\n        });\n        \n        return multiProductUsers;\n    }, [backendUserTimelinesEvents]);\n    \n    // NEW: Get available products for selected user\n    const availableProductsForUser = useMemo(() => {\n        if (!selectedUser || !backendUserTimelinesEvents[selectedUser]) {\n            return [];\n        }\n        \n        const userData = backendUserTimelinesEvents[selectedUser];\n        if (userData.summary && userData.summary.product_summaries) {\n            return Object.keys(userData.summary.product_summaries);\n        }\n        \n        return [];\n    }, [selectedUser, backendUserTimelinesEvents]);\n    \n    // NEW: Check if current user has multiple products\n    const selectedUserHasMultipleProducts = availableProductsForUser.length > 1;\n    \n    // Process user list for dropdown with search filtering\n    const userList = useMemo(() => {\n        // FIXED: Use user_timelines_events for user list, which has consolidated user data\n        const usersSource = backendUserTimelinesEvents && Object.keys(backendUserTimelinesEvents).length > 0 \n            ? backendUserTimelinesEvents \n            : userTimelines;\n        \n        const users = Object.entries(usersSource).map(([userId, timelineData]) => {\n            // Handle both old and new data formats\n            let outcomeType = 'pending';\n            let estimatedRevenue = 0;\n            let actualRevenue = 0;\n            \n            if (timelineData.summary) {\n                // New consolidated format from backend fix\n                outcomeType = timelineData.summary.outcome_type || 'pending';\n                estimatedRevenue = timelineData.summary.total_estimated_revenue || 0;\n                actualRevenue = timelineData.summary.total_actual_revenue || 0;\n            } else if (timelineData.outcome_type !== undefined) {\n                // Original format (user#product composite keys)\n                outcomeType = timelineData.outcome_type || 'pending';\n                estimatedRevenue = timelineData.total_estimated_revenue || 0;\n                actualRevenue = timelineData.total_actual_revenue || 0;\n            }\n            \n            // NEW: Add indicator for multi-product users\n            const hasMultipleProducts = usersWithMultipleProducts[userId] ? true : false;\n            const productIndicator = hasMultipleProducts ? ' 📦' : '';\n            \n            return {\n            userId,\n                timeline: timelineData,\n                displayName: `${userId.substring(0, 8)}... (${outcomeType})${productIndicator}`,\n            fullId: userId,\n                outcomeType,\n                estimatedRevenue,\n                actualRevenue,\n                hasMultipleProducts\n            };\n        });\n        \n        // Filter based on search term\n        if (userSearchTerm) {\n            return users.filter(user => \n                user.userId.toLowerCase().includes(userSearchTerm.toLowerCase()) ||\n                user.outcomeType.toLowerCase().includes(userSearchTerm.toLowerCase())\n            );\n        }\n        \n        return users;\n    }, [userTimelines, backendUserTimelinesEvents, userSearchTerm, usersWithMultipleProducts]);\n\n    if (!stage3Data) {\n        return (\n            <div className=\"text-center py-8\">\n                <p className=\"text-gray-500 dark:text-gray-400\">\n                    No Stage 3 data available. Run analysis to see revenue timeline results.\n                </p>\n            </div>\n        );\n    }\n\n    // Helper function to format numbers\n    const formatNumber = (num) => {\n        if (typeof num !== 'number') return '0';\n        return num.toLocaleString();\n    };\n\n    // Helper function to format currency\n    const formatCurrency = (num) => {\n        if (typeof num !== 'number') return '$0';\n        return '$' + num.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n    };\n\n    // Helper function to format percentages\n    const formatPercentage = (num, total) => {\n        if (!total || typeof num !== 'number') return '0.0%';\n        return ((num / total) * 100).toFixed(1) + '%';\n    };\n    \n    // Get the appropriate data for EventTimelineTable - backend provides it directly now\n    const getTimelineTableData = () => {\n        if (selectedUser && backendUserDailyMetrics[selectedUser]) {\n            // Individual user view - create data structure for single user\n            const userDates = Object.keys(backendUserDailyMetrics[selectedUser]).sort();\n            const userDailyData = {};\n            const userCumulativeData = {};\n            \n            // Build daily metrics for selected user only\n            userDates.forEach(date => {\n                userDailyData[date] = backendUserDailyMetrics[selectedUser][date];\n            });\n            \n            // Calculate cumulative metrics for individual user\n            let cumulativeCounters = {\n                trial_started: 0,\n                trial_ended: 0,\n                trial_converted: 0,\n                trial_cancelled: 0,\n                initial_purchase: 0,\n                subscription_cancelled: 0,\n                revenue: 0,\n                refund: 0,\n                refund_count: 0,\n                estimated_revenue: 0\n            };\n            \n            userDates.forEach(date => {\n                const dayData = userDailyData[date];\n                \n                // Update cumulative counters\n                Object.keys(cumulativeCounters).forEach(key => {\n                    if (key === 'trial_pending' || key === 'subscription_active') {\n                        // State-based metrics use current value, not cumulative\n                        userCumulativeData[date] = userCumulativeData[date] || {};\n                        userCumulativeData[date][`cumulative_${key}`] = dayData[key] || 0;\n                    } else {\n                        cumulativeCounters[key] += (dayData[key] || 0);\n                        userCumulativeData[date] = userCumulativeData[date] || {};\n                        userCumulativeData[date][`cumulative_${key}`] = cumulativeCounters[key];\n                    }\n                });\n                \n                // Add net revenue\n                userCumulativeData[date]['cumulative_revenue_net'] = cumulativeCounters['revenue'] - cumulativeCounters['refund'];\n            });\n            \n            const individualResult = {\n                data: {\n                    dates: userDates,\n                    daily_metrics: userDailyData,\n                    cumulative_metrics: userCumulativeData,\n                    user_timelines: backendUserTimelinesEvents,\n                    user_daily_metrics: { [selectedUser]: backendUserDailyMetrics[selectedUser] },\n                    summary_stats: {\n                        total_users: 1,\n                        total_estimated_revenue: userTimelines[selectedUser]?.total_estimated_revenue || 0,\n                        total_actual_revenue: userTimelines[selectedUser]?.total_actual_revenue || 0\n                    }\n                }\n            };\n            \n            return individualResult;\n        }\n        \n        // Aggregate view - calculate cumulative metrics from daily metrics\n        const aggregateDates = Object.keys(backendTimelineData).sort();\n        const aggregateCumulativeMetrics = {};\n        \n        // Initialize cumulative counters for aggregate view\n        let cumulativeCounters = {\n            trial_started: 0,\n            trial_ended: 0,\n            trial_converted: 0,\n            trial_cancelled: 0,\n            initial_purchase: 0,\n            subscription_cancelled: 0,\n            revenue: 0,\n            refund: 0,\n            refund_count: 0\n        };\n        \n        // Calculate cumulative metrics for each date\n        aggregateDates.forEach(date => {\n            const dayData = backendTimelineData[date] || {};\n            \n            // Update cumulative counters (for event-based metrics)\n            Object.keys(cumulativeCounters).forEach(key => {\n                if (key in dayData && typeof dayData[key] === 'number') {\n                    cumulativeCounters[key] += dayData[key];\n                }\n            });\n            \n            // Store cumulative data for this date\n            aggregateCumulativeMetrics[date] = {\n                // State-based metrics use current daily value (not cumulative)\n                trial_pending: dayData.trial_pending || 0,\n                subscription_active: dayData.subscription_active || 0,\n                estimated_revenue: dayData.estimated_revenue || 0,\n                \n                // Event-based metrics use cumulative values\n                cumulative_trial_started: cumulativeCounters.trial_started,\n                cumulative_trial_ended: cumulativeCounters.trial_ended,\n                cumulative_trial_converted: cumulativeCounters.trial_converted,\n                cumulative_trial_cancelled: cumulativeCounters.trial_cancelled,\n                cumulative_initial_purchase: cumulativeCounters.initial_purchase,\n                cumulative_subscription_cancelled: cumulativeCounters.subscription_cancelled,\n                cumulative_revenue: cumulativeCounters.revenue,\n                cumulative_refund: cumulativeCounters.refund,\n                cumulative_refund_count: cumulativeCounters.refund_count,\n                cumulative_revenue_net: cumulativeCounters.revenue - cumulativeCounters.refund\n            };\n        });\n        \n        const aggregateResult = {\n            data: {\n                dates: aggregateDates,\n                daily_metrics: backendTimelineData,\n                cumulative_metrics: aggregateCumulativeMetrics,\n                user_timelines: backendUserTimelinesEvents,\n                user_daily_metrics: backendUserDailyMetrics,\n                summary_stats: aggregateStats\n            }\n        };\n        \n        return aggregateResult;\n    };\n\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\">\n            <div className=\"flex items-center gap-2 mb-6\">\n                <TrendingUp size={24} className=\"text-purple-600 dark:text-purple-400\" />\n                <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                    Stage 3: Revenue Timeline Generation Results\n                </h2>\n                <div className=\"ml-auto flex items-center gap-1 text-purple-600 dark:text-purple-400 text-sm\">\n                    <span>✓</span>\n                    <span>Revenue Estimation & Timeline Projection</span>\n                </div>\n            </div>\n\n            {/* User Selection Controls */}\n            <div className=\"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                    <User size={20} className=\"text-blue-600 dark:text-blue-400\" />\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">View Selection</h3>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {/* User Dropdown */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            Select User (or leave empty for aggregate)\n                        </label>\n                        <div className=\"space-y-2\">\n                            <input\n                                type=\"text\"\n                                placeholder=\"Search by User ID or outcome...\"\n                                value={userSearchTerm}\n                                onChange={(e) => setUserSearchTerm(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\"\n                            />\n                            <select\n                                value={selectedUser}\n                                onChange={(e) => {\n                                    setSelectedUser(e.target.value);\n                                    setSelectedProductId(''); // Reset product selection when user changes\n                                }}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\"\n                            >\n                                <option value=\"\">🌍 Aggregate View (All Users)</option>\n                                {userList.map(user => (\n                                    <option key={user.userId} value={user.userId}>\n                                        👤 {user.displayName} - Est: {formatCurrency(user.estimatedRevenue)}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                        \n                        {/* NEW: Product Selector - Only show when user has multiple products */}\n                        {selectedUser && selectedUserHasMultipleProducts && (\n                            <div className=\"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800\">\n                                <div className=\"flex items-center gap-2 mb-2\">\n                                    <Package size={16} className=\"text-yellow-600 dark:text-yellow-400\" />\n                                    <span className=\"text-sm font-medium text-yellow-800 dark:text-yellow-200\">\n                                        Multiple Products Detected\n                                    </span>\n                                </div>\n                                <select\n                                    value={selectedProductId}\n                                    onChange={(e) => setSelectedProductId(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm\"\n                                >\n                                    <option value=\"\">📊 All Products (Combined)</option>\n                                    {availableProductsForUser.map(productId => (\n                                        <option key={productId} value={productId}>\n                                            📦 {productId}\n                                        </option>\n                                    ))}\n                                </select>\n                                <p className=\"text-xs text-yellow-700 dark:text-yellow-300 mt-1\">\n                                    This user has trials for {availableProductsForUser.length} different products. \n                                    Select a specific product or view combined data.\n                                </p>\n                            </div>\n                        )}\n                    </div>\n                    \n                    {/* Current Selection Info */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            Current View\n                        </label>\n                        <div className=\"p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700\">\n                            {selectedUser ? (\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-1\">\n                                        <User size={16} className=\"text-blue-600 dark:text-blue-400\" />\n                                        <span className=\"font-medium text-gray-900 dark:text-white\">Individual User</span>\n                                    </div>\n                                    <div className=\"text-sm text-gray-600 dark:text-gray-400 break-all\">\n                                        ID: {selectedUser}\n                                    </div>\n                                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                        Status: {userTimelines[selectedUser]?.outcome_type || 'pending'}\n                                    </div>\n                                    {selectedUserHasMultipleProducts && (\n                                        <div className=\"text-sm text-orange-600 dark:text-orange-400\">\n                                            Products: {availableProductsForUser.length} ({selectedProductId || 'All'})\n                                        </div>\n                                    )}\n                                </div>\n                            ) : (\n                                <div>\n                                    <div className=\"flex items-center gap-2 mb-1\">\n                                        <Globe size={16} className=\"text-green-600 dark:text-green-400\" />\n                                        <span className=\"font-medium text-gray-900 dark:text-white\">Aggregate View</span>\n                                    </div>\n                                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                        Showing data for all {Object.keys(userTimelines).length} users\n                                    </div>\n                                    <div className=\"text-sm text-blue-600 dark:text-blue-400\">\n                                        Multi-product users: {Object.keys(usersWithMultipleProducts).length}\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Revenue Summary Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n                <div className=\"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Users size={20} className=\"text-purple-600 dark:text-purple-400\" />\n                        <h3 className=\"font-semibold text-purple-900 dark:text-purple-200\">Users with Timelines</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-purple-600 dark:text-purple-300\">\n                        {selectedUser ? '1' : formatNumber(stage3Data.users_with_timelines || 0)}\n                    </p>\n                    <p className=\"text-sm text-purple-700 dark:text-purple-400\">\n                        {selectedUser ? 'Individual view' : 'Revenue projections generated'}\n                    </p>\n                </div>\n\n                <div className=\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <DollarSign size={20} className=\"text-green-600 dark:text-green-400\" />\n                        <h3 className=\"font-semibold text-green-900 dark:text-green-200\">Estimated Revenue</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-green-600 dark:text-green-300\">\n                        {selectedUser ? \n                            formatCurrency(userTimelines[selectedUser]?.total_estimated_revenue || 0) :\n                            formatCurrency(aggregateStats.total_estimated_revenue || 0)\n                        }\n                    </p>\n                    <p className=\"text-sm text-green-700 dark:text-green-400\">\n                        Based on conversion probabilities\n                    </p>\n                </div>\n\n                <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Activity size={20} className=\"text-blue-600 dark:text-blue-400\" />\n                        <h3 className=\"font-semibold text-blue-900 dark:text-blue-200\">Actual Revenue</h3>\n                    </div>\n                    <p className=\"text-2xl font-bold text-blue-600 dark:text-blue-300\">\n                        {selectedUser ? \n                            formatCurrency(userTimelines[selectedUser]?.total_actual_revenue || 0) :\n                            formatCurrency(aggregateStats.total_actual_revenue || 0)\n                        }\n                    </p>\n                    <p className=\"text-sm text-blue-700 dark:text-blue-400\">\n                        From confirmed outcomes\n                    </p>\n                </div>\n\n                <div className=\"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Clock size={20} className=\"text-orange-600 dark:text-orange-400\" />\n                        <h3 className=\"font-semibold text-orange-900 dark:text-orange-200\">Timeline End</h3>\n                    </div>\n                    <p className=\"text-lg font-bold text-orange-600 dark:text-orange-300\">\n                        {stage3Data.timeline_end_date || 'N/A'}\n                    </p>\n                    <p className=\"text-sm text-orange-700 dark:text-orange-400\">\n                        Projection end date\n                    </p>\n                </div>\n            </div>\n\n            {/* Revenue Formula Explanation */}\n            <div className=\"mb-6\">\n                <div className=\"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\n                        <Calculator size={20} className=\"text-green-600 dark:text-green-400\" />\n                        Revenue Calculation Using Event State Tracker\n                    </h3>\n                    \n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 font-mono text-sm mb-4\">\n                        <div className=\"space-y-3\">\n                            <div className=\"text-center\">\n                                <div className=\"text-lg font-bold text-gray-900 dark:text-white mb-2\">\n                                    🔵 Pre-Outcome (Trial Pending)\n                                </div>\n                                <div className=\"text-base text-blue-600 dark:text-blue-400\">\n                                    estimated_revenue = conversion_probability × (1 - refund_rate) × price\n                                </div>\n                            </div>\n                            \n                            <div className=\"text-center\">\n                                <div className=\"text-lg font-bold text-gray-900 dark:text-white mb-2\">\n                                    🟢 Post-Conversion (Subscription Active)\n                                </div>\n                                <div className=\"text-base text-green-600 dark:text-green-400\">\n                                    revenue = price × (1 - current_refund_rate)\n                                </div>\n                                <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                    current_refund_rate degrades linearly to 0% over 30 days\n                                </div>\n                            </div>\n                            \n                            <div className=\"text-center\">\n                                <div className=\"text-lg font-bold text-gray-900 dark:text-white mb-2\">\n                                    🔴 Post-Cancellation (Subscription Cancelled)\n                                </div>\n                                <div className=\"text-base text-red-600 dark:text-red-400\">\n                                    revenue = $0.00\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        <strong>📈 State Tracking:</strong> \n                        • Backend uses event_state_tracker.py for proper event state management\n                        • Trial states: started → pending → ended (converted/cancelled)\n                        • Subscription states: active → cancelled  \n                        • Revenue tracking includes actual event revenue and refunds\n                    </div>\n                </div>\n            </div>\n\n            {/* User & Segment Details - Full Width */}\n            <div className=\"mb-6 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-800\">\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n                    <Target size={20} className=\"text-purple-600 dark:text-purple-400\" />\n                    User & Segment Details\n                </h3>\n                \n                {selectedUser ? (\n                    (() => {\n                        // --- START: REPLACEMENT LOGIC ---\n                        \n                        // Get the complete, consolidated data for the selected user\n                        const userEventsData = backendUserTimelinesEvents[selectedUser];\n\n                        // If there's no data for the selected user, show an error state.\n                        if (!userEventsData) {\n                            return <div className=\"text-red-500 text-center\">Error: No timeline event data found for user {selectedUser}.</div>;\n                        }\n\n                        // Extract segment info and properties directly from the new, correct data structure.\n                        const segmentInfo = userEventsData.segment_info || {};\n                        const userProperties = segmentInfo.user_properties || {};\n                        \n                        // Extract metrics directly from the segment info\n                        const effectiveSegmentMetrics = segmentInfo.conversion_metrics || {};\n\n                        // The rest of your display logic can now use these variables directly.\n                        // For example, to get the matched segment ID:\n                        const matchedSegmentId = segmentInfo.matched_segment_id || segmentInfo.segment_id;\n                        // To get the final segment ID after rollup:\n                        const finalSegmentId = segmentInfo.final_viable_segment_id || segmentInfo.segment_id;\n\n                        // To check if a rollup occurred:\n                        const hasActualRollup = matchedSegmentId && finalSegmentId && matchedSegmentId !== finalSegmentId;\n\n                        // Extract segment properties from the correct sources\n                        let matchedSegmentProperties = userProperties;\n                        let finalSegmentProperties = userProperties;\n                        let matchedLevel = 0;\n                        let matchedUserCount = effectiveSegmentMetrics.sample_size || effectiveSegmentMetrics.cohort_size || 'Unknown';\n                        let finalLevel = 0;\n                        let finalUserCount = matchedUserCount;\n\n                        // --- END: REPLACEMENT LOGIC ---\n                        \n                        return (\n                            <div className=\"space-y-4\">\n                                <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-4\">\n                                    {/* Column 1: User ID + User Properties */}\n                                    <div className=\"bg-gray-800 text-white p-4 rounded-lg text-sm\">\n                                        <div className=\"font-mono text-xs mb-3 text-blue-300 break-all\">\n                                            {selectedUser}\n                                        </div>\n                                        <div className=\"text-xs text-gray-400 mb-3\">\n                                            Short: {selectedUser.substring(0, 8)}...\n                                        </div>\n                                        <div className=\"space-y-1 text-xs\">\n                                            <div><span className=\"text-gray-400\">Product:</span> {userProperties.product_id || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Store:</span> {userProperties.app_store || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Price:</span> {userProperties.price_bucket || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Country:</span> {userProperties.country || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Economic Tier:</span> {userProperties.economic_tier || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Region:</span> {userProperties.region || 'N/A'}</div>\n                                        </div>\n                                    </div>\n\n                                    {/* Column 2: Matched Segment (Initial) - Uses enhanced data when available */}\n                                    <div className=\"bg-gray-800 text-white p-4 rounded-lg text-sm\">\n                                        <div className=\"font-medium text-blue-300 mb-2 text-xs\">\n                                            ID: {matchedSegmentId ? matchedSegmentId.substring(0, 8) + '...' : 'Unknown'}\n                                        </div>\n                                        <div className=\"space-y-1 text-xs\">\n                                            <div><span className=\"text-gray-400\">Product:</span> {matchedSegmentProperties.product_id || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Store:</span> {matchedSegmentProperties.app_store || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Price:</span> {matchedSegmentProperties.price_bucket || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Country:</span> {matchedSegmentProperties.country || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Economic Tier:</span> {matchedSegmentProperties.economic_tier || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Region:</span> {matchedSegmentProperties.region || 'N/A'}</div>\n                                            <div><span className=\"text-gray-400\">Level:</span> {matchedLevel}</div>\n                                            <div><span className=\"text-gray-400\">Users:</span> {matchedUserCount}</div>\n                                        </div>\n                                    </div>\n\n                                    {/* Column 3: Target Segment (Final Segment) - Always show if we have segment data */}\n                                    <div className=\"bg-gray-800 text-white p-4 rounded-lg text-sm\">\n                                        {hasActualRollup ? (\n                                            <div>\n                                                <div className=\"font-medium text-green-300 mb-2 text-xs\">\n                                                    ID: {finalSegmentId ? finalSegmentId.substring(0, 8) + '...' : 'Unknown'}\n                                                </div>\n                                                <div className=\"space-y-1 text-xs\">\n                                                    <div><span className=\"text-gray-400\">Product:</span> {finalSegmentProperties.product_id || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Store:</span> {finalSegmentProperties.app_store || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Price:</span> {finalSegmentProperties.price_bucket || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Country:</span> {finalSegmentProperties.country || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Economic Tier:</span> {finalSegmentProperties.economic_tier || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Region:</span> {finalSegmentProperties.region || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Level:</span> {finalLevel}</div>\n                                                    <div><span className=\"text-gray-400\">Users:</span> {finalUserCount}</div>\n                                                </div>\n                                            </div>\n                                        ) : (\n                                            <div>\n                                                <div className=\"font-medium text-blue-300 mb-2 text-xs\">\n                                                    ID: {finalSegmentId ? finalSegmentId.substring(0, 8) + '...' : 'Same as matched'}\n                                                </div>\n                                                <div className=\"space-y-1 text-xs\">\n                                                    <div><span className=\"text-gray-400\">Product:</span> {finalSegmentProperties.product_id || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Store:</span> {finalSegmentProperties.app_store || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Price:</span> {finalSegmentProperties.price_bucket || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Country:</span> {finalSegmentProperties.country || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Economic Tier:</span> {finalSegmentProperties.economic_tier || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Region:</span> {finalSegmentProperties.region || 'N/A'}</div>\n                                                    <div><span className=\"text-gray-400\">Level:</span> {finalLevel}</div>\n                                                    <div><span className=\"text-gray-400\">Users:</span> {finalUserCount}</div>\n                                                </div>\n                                                <div className=\"text-xs text-gray-500 mt-2 italic\">\n                                                    Direct match - no rollup applied\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Column 4: 4 Key Metrics */}\n                                    <div className=\"bg-gray-800 text-white p-4 rounded-lg text-sm\">\n                                        <div className=\"space-y-2 text-xs\">\n                                            <div>\n                                                <span className=\"text-gray-400\">Trial Conv.:</span> \n                                                <span className=\"ml-1 text-green-300\">\n                                                    {((effectiveSegmentMetrics.trial_conversion_rate || 0) * 100).toFixed(1)}%\n                                                </span>\n                                            </div>\n                                            <div>\n                                                <span className=\"text-gray-400\">Refund:</span> \n                                                <span className=\"ml-1 text-red-300\">\n                                                    {((effectiveSegmentMetrics.trial_converted_to_refund_rate || 0) * 100).toFixed(1)}%\n                                                </span>\n                                            </div>\n                                            <div>\n                                                <span className=\"text-gray-400\">Init. Refund:</span> \n                                                <span className=\"ml-1 text-red-300\">\n                                                    {((effectiveSegmentMetrics.initial_purchase_to_refund_rate || 0) * 100).toFixed(1)}%\n                                                </span>\n                                            </div>\n                                            <div>\n                                                <span className=\"text-gray-400\">Renewal Refund:</span> \n                                                <span className=\"ml-1 text-red-300\">\n                                                    {((effectiveSegmentMetrics.renewal_to_refund_rate || 0) * 100).toFixed(1)}%\n                                                </span>\n                                            </div>\n                                            <div>\n                                                <span className=\"text-gray-400\">Sample size:</span> \n                                                <span className=\"ml-1 text-blue-300\">\n                                                    {finalUserCount}\n                                                </span>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    {/* Column 5: Prediction Accuracy */}\n                                    <div className=\"bg-gray-800 text-white p-4 rounded-lg text-sm\">\n                                        <div className=\"text-center\">\n                                            <div className={`\n                                                px-3 py-2 rounded-full text-xs font-medium\n                                                ${segmentInfo.accuracy_score === 'high' ? 'bg-green-600 text-white' : \n                                                  segmentInfo.accuracy_score === 'medium' ? 'bg-yellow-600 text-white' : \n                                                  'bg-red-600 text-white'}\n                                            `}>\n                                                {(segmentInfo.accuracy_score || 'Unknown').toUpperCase()}\n                                            </div>\n                                            <div className=\"text-xs text-gray-400 mt-2\">\n                                                Prediction Accuracy\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        );\n                    })()\n                ) : (\n                    <div className=\"text-gray-600 dark:text-gray-400 italic text-center py-8\">\n                        Select an individual user to view segment details\n                    </div>\n                )}\n            </div>\n\n            {/* Event Timeline Table - Uses backend data directly */}\n            {stage3Data && (\n                <div className=\"mb-6\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                        {selectedUser ? `Revenue Timeline for User ${selectedUser.substring(0, 16)}...` : 'Aggregate Revenue Timeline'}\n                        {selectedUser && selectedProductId && (\n                            <span className=\"text-sm text-gray-500 dark:text-gray-400 ml-2\">\n                                (Product: {selectedProductId})\n                            </span>\n                        )}\n                    </h3>\n                    <EventTimelineTableV3 \n                        data={getTimelineTableData()} \n                        selectedUserId={selectedUser}\n                        selectedProductId={selectedProductId || (selectedUser ? userTimelines[selectedUser]?.user_properties?.product_id : null)}\n                    />\n                </div>\n            )}\n\n            {/* Stage 3 Error Display */}\n            {stage3Data.error && (\n                <div className=\"text-center py-8 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800\">\n                    <AlertCircle size={48} className=\"mx-auto text-red-400 mb-4\" />\n                    <p className=\"text-red-600 dark:text-red-400 mb-2\">\n                        Stage 3 Error: {stage3Data.error}\n                    </p>\n                </div>\n            )}\n\n            {/* No Data Message */}\n            {Object.keys(userTimelines).length === 0 && !stage3Data.error && (\n                <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                    <TrendingUp size={48} className=\"mx-auto text-gray-400 mb-4\" />\n                    <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\n                        No revenue timeline data available\n                    </p>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-500\">\n                        Run Stage 3 analysis to see revenue timeline projections\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default Stage3RevenueResultsV3; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}