{"ast":null,"code":"var _jsxFileName = \"/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/pages/PricingManagementPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PricingManagementPage = () => {\n  _s();\n  var _productGroups$formDa, _productGroups$formDa2, _showDataProvenance$d, _showDataProvenance$d3, _showDataProvenance$d4, _showRuleHistory$data, _showRuleHistory$data2;\n  const [rules, setRules] = useState([]);\n  const [missingProducts, setMissingProducts] = useState([]);\n  const [schemaVersion, setSchemaVersion] = useState('1.0.0');\n  const [productGroups, setProductGroups] = useState({});\n  const [productsStructure, setProductsStructure] = useState({}); // New products structure from API\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [expandedProducts, setExpandedProducts] = useState(new Set());\n  const [expandedCountries, setExpandedCountries] = useState(new Set());\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [editingRule, setEditingRule] = useState(null);\n  const [addingCountryFor, setAddingCountryFor] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [countries, setCountries] = useState([]);\n  const [showDataProvenance, setShowDataProvenance] = useState(null); // For showing underlying data\n\n  // Rule history state\n  const [showRuleHistory, setShowRuleHistory] = useState(null);\n  const [ruleHistory, setRuleHistory] = useState({});\n\n  // Edit rule state\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editFormData, setEditFormData] = useState({\n    rule_id: '',\n    product_id: '',\n    price_usd: '',\n    start_date: '',\n    countries: []\n  });\n\n  // Form state for creating rules\n  const [formData, setFormData] = useState({\n    product_id: '',\n    price_usd: '',\n    start_date: '',\n    countries: []\n  });\n\n  // Smart defaults and loading states\n  const [suggestedPrice, setSuggestedPrice] = useState(null);\n  const [loadingPrice, setLoadingPrice] = useState(false);\n  const [countrySelectAll, setCountrySelectAll] = useState(false);\n\n  // Trial activity data from backend\n  const [trialActivityData, setTrialActivityData] = useState({});\n\n  // Auto-repair notification state\n  const [autoRepairNotification, setAutoRepairNotification] = useState(null);\n\n  // Load pricing rules and dropdown data\n  useEffect(() => {\n    loadPricingRules();\n    loadDropdownData();\n  }, []);\n\n  // Group rules by product and country when rules change\n  useEffect(() => {\n    if (rules.length > 0 || missingProducts.length > 0) {\n      groupRulesByProductAndCountry();\n    }\n  }, [rules, missingProducts]);\n\n  // Auto-expand logic when data loads\n  useEffect(() => {\n    if (Object.keys(productGroups).length > 0) {\n      // Keep products collapsed by default - only expand if search matches\n      if (searchTerm) {\n        const matchingProducts = Object.keys(productGroups).filter(productId => productId.toLowerCase().includes(searchTerm.toLowerCase()));\n        setExpandedProducts(new Set(matchingProducts));\n      } else {\n        setExpandedProducts(new Set()); // Collapsed by default\n      }\n\n      // Countries don't need expand/collapse state anymore - they're always shown when product is expanded\n      setExpandedCountries(new Set());\n    }\n  }, [productGroups, searchTerm]);\n\n  // Keep country select all state in sync\n  useEffect(() => {\n    if (countries.length > 0) {\n      setCountrySelectAll(formData.countries.length === countries.length && formData.countries.length > 0);\n    }\n  }, [formData.countries, countries]);\n  const loadPricingRules = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/pricing/rules');\n      const data = await response.json();\n      if (data.success) {\n        setRules(data.data.rules || []);\n        // Handle both old and new schema formats\n        if (data.data.missing_products) {\n          setMissingProducts(data.data.missing_products);\n        }\n        if (data.data.schema_version) {\n          setSchemaVersion(data.data.schema_version);\n        }\n        // Store the new products structure from API\n        if (data.data.products) {\n          setProductsStructure(data.data.products);\n        }\n        // Store trial activity data from backend\n        if (data.data.trial_activity_data) {\n          setTrialActivityData(data.data.trial_activity_data);\n        }\n\n        // Handle auto-repair notifications\n        if (data.data.auto_repair_count && data.data.auto_repair_count > 0) {\n          setAutoRepairNotification({\n            type: 'success',\n            message: `âœ… Auto-repaired ${data.data.auto_repair_count} pricing rules with missing end dates`,\n            timestamp: Date.now()\n          });\n\n          // Auto-hide notification after 8 seconds\n          setTimeout(() => {\n            setAutoRepairNotification(null);\n          }, 8000);\n        }\n      } else {\n        setError(data.error || 'Failed to load pricing rules');\n      }\n    } catch (err) {\n      setError('Network error loading pricing rules');\n      console.error('Error loading pricing rules:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const forceRepairRules = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/pricing/repair-rules', {\n        method: 'POST'\n      });\n      const data = await response.json();\n      if (data.success) {\n        setAutoRepairNotification({\n          type: 'success',\n          message: `ðŸ”§ ${data.message}`,\n          timestamp: Date.now()\n        });\n\n        // Reload data after repair\n        setTimeout(() => {\n          loadPricingRules();\n        }, 1000);\n      } else {\n        setError(data.error || 'Failed to repair rules');\n      }\n    } catch (err) {\n      setError('Network error during rule repair');\n      console.error('Error repairing rules:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const loadDropdownData = async () => {\n    try {\n      const [productsRes, countriesRes] = await Promise.all([fetch('/api/pricing/products'), fetch('/api/pricing/countries')]);\n      const [productsData, countriesData] = await Promise.all([productsRes.json(), countriesRes.json()]);\n      if (productsData.success && productsData.data && productsData.data.products) {\n        const productList = productsData.data.products.map(p => p.product_id);\n        setProducts(productList);\n      }\n      if (countriesData.success && countriesData.data && countriesData.data.countries) {\n        const countryList = countriesData.data.countries.map(c => c.country_code);\n        setCountries(countryList);\n      }\n    } catch (err) {\n      console.error('Error loading dropdown data:', err);\n      setProducts([]);\n      setCountries([]);\n    }\n  };\n  const loadDataProvenance = async ruleId => {\n    try {\n      const response = await fetch(`/api/pricing/rules/${ruleId}/provenance`);\n      const data = await response.json();\n      if (data.success) {\n        setShowDataProvenance({\n          ruleId,\n          data: data.data\n        });\n      } else {\n        console.error('Failed to load data provenance:', data.error);\n      }\n    } catch (err) {\n      console.error('Error loading data provenance:', err);\n    }\n  };\n  const loadRuleHistory = async productId => {\n    try {\n      const response = await fetch(`/api/pricing/rules/${productId}/history`);\n      const data = await response.json();\n      if (data.success) {\n        setShowRuleHistory({\n          productId,\n          data: data.data\n        });\n      } else {\n        console.error('Failed to load rule history:', data.error);\n      }\n    } catch (err) {\n      console.error('Error loading rule history:', err);\n    }\n  };\n  const openEditModal = rule => {\n    setEditFormData({\n      rule_id: rule.rule_id,\n      product_id: rule.product_id,\n      price_usd: rule.price_usd.toString(),\n      start_date: rule.start_date,\n      countries: [...rule.countries]\n    });\n    setEditingRule(rule);\n    setShowEditModal(true);\n  };\n  const updateRule = async e => {\n    e.preventDefault();\n    try {\n      const response = await fetch(`/api/pricing/rules/${editFormData.rule_id}?simple_edit=true`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          product_id: editFormData.product_id,\n          price_usd: parseFloat(editFormData.price_usd),\n          start_date: editFormData.start_date,\n          countries: editFormData.countries\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setShowEditModal(false);\n        setEditingRule(null);\n        setEditFormData({\n          rule_id: '',\n          product_id: '',\n          price_usd: '',\n          start_date: '',\n          countries: []\n        });\n        // Reload all data to ensure consistency\n        loadPricingRules();\n        setError(null);\n      } else {\n        setError(data.error || 'Failed to update rule');\n      }\n    } catch (err) {\n      setError('Network error updating rule');\n      console.error('Error updating rule:', err);\n    }\n  };\n  const groupRulesByProductAndCountry = () => {\n    const groups = {};\n\n    // Group existing rules by product and country\n    rules.forEach(rule => {\n      const productId = rule.product_id;\n      if (!groups[productId]) {\n        groups[productId] = {\n          totalRules: 0,\n          countries: {},\n          allCountries: [],\n          mostRecentPricingUpdate: null,\n          // When pricing was last changed (start_date)\n          hasMissingRules: false\n        };\n      }\n      groups[productId].totalRules++;\n\n      // Track most recent pricing update (start_date) - when pricing was actually changed\n      const pricingStartDate = new Date(rule.start_date);\n      if (!groups[productId].mostRecentPricingUpdate || pricingStartDate > groups[productId].mostRecentPricingUpdate) {\n        groups[productId].mostRecentPricingUpdate = pricingStartDate;\n      }\n      rule.countries.forEach(country => {\n        if (!groups[productId].countries[country]) {\n          groups[productId].countries[country] = {\n            rules: [],\n            priceRange: {\n              min: Infinity,\n              max: -Infinity\n            },\n            hasActive: false,\n            hasFuture: false,\n            hasHistorical: false\n          };\n          groups[productId].allCountries.push(country);\n        }\n        const countryData = groups[productId].countries[country];\n        countryData.rules.push(rule);\n\n        // Update price range\n        countryData.priceRange.min = Math.min(countryData.priceRange.min, rule.price_usd);\n        countryData.priceRange.max = Math.max(countryData.priceRange.max, rule.price_usd);\n\n        // Determine rule status for country\n        const now = new Date();\n        const startDate = new Date(rule.start_date);\n        const endDate = rule.end_date ? new Date(rule.end_date) : null;\n        if (endDate && now > endDate) {\n          countryData.hasHistorical = true;\n        } else if (now >= startDate && (!endDate || now <= endDate)) {\n          countryData.hasActive = true;\n        } else {\n          countryData.hasFuture = true;\n        }\n      });\n    });\n\n    // Add missing products and update trial activity for all products\n    missingProducts.forEach(missingProduct => {\n      const productId = missingProduct.product_id;\n      const trialActivityDate = new Date(missingProduct.last_trial || missingProduct.last_conversion);\n      if (!groups[productId]) {\n        groups[productId] = {\n          totalRules: 0,\n          countries: {},\n          allCountries: [],\n          mostRecentPricingUpdate: trialActivityDate,\n          mostRecentTrialActivity: trialActivityDate,\n          hasMissingRules: true,\n          missingProductInfo: missingProduct\n        };\n      } else {\n        // Product exists with rules - update trial activity and mark as having missing rules if needed\n        groups[productId].hasMissingRules = true;\n        groups[productId].missingProductInfo = missingProduct;\n\n        // Update with trial activity date - this is key for proper sorting\n        if (!groups[productId].mostRecentTrialActivity || trialActivityDate > groups[productId].mostRecentTrialActivity) {\n          groups[productId].mostRecentTrialActivity = trialActivityDate;\n        }\n\n        // Also update pricing update if trial activity is more recent\n        if (!groups[productId].mostRecentPricingUpdate || trialActivityDate > groups[productId].mostRecentPricingUpdate) {\n          groups[productId].mostRecentPricingUpdate = trialActivityDate;\n        }\n      }\n    });\n\n    // Update all products with accurate trial activity data from backend\n    Object.keys(groups).forEach(productId => {\n      if (trialActivityData[productId]) {\n        const activityInfo = trialActivityData[productId];\n        const activityDate = new Date(activityInfo.most_recent_activity);\n\n        // Update with the accurate trial activity date\n        groups[productId].mostRecentTrialActivity = activityDate;\n        groups[productId].totalTrialEvents = activityInfo.total_events;\n\n        // If this product doesn't have pricing rules, also update the pricing update date\n        if (groups[productId].totalRules === 0) {\n          groups[productId].mostRecentPricingUpdate = activityDate;\n        }\n      }\n    });\n\n    // For products with rules but no trial activity data, use pricing date as trial activity\n    Object.values(groups).forEach(product => {\n      if (!product.mostRecentTrialActivity && product.mostRecentPricingUpdate) {\n        product.mostRecentTrialActivity = product.mostRecentPricingUpdate;\n      }\n    });\n\n    // Fix any infinite values in price ranges\n    Object.values(groups).forEach(product => {\n      Object.values(product.countries).forEach(countryData => {\n        if (countryData.priceRange.min === Infinity) {\n          countryData.priceRange.min = 0;\n        }\n        if (countryData.priceRange.max === -Infinity) {\n          countryData.priceRange.max = 0;\n        }\n      });\n    });\n    setProductGroups(groups);\n  };\n  const toggleProductExpansion = productId => {\n    const newExpanded = new Set(expandedProducts);\n    if (newExpanded.has(productId)) {\n      newExpanded.delete(productId);\n    } else {\n      newExpanded.add(productId);\n    }\n    setExpandedProducts(newExpanded);\n  };\n  const deleteRule = async ruleId => {\n    if (!window.confirm('Are you sure you want to delete this pricing rule?')) {\n      return;\n    }\n    try {\n      const response = await fetch(`/api/pricing/rules/${ruleId}?hard_delete=true`, {\n        method: 'DELETE'\n      });\n      const data = await response.json();\n      if (data.success) {\n        // Remove the rule from frontend state immediately\n        setRules(rules.filter(rule => rule.rule_id !== ruleId));\n        // Also reload all data to ensure consistency across all affected areas\n        loadPricingRules();\n      } else {\n        setError(data.error || 'Failed to delete rule');\n      }\n    } catch (err) {\n      setError('Network error deleting rule');\n      console.error('Error deleting rule:', err);\n    }\n  };\n  const createRule = async e => {\n    e.preventDefault();\n    try {\n      const response = await fetch('/api/pricing/rules', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          product_id: formData.product_id,\n          price_usd: parseFloat(formData.price_usd),\n          start_date: formData.start_date,\n          countries: formData.countries\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setShowCreateModal(false);\n        setFormData({\n          product_id: '',\n          price_usd: '',\n          start_date: '',\n          countries: []\n        });\n        loadPricingRules();\n      } else {\n        setError(data.error || 'Failed to create rule');\n      }\n    } catch (err) {\n      setError('Network error creating rule');\n      console.error('Error creating rule:', err);\n    }\n  };\n  const roundToNearestPricePoint = price => {\n    // Round to nearest $5 increment, then subtract $0.01 to make it .99\n    const nearestFive = Math.round(price / 5) * 5;\n    const finalPrice = nearestFive - 0.01;\n\n    // Ensure minimum price of $4.99\n    return Math.max(4.99, finalPrice);\n  };\n  const fetchSuggestedPrice = async productId => {\n    if (!productId) return;\n    setLoadingPrice(true);\n    try {\n      const response = await fetch(`/api/pricing/products/${productId}/most-recent-conversion-price`);\n      const data = await response.json();\n      if (data.success) {\n        // Round the suggested price to nearest $5 increment minus $0.01\n        const roundedPrice = roundToNearestPricePoint(data.data.suggested_price);\n        setSuggestedPrice({\n          ...data.data,\n          suggested_price: roundedPrice,\n          original_price: data.data.suggested_price,\n          note: `Rounded from $${data.data.suggested_price} to $${roundedPrice} (${data.data.note})`\n        });\n        setFormData(prev => ({\n          ...prev,\n          price_usd: roundedPrice.toString()\n        }));\n      } else {\n        setSuggestedPrice(null);\n      }\n    } catch (err) {\n      console.error('Error fetching suggested price:', err);\n      setSuggestedPrice(null);\n    } finally {\n      setLoadingPrice(false);\n    }\n  };\n  const handleCountrySelectAll = () => {\n    if (countrySelectAll) {\n      // Deselect all\n      setFormData({\n        ...formData,\n        countries: []\n      });\n      setCountrySelectAll(false);\n    } else {\n      // Select all\n      setFormData({\n        ...formData,\n        countries: [...countries]\n      });\n      setCountrySelectAll(true);\n    }\n  };\n  const getDefaultStartDate = productId => {\n    // Check if this product has any existing rules\n    const existingRules = rules.filter(rule => rule.product_id === productId);\n    if (existingRules.length === 0) {\n      // First rule for this product - default to Jan 1 2024\n      return '2024-01-01';\n    } else {\n      // Subsequent rule - leave empty\n      return '';\n    }\n  };\n  const openCreateModal = (productId = '') => {\n    const defaultStartDate = productId ? getDefaultStartDate(productId) : '';\n    setFormData({\n      product_id: productId,\n      price_usd: '',\n      start_date: defaultStartDate,\n      countries: [...countries] // Auto-select all countries by default\n    });\n\n    // Reset smart defaults\n    setSuggestedPrice(null);\n    setCountrySelectAll(true); // Set to true since we're selecting all countries\n\n    // If we have a specific product, fetch suggested price\n    if (productId) {\n      fetchSuggestedPrice(productId);\n    }\n    setShowCreateModal(true);\n  };\n  const formatDate = dateStr => {\n    if (!dateStr) return 'Ongoing';\n    return new Date(dateStr).toLocaleDateString();\n  };\n  const getRuleStatusColor = (rule, countryRules = null) => {\n    const now = new Date();\n    const startDate = new Date(rule.start_date);\n    let endDate = rule.end_date ? new Date(rule.end_date) : null;\n\n    // If no explicit end date and we have country rules, calculate effective end date\n    if (!endDate && countryRules && Array.isArray(countryRules)) {\n      // Find the next rule that starts after this rule\n      const sortedRules = countryRules.filter(r => r.rule_id !== rule.rule_id) // Exclude current rule\n      .sort((a, b) => new Date(a.start_date) - new Date(b.start_date));\n      const nextRule = sortedRules.find(r => new Date(r.start_date) > startDate);\n      if (nextRule) {\n        // This rule effectively ends the day before the next rule starts\n        const nextStartDate = new Date(nextRule.start_date);\n        endDate = new Date(nextStartDate.getTime() - 24 * 60 * 60 * 1000); // Previous day\n      }\n    }\n    if (endDate && now > endDate) {\n      return 'bg-gray-100 border-gray-300 text-gray-600'; // Historical\n    } else if (now >= startDate && (!endDate || now <= endDate)) {\n      return 'bg-green-100 border-green-300 text-green-800'; // Active\n    } else {\n      return 'bg-blue-100 border-blue-300 text-blue-800'; // Future\n    }\n  };\n  const getRuleStatusLabel = (rule, countryRules = null) => {\n    const now = new Date();\n    const startDate = new Date(rule.start_date);\n    let endDate = rule.end_date ? new Date(rule.end_date) : null;\n\n    // If no explicit end date and we have country rules, calculate effective end date\n    if (!endDate && countryRules && Array.isArray(countryRules)) {\n      // Find the next rule that starts after this rule\n      const sortedRules = countryRules.filter(r => r.rule_id !== rule.rule_id) // Exclude current rule\n      .sort((a, b) => new Date(a.start_date) - new Date(b.start_date));\n      const nextRule = sortedRules.find(r => new Date(r.start_date) > startDate);\n      if (nextRule) {\n        // This rule effectively ends the day before the next rule starts\n        const nextStartDate = new Date(nextRule.start_date);\n        endDate = new Date(nextStartDate.getTime() - 24 * 60 * 60 * 1000); // Previous day\n      }\n    }\n    if (endDate && now > endDate) {\n      return 'Historical';\n    } else if (now >= startDate && (!endDate || now <= endDate)) {\n      return 'Active';\n    } else {\n      return 'Future';\n    }\n  };\n  const formatPriceRange = countryData => {\n    if (countryData.priceRange.min === countryData.priceRange.max) {\n      return `$${countryData.priceRange.min}`;\n    }\n    return `$${countryData.priceRange.min} - $${countryData.priceRange.max}`;\n  };\n  const getPriceProgression = product => {\n    if (!product || !product.countries || Object.keys(product.countries).length === 0) {\n      return [];\n    }\n\n    // Get all rules across all countries for this product\n    const allRules = [];\n    Object.values(product.countries).forEach(countryData => {\n      allRules.push(...countryData.rules);\n    });\n\n    // Remove duplicates (same rule might appear in multiple countries)\n    const uniqueRules = allRules.filter((rule, index, self) => index === self.findIndex(r => r.rule_id === rule.rule_id));\n\n    // Sort by start date to show progression\n    const sortedRules = uniqueRules.sort((a, b) => new Date(a.start_date) - new Date(b.start_date));\n\n    // Create price progression - show unique price points in chronological order\n    const priceProgression = [];\n    let lastPrice = null;\n    sortedRules.forEach(rule => {\n      if (rule.price_usd !== lastPrice) {\n        priceProgression.push({\n          price: rule.price_usd,\n          date: rule.start_date,\n          ruleId: rule.rule_id\n        });\n        lastPrice = rule.price_usd;\n      }\n    });\n    return priceProgression;\n  };\n  const sortCountriesByRecentActivity = (countries, productCountries) => {\n    /**\n     * Sort countries by most recent rule update, then alphabetically\n     * @param {Array} countries - Array of country codes\n     * @param {Object} productCountries - Product countries data with rules\n     * @returns {Array} Sorted country codes\n     */\n\n    // More detailed debugging\n    console.log('ðŸ” sortCountriesByRecentActivity called with:', {\n      countriesCount: countries.length,\n      firstFewCountries: countries.slice(0, 5),\n      hasProductCountries: !!productCountries,\n      productCountriesKeys: Object.keys(productCountries || {}).slice(0, 5)\n    });\n    const sortedCountries = countries.sort((a, b) => {\n      const countryA = productCountries[a];\n      const countryB = productCountries[b];\n\n      // Get the most recent rule start date for each country\n      const getMostRecentRuleDate = countryData => {\n        if (!countryData || !countryData.rules || countryData.rules.length === 0) {\n          return null;\n        }\n        // Rules are already sorted with newest first, so take the first one\n        return new Date(countryData.rules[0].start_date);\n      };\n      const dateA = getMostRecentRuleDate(countryA);\n      const dateB = getMostRecentRuleDate(countryB);\n\n      // If both have dates, sort by most recent first\n      if (dateA && dateB) {\n        const dateDiff = dateB - dateA; // Most recent first\n        if (dateDiff !== 0) return dateDiff;\n      }\n\n      // If only one has a date, prioritize it\n      if (dateA && !dateB) return -1;\n      if (!dateA && dateB) return 1;\n\n      // If both have same date or no dates, sort alphabetically\n      return a.localeCompare(b);\n    });\n\n    // Show the results\n    if (countries.includes('US')) {\n      console.log('ðŸŽ¯ Final sorted countries (first 10):', sortedCountries.slice(0, 10));\n      const usIndex = sortedCountries.indexOf('US');\n      const adIndex = sortedCountries.indexOf('AD');\n      const aeIndex = sortedCountries.indexOf('AE');\n      console.log(`ðŸ“ Positions - US: ${usIndex + 1}, AD: ${adIndex + 1}, AE: ${aeIndex + 1}`);\n\n      // Show the most recent rule for US, AD, AE\n      if (productCountries['US'] && productCountries['US'].rules && productCountries['US'].rules[0]) {\n        console.log(`ðŸ‡ºðŸ‡¸ US most recent rule:`, productCountries['US'].rules[0].start_date, `$${productCountries['US'].rules[0].price_usd}`);\n      }\n      if (productCountries['AD'] && productCountries['AD'].rules && productCountries['AD'].rules[0]) {\n        console.log(`ðŸ‡¦ðŸ‡© AD most recent rule:`, productCountries['AD'].rules[0].start_date, `$${productCountries['AD'].rules[0].price_usd}`);\n      }\n    }\n    return sortedCountries;\n  };\n\n  // Filter and sort products based on search and most recent trial activity\n  const filteredProducts = Object.keys(productGroups).filter(productId => productId.toLowerCase().includes(searchTerm.toLowerCase())).sort((a, b) => {\n    const productA = productGroups[a];\n    const productB = productGroups[b];\n\n    // First, separate products with rules vs missing rules\n    const aMissingRules = (productA === null || productA === void 0 ? void 0 : productA.hasMissingRules) || false;\n    const bMissingRules = (productB === null || productB === void 0 ? void 0 : productB.hasMissingRules) || false;\n\n    // Products with rules come first, missing rules go to bottom\n    if (aMissingRules && !bMissingRules) return 1; // A has missing rules, goes to bottom\n    if (!aMissingRules && bMissingRules) return -1; // B has missing rules, goes to bottom\n\n    // Within each group, sort by most recent trial activity (more urgent trials first)\n    const dateA = productA === null || productA === void 0 ? void 0 : productA.mostRecentTrialActivity;\n    const dateB = productB === null || productB === void 0 ? void 0 : productB.mostRecentTrialActivity;\n    if (!dateA && !dateB) return a.localeCompare(b); // Fallback to alphabetical\n    if (!dateA) return 1; // Products without trial dates go to the end of their group\n    if (!dateB) return -1;\n    return dateB - dateA; // Most recent trial activity first within each group\n  });\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mx-auto p-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center items-center h-64\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: \"Loading pricing rules...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 786,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 785,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 784,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-3xl font-bold mb-2\",\n            children: \"Pricing Management\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 798,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600 dark:text-gray-400\",\n            children: \"Manage product pricing across different countries and time periods\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 799,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 797,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-right\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${schemaVersion === '2.0.0' ? 'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200' : 'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200'}`,\n            children: [\"Schema v\", schemaVersion]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 804,\n            columnNumber: 13\n          }, this), schemaVersion === '2.0.0' && missingProducts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1 text-xs text-red-600 dark:text-red-400\",\n            children: \"Enhanced with missing product detection\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 812,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 796,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 795,\n      columnNumber: 7\n    }, this), autoRepairNotification && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-emerald-50 border border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200 px-4 py-3 rounded-xl mb-4 shadow-sm\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-8 h-8 rounded-full bg-emerald-500 flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-4 h-4 text-white\",\n              fill: \"currentColor\",\n              viewBox: \"0 0 20 20\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                fillRule: \"evenodd\",\n                d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",\n                clipRule: \"evenodd\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 827,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 826,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 825,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"font-semibold\",\n              children: autoRepairNotification.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 831,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm opacity-80\",\n              children: \"End dates have been automatically calculated based on newer rules\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 832,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 830,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 824,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setAutoRepairNotification(null),\n          className: \"text-emerald-600 hover:text-emerald-800 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"currentColor\",\n            viewBox: \"0 0 20 20\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 840,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 839,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 835,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 823,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 822,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\",\n      children: [error, /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setError(null),\n        className: \"float-right text-red-700 hover:text-red-900\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 851,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 849,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap gap-4 items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 min-w-64\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Search by product ID...\",\n            value: searchTerm,\n            onChange: e => setSearchTerm(e.target.value),\n            className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 865,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 864,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => openCreateModal(),\n            className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\",\n            children: \"Create Rule\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 876,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: forceRepairRules,\n            className: \"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md\",\n            disabled: loading,\n            children: \"\\uD83D\\uDD27 Fix \\\"Ongoing\\\" Rules\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 882,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: loadPricingRules,\n            className: \"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\",\n            children: \"Refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 889,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 875,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 862,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 861,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl font-bold text-blue-600\",\n          children: filteredProducts.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 902,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 903,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 901,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl font-bold text-green-600\",\n          children: filteredProducts.reduce((sum, productId) => {\n            var _productGroups$produc;\n            return sum + (((_productGroups$produc = productGroups[productId]) === null || _productGroups$produc === void 0 ? void 0 : _productGroups$produc.totalRules) || 0);\n          }, 0)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 906,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Total Rules\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 911,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 905,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `text-2xl font-bold ${filteredProducts.filter(productId => {\n            var _productGroups$produc2;\n            return (_productGroups$produc2 = productGroups[productId]) === null || _productGroups$produc2 === void 0 ? void 0 : _productGroups$produc2.hasMissingRules;\n          }).length > 0 ? 'text-red-600' : 'text-gray-400'}`,\n          children: filteredProducts.filter(productId => {\n            var _productGroups$produc3;\n            return (_productGroups$produc3 = productGroups[productId]) === null || _productGroups$produc3 === void 0 ? void 0 : _productGroups$produc3.hasMissingRules;\n          }).length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 914,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Missing Rules\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 921,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 913,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl font-bold text-purple-600\",\n          children: [...new Set(filteredProducts.flatMap(productId => {\n            var _productGroups$produc4;\n            return ((_productGroups$produc4 = productGroups[productId]) === null || _productGroups$produc4 === void 0 ? void 0 : _productGroups$produc4.allCountries) || [];\n          }))].length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Countries\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 929,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 923,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl font-bold text-orange-600\",\n          children: (() => {\n            const thirtyDaysAgo = new Date();\n            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n            return filteredProducts.filter(productId => {\n              var _productGroups$produc5;\n              const lastUpdate = (_productGroups$produc5 = productGroups[productId]) === null || _productGroups$produc5 === void 0 ? void 0 : _productGroups$produc5.mostRecentPricingUpdate;\n              return lastUpdate && lastUpdate > thirtyDaysAgo;\n            }).length;\n          })()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 932,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Recent Updates\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 942,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 931,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl font-bold text-indigo-600\",\n          children: filteredProducts.filter(productId => expandedProducts.has(productId)).length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 945,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-400\",\n          children: \"Expanded\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 948,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 944,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 900,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: filteredProducts.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center text-gray-500 dark:text-gray-400\",\n        children: Object.keys(productGroups).length === 0 ? 'No pricing rules found' : 'No products match your search criteria'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 955,\n        columnNumber: 11\n      }, this) : filteredProducts.map(productId => {\n        var _product$mostRecentTr;\n        const product = productGroups[productId];\n        const isExpanded = expandedProducts.has(productId);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `group relative overflow-hidden transition-all duration-300 ease-out ${product.hasMissingRules ? 'bg-gradient-to-br from-rose-50 to-red-50 dark:from-red-950/30 dark:to-red-900/20 border-2 border-rose-200 dark:border-red-800/50 shadow-lg shadow-red-100/50 dark:shadow-red-900/20' : 'bg-white dark:bg-slate-900 border border-slate-200/60 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/30 dark:hover:shadow-slate-900/30'} rounded-2xl backdrop-blur-sm`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `relative p-6 border-b cursor-pointer transition-all duration-200 ${product.hasMissingRules ? 'border-rose-200/70 dark:border-red-800/40 hover:bg-gradient-to-br hover:from-rose-100 hover:to-red-100 dark:hover:from-red-950/40 dark:hover:to-red-900/30' : 'border-slate-200/60 dark:border-slate-700/50 hover:bg-slate-50/70 dark:hover:bg-slate-800/50'}`,\n            onClick: () => toggleProductExpansion(productId),\n            children: [product.hasMissingRules && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bg-gradient-to-r from-rose-500 to-red-500 text-white text-xs font-semibold px-4 py-2 flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-4 h-4\",\n                fill: \"currentColor\",\n                viewBox: \"0 0 20 20\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  fillRule: \"evenodd\",\n                  d: \"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\",\n                  clipRule: \"evenodd\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 982,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 981,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"MISSING PRICING RULES \\u2014 URGENT ACTION REQUIRED\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 984,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 980,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${product.hasMissingRules ? 'mt-8' : ''} flex items-center justify-between`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1 min-w-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-4 mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: `text-2xl font-bold tracking-tight ${product.hasMissingRules ? 'text-red-900 dark:text-red-100' : 'text-slate-900 dark:text-slate-100'}`,\n                    children: productId\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 992,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: `inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold transition-all ${product.hasMissingRules ? 'bg-red-500 text-white shadow-md' : 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300'}`,\n                      children: product.hasMissingRules ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                          className: \"w-3 h-3\",\n                          fill: \"currentColor\",\n                          viewBox: \"0 0 20 20\",\n                          children: /*#__PURE__*/_jsxDEV(\"path\", {\n                            fillRule: \"evenodd\",\n                            d: \"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\",\n                            clipRule: \"evenodd\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1010,\n                            columnNumber: 35\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1009,\n                          columnNumber: 33\n                        }, this), \"Missing Rules\"]\n                      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                          className: \"w-3 h-3\",\n                          fill: \"currentColor\",\n                          viewBox: \"0 0 20 20\",\n                          children: /*#__PURE__*/_jsxDEV(\"path\", {\n                            fillRule: \"evenodd\",\n                            d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",\n                            clipRule: \"evenodd\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1017,\n                            columnNumber: 35\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1016,\n                          columnNumber: 33\n                        }, this), \"Active Rules\"]\n                      }, void 0, true)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1002,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1001,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 991,\n                  columnNumber: 23\n                }, this), product.hasMissingRules && product.missingProductInfo ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mb-4 p-4 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-red-200/50 dark:border-red-800/50 rounded-xl shadow-sm\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"space-y-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-start gap-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                        className: \"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0\",\n                        fill: \"currentColor\",\n                        viewBox: \"0 0 20 20\",\n                        children: /*#__PURE__*/_jsxDEV(\"path\", {\n                          fillRule: \"evenodd\",\n                          d: \"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\",\n                          clipRule: \"evenodd\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1032,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1031,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"text-sm font-semibold text-red-900 dark:text-red-100 mb-1\",\n                          children: \"Active trials without pricing rules detected\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1035,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-red-800 dark:text-red-200\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"font-medium\",\n                              children: product.missingProductInfo.trial_count\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1039,\n                              columnNumber: 40\n                            }, this), \" trial events\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1039,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [\"First: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"font-medium\",\n                              children: formatDate(product.missingProductInfo.first_trial)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1040,\n                              columnNumber: 47\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1040,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [\"Latest: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"font-medium\",\n                              children: formatDate(product.missingProductInfo.last_trial)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1041,\n                              columnNumber: 48\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1041,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"col-span-2 mt-1 text-red-700 dark:text-red-300 font-medium\",\n                            children: \"\\u26A0\\uFE0F Revenue analysis incomplete without pricing rules\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1042,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1038,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1034,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1030,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1029,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1028,\n                  columnNumber: 25\n                }, this) :\n                /*#__PURE__*/\n                /* Normal product metrics */\n                _jsxDEV(\"div\", {\n                  className: \"flex items-center gap-6 mb-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-2 h-2 rounded-full bg-blue-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1054,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-sm font-medium text-slate-700 dark:text-slate-300\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-bold text-slate-900 dark:text-slate-100\",\n                        children: product.totalRules\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1056,\n                        columnNumber: 31\n                      }, this), \" rules\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1055,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1053,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-2 h-2 rounded-full bg-purple-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1060,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-sm font-medium text-slate-700 dark:text-slate-300\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-bold text-slate-900 dark:text-slate-100\",\n                        children: product.allCountries.length\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1062,\n                        columnNumber: 31\n                      }, this), \" countries\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1061,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1059,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-2 h-2 rounded-full bg-emerald-500\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1066,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-sm font-medium text-slate-700 dark:text-slate-300\",\n                      children: [\"Last activity: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-bold text-slate-900 dark:text-slate-100\",\n                        children: formatDate((_product$mostRecentTr = product.mostRecentTrialActivity) === null || _product$mostRecentTr === void 0 ? void 0 : _product$mostRecentTr.toISOString().split('T')[0])\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1068,\n                        columnNumber: 46\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1067,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1065,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1052,\n                  columnNumber: 25\n                }, this), !product.hasMissingRules && product.allCountries.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-wrap gap-1.5 mb-4\",\n                  children: [sortCountriesByRecentActivity([...product.allCountries], product.countries).slice(0, 12).map(country => /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200/50 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800/50 transition-colors hover:bg-blue-100 dark:hover:bg-blue-900/50\",\n                    children: country\n                  }, country, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1078,\n                    columnNumber: 29\n                  }, this)), product.allCountries.length > 12 && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200/50 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700\",\n                    children: [\"+\", product.allCountries.length - 12, \" more\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1086,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1076,\n                  columnNumber: 25\n                }, this), !product.hasMissingRules && (() => {\n                  const priceProgression = getPriceProgression(product);\n                  return priceProgression.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"p-4 bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-800/50 dark:to-slate-900/50 rounded-xl border border-slate-200/50 dark:border-slate-700/50 backdrop-blur-sm\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center gap-2 mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-2\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"w-6 h-6 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center\",\n                          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                            className: \"w-3.5 h-3.5 text-white\",\n                            fill: \"none\",\n                            stroke: \"currentColor\",\n                            viewBox: \"0 0 24 24\",\n                            children: /*#__PURE__*/_jsxDEV(\"path\", {\n                              strokeLinecap: \"round\",\n                              strokeLinejoin: \"round\",\n                              strokeWidth: 2,\n                              d: \"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1102,\n                              columnNumber: 37\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1101,\n                            columnNumber: 35\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1100,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                          className: \"text-sm font-bold text-slate-800 dark:text-slate-200\",\n                          children: \"Price Evolution\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1105,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1099,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex-1\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1107,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/70 dark:bg-slate-800/70 px-2 py-1 rounded-md\",\n                        children: [priceProgression.length, \" changes\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1108,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1098,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center gap-3 overflow-x-auto pb-2\",\n                      style: {\n                        scrollbarWidth: 'thin'\n                      },\n                      children: priceProgression.map((point, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-3 flex-shrink-0\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-center group\",\n                          children: /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"relative\",\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"text-xl font-black text-emerald-700 dark:text-emerald-400 mb-0.5 group-hover:scale-105 transition-transform\",\n                              children: [\"$\", point.price]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1117,\n                              columnNumber: 39\n                            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-0.5 rounded-md shadow-sm\",\n                              children: formatDate(point.date)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1120,\n                              columnNumber: 39\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1116,\n                            columnNumber: 37\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1115,\n                          columnNumber: 35\n                        }, this), index < priceProgression.length - 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex items-center\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"w-8 h-0.5 bg-gradient-to-r from-slate-300 to-slate-400 dark:from-slate-600 dark:to-slate-500 rounded-full\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1127,\n                            columnNumber: 39\n                          }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n                            className: \"w-3 h-3 text-slate-400 dark:text-slate-500 -ml-1\",\n                            fill: \"currentColor\",\n                            viewBox: \"0 0 20 20\",\n                            children: /*#__PURE__*/_jsxDEV(\"path\", {\n                              fillRule: \"evenodd\",\n                              d: \"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\",\n                              clipRule: \"evenodd\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1129,\n                              columnNumber: 41\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1128,\n                            columnNumber: 39\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1126,\n                          columnNumber: 37\n                        }, this)]\n                      }, point.ruleId, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1114,\n                        columnNumber: 33\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1112,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1097,\n                    columnNumber: 27\n                  }, this);\n                })()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 989,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 ml-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    openCreateModal(productId);\n                  },\n                  className: `group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-lg ${product.hasMissingRules ? 'bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-red-200 dark:shadow-red-900/30' : 'bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/30'}`,\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative z-10 flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-4 h-4\",\n                      fill: \"none\",\n                      stroke: \"currentColor\",\n                      viewBox: \"0 0 24 24\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        strokeLinecap: \"round\",\n                        strokeLinejoin: \"round\",\n                        strokeWidth: 2,\n                        d: \"M12 6v6m0 0v6m0-6h6m-6 0H6\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1156,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1155,\n                      columnNumber: 27\n                    }, this), product.hasMissingRules ? 'Create First Rule' : 'Add Rule']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1154,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1143,\n                  columnNumber: 23\n                }, this), !product.hasMissingRules && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    loadRuleHistory(productId);\n                  },\n                  className: \"group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white shadow-lg shadow-slate-200 dark:shadow-slate-900/30\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative z-10 flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-4 h-4\",\n                      fill: \"none\",\n                      stroke: \"currentColor\",\n                      viewBox: \"0 0 24 24\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        strokeLinecap: \"round\",\n                        strokeLinejoin: \"round\",\n                        strokeWidth: 2,\n                        d: \"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1173,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1172,\n                      columnNumber: 29\n                    }, this), \"History\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1171,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1164,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center w-10 h-10 rounded-xl bg-slate-100 dark:bg-slate-800 group-hover:bg-slate-200 dark:group-hover:bg-slate-700 transition-colors\",\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    className: `w-5 h-5 text-slate-600 dark:text-slate-400 transform transition-transform duration-200 ${isExpanded ? 'rotate-180' : ''}`,\n                    fill: \"none\",\n                    stroke: \"currentColor\",\n                    viewBox: \"0 0 24 24\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      strokeLinecap: \"round\",\n                      strokeLinejoin: \"round\",\n                      strokeWidth: 2,\n                      d: \"M19 9l-7 7-7-7\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1188,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1182,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1181,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1142,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 988,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 970,\n            columnNumber: 17\n          }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 bg-gradient-to-br from-slate-50/50 to-white dark:from-slate-800/50 dark:to-slate-900/50\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-6\",\n              children: sortCountriesByRecentActivity([...product.allCountries], product.countries).map(country => {\n                const countryData = product.countries[country];\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"group relative overflow-hidden bg-white dark:bg-slate-800/90 border border-slate-200/60 dark:border-slate-700/50 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 backdrop-blur-sm\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative p-6 bg-gradient-to-r from-slate-50 via-white to-slate-50 dark:from-slate-800/80 dark:via-slate-800/60 dark:to-slate-800/80 border-b border-slate-200/60 dark:border-slate-700/50\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center justify-between\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-6\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex items-center gap-3\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-200/50 dark:shadow-blue-900/30\",\n                            children: /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-white font-bold text-lg\",\n                              children: country.slice(0, 2).toUpperCase()\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1210,\n                              columnNumber: 39\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1209,\n                            columnNumber: 37\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                              className: \"text-2xl font-bold text-slate-900 dark:text-slate-100\",\n                              children: country\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1213,\n                              columnNumber: 39\n                            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                              className: \"text-sm text-slate-600 dark:text-slate-400\",\n                              children: \"Pricing timeline\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1214,\n                              columnNumber: 39\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1212,\n                            columnNumber: 37\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1208,\n                          columnNumber: 35\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex items-center gap-4\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex items-center gap-3 px-4 py-2 bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm rounded-xl border border-slate-200/50 dark:border-slate-700/50 shadow-sm\",\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"w-2 h-2 rounded-full bg-blue-500\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1220,\n                              columnNumber: 39\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-sm font-semibold text-slate-700 dark:text-slate-300\",\n                              children: [countryData.rules.length, \" rules\"]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1221,\n                              columnNumber: 39\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1219,\n                            columnNumber: 37\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex items-center gap-3 px-4 py-2 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/30 dark:to-green-900/30 backdrop-blur-sm rounded-xl border border-emerald-200/50 dark:border-emerald-800/50 shadow-sm\",\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"w-2 h-2 rounded-full bg-emerald-500\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1227,\n                              columnNumber: 39\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"text-lg font-black text-emerald-700 dark:text-emerald-400\",\n                              children: formatPriceRange(countryData)\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1228,\n                              columnNumber: 39\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1226,\n                            columnNumber: 37\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1218,\n                          columnNumber: 35\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1207,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1206,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1205,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"p-6\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center gap-3 mb-6\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"w-8 h-8 rounded-xl bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center shadow-md\",\n                        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                          className: \"w-4 h-4 text-white\",\n                          fill: \"none\",\n                          stroke: \"currentColor\",\n                          viewBox: \"0 0 24 24\",\n                          children: /*#__PURE__*/_jsxDEV(\"path\", {\n                            strokeLinecap: \"round\",\n                            strokeLinejoin: \"round\",\n                            strokeWidth: 2,\n                            d: \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1242,\n                            columnNumber: 37\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1241,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1240,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                        className: \"text-lg font-bold text-slate-800 dark:text-slate-200\",\n                        children: \"Chronological Pricing History\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1245,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent dark:from-slate-700\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1248,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1239,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"relative\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex gap-6 overflow-x-auto pb-4 scrollbar-hide\",\n                        style: {\n                          scrollbarWidth: 'none'\n                        },\n                        children: countryData.rules.map((rule, index) => {\n                          const status = getRuleStatusLabel(rule, countryData.rules);\n                          const isActive = status === 'Active';\n                          const isFuture = status === 'Future';\n                          const isHistorical = status === 'Historical';\n                          return /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: `relative flex-shrink-0 w-80 group/card transition-all duration-300 hover:scale-105`,\n                            children: [index < countryData.rules.length - 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"absolute top-1/2 -right-3 z-10 w-6 h-px bg-gradient-to-r from-slate-300 via-slate-400 to-slate-300 dark:from-slate-600 dark:via-slate-500 dark:to-slate-600\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1267,\n                              columnNumber: 43\n                            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                              className: `relative overflow-hidden rounded-2xl shadow-lg transition-all duration-300 group-hover/card:shadow-xl ${isActive ? 'bg-gradient-to-br from-emerald-50 via-green-50 to-emerald-100 dark:from-emerald-950/50 dark:via-emerald-900/30 dark:to-green-900/40 border-2 border-emerald-300/60 dark:border-emerald-700/50 shadow-emerald-200/50 dark:shadow-emerald-900/30' : isFuture ? 'bg-gradient-to-br from-blue-50 via-sky-50 to-blue-100 dark:from-blue-950/50 dark:via-blue-900/30 dark:to-sky-900/40 border-2 border-blue-300/60 dark:border-blue-700/50 shadow-blue-200/50 dark:shadow-blue-900/30' : 'bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 dark:from-slate-800/50 dark:via-slate-900/30 dark:to-slate-800/40 border-2 border-slate-300/60 dark:border-slate-700/50 shadow-slate-200/50 dark:shadow-slate-900/30'}`,\n                              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                                className: \"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-current to-transparent opacity-60\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1278,\n                                columnNumber: 43\n                              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                className: \"p-6\",\n                                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                                  className: \"flex items-center justify-between mb-4\",\n                                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                                    className: `inline-flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${isActive ? 'bg-emerald-500 text-white' : isFuture ? 'bg-blue-500 text-white' : 'bg-slate-500 text-white'}`,\n                                    children: [isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n                                      className: \"w-2 h-2 bg-white rounded-full animate-pulse\"\n                                    }, void 0, false, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1290,\n                                      columnNumber: 62\n                                    }, this), isFuture && /*#__PURE__*/_jsxDEV(\"svg\", {\n                                      className: \"w-3 h-3\",\n                                      fill: \"currentColor\",\n                                      viewBox: \"0 0 20 20\",\n                                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                                        fillRule: \"evenodd\",\n                                        d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\",\n                                        clipRule: \"evenodd\"\n                                      }, void 0, false, {\n                                        fileName: _jsxFileName,\n                                        lineNumber: 1291,\n                                        columnNumber: 127\n                                      }, this)\n                                    }, void 0, false, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1291,\n                                      columnNumber: 62\n                                    }, this), isHistorical && /*#__PURE__*/_jsxDEV(\"svg\", {\n                                      className: \"w-3 h-3\",\n                                      fill: \"currentColor\",\n                                      viewBox: \"0 0 20 20\",\n                                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                                        fillRule: \"evenodd\",\n                                        d: \"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\",\n                                        clipRule: \"evenodd\"\n                                      }, void 0, false, {\n                                        fileName: _jsxFileName,\n                                        lineNumber: 1292,\n                                        columnNumber: 131\n                                      }, this)\n                                    }, void 0, false, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1292,\n                                      columnNumber: 66\n                                    }, this), status.toUpperCase()]\n                                  }, void 0, true, {\n                                    fileName: _jsxFileName,\n                                    lineNumber: 1283,\n                                    columnNumber: 47\n                                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                    className: \"text-xs font-mono text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-1 rounded-lg\",\n                                    children: rule.rule_id.slice(-8)\n                                  }, void 0, false, {\n                                    fileName: _jsxFileName,\n                                    lineNumber: 1296,\n                                    columnNumber: 47\n                                  }, this)]\n                                }, void 0, true, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 1282,\n                                  columnNumber: 45\n                                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                  className: \"mb-6\",\n                                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                                    className: \"text-4xl font-black text-slate-900 dark:text-slate-100 mb-2 tracking-tight\",\n                                    children: [\"$\", rule.price_usd]\n                                  }, void 0, true, {\n                                    fileName: _jsxFileName,\n                                    lineNumber: 1303,\n                                    columnNumber: 47\n                                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                    className: `text-sm font-semibold ${isActive ? 'text-emerald-700 dark:text-emerald-300' : isFuture ? 'text-blue-700 dark:text-blue-300' : 'text-slate-600 dark:text-slate-400'}`,\n                                    children: [formatDate(rule.start_date), /*#__PURE__*/_jsxDEV(\"span\", {\n                                      className: \"mx-2 opacity-60\",\n                                      children: \"\\u2192\"\n                                    }, void 0, false, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1314,\n                                      columnNumber: 49\n                                    }, this), formatDate(rule.end_date) || /*#__PURE__*/_jsxDEV(\"span\", {\n                                      className: `inline-flex items-center gap-1 ${isActive ? 'text-emerald-600' : 'text-slate-500'}`,\n                                      children: [isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n                                        className: \"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse\"\n                                      }, void 0, false, {\n                                        fileName: _jsxFileName,\n                                        lineNumber: 1317,\n                                        columnNumber: 66\n                                      }, this), \"Ongoing\"]\n                                    }, void 0, true, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1316,\n                                      columnNumber: 51\n                                    }, this)]\n                                  }, void 0, true, {\n                                    fileName: _jsxFileName,\n                                    lineNumber: 1306,\n                                    columnNumber: 47\n                                  }, this)]\n                                }, void 0, true, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 1302,\n                                  columnNumber: 45\n                                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                                  onClick: e => {\n                                    e.stopPropagation();\n                                    loadDataProvenance(rule.rule_id);\n                                  },\n                                  className: `w-full group/btn relative overflow-hidden px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg ${isActive ? 'bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-200 dark:shadow-emerald-900/50' : isFuture ? 'bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/50' : 'bg-slate-600 hover:bg-slate-700 text-white shadow-slate-200 dark:shadow-slate-900/50'}`,\n                                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                                    className: \"relative z-10 flex items-center justify-center gap-2\",\n                                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                                      className: \"w-4 h-4 transition-transform group-hover/btn:scale-110\",\n                                      fill: \"none\",\n                                      stroke: \"currentColor\",\n                                      viewBox: \"0 0 24 24\",\n                                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                                        strokeLinecap: \"round\",\n                                        strokeLinejoin: \"round\",\n                                        strokeWidth: 2,\n                                        d: \"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"\n                                      }, void 0, false, {\n                                        fileName: _jsxFileName,\n                                        lineNumber: 1340,\n                                        columnNumber: 51\n                                      }, this)\n                                    }, void 0, false, {\n                                      fileName: _jsxFileName,\n                                      lineNumber: 1339,\n                                      columnNumber: 49\n                                    }, this), \"View Data Source\"]\n                                  }, void 0, true, {\n                                    fileName: _jsxFileName,\n                                    lineNumber: 1338,\n                                    columnNumber: 47\n                                  }, this)\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 1325,\n                                  columnNumber: 45\n                                }, this)]\n                              }, void 0, true, {\n                                fileName: _jsxFileName,\n                                lineNumber: 1280,\n                                columnNumber: 43\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1270,\n                              columnNumber: 41\n                            }, this)]\n                          }, rule.rule_id, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1261,\n                            columnNumber: 39\n                          }, this);\n                        })\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1253,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1252,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1238,\n                    columnNumber: 29\n                  }, this)]\n                }, country, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1203,\n                  columnNumber: 27\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1198,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1197,\n            columnNumber: 19\n          }, this)]\n        }, productId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 964,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 953,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 text-sm text-gray-500 dark:text-gray-400 text-center\",\n      children: [\"Pricing rules are organized by product and country for easy market management.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1368,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"inline-flex items-center gap-4 mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"flex items-center gap-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-3 h-3 bg-green-100 border border-green-300 rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1371,\n            columnNumber: 13\n          }, this), \"Active\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1370,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"flex items-center gap-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-3 h-3 bg-blue-100 border border-blue-300 rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1375,\n            columnNumber: 13\n          }, this), \"Future\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"flex items-center gap-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-3 h-3 bg-gray-100 border border-gray-300 rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1379,\n            columnNumber: 13\n          }, this), \"Historical\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1378,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1369,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1366,\n      columnNumber: 7\n    }, this), showCreateModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-b border-gray-200 dark:border-gray-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 dark:text-gray-100\",\n              children: \"\\u2795 Create New Pricing Rule\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1392,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowCreateModal(false),\n              className: \"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-6 h-6\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M6 18L18 6M6 6l12 12\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1400,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1399,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1395,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1391,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 dark:text-gray-400 mt-2\",\n            children: \"Create a new pricing rule for a product and countries\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1404,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1390,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 overflow-y-auto max-h-[70vh]\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: createRule,\n            className: \"space-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Product ID *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1414,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: formData.product_id,\n                onChange: e => {\n                  const newProductId = e.target.value;\n                  setFormData({\n                    ...formData,\n                    product_id: newProductId,\n                    start_date: getDefaultStartDate(newProductId)\n                  });\n                  if (newProductId) {\n                    fetchSuggestedPrice(newProductId);\n                  } else {\n                    setSuggestedPrice(null);\n                  }\n                },\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n                required: true,\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select a product...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1431,\n                  columnNumber: 21\n                }, this), products.map(product => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: product,\n                  children: product\n                }, product, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1433,\n                  columnNumber: 23\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1417,\n                columnNumber: 19\n              }, this), formData.product_id && ((_productGroups$formDa = productGroups[formData.product_id]) === null || _productGroups$formDa === void 0 ? void 0 : _productGroups$formDa.hasMissingRules) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-2 text-amber-800 dark:text-amber-200 text-sm\",\n                  children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                    className: \"w-4 h-4\",\n                    fill: \"currentColor\",\n                    viewBox: \"0 0 20 20\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      fillRule: \"evenodd\",\n                      d: \"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\",\n                      clipRule: \"evenodd\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1442,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1441,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: \"First pricing rule for this product!\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1444,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1440,\n                  columnNumber: 23\n                }, this), ((_productGroups$formDa2 = productGroups[formData.product_id]) === null || _productGroups$formDa2 === void 0 ? void 0 : _productGroups$formDa2.missingProductInfo) && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-1 text-xs text-amber-700 dark:text-amber-300\",\n                  children: [\"This product has \", productGroups[formData.product_id].missingProductInfo.trial_count, \" trial events but no pricing rules yet.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1447,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1439,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1413,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Price (USD) *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1457,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-500 dark:text-gray-400\",\n                    children: \"$\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1462,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1461,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  step: \"0.01\",\n                  min: \"0\",\n                  value: formData.price_usd,\n                  onChange: e => setFormData({\n                    ...formData,\n                    price_usd: e.target.value\n                  }),\n                  className: \"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n                  placeholder: \"29.99\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1464,\n                  columnNumber: 21\n                }, this), loadingPrice && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute inset-y-0 right-0 pr-3 flex items-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    className: \"animate-spin h-4 w-4 text-gray-400\",\n                    fill: \"none\",\n                    viewBox: \"0 0 24 24\",\n                    children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                      className: \"opacity-25\",\n                      cx: \"12\",\n                      cy: \"12\",\n                      r: \"10\",\n                      stroke: \"currentColor\",\n                      strokeWidth: \"4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1477,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                      className: \"opacity-75\",\n                      fill: \"currentColor\",\n                      d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1478,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1476,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1475,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1460,\n                columnNumber: 19\n              }, this), suggestedPrice && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2 text-green-800 dark:text-green-200 text-sm\",\n                    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-4 h-4\",\n                      fill: \"currentColor\",\n                      viewBox: \"0 0 20 20\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        fillRule: \"evenodd\",\n                        d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",\n                        clipRule: \"evenodd\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1490,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1489,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium\",\n                      children: [\"Suggested: $\", suggestedPrice.suggested_price, \" from most recent conversion\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1492,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1488,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    onClick: () => setFormData({\n                      ...formData,\n                      price_usd: suggestedPrice.suggested_price.toString()\n                    }),\n                    className: \"text-xs bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded\",\n                    children: \"Use This\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1496,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1487,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-1 text-xs text-green-700 dark:text-green-300\",\n                  children: suggestedPrice.note\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1504,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1486,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1456,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Start Date *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1513,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: formData.start_date,\n                onChange: e => setFormData({\n                  ...formData,\n                  start_date: e.target.value\n                }),\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1516,\n                columnNumber: 19\n              }, this), formData.product_id && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 text-xs text-gray-600 dark:text-gray-400\",\n                children: rules.filter(rule => rule.product_id === formData.product_id).length === 0 ? \"ðŸ’¡ First rule for this product - defaulted to Jan 1, 2024\" : \"ðŸ“… Additional rule - choose when this pricing takes effect\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1526,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1512,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"Countries *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1538,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: handleCountrySelectAll,\n                  className: \"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium\",\n                  children: [countrySelectAll ? 'Deselect All' : 'Select All', \" (\", countries.length, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1541,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1537,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2\",\n                children: countries.map(country => /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    checked: formData.countries.includes(country),\n                    onChange: e => {\n                      if (e.target.checked) {\n                        const newCountries = [...formData.countries, country];\n                        setFormData({\n                          ...formData,\n                          countries: newCountries\n                        });\n                        setCountrySelectAll(newCountries.length === countries.length);\n                      } else {\n                        const newCountries = formData.countries.filter(c => c !== country);\n                        setFormData({\n                          ...formData,\n                          countries: newCountries\n                        });\n                        setCountrySelectAll(false);\n                      }\n                    },\n                    className: \"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1553,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-900 dark:text-gray-100 font-medium\",\n                    children: country\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1569,\n                    columnNumber: 25\n                  }, this)]\n                }, country, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1552,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1550,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 flex items-center justify-between text-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-500 dark:text-gray-400\",\n                  children: [formData.countries.length, \" of \", countries.length, \" countries selected\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1575,\n                  columnNumber: 21\n                }, this), formData.countries.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-blue-600 dark:text-blue-400 font-medium\",\n                  children: \"\\u2713 Ready to create rule\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1579,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1574,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1536,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                disabled: !formData.product_id || !formData.price_usd || !formData.start_date || formData.countries.length === 0,\n                className: \"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl\",\n                children: \"Create Pricing Rule\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1588,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => setShowCreateModal(false),\n                className: \"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors\",\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1595,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1587,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1411,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1410,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1388,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1387,\n      columnNumber: 9\n    }, this), showEditModal && editingRule && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-b border-gray-200 dark:border-gray-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 dark:text-gray-100\",\n              children: \"\\u270F\\uFE0F Edit Pricing Rule\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1616,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setShowEditModal(false);\n                setEditingRule(null);\n              },\n              className: \"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-6 h-6\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M6 18L18 6M6 6l12 12\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1627,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1626,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1619,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1615,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 dark:text-gray-400 mt-2\",\n            children: [\"Modify pricing rule for \", editFormData.product_id, \" \\u2022 Rule ID: \", editFormData.rule_id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1631,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1614,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 overflow-y-auto max-h-[70vh]\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: updateRule,\n            className: \"space-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Rule ID (Read-only)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1641,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: editFormData.rule_id,\n                disabled: true,\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1644,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1640,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Product ID (Read-only)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1654,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: editFormData.product_id,\n                disabled: true,\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1657,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500 mt-1\",\n                children: \"Product ID cannot be changed to maintain data integrity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1663,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1653,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Price (USD) *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1670,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-500 dark:text-gray-400\",\n                    children: \"$\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1675,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1674,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  step: \"0.01\",\n                  min: \"0\",\n                  value: editFormData.price_usd,\n                  onChange: e => setEditFormData({\n                    ...editFormData,\n                    price_usd: e.target.value\n                  }),\n                  className: \"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1677,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1673,\n                columnNumber: 19\n              }, this), editingRule && editFormData.price_usd !== editingRule.price_usd.toString() && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 text-sm text-amber-600 dark:text-amber-400\",\n                children: [\"\\u26A0\\uFE0F Changing from $\", editingRule.price_usd, \" to $\", editFormData.price_usd]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1688,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1669,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",\n                children: \"Start Date *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1696,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: editFormData.start_date,\n                onChange: e => setEditFormData({\n                  ...editFormData,\n                  start_date: e.target.value\n                }),\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1699,\n                columnNumber: 19\n              }, this), editingRule && editFormData.start_date !== editingRule.start_date && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 text-sm text-amber-600 dark:text-amber-400\",\n                children: [\"\\u26A0\\uFE0F Changing from \", formatDate(editingRule.start_date), \" to \", formatDate(editFormData.start_date)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1707,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1695,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"Countries *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1716,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => {\n                    if (editFormData.countries.length === countries.length) {\n                      setEditFormData({\n                        ...editFormData,\n                        countries: []\n                      });\n                    } else {\n                      setEditFormData({\n                        ...editFormData,\n                        countries: [...countries]\n                      });\n                    }\n                  },\n                  className: \"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium\",\n                  children: [editFormData.countries.length === countries.length ? 'Deselect All' : 'Select All', \" (\", countries.length, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1719,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1715,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2\",\n                children: countries.map(country => /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    checked: editFormData.countries.includes(country),\n                    onChange: e => {\n                      if (e.target.checked) {\n                        setEditFormData({\n                          ...editFormData,\n                          countries: [...editFormData.countries, country]\n                        });\n                      } else {\n                        setEditFormData({\n                          ...editFormData,\n                          countries: editFormData.countries.filter(c => c !== country)\n                        });\n                      }\n                    },\n                    className: \"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1737,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-900 dark:text-gray-100 font-medium\",\n                    children: country\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1749,\n                    columnNumber: 25\n                  }, this)]\n                }, country, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1736,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1734,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 flex items-center justify-between text-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-500 dark:text-gray-400\",\n                  children: [editFormData.countries.length, \" of \", countries.length, \" countries selected\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1755,\n                  columnNumber: 21\n                }, this), editingRule && JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort()) && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-amber-600 dark:text-amber-400 font-medium\",\n                  children: \"\\u26A0\\uFE0F Countries modified\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1759,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1754,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1714,\n              columnNumber: 17\n            }, this), editingRule && (editFormData.price_usd !== editingRule.price_usd.toString() || editFormData.start_date !== editingRule.start_date || JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort())) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-medium text-amber-800 dark:text-amber-200 mb-2\",\n                children: \"\\uD83D\\uDCDD Changes Summary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1773,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-amber-700 dark:text-amber-300 space-y-1\",\n                children: [editFormData.price_usd !== editingRule.price_usd.toString() && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"\\u2022 Price: $\", editingRule.price_usd, \" \\u2192 $\", editFormData.price_usd]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1778,\n                  columnNumber: 25\n                }, this), editFormData.start_date !== editingRule.start_date && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"\\u2022 Start Date: \", formatDate(editingRule.start_date), \" \\u2192 \", formatDate(editFormData.start_date)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1781,\n                  columnNumber: 25\n                }, this), JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort()) && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"\\u2022 Countries: \", editingRule.countries.length, \" \\u2192 \", editFormData.countries.length, \" selected\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1784,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1776,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1772,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                disabled: !editFormData.price_usd || !editFormData.start_date || editFormData.countries.length === 0,\n                className: \"flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl\",\n                children: \"\\uD83D\\uDCBE Save Changes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1792,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => {\n                  setShowEditModal(false);\n                  setEditingRule(null);\n                },\n                className: \"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors\",\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1799,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1791,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1638,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1637,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1612,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1611,\n      columnNumber: 9\n    }, this), showDataProvenance && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl max-h-[80vh] overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-b border-gray-200 dark:border-gray-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 dark:text-gray-100\",\n              children: [\"\\uD83D\\uDCCA Data Provenance: Rule \", showDataProvenance.ruleId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1823,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowDataProvenance(null),\n              className: \"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-6 h-6\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M6 18L18 6M6 6l12 12\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1831,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1830,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1826,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1822,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 dark:text-gray-400 mt-2\",\n            children: \"This shows the underlying data that led to the creation of this pricing rule\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1835,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1821,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 overflow-y-auto max-h-[60vh]\",\n          children: showDataProvenance.data ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold text-blue-900 dark:text-blue-200 mb-2\",\n                children: \"Rule Summary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1846,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-2 gap-4 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: \"Product:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1849,\n                    columnNumber: 25\n                  }, this), \" \", showDataProvenance.data.product_id]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1848,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: \"Countries:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1852,\n                    columnNumber: 25\n                  }, this), \" \", (_showDataProvenance$d = showDataProvenance.data.countries) === null || _showDataProvenance$d === void 0 ? void 0 : _showDataProvenance$d.join(', ')]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1851,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: \"USD Price:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1855,\n                    columnNumber: 25\n                  }, this), \" $\", showDataProvenance.data.price_usd]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1854,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: \"Date Range:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1858,\n                    columnNumber: 25\n                  }, this), \" \", showDataProvenance.data.start_date, \" \\u2192 \", showDataProvenance.data.end_date || 'ongoing']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1857,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1847,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1845,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold text-gray-900 dark:text-gray-100 mb-3\",\n                children: [\"\\uD83D\\uDD0D Underlying Events (\", showDataProvenance.data.events_analyzed || 0, \" events)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1865,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gray-50 dark:bg-gray-900 rounded-lg p-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-gray-600 dark:text-gray-400 mb-3\",\n                  children: \"These are the actual pricing events from your database that led to this rule:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1869,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"overflow-x-auto\",\n                  children: /*#__PURE__*/_jsxDEV(\"table\", {\n                    className: \"w-full text-xs\",\n                    children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                      children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                        className: \"bg-gray-200 dark:bg-gray-700\",\n                        children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                          className: \"p-2 text-left\",\n                          children: \"Trial Start\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1878,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          className: \"p-2 text-left\",\n                          children: \"Conversion\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1879,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          className: \"p-2 text-left\",\n                          children: \"Actual Price\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1880,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          className: \"p-2 text-left\",\n                          children: \"Country\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1881,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                          className: \"p-2 text-left\",\n                          children: \"User ID\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1882,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1877,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1876,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                      children: (showDataProvenance.data.sample_events || []).map((event, index) => {\n                        var _event$user_id;\n                        return /*#__PURE__*/_jsxDEV(\"tr\", {\n                          className: \"border-b border-gray-200 dark:border-gray-600\",\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"p-2\",\n                            children: event.trial_start_date\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1888,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"p-2\",\n                            children: event.conversion_date\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1889,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"p-2 font-mono\",\n                            children: [\"$\", event.actual_price]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1890,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"p-2\",\n                            children: event.country\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1891,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"p-2 font-mono text-xs\",\n                            children: [(_event$user_id = event.user_id) === null || _event$user_id === void 0 ? void 0 : _event$user_id.substring(0, 8), \"...\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1892,\n                            columnNumber: 33\n                          }, this)]\n                        }, index, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1887,\n                          columnNumber: 31\n                        }, this);\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1885,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1875,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1874,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1868,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1864,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold text-gray-900 dark:text-gray-100 mb-3\",\n                children: \"\\uD83D\\uDCB0 Price Analysis\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1903,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-green-50 dark:bg-green-900/20 rounded-lg p-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                    className: \"font-medium text-green-900 dark:text-green-200 mb-2\",\n                    children: \"Actual Prices Charged\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1909,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm space-y-1\",\n                    children: (showDataProvenance.data.actual_prices || []).map((price, index) => {\n                      var _showDataProvenance$d2;\n                      return /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex justify-between\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-mono\",\n                          children: [\"$\", price]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1913,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-xs text-gray-500\",\n                          children: [((_showDataProvenance$d2 = showDataProvenance.data.price_counts) === null || _showDataProvenance$d2 === void 0 ? void 0 : _showDataProvenance$d2[price]) || 0, \" events\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1914,\n                          columnNumber: 31\n                        }, this)]\n                      }, index, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1912,\n                        columnNumber: 29\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1910,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1908,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                    className: \"font-medium text-yellow-900 dark:text-yellow-200 mb-2\",\n                    children: \"USD Clustering\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1924,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm space-y-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-medium\",\n                        children: \"Target USD:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1927,\n                        columnNumber: 29\n                      }, this), \" $\", showDataProvenance.data.price_usd]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1926,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-medium\",\n                        children: \"Price Range:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1930,\n                        columnNumber: 29\n                      }, this), \" $\", ((_showDataProvenance$d3 = showDataProvenance.data.price_range) === null || _showDataProvenance$d3 === void 0 ? void 0 : _showDataProvenance$d3.min) || 0, \" - $\", ((_showDataProvenance$d4 = showDataProvenance.data.price_range) === null || _showDataProvenance$d4 === void 0 ? void 0 : _showDataProvenance$d4.max) || 0]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1929,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-medium\",\n                        children: \"Variance:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1933,\n                        columnNumber: 29\n                      }, this), \" \", showDataProvenance.data.price_variance || 0, \"%\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1932,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-xs text-gray-600 dark:text-gray-400\",\n                      children: \"Prices were clustered within 15% tolerance to account for FX fluctuations and rounding\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1935,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1925,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1923,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1906,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1902,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold text-gray-900 dark:text-gray-100 mb-3\",\n                children: \"\\uD83D\\uDD2C Detection Logic\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1945,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium\",\n                      children: \"Method:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1951,\n                      columnNumber: 27\n                    }, this), \" \", showDataProvenance.data.detection_method || 'USD price clustering']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1950,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium\",\n                      children: \"Confidence:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1954,\n                      columnNumber: 27\n                    }, this), \" \", showDataProvenance.data.confidence_score || 'High']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1953,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-medium\",\n                      children: \"Notes:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1957,\n                      columnNumber: 27\n                    }, this), \" \", showDataProvenance.data.notes || 'Auto-generated from conversion events']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1956,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1949,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1948,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1944,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1843,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-8\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-500 dark:text-gray-400\",\n              children: \"Loading data provenance information...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1965,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1964,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1841,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowDataProvenance(null),\n              className: \"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md\",\n              children: \"Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1975,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1974,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1973,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1819,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1818,\n      columnNumber: 9\n    }, this), showRuleHistory && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-b border-gray-200 dark:border-gray-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 dark:text-gray-100\",\n              children: [\"\\uD83D\\uDCDC Rule History: \", showRuleHistory.productId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1994,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowRuleHistory(null),\n              className: \"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-6 h-6\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M6 18L18 6M6 6l12 12\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2002,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2001,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1997,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1993,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 dark:text-gray-400 mt-2\",\n            children: \"Complete chronological history of pricing rule changes (newest first)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2006,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1992,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 overflow-y-auto max-h-[60vh]\",\n          children: (_showRuleHistory$data = showRuleHistory.data) !== null && _showRuleHistory$data !== void 0 && _showRuleHistory$data.history && showRuleHistory.data.history.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-3 gap-4 mb-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-2xl font-bold text-green-600 dark:text-green-400\",\n                  children: showRuleHistory.data.history.filter(e => e.action === 'created').length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2018,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-green-800 dark:text-green-300\",\n                  children: \"Rules Created\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2021,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2017,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-2xl font-bold text-blue-600 dark:text-blue-400\",\n                  children: showRuleHistory.data.history.filter(e => e.action === 'updated').length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2024,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-blue-800 dark:text-blue-300\",\n                  children: \"Rules Updated\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2027,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2023,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-2xl font-bold text-red-600 dark:text-red-400\",\n                  children: showRuleHistory.data.history.filter(e => e.action === 'deleted').length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2030,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-red-800 dark:text-red-300\",\n                  children: \"Rules Deleted\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2033,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2029,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2016,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4\",\n                children: \"\\uD83D\\uDCC5 Chronological History (Newest First)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2039,\n                columnNumber: 21\n              }, this), showRuleHistory.data.history.map((entry, index) => {\n                var _entry$rule_data$coun, _entry$rule_data$coun2, _entry$rule_data$coun3;\n                // Check if this rule still exists and can be edited\n                const currentRule = rules.find(r => r.rule_id === entry.rule_data.rule_id);\n                const canEdit = entry.action !== 'deleted' && currentRule;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `relative p-6 rounded-xl border-l-4 shadow-lg ${entry.action === 'created' ? 'bg-green-50 border-green-400 dark:bg-green-900/20' : entry.action === 'updated' ? 'bg-blue-50 border-blue-400 dark:bg-blue-900/20' : 'bg-red-50 border-red-400 dark:bg-red-900/20'}`,\n                  children: [index < showRuleHistory.data.history.length - 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 bottom-0 w-1 h-6 bg-gray-300 transform translate-y-full\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2059,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-start justify-between\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex-1\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-4 mb-3\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: `px-3 py-1 text-sm font-bold rounded-full ${entry.action === 'created' ? 'bg-green-100 text-green-800' : entry.action === 'updated' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`,\n                          children: entry.action === 'created' ? 'âœ… CREATED' : entry.action === 'updated' ? 'ðŸ“ UPDATED' : 'ðŸ—‘ï¸ DELETED'\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2066,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-xl font-bold text-gray-900 dark:text-gray-100\",\n                          children: [\"$\", entry.rule_data.price_usd]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2075,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-sm font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full\",\n                          children: [(_entry$rule_data$coun = entry.rule_data.countries) === null || _entry$rule_data$coun === void 0 ? void 0 : _entry$rule_data$coun.length, \" countries\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2079,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded font-mono\",\n                          children: entry.rule_data.rule_id\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2083,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2065,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"grid grid-cols-2 gap-6 mb-4\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n                            children: \"Date Range\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 2091,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"text-base text-gray-900 dark:text-gray-100\",\n                            children: [formatDate(entry.rule_data.start_date), \" \\u2192 \", formatDate(entry.rule_data.end_date) || 'Ongoing']\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 2092,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2090,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n                            children: \"Countries Applied\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 2097,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"text-sm text-gray-900 dark:text-gray-100\",\n                            children: [(_entry$rule_data$coun2 = entry.rule_data.countries) === null || _entry$rule_data$coun2 === void 0 ? void 0 : _entry$rule_data$coun2.slice(0, 3).join(', '), ((_entry$rule_data$coun3 = entry.rule_data.countries) === null || _entry$rule_data$coun3 === void 0 ? void 0 : _entry$rule_data$coun3.length) > 3 && ` +${entry.rule_data.countries.length - 3} more`]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 2098,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2096,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2089,\n                        columnNumber: 31\n                      }, this), entry.user_notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-600 mb-4\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                          children: \"Notes\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2108,\n                          columnNumber: 35\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"text-sm text-gray-600 dark:text-gray-400\",\n                          children: entry.user_notes\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2109,\n                          columnNumber: 35\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2107,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex gap-3\",\n                        children: [canEdit && /*#__PURE__*/_jsxDEV(\"button\", {\n                          onClick: () => {\n                            setShowRuleHistory(null); // Close history modal\n                            openEditModal(currentRule); // Open edit modal\n                          },\n                          className: \"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\",\n                          children: \"\\u270F\\uFE0F Edit This Rule\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2116,\n                          columnNumber: 35\n                        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                          onClick: () => {\n                            setShowRuleHistory(null);\n                            loadDataProvenance(entry.rule_data.rule_id);\n                          },\n                          className: \"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\",\n                          children: \"\\uD83D\\uDCCA View Data Source\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2127,\n                          columnNumber: 33\n                        }, this), canEdit && /*#__PURE__*/_jsxDEV(\"button\", {\n                          onClick: () => {\n                            if (window.confirm(`Are you sure you want to delete rule ${entry.rule_data.rule_id}?`)) {\n                              deleteRule(entry.rule_data.rule_id);\n                              setShowRuleHistory(null);\n                            }\n                          },\n                          className: \"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\",\n                          children: \"\\uD83D\\uDDD1\\uFE0F Delete Rule\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2138,\n                          columnNumber: 35\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2114,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2063,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-right text-sm text-gray-500 dark:text-gray-400 ml-6\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"font-medium\",\n                        children: new Date(entry.timestamp).toLocaleDateString()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2155,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        children: new Date(entry.timestamp).toLocaleTimeString()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2156,\n                        columnNumber: 31\n                      }, this), !canEdit && entry.action !== 'deleted' && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"text-xs text-red-500 mt-1\",\n                        children: \"Rule no longer exists\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2158,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2154,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2062,\n                    columnNumber: 27\n                  }, this)]\n                }, entry.entry_id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2049,\n                  columnNumber: 25\n                }, this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2038,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2014,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center py-12\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-6xl mb-4\",\n              children: \"\\uD83D\\uDCDC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2169,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xl font-medium text-gray-600 dark:text-gray-400 mb-2\",\n              children: \"No Rule History Yet\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2170,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-500 dark:text-gray-500\",\n              children: \"Create your first pricing rule to start tracking changes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2173,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2168,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2012,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600 dark:text-gray-400\",\n              children: [((_showRuleHistory$data2 = showRuleHistory.data) === null || _showRuleHistory$data2 === void 0 ? void 0 : _showRuleHistory$data2.total_count) || 0, \" total changes tracked\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2183,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowRuleHistory(null),\n              className: \"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium\",\n              children: \"Close History\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2186,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2182,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2181,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1990,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1989,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 793,\n    columnNumber: 5\n  }, this);\n};\n_s(PricingManagementPage, \"i6HFHYsHwqBVAkhuFoNLZljZhlU=\");\n_c = PricingManagementPage;\nexport default PricingManagementPage;\nvar _c;\n$RefreshReg$(_c, \"PricingManagementPage\");","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","Fragment","_Fragment","PricingManagementPage","_s","_productGroups$formDa","_productGroups$formDa2","_showDataProvenance$d","_showDataProvenance$d3","_showDataProvenance$d4","_showRuleHistory$data","_showRuleHistory$data2","rules","setRules","missingProducts","setMissingProducts","schemaVersion","setSchemaVersion","productGroups","setProductGroups","productsStructure","setProductsStructure","loading","setLoading","error","setError","searchTerm","setSearchTerm","expandedProducts","setExpandedProducts","Set","expandedCountries","setExpandedCountries","showCreateModal","setShowCreateModal","editingRule","setEditingRule","addingCountryFor","setAddingCountryFor","products","setProducts","countries","setCountries","showDataProvenance","setShowDataProvenance","showRuleHistory","setShowRuleHistory","ruleHistory","setRuleHistory","showEditModal","setShowEditModal","editFormData","setEditFormData","rule_id","product_id","price_usd","start_date","formData","setFormData","suggestedPrice","setSuggestedPrice","loadingPrice","setLoadingPrice","countrySelectAll","setCountrySelectAll","trialActivityData","setTrialActivityData","autoRepairNotification","setAutoRepairNotification","loadPricingRules","loadDropdownData","length","groupRulesByProductAndCountry","Object","keys","matchingProducts","filter","productId","toLowerCase","includes","response","fetch","data","json","success","missing_products","schema_version","trial_activity_data","auto_repair_count","type","message","timestamp","Date","now","setTimeout","err","console","forceRepairRules","method","productsRes","countriesRes","Promise","all","productsData","countriesData","productList","map","p","countryList","c","country_code","loadDataProvenance","ruleId","loadRuleHistory","openEditModal","rule","toString","updateRule","e","preventDefault","headers","body","JSON","stringify","parseFloat","groups","forEach","totalRules","allCountries","mostRecentPricingUpdate","hasMissingRules","pricingStartDate","country","priceRange","min","Infinity","max","hasActive","hasFuture","hasHistorical","push","countryData","Math","startDate","endDate","end_date","missingProduct","trialActivityDate","last_trial","last_conversion","mostRecentTrialActivity","missingProductInfo","activityInfo","activityDate","most_recent_activity","totalTrialEvents","total_events","values","product","toggleProductExpansion","newExpanded","has","delete","add","deleteRule","window","confirm","createRule","roundToNearestPricePoint","price","nearestFive","round","finalPrice","fetchSuggestedPrice","roundedPrice","suggested_price","original_price","note","prev","handleCountrySelectAll","getDefaultStartDate","existingRules","openCreateModal","defaultStartDate","formatDate","dateStr","toLocaleDateString","getRuleStatusColor","countryRules","Array","isArray","sortedRules","r","sort","a","b","nextRule","find","nextStartDate","getTime","getRuleStatusLabel","formatPriceRange","getPriceProgression","allRules","uniqueRules","index","self","findIndex","priceProgression","lastPrice","date","sortCountriesByRecentActivity","productCountries","log","countriesCount","firstFewCountries","slice","hasProductCountries","productCountriesKeys","sortedCountries","countryA","countryB","getMostRecentRuleDate","dateA","dateB","dateDiff","localeCompare","usIndex","indexOf","adIndex","aeIndex","filteredProducts","productA","productB","aMissingRules","bMissingRules","className","children","fileName","_jsxFileName","lineNumber","columnNumber","fill","viewBox","fillRule","d","clipRule","onClick","placeholder","value","onChange","target","disabled","reduce","sum","_productGroups$produc","_productGroups$produc2","_productGroups$produc3","flatMap","_productGroups$produc4","thirtyDaysAgo","setDate","getDate","_productGroups$produc5","lastUpdate","_product$mostRecentTr","isExpanded","trial_count","first_trial","toISOString","split","stroke","strokeLinecap","strokeLinejoin","strokeWidth","style","scrollbarWidth","point","stopPropagation","toUpperCase","status","isActive","isFuture","isHistorical","onSubmit","newProductId","required","step","cx","cy","checked","newCountries","join","events_analyzed","sample_events","event","_event$user_id","trial_start_date","conversion_date","actual_price","user_id","substring","actual_prices","_showDataProvenance$d2","price_counts","price_range","price_variance","detection_method","confidence_score","notes","history","action","entry","_entry$rule_data$coun","_entry$rule_data$coun2","_entry$rule_data$coun3","currentRule","rule_data","canEdit","user_notes","toLocaleTimeString","entry_id","total_count","_c","$RefreshReg$"],"sources":["/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/pages/PricingManagementPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst PricingManagementPage = () => {\n  const [rules, setRules] = useState([]);\n  const [missingProducts, setMissingProducts] = useState([]);\n  const [schemaVersion, setSchemaVersion] = useState('1.0.0');\n  const [productGroups, setProductGroups] = useState({});\n  const [productsStructure, setProductsStructure] = useState({}); // New products structure from API\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [expandedProducts, setExpandedProducts] = useState(new Set());\n  const [expandedCountries, setExpandedCountries] = useState(new Set());\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [editingRule, setEditingRule] = useState(null);\n  const [addingCountryFor, setAddingCountryFor] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [countries, setCountries] = useState([]);\n  const [showDataProvenance, setShowDataProvenance] = useState(null); // For showing underlying data\n  \n  // Rule history state\n  const [showRuleHistory, setShowRuleHistory] = useState(null);\n  const [ruleHistory, setRuleHistory] = useState({});\n  \n  // Edit rule state\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editFormData, setEditFormData] = useState({\n    rule_id: '',\n    product_id: '',\n    price_usd: '',\n    start_date: '',\n    countries: []\n  });\n  \n  // Form state for creating rules\n  const [formData, setFormData] = useState({\n    product_id: '',\n    price_usd: '',\n    start_date: '',\n    countries: []\n  });\n  \n  // Smart defaults and loading states\n  const [suggestedPrice, setSuggestedPrice] = useState(null);\n  const [loadingPrice, setLoadingPrice] = useState(false);\n  const [countrySelectAll, setCountrySelectAll] = useState(false);\n\n  // Trial activity data from backend\n  const [trialActivityData, setTrialActivityData] = useState({});\n  \n  // Auto-repair notification state\n  const [autoRepairNotification, setAutoRepairNotification] = useState(null);\n\n  // Load pricing rules and dropdown data\n  useEffect(() => {\n    loadPricingRules();\n    loadDropdownData();\n  }, []);\n\n  // Group rules by product and country when rules change\n  useEffect(() => {\n    if (rules.length > 0 || missingProducts.length > 0) {\n      groupRulesByProductAndCountry();\n    }\n  }, [rules, missingProducts]);\n\n  // Auto-expand logic when data loads\n  useEffect(() => {\n    if (Object.keys(productGroups).length > 0) {\n      // Keep products collapsed by default - only expand if search matches\n      if (searchTerm) {\n        const matchingProducts = Object.keys(productGroups).filter(productId =>\n          productId.toLowerCase().includes(searchTerm.toLowerCase())\n        );\n        setExpandedProducts(new Set(matchingProducts));\n      } else {\n        setExpandedProducts(new Set()); // Collapsed by default\n      }\n      \n      // Countries don't need expand/collapse state anymore - they're always shown when product is expanded\n      setExpandedCountries(new Set());\n    }\n  }, [productGroups, searchTerm]);\n\n  // Keep country select all state in sync\n  useEffect(() => {\n    if (countries.length > 0) {\n      setCountrySelectAll(formData.countries.length === countries.length && formData.countries.length > 0);\n    }\n  }, [formData.countries, countries]);\n\n  const loadPricingRules = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/pricing/rules');\n      const data = await response.json();\n      \n      if (data.success) {\n        setRules(data.data.rules || []);\n        // Handle both old and new schema formats\n        if (data.data.missing_products) {\n          setMissingProducts(data.data.missing_products);\n        }\n        if (data.data.schema_version) {\n          setSchemaVersion(data.data.schema_version);\n        }\n        // Store the new products structure from API\n        if (data.data.products) {\n          setProductsStructure(data.data.products);\n        }\n        // Store trial activity data from backend\n        if (data.data.trial_activity_data) {\n          setTrialActivityData(data.data.trial_activity_data);\n        }\n        \n        // Handle auto-repair notifications\n        if (data.data.auto_repair_count && data.data.auto_repair_count > 0) {\n          setAutoRepairNotification({\n            type: 'success',\n            message: `âœ… Auto-repaired ${data.data.auto_repair_count} pricing rules with missing end dates`,\n            timestamp: Date.now()\n          });\n          \n          // Auto-hide notification after 8 seconds\n          setTimeout(() => {\n            setAutoRepairNotification(null);\n          }, 8000);\n        }\n      } else {\n        setError(data.error || 'Failed to load pricing rules');\n      }\n    } catch (err) {\n      setError('Network error loading pricing rules');\n      console.error('Error loading pricing rules:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const forceRepairRules = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/pricing/repair-rules', {\n        method: 'POST'\n      });\n      const data = await response.json();\n      \n      if (data.success) {\n        setAutoRepairNotification({\n          type: 'success',\n          message: `ðŸ”§ ${data.message}`,\n          timestamp: Date.now()\n        });\n        \n        // Reload data after repair\n        setTimeout(() => {\n          loadPricingRules();\n        }, 1000);\n      } else {\n        setError(data.error || 'Failed to repair rules');\n      }\n    } catch (err) {\n      setError('Network error during rule repair');\n      console.error('Error repairing rules:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadDropdownData = async () => {\n    try {\n      const [productsRes, countriesRes] = await Promise.all([\n        fetch('/api/pricing/products'),\n        fetch('/api/pricing/countries')\n      ]);\n      \n      const [productsData, countriesData] = await Promise.all([\n        productsRes.json(),\n        countriesRes.json()\n      ]);\n\n      if (productsData.success && productsData.data && productsData.data.products) {\n        const productList = productsData.data.products.map(p => p.product_id);\n        setProducts(productList);\n      }\n      \n      if (countriesData.success && countriesData.data && countriesData.data.countries) {\n        const countryList = countriesData.data.countries.map(c => c.country_code);\n        setCountries(countryList);\n      }\n    } catch (err) {\n      console.error('Error loading dropdown data:', err);\n      setProducts([]);\n      setCountries([]);\n    }\n  };\n\n  const loadDataProvenance = async (ruleId) => {\n    try {\n      const response = await fetch(`/api/pricing/rules/${ruleId}/provenance`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setShowDataProvenance({\n          ruleId,\n          data: data.data\n        });\n      } else {\n        console.error('Failed to load data provenance:', data.error);\n      }\n    } catch (err) {\n      console.error('Error loading data provenance:', err);\n    }\n  };\n\n  const loadRuleHistory = async (productId) => {\n    try {\n      const response = await fetch(`/api/pricing/rules/${productId}/history`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setShowRuleHistory({\n          productId,\n          data: data.data\n        });\n      } else {\n        console.error('Failed to load rule history:', data.error);\n      }\n    } catch (err) {\n      console.error('Error loading rule history:', err);\n    }\n  };\n\n  const openEditModal = (rule) => {\n    setEditFormData({\n      rule_id: rule.rule_id,\n      product_id: rule.product_id,\n      price_usd: rule.price_usd.toString(),\n      start_date: rule.start_date,\n      countries: [...rule.countries]\n    });\n    setEditingRule(rule);\n    setShowEditModal(true);\n  };\n\n  const updateRule = async (e) => {\n    e.preventDefault();\n    \n    try {\n      const response = await fetch(`/api/pricing/rules/${editFormData.rule_id}?simple_edit=true`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          product_id: editFormData.product_id,\n          price_usd: parseFloat(editFormData.price_usd),\n          start_date: editFormData.start_date,\n          countries: editFormData.countries\n        })\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setShowEditModal(false);\n        setEditingRule(null);\n        setEditFormData({\n          rule_id: '',\n          product_id: '',\n          price_usd: '',\n          start_date: '',\n          countries: []\n        });\n        // Reload all data to ensure consistency\n        loadPricingRules();\n        setError(null);\n      } else {\n        setError(data.error || 'Failed to update rule');\n      }\n    } catch (err) {\n      setError('Network error updating rule');\n      console.error('Error updating rule:', err);\n    }\n  };\n\n  const groupRulesByProductAndCountry = () => {\n    const groups = {};\n    \n    // Group existing rules by product and country\n    rules.forEach(rule => {\n      const productId = rule.product_id;\n      \n      if (!groups[productId]) {\n        groups[productId] = {\n          totalRules: 0,\n          countries: {},\n          allCountries: [],\n          mostRecentPricingUpdate: null,  // When pricing was last changed (start_date)\n          hasMissingRules: false\n        };\n      }\n      \n      groups[productId].totalRules++;\n      \n      // Track most recent pricing update (start_date) - when pricing was actually changed\n      const pricingStartDate = new Date(rule.start_date);\n      if (!groups[productId].mostRecentPricingUpdate || pricingStartDate > groups[productId].mostRecentPricingUpdate) {\n        groups[productId].mostRecentPricingUpdate = pricingStartDate;\n      }\n      \n      rule.countries.forEach(country => {\n        if (!groups[productId].countries[country]) {\n          groups[productId].countries[country] = {\n            rules: [],\n            priceRange: { min: Infinity, max: -Infinity },\n            hasActive: false,\n            hasFuture: false,\n            hasHistorical: false\n          };\n          groups[productId].allCountries.push(country);\n        }\n        \n        const countryData = groups[productId].countries[country];\n        countryData.rules.push(rule);\n        \n        // Update price range\n        countryData.priceRange.min = Math.min(countryData.priceRange.min, rule.price_usd);\n        countryData.priceRange.max = Math.max(countryData.priceRange.max, rule.price_usd);\n        \n        // Determine rule status for country\n        const now = new Date();\n        const startDate = new Date(rule.start_date);\n        const endDate = rule.end_date ? new Date(rule.end_date) : null;\n        \n        if (endDate && now > endDate) {\n          countryData.hasHistorical = true;\n        } else if (now >= startDate && (!endDate || now <= endDate)) {\n          countryData.hasActive = true;\n        } else {\n          countryData.hasFuture = true;\n        }\n      });\n    });\n    \n    // Add missing products and update trial activity for all products\n    missingProducts.forEach(missingProduct => {\n      const productId = missingProduct.product_id;\n      const trialActivityDate = new Date(missingProduct.last_trial || missingProduct.last_conversion);\n      \n      if (!groups[productId]) {\n        groups[productId] = {\n          totalRules: 0,\n          countries: {},\n          allCountries: [],\n          mostRecentPricingUpdate: trialActivityDate,\n          mostRecentTrialActivity: trialActivityDate,\n          hasMissingRules: true,\n          missingProductInfo: missingProduct\n        };\n      } else {\n        // Product exists with rules - update trial activity and mark as having missing rules if needed\n        groups[productId].hasMissingRules = true;\n        groups[productId].missingProductInfo = missingProduct;\n        \n        // Update with trial activity date - this is key for proper sorting\n        if (!groups[productId].mostRecentTrialActivity || trialActivityDate > groups[productId].mostRecentTrialActivity) {\n          groups[productId].mostRecentTrialActivity = trialActivityDate;\n        }\n        \n        // Also update pricing update if trial activity is more recent\n        if (!groups[productId].mostRecentPricingUpdate || trialActivityDate > groups[productId].mostRecentPricingUpdate) {\n          groups[productId].mostRecentPricingUpdate = trialActivityDate;\n        }\n      }\n    });\n    \n    // Update all products with accurate trial activity data from backend\n    Object.keys(groups).forEach(productId => {\n      if (trialActivityData[productId]) {\n        const activityInfo = trialActivityData[productId];\n        const activityDate = new Date(activityInfo.most_recent_activity);\n        \n        // Update with the accurate trial activity date\n        groups[productId].mostRecentTrialActivity = activityDate;\n        groups[productId].totalTrialEvents = activityInfo.total_events;\n        \n        // If this product doesn't have pricing rules, also update the pricing update date\n        if (groups[productId].totalRules === 0) {\n          groups[productId].mostRecentPricingUpdate = activityDate;\n        }\n      }\n    });\n    \n    // For products with rules but no trial activity data, use pricing date as trial activity\n    Object.values(groups).forEach(product => {\n      if (!product.mostRecentTrialActivity && product.mostRecentPricingUpdate) {\n        product.mostRecentTrialActivity = product.mostRecentPricingUpdate;\n      }\n    });\n    \n    // Fix any infinite values in price ranges\n    Object.values(groups).forEach(product => {\n      Object.values(product.countries).forEach(countryData => {\n        if (countryData.priceRange.min === Infinity) {\n          countryData.priceRange.min = 0;\n        }\n        if (countryData.priceRange.max === -Infinity) {\n          countryData.priceRange.max = 0;\n        }\n      });\n    });\n    \n    setProductGroups(groups);\n  };\n\n  const toggleProductExpansion = (productId) => {\n    const newExpanded = new Set(expandedProducts);\n    if (newExpanded.has(productId)) {\n      newExpanded.delete(productId);\n    } else {\n      newExpanded.add(productId);\n    }\n    setExpandedProducts(newExpanded);\n  };\n\n  const deleteRule = async (ruleId) => {\n    if (!window.confirm('Are you sure you want to delete this pricing rule?')) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/pricing/rules/${ruleId}?hard_delete=true`, {\n        method: 'DELETE'\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        // Remove the rule from frontend state immediately\n        setRules(rules.filter(rule => rule.rule_id !== ruleId));\n        // Also reload all data to ensure consistency across all affected areas\n        loadPricingRules();\n      } else {\n        setError(data.error || 'Failed to delete rule');\n      }\n    } catch (err) {\n      setError('Network error deleting rule');\n      console.error('Error deleting rule:', err);\n    }\n  };\n\n  const createRule = async (e) => {\n    e.preventDefault();\n    \n    try {\n      const response = await fetch('/api/pricing/rules', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          product_id: formData.product_id,\n          price_usd: parseFloat(formData.price_usd),\n          start_date: formData.start_date,\n          countries: formData.countries\n        })\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setShowCreateModal(false);\n        setFormData({\n          product_id: '',\n          price_usd: '',\n          start_date: '',\n          countries: []\n        });\n        loadPricingRules();\n      } else {\n        setError(data.error || 'Failed to create rule');\n      }\n    } catch (err) {\n      setError('Network error creating rule');\n      console.error('Error creating rule:', err);\n    }\n  };\n\n  const roundToNearestPricePoint = (price) => {\n    // Round to nearest $5 increment, then subtract $0.01 to make it .99\n    const nearestFive = Math.round(price / 5) * 5;\n    const finalPrice = nearestFive - 0.01;\n    \n    // Ensure minimum price of $4.99\n    return Math.max(4.99, finalPrice);\n  };\n\n  const fetchSuggestedPrice = async (productId) => {\n    if (!productId) return;\n    \n    setLoadingPrice(true);\n    try {\n      const response = await fetch(`/api/pricing/products/${productId}/most-recent-conversion-price`);\n      const data = await response.json();\n      \n      if (data.success) {\n        // Round the suggested price to nearest $5 increment minus $0.01\n        const roundedPrice = roundToNearestPricePoint(data.data.suggested_price);\n        \n        setSuggestedPrice({\n          ...data.data,\n          suggested_price: roundedPrice,\n          original_price: data.data.suggested_price,\n          note: `Rounded from $${data.data.suggested_price} to $${roundedPrice} (${data.data.note})`\n        });\n        setFormData(prev => ({\n          ...prev,\n          price_usd: roundedPrice.toString()\n        }));\n      } else {\n        setSuggestedPrice(null);\n      }\n    } catch (err) {\n      console.error('Error fetching suggested price:', err);\n      setSuggestedPrice(null);\n    } finally {\n      setLoadingPrice(false);\n    }\n  };\n\n  const handleCountrySelectAll = () => {\n    if (countrySelectAll) {\n      // Deselect all\n      setFormData({...formData, countries: []});\n      setCountrySelectAll(false);\n    } else {\n      // Select all\n      setFormData({...formData, countries: [...countries]});\n      setCountrySelectAll(true);\n    }\n  };\n\n  const getDefaultStartDate = (productId) => {\n    // Check if this product has any existing rules\n    const existingRules = rules.filter(rule => rule.product_id === productId);\n    \n    if (existingRules.length === 0) {\n      // First rule for this product - default to Jan 1 2024\n      return '2024-01-01';\n    } else {\n      // Subsequent rule - leave empty\n      return '';\n    }\n  };\n\n  const openCreateModal = (productId = '') => {\n    const defaultStartDate = productId ? getDefaultStartDate(productId) : '';\n    \n    setFormData({\n      product_id: productId,\n      price_usd: '',\n      start_date: defaultStartDate,\n      countries: [...countries] // Auto-select all countries by default\n    });\n    \n    // Reset smart defaults\n    setSuggestedPrice(null);\n    setCountrySelectAll(true); // Set to true since we're selecting all countries\n    \n    // If we have a specific product, fetch suggested price\n    if (productId) {\n      fetchSuggestedPrice(productId);\n    }\n    \n    setShowCreateModal(true);\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return 'Ongoing';\n    return new Date(dateStr).toLocaleDateString();\n  };\n\n  const getRuleStatusColor = (rule, countryRules = null) => {\n    const now = new Date();\n    const startDate = new Date(rule.start_date);\n    let endDate = rule.end_date ? new Date(rule.end_date) : null;\n\n    // If no explicit end date and we have country rules, calculate effective end date\n    if (!endDate && countryRules && Array.isArray(countryRules)) {\n      // Find the next rule that starts after this rule\n      const sortedRules = countryRules\n        .filter(r => r.rule_id !== rule.rule_id)  // Exclude current rule\n        .sort((a, b) => new Date(a.start_date) - new Date(b.start_date));\n      \n      const nextRule = sortedRules.find(r => new Date(r.start_date) > startDate);\n      if (nextRule) {\n        // This rule effectively ends the day before the next rule starts\n        const nextStartDate = new Date(nextRule.start_date);\n        endDate = new Date(nextStartDate.getTime() - 24 * 60 * 60 * 1000); // Previous day\n      }\n    }\n\n    if (endDate && now > endDate) {\n      return 'bg-gray-100 border-gray-300 text-gray-600'; // Historical\n    } else if (now >= startDate && (!endDate || now <= endDate)) {\n      return 'bg-green-100 border-green-300 text-green-800'; // Active\n    } else {\n      return 'bg-blue-100 border-blue-300 text-blue-800'; // Future\n    }\n  };\n\n  const getRuleStatusLabel = (rule, countryRules = null) => {\n    const now = new Date();\n    const startDate = new Date(rule.start_date);\n    let endDate = rule.end_date ? new Date(rule.end_date) : null;\n\n    // If no explicit end date and we have country rules, calculate effective end date\n    if (!endDate && countryRules && Array.isArray(countryRules)) {\n      // Find the next rule that starts after this rule\n      const sortedRules = countryRules\n        .filter(r => r.rule_id !== rule.rule_id)  // Exclude current rule\n        .sort((a, b) => new Date(a.start_date) - new Date(b.start_date));\n      \n      const nextRule = sortedRules.find(r => new Date(r.start_date) > startDate);\n      if (nextRule) {\n        // This rule effectively ends the day before the next rule starts\n        const nextStartDate = new Date(nextRule.start_date);\n        endDate = new Date(nextStartDate.getTime() - 24 * 60 * 60 * 1000); // Previous day\n      }\n    }\n\n    if (endDate && now > endDate) {\n      return 'Historical';\n    } else if (now >= startDate && (!endDate || now <= endDate)) {\n      return 'Active';\n    } else {\n      return 'Future';\n    }\n  };\n\n  const formatPriceRange = (countryData) => {\n    if (countryData.priceRange.min === countryData.priceRange.max) {\n      return `$${countryData.priceRange.min}`;\n    }\n    return `$${countryData.priceRange.min} - $${countryData.priceRange.max}`;\n  };\n\n  const getPriceProgression = (product) => {\n    if (!product || !product.countries || Object.keys(product.countries).length === 0) {\n      return [];\n    }\n    \n    // Get all rules across all countries for this product\n    const allRules = [];\n    Object.values(product.countries).forEach(countryData => {\n      allRules.push(...countryData.rules);\n    });\n    \n    // Remove duplicates (same rule might appear in multiple countries)\n    const uniqueRules = allRules.filter((rule, index, self) => \n      index === self.findIndex(r => r.rule_id === rule.rule_id)\n    );\n    \n    // Sort by start date to show progression\n    const sortedRules = uniqueRules.sort((a, b) => \n      new Date(a.start_date) - new Date(b.start_date)\n    );\n    \n    // Create price progression - show unique price points in chronological order\n    const priceProgression = [];\n    let lastPrice = null;\n    \n    sortedRules.forEach(rule => {\n      if (rule.price_usd !== lastPrice) {\n        priceProgression.push({\n          price: rule.price_usd,\n          date: rule.start_date,\n          ruleId: rule.rule_id\n        });\n        lastPrice = rule.price_usd;\n      }\n    });\n    \n    return priceProgression;\n  };\n\n  const sortCountriesByRecentActivity = (countries, productCountries) => {\n    /**\n     * Sort countries by most recent rule update, then alphabetically\n     * @param {Array} countries - Array of country codes\n     * @param {Object} productCountries - Product countries data with rules\n     * @returns {Array} Sorted country codes\n     */\n    \n    // More detailed debugging\n    console.log('ðŸ” sortCountriesByRecentActivity called with:', {\n      countriesCount: countries.length,\n      firstFewCountries: countries.slice(0, 5),\n      hasProductCountries: !!productCountries,\n      productCountriesKeys: Object.keys(productCountries || {}).slice(0, 5)\n    });\n    \n    const sortedCountries = countries.sort((a, b) => {\n      const countryA = productCountries[a];\n      const countryB = productCountries[b];\n      \n      // Get the most recent rule start date for each country\n      const getMostRecentRuleDate = (countryData) => {\n        if (!countryData || !countryData.rules || countryData.rules.length === 0) {\n          return null;\n        }\n        // Rules are already sorted with newest first, so take the first one\n        return new Date(countryData.rules[0].start_date);\n      };\n      \n      const dateA = getMostRecentRuleDate(countryA);\n      const dateB = getMostRecentRuleDate(countryB);\n      \n      // If both have dates, sort by most recent first\n      if (dateA && dateB) {\n        const dateDiff = dateB - dateA; // Most recent first\n        if (dateDiff !== 0) return dateDiff;\n      }\n      \n      // If only one has a date, prioritize it\n      if (dateA && !dateB) return -1;\n      if (!dateA && dateB) return 1;\n      \n      // If both have same date or no dates, sort alphabetically\n      return a.localeCompare(b);\n    });\n    \n    // Show the results\n    if (countries.includes('US')) {\n      console.log('ðŸŽ¯ Final sorted countries (first 10):', sortedCountries.slice(0, 10));\n      const usIndex = sortedCountries.indexOf('US');\n      const adIndex = sortedCountries.indexOf('AD');\n      const aeIndex = sortedCountries.indexOf('AE');\n      console.log(`ðŸ“ Positions - US: ${usIndex + 1}, AD: ${adIndex + 1}, AE: ${aeIndex + 1}`);\n      \n      // Show the most recent rule for US, AD, AE\n      if (productCountries['US'] && productCountries['US'].rules && productCountries['US'].rules[0]) {\n        console.log(`ðŸ‡ºðŸ‡¸ US most recent rule:`, productCountries['US'].rules[0].start_date, `$${productCountries['US'].rules[0].price_usd}`);\n      }\n      if (productCountries['AD'] && productCountries['AD'].rules && productCountries['AD'].rules[0]) {\n        console.log(`ðŸ‡¦ðŸ‡© AD most recent rule:`, productCountries['AD'].rules[0].start_date, `$${productCountries['AD'].rules[0].price_usd}`);\n      }\n    }\n    \n    return sortedCountries;\n  };\n\n  // Filter and sort products based on search and most recent trial activity\n  const filteredProducts = Object.keys(productGroups)\n    .filter(productId =>\n      productId.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n    .sort((a, b) => {\n      const productA = productGroups[a];\n      const productB = productGroups[b];\n      \n      // First, separate products with rules vs missing rules\n      const aMissingRules = productA?.hasMissingRules || false;\n      const bMissingRules = productB?.hasMissingRules || false;\n      \n      // Products with rules come first, missing rules go to bottom\n      if (aMissingRules && !bMissingRules) return 1;  // A has missing rules, goes to bottom\n      if (!aMissingRules && bMissingRules) return -1; // B has missing rules, goes to bottom\n      \n      // Within each group, sort by most recent trial activity (more urgent trials first)\n      const dateA = productA?.mostRecentTrialActivity;\n      const dateB = productB?.mostRecentTrialActivity;\n      \n      if (!dateA && !dateB) return a.localeCompare(b); // Fallback to alphabetical\n      if (!dateA) return 1; // Products without trial dates go to the end of their group\n      if (!dateB) return -1;\n      \n      return dateB - dateA; // Most recent trial activity first within each group\n    });\n\n  if (loading) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <div className=\"flex justify-center items-center h-64\">\n          <div className=\"text-lg\">Loading pricing rules...</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold mb-2\">Pricing Management</h1>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              Manage product pricing across different countries and time periods\n            </p>\n          </div>\n          <div className=\"text-right\">\n            <div className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n              schemaVersion === '2.0.0' \n                ? 'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200'\n                : 'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200'\n            }`}>\n              Schema v{schemaVersion}\n            </div>\n            {schemaVersion === '2.0.0' && missingProducts.length > 0 && (\n              <div className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                Enhanced with missing product detection\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Auto-Repair Notification */}\n      {autoRepairNotification && (\n        <div className=\"bg-emerald-50 border border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200 px-4 py-3 rounded-xl mb-4 shadow-sm\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-8 h-8 rounded-full bg-emerald-500 flex items-center justify-center\">\n                <svg className=\"w-4 h-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div>\n                <p className=\"font-semibold\">{autoRepairNotification.message}</p>\n                <p className=\"text-sm opacity-80\">End dates have been automatically calculated based on newer rules</p>\n              </div>\n            </div>\n            <button \n              onClick={() => setAutoRepairNotification(null)}\n              className=\"text-emerald-600 hover:text-emerald-800 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors\"\n            >\n              <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n          {error}\n          <button \n            onClick={() => setError(null)}\n            className=\"float-right text-red-700 hover:text-red-900\"\n          >\n            Ã—\n          </button>\n        </div>\n      )}\n\n      {/* Controls Row */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6\">\n        <div className=\"flex flex-wrap gap-4 items-center justify-between\">\n          {/* Search */}\n          <div className=\"flex-1 min-w-64\">\n            <input\n              type=\"text\"\n              placeholder=\"Search by product ID...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700\"\n            />\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => openCreateModal()}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md\"\n            >\n              Create Rule\n            </button>\n            <button\n              onClick={forceRepairRules}\n              className=\"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md\"\n              disabled={loading}\n            >\n              ðŸ”§ Fix \"Ongoing\" Rules\n            </button>\n            <button\n              onClick={loadPricingRules}\n              className=\"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md\"\n            >\n              Refresh\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className=\"text-2xl font-bold text-blue-600\">{filteredProducts.length}</div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Products</div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className=\"text-2xl font-bold text-green-600\">\n            {filteredProducts.reduce((sum, productId) => \n              sum + (productGroups[productId]?.totalRules || 0), 0\n            )}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Total Rules</div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className={`text-2xl font-bold ${\n            filteredProducts.filter(productId => productGroups[productId]?.hasMissingRules).length > 0 \n              ? 'text-red-600' \n              : 'text-gray-400'\n          }`}>\n            {filteredProducts.filter(productId => productGroups[productId]?.hasMissingRules).length}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Missing Rules</div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className=\"text-2xl font-bold text-purple-600\">\n            {[...new Set(filteredProducts.flatMap(productId => \n              productGroups[productId]?.allCountries || []\n            ))].length}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Countries</div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className=\"text-2xl font-bold text-orange-600\">\n            {(() => {\n              const thirtyDaysAgo = new Date();\n              thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n              return filteredProducts.filter(productId => {\n                const lastUpdate = productGroups[productId]?.mostRecentPricingUpdate;\n                return lastUpdate && lastUpdate > thirtyDaysAgo;\n              }).length;\n            })()}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Recent Updates</div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4\">\n          <div className=\"text-2xl font-bold text-indigo-600\">\n            {filteredProducts.filter(productId => expandedProducts.has(productId)).length}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Expanded</div>\n        </div>\n      </div>\n\n      {/* Products List */}\n      <div className=\"space-y-4\">\n        {filteredProducts.length === 0 ? (\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center text-gray-500 dark:text-gray-400\">\n            {Object.keys(productGroups).length === 0 ? 'No pricing rules found' : 'No products match your search criteria'}\n          </div>\n        ) : (\n          filteredProducts.map(productId => {\n            const product = productGroups[productId];\n            const isExpanded = expandedProducts.has(productId);\n            \n            return (\n              <div key={productId} className={`group relative overflow-hidden transition-all duration-300 ease-out ${\n                product.hasMissingRules \n                  ? 'bg-gradient-to-br from-rose-50 to-red-50 dark:from-red-950/30 dark:to-red-900/20 border-2 border-rose-200 dark:border-red-800/50 shadow-lg shadow-red-100/50 dark:shadow-red-900/20' \n                  : 'bg-white dark:bg-slate-900 border border-slate-200/60 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/30 dark:hover:shadow-slate-900/30'\n              } rounded-2xl backdrop-blur-sm`}>\n                {/* Product Header */}\n                <div \n                  className={`relative p-6 border-b cursor-pointer transition-all duration-200 ${\n                    product.hasMissingRules\n                      ? 'border-rose-200/70 dark:border-red-800/40 hover:bg-gradient-to-br hover:from-rose-100 hover:to-red-100 dark:hover:from-red-950/40 dark:hover:to-red-900/30'\n                      : 'border-slate-200/60 dark:border-slate-700/50 hover:bg-slate-50/70 dark:hover:bg-slate-800/50'\n                  }`}\n                  onClick={() => toggleProductExpansion(productId)}\n                >\n                  {/* Critical Alert Banner for Missing Rules */}\n                  {product.hasMissingRules && (\n                    <div className=\"absolute top-0 left-0 right-0 bg-gradient-to-r from-rose-500 to-red-500 text-white text-xs font-semibold px-4 py-2 flex items-center gap-2\">\n                      <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                      </svg>\n                      <span>MISSING PRICING RULES â€” URGENT ACTION REQUIRED</span>\n                    </div>\n                  )}\n                  \n                  <div className={`${product.hasMissingRules ? 'mt-8' : ''} flex items-center justify-between`}>\n                    <div className=\"flex-1 min-w-0\">\n                      {/* Product ID with sophisticated typography */}\n                      <div className=\"flex items-center gap-4 mb-3\">\n                        <h3 className={`text-2xl font-bold tracking-tight ${\n                          product.hasMissingRules \n                            ? 'text-red-900 dark:text-red-100' \n                            : 'text-slate-900 dark:text-slate-100'\n                        }`}>\n                          {productId}\n                        </h3>\n                        \n                        {/* Enhanced status indicators */}\n                        <div className=\"flex items-center gap-2\">\n                          <div className={`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold transition-all ${\n                            product.hasMissingRules\n                              ? 'bg-red-500 text-white shadow-md'\n                              : 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300'\n                          }`}>\n                            {product.hasMissingRules ? (\n                              <>\n                                <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                                </svg>\n                                Missing Rules\n                              </>\n                            ) : (\n                              <>\n                                <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                </svg>\n                                Active Rules\n                              </>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {/* Missing rules detailed alert */}\n                      {product.hasMissingRules && product.missingProductInfo ? (\n                        <div className=\"mb-4 p-4 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-red-200/50 dark:border-red-800/50 rounded-xl shadow-sm\">\n                          <div className=\"space-y-2\">\n                            <div className=\"flex items-start gap-3\">\n                              <svg className=\"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\n                              </svg>\n                              <div>\n                                <p className=\"text-sm font-semibold text-red-900 dark:text-red-100 mb-1\">\n                                  Active trials without pricing rules detected\n                                </p>\n                                <div className=\"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-red-800 dark:text-red-200\">\n                                  <div><span className=\"font-medium\">{product.missingProductInfo.trial_count}</span> trial events</div>\n                                  <div>First: <span className=\"font-medium\">{formatDate(product.missingProductInfo.first_trial)}</span></div>\n                                  <div>Latest: <span className=\"font-medium\">{formatDate(product.missingProductInfo.last_trial)}</span></div>\n                                  <div className=\"col-span-2 mt-1 text-red-700 dark:text-red-300 font-medium\">\n                                    âš ï¸ Revenue analysis incomplete without pricing rules\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      ) : (\n                        /* Normal product metrics */\n                        <div className=\"flex items-center gap-6 mb-4\">\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>\n                            <span className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                              <span className=\"font-bold text-slate-900 dark:text-slate-100\">{product.totalRules}</span> rules\n                            </span>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"w-2 h-2 rounded-full bg-purple-500\"></div>\n                            <span className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                              <span className=\"font-bold text-slate-900 dark:text-slate-100\">{product.allCountries.length}</span> countries\n                            </span>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"w-2 h-2 rounded-full bg-emerald-500\"></div>\n                            <span className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                              Last activity: <span className=\"font-bold text-slate-900 dark:text-slate-100\">{formatDate(product.mostRecentTrialActivity?.toISOString().split('T')[0])}</span>\n                            </span>\n                          </div>\n                        </div>\n                      )}\n                      \n                      {/* Enhanced country tags - only show if not missing rules */}\n                      {!product.hasMissingRules && product.allCountries.length > 0 && (\n                        <div className=\"flex flex-wrap gap-1.5 mb-4\">\n                          {sortCountriesByRecentActivity([...product.allCountries], product.countries).slice(0, 12).map(country => (\n                            <span \n                              key={country}\n                              className=\"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200/50 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800/50 transition-colors hover:bg-blue-100 dark:hover:bg-blue-900/50\"\n                            >\n                              {country}\n                            </span>\n                          ))}\n                          {product.allCountries.length > 12 && (\n                            <span className=\"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200/50 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700\">\n                              +{product.allCountries.length - 12} more\n                            </span>\n                          )}\n                        </div>\n                      )}\n\n                      {/* Beautiful Price Progression - only show if not missing rules */}\n                      {!product.hasMissingRules && (() => {\n                        const priceProgression = getPriceProgression(product);\n                        return priceProgression.length > 0 && (\n                          <div className=\"p-4 bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-800/50 dark:to-slate-900/50 rounded-xl border border-slate-200/50 dark:border-slate-700/50 backdrop-blur-sm\">\n                            <div className=\"flex items-center gap-2 mb-3\">\n                              <div className=\"flex items-center gap-2\">\n                                <div className=\"w-6 h-6 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center\">\n                                  <svg className=\"w-3.5 h-3.5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6\" />\n                                  </svg>\n                                </div>\n                                <h4 className=\"text-sm font-bold text-slate-800 dark:text-slate-200\">Price Evolution</h4>\n                              </div>\n                              <div className=\"flex-1\"></div>\n                              <span className=\"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/70 dark:bg-slate-800/70 px-2 py-1 rounded-md\">\n                                {priceProgression.length} changes\n                              </span>\n                            </div>\n                            <div className=\"flex items-center gap-3 overflow-x-auto pb-2\" style={{scrollbarWidth: 'thin'}}>\n                              {priceProgression.map((point, index) => (\n                                <div key={point.ruleId} className=\"flex items-center gap-3 flex-shrink-0\">\n                                  <div className=\"text-center group\">\n                                    <div className=\"relative\">\n                                      <div className=\"text-xl font-black text-emerald-700 dark:text-emerald-400 mb-0.5 group-hover:scale-105 transition-transform\">\n                                        ${point.price}\n                                      </div>\n                                      <div className=\"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-0.5 rounded-md shadow-sm\">\n                                        {formatDate(point.date)}\n                                      </div>\n                                    </div>\n                                  </div>\n                                  {index < priceProgression.length - 1 && (\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-8 h-0.5 bg-gradient-to-r from-slate-300 to-slate-400 dark:from-slate-600 dark:to-slate-500 rounded-full\"></div>\n                                      <svg className=\"w-3 h-3 text-slate-400 dark:text-slate-500 -ml-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                        <path fillRule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clipRule=\"evenodd\" />\n                                      </svg>\n                                    </div>\n                                  )}\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n                        );\n                      })()}\n                    </div>\n                    \n                    {/* Enhanced action buttons */}\n                    <div className=\"flex items-center gap-3 ml-6\">\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          openCreateModal(productId);\n                        }}\n                        className={`group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-lg ${\n                          product.hasMissingRules\n                            ? 'bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-red-200 dark:shadow-red-900/30'\n                            : 'bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/30'\n                        }`}\n                      >\n                        <div className=\"relative z-10 flex items-center gap-2\">\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                          </svg>\n                          {product.hasMissingRules ? 'Create First Rule' : 'Add Rule'}\n                        </div>\n                      </button>\n                      \n                      {/* Show Rules History Button */}\n                      {!product.hasMissingRules && (\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            loadRuleHistory(productId);\n                          }}\n                          className=\"group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white shadow-lg shadow-slate-200 dark:shadow-slate-900/30\"\n                        >\n                          <div className=\"relative z-10 flex items-center gap-2\">\n                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                            </svg>\n                            History\n                          </div>\n                        </button>\n                      )}\n                      \n                      {/* Elegant expand/collapse indicator */}\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-xl bg-slate-100 dark:bg-slate-800 group-hover:bg-slate-200 dark:group-hover:bg-slate-700 transition-colors\">\n                        <svg \n                          className={`w-5 h-5 text-slate-600 dark:text-slate-400 transform transition-transform duration-200 ${isExpanded ? 'rotate-180' : ''}`}\n                          fill=\"none\" \n                          stroke=\"currentColor\" \n                          viewBox=\"0 0 24 24\"\n                        >\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                        </svg>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Country Breakdown */}\n                {isExpanded && (\n                  <div className=\"p-6 bg-gradient-to-br from-slate-50/50 to-white dark:from-slate-800/50 dark:to-slate-900/50\">\n                    <div className=\"space-y-6\">\n                      {sortCountriesByRecentActivity([...product.allCountries], product.countries).map(country => {\n                        const countryData = product.countries[country];\n                        \n                        return (\n                          <div key={country} className=\"group relative overflow-hidden bg-white dark:bg-slate-800/90 border border-slate-200/60 dark:border-slate-700/50 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 backdrop-blur-sm\">\n                            {/* Country Header */}\n                            <div className=\"relative p-6 bg-gradient-to-r from-slate-50 via-white to-slate-50 dark:from-slate-800/80 dark:via-slate-800/60 dark:to-slate-800/80 border-b border-slate-200/60 dark:border-slate-700/50\">\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"flex items-center gap-6\">\n                                  <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-200/50 dark:shadow-blue-900/30\">\n                                      <span className=\"text-white font-bold text-lg\">{country.slice(0, 2).toUpperCase()}</span>\n                                    </div>\n                                    <div>\n                                      <h4 className=\"text-2xl font-bold text-slate-900 dark:text-slate-100\">{country}</h4>\n                                      <p className=\"text-sm text-slate-600 dark:text-slate-400\">Pricing timeline</p>\n                                    </div>\n                                  </div>\n                                  \n                                  <div className=\"flex items-center gap-4\">\n                                    <div className=\"flex items-center gap-3 px-4 py-2 bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm rounded-xl border border-slate-200/50 dark:border-slate-700/50 shadow-sm\">\n                                      <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>\n                                      <span className=\"text-sm font-semibold text-slate-700 dark:text-slate-300\">\n                                        {countryData.rules.length} rules\n                                      </span>\n                                    </div>\n                                    \n                                    <div className=\"flex items-center gap-3 px-4 py-2 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/30 dark:to-green-900/30 backdrop-blur-sm rounded-xl border border-emerald-200/50 dark:border-emerald-800/50 shadow-sm\">\n                                      <div className=\"w-2 h-2 rounded-full bg-emerald-500\"></div>\n                                      <span className=\"text-lg font-black text-emerald-700 dark:text-emerald-400\">\n                                        {formatPriceRange(countryData)}\n                                      </span>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n\n                            {/* Enhanced Price Timeline */}\n                            <div className=\"p-6\">\n                              <div className=\"flex items-center gap-3 mb-6\">\n                                <div className=\"w-8 h-8 rounded-xl bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center shadow-md\">\n                                  <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                                  </svg>\n                                </div>\n                                <h5 className=\"text-lg font-bold text-slate-800 dark:text-slate-200\">\n                                  Chronological Pricing History\n                                </h5>\n                                <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent dark:from-slate-700\"></div>\n                              </div>\n                              \n                              {/* Horizontal Timeline Cards */}\n                              <div className=\"relative\">\n                                <div className=\"flex gap-6 overflow-x-auto pb-4 scrollbar-hide\" style={{scrollbarWidth: 'none'}}>\n                                  {countryData.rules.map((rule, index) => {\n                                    const status = getRuleStatusLabel(rule, countryData.rules);\n                                    const isActive = status === 'Active';\n                                    const isFuture = status === 'Future';\n                                    const isHistorical = status === 'Historical';\n                                    \n                                    return (\n                                      <div \n                                        key={rule.rule_id}\n                                        className={`relative flex-shrink-0 w-80 group/card transition-all duration-300 hover:scale-105`}\n                                      >\n                                        {/* Timeline Connector */}\n                                        {index < countryData.rules.length - 1 && (\n                                          <div className=\"absolute top-1/2 -right-3 z-10 w-6 h-px bg-gradient-to-r from-slate-300 via-slate-400 to-slate-300 dark:from-slate-600 dark:via-slate-500 dark:to-slate-600\"></div>\n                                        )}\n                                        \n                                        <div className={`relative overflow-hidden rounded-2xl shadow-lg transition-all duration-300 group-hover/card:shadow-xl ${\n                                          isActive \n                                            ? 'bg-gradient-to-br from-emerald-50 via-green-50 to-emerald-100 dark:from-emerald-950/50 dark:via-emerald-900/30 dark:to-green-900/40 border-2 border-emerald-300/60 dark:border-emerald-700/50 shadow-emerald-200/50 dark:shadow-emerald-900/30' \n                                            : isFuture\n                                            ? 'bg-gradient-to-br from-blue-50 via-sky-50 to-blue-100 dark:from-blue-950/50 dark:via-blue-900/30 dark:to-sky-900/40 border-2 border-blue-300/60 dark:border-blue-700/50 shadow-blue-200/50 dark:shadow-blue-900/30'\n                                            : 'bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 dark:from-slate-800/50 dark:via-slate-900/30 dark:to-slate-800/40 border-2 border-slate-300/60 dark:border-slate-700/50 shadow-slate-200/50 dark:shadow-slate-900/30'\n                                        }`}>\n                                          {/* Status Indicator */}\n                                          <div className=\"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-current to-transparent opacity-60\"></div>\n                                          \n                                          <div className=\"p-6\">\n                                            {/* Rule Header */}\n                                            <div className=\"flex items-center justify-between mb-4\">\n                                              <div className={`inline-flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${\n                                                isActive \n                                                  ? 'bg-emerald-500 text-white'\n                                                  : isFuture\n                                                  ? 'bg-blue-500 text-white'\n                                                  : 'bg-slate-500 text-white'\n                                              }`}>\n                                                {isActive && <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>}\n                                                {isFuture && <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\" /></svg>}\n                                                {isHistorical && <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\" d=\"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\" clipRule=\"evenodd\" /></svg>}\n                                                {status.toUpperCase()}\n                                              </div>\n                                              \n                                              <div className=\"text-xs font-mono text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-1 rounded-lg\">\n                                                {rule.rule_id.slice(-8)}\n                                              </div>\n                                            </div>\n                                            \n                                            {/* Price Display */}\n                                            <div className=\"mb-6\">\n                                              <div className=\"text-4xl font-black text-slate-900 dark:text-slate-100 mb-2 tracking-tight\">\n                                                ${rule.price_usd}\n                                              </div>\n                                              <div className={`text-sm font-semibold ${\n                                                isActive \n                                                  ? 'text-emerald-700 dark:text-emerald-300' \n                                                  : isFuture\n                                                  ? 'text-blue-700 dark:text-blue-300'\n                                                  : 'text-slate-600 dark:text-slate-400'\n                                              }`}>\n                                                {formatDate(rule.start_date)} \n                                                <span className=\"mx-2 opacity-60\">â†’</span> \n                                                {formatDate(rule.end_date) || (\n                                                  <span className={`inline-flex items-center gap-1 ${isActive ? 'text-emerald-600' : 'text-slate-500'}`}>\n                                                    {isActive && <div className=\"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse\"></div>}\n                                                    Ongoing\n                                                  </span>\n                                                )}\n                                              </div>\n                                            </div>\n                                            \n                                            {/* Action Button */}\n                                            <button\n                                              onClick={(e) => {\n                                                e.stopPropagation();\n                                                loadDataProvenance(rule.rule_id);\n                                              }}\n                                              className={`w-full group/btn relative overflow-hidden px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg ${\n                                                isActive\n                                                  ? 'bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-200 dark:shadow-emerald-900/50'\n                                                  : isFuture\n                                                  ? 'bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/50'\n                                                  : 'bg-slate-600 hover:bg-slate-700 text-white shadow-slate-200 dark:shadow-slate-900/50'\n                                              }`}\n                                            >\n                                              <div className=\"relative z-10 flex items-center justify-center gap-2\">\n                                                <svg className=\"w-4 h-4 transition-transform group-hover/btn:scale-110\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\n                                                </svg>\n                                                View Data Source\n                                              </div>\n                                            </button>\n                                          </div>\n                                        </div>\n                                      </div>\n                                    );\n                                  })}\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })\n        )}\n      </div>\n\n      {/* Footer Info */}\n      <div className=\"mt-6 text-sm text-gray-500 dark:text-gray-400 text-center\">\n        Pricing rules are organized by product and country for easy market management.\n        <br />\n        <span className=\"inline-flex items-center gap-4 mt-2\">\n          <span className=\"flex items-center gap-1\">\n            <div className=\"w-3 h-3 bg-green-100 border border-green-300 rounded\"></div>\n            Active\n          </span>\n          <span className=\"flex items-center gap-1\">\n            <div className=\"w-3 h-3 bg-blue-100 border border-blue-300 rounded\"></div>\n            Future\n          </span>\n          <span className=\"flex items-center gap-1\">\n            <div className=\"w-3 h-3 bg-gray-100 border border-gray-300 rounded\"></div>\n            Historical\n          </span>\n        </span>\n      </div>\n\n      {/* Create Rule Modal */}\n      {showCreateModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden\">\n            {/* Modal Header */}\n            <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                  âž• Create New Pricing Rule\n                </h3>\n                <button\n                  onClick={() => setShowCreateModal(false)}\n                  className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                Create a new pricing rule for a product and countries\n              </p>\n            </div>\n\n            {/* Modal Content */}\n            <div className=\"p-6 overflow-y-auto max-h-[70vh]\">\n              <form onSubmit={createRule} className=\"space-y-6\">\n                {/* Product Selection */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Product ID *\n                  </label>\n                  <select\n                    value={formData.product_id}\n                    onChange={(e) => {\n                      const newProductId = e.target.value;\n                      setFormData({...formData, product_id: newProductId, start_date: getDefaultStartDate(newProductId)});\n                      if (newProductId) {\n                        fetchSuggestedPrice(newProductId);\n                      } else {\n                        setSuggestedPrice(null);\n                      }\n                    }}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    required\n                  >\n                    <option value=\"\">Select a product...</option>\n                    {products.map(product => (\n                      <option key={product} value={product}>{product}</option>\n                    ))}\n                  </select>\n                  \n                  {/* Product hint for missing rules */}\n                  {formData.product_id && productGroups[formData.product_id]?.hasMissingRules && (\n                    <div className=\"mt-2 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\">\n                      <div className=\"flex items-center gap-2 text-amber-800 dark:text-amber-200 text-sm\">\n                        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                        </svg>\n                        <span className=\"font-medium\">First pricing rule for this product!</span>\n                      </div>\n                      {productGroups[formData.product_id]?.missingProductInfo && (\n                        <div className=\"mt-1 text-xs text-amber-700 dark:text-amber-300\">\n                          This product has {productGroups[formData.product_id].missingProductInfo.trial_count} trial events but no pricing rules yet.\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                {/* Price with Smart Suggestions */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Price (USD) *\n                  </label>\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                      <span className=\"text-gray-500 dark:text-gray-400\">$</span>\n                    </div>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      value={formData.price_usd}\n                      onChange={(e) => setFormData({...formData, price_usd: e.target.value})}\n                      className=\"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      placeholder=\"29.99\"\n                      required\n                    />\n                    {loadingPrice && (\n                      <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center\">\n                        <svg className=\"animate-spin h-4 w-4 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\">\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                        </svg>\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Smart Price Suggestion */}\n                  {suggestedPrice && (\n                    <div className=\"mt-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2 text-green-800 dark:text-green-200 text-sm\">\n                          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                          </svg>\n                          <span className=\"font-medium\">\n                            Suggested: ${suggestedPrice.suggested_price} from most recent conversion\n                          </span>\n                        </div>\n                        <button\n                          type=\"button\"\n                          onClick={() => setFormData({...formData, price_usd: suggestedPrice.suggested_price.toString()})}\n                          className=\"text-xs bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded\"\n                        >\n                          Use This\n                        </button>\n                      </div>\n                      <div className=\"mt-1 text-xs text-green-700 dark:text-green-300\">\n                        {suggestedPrice.note}\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                {/* Start Date with Smart Default */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Start Date *\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={formData.start_date}\n                    onChange={(e) => setFormData({...formData, start_date: e.target.value})}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    required\n                  />\n                  \n                  {/* Date context */}\n                  {formData.product_id && (\n                    <div className=\"mt-2 text-xs text-gray-600 dark:text-gray-400\">\n                      {rules.filter(rule => rule.product_id === formData.product_id).length === 0 \n                        ? \"ðŸ’¡ First rule for this product - defaulted to Jan 1, 2024\"\n                        : \"ðŸ“… Additional rule - choose when this pricing takes effect\"\n                      }\n                    </div>\n                  )}\n                </div>\n\n                {/* Countries with Select All */}\n                <div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                      Countries *\n                    </label>\n                    <button\n                      type=\"button\"\n                      onClick={handleCountrySelectAll}\n                      className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium\"\n                    >\n                      {countrySelectAll ? 'Deselect All' : 'Select All'} ({countries.length})\n                    </button>\n                  </div>\n                  \n                  <div className=\"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2\">\n                    {countries.map(country => (\n                      <label key={country} className=\"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer\">\n                        <input\n                          type=\"checkbox\"\n                          checked={formData.countries.includes(country)}\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              const newCountries = [...formData.countries, country];\n                              setFormData({...formData, countries: newCountries});\n                              setCountrySelectAll(newCountries.length === countries.length);\n                            } else {\n                              const newCountries = formData.countries.filter(c => c !== country);\n                              setFormData({...formData, countries: newCountries});\n                              setCountrySelectAll(false);\n                            }\n                          }}\n                          className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500\"\n                        />\n                        <span className=\"text-gray-900 dark:text-gray-100 font-medium\">{country}</span>\n                      </label>\n                    ))}\n                  </div>\n                  \n                  <div className=\"mt-2 flex items-center justify-between text-xs\">\n                    <span className=\"text-gray-500 dark:text-gray-400\">\n                      {formData.countries.length} of {countries.length} countries selected\n                    </span>\n                    {formData.countries.length > 0 && (\n                      <span className=\"text-blue-600 dark:text-blue-400 font-medium\">\n                        âœ“ Ready to create rule\n                      </span>\n                    )}\n                  </div>\n                </div>\n\n                {/* Form Actions */}\n                <div className=\"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\">\n                  <button\n                    type=\"submit\"\n                    disabled={!formData.product_id || !formData.price_usd || !formData.start_date || formData.countries.length === 0}\n                    className=\"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl\"\n                  >\n                    Create Pricing Rule\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowCreateModal(false)}\n                    className=\"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Rule Modal */}\n      {showEditModal && editingRule && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden\">\n            {/* Modal Header */}\n            <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                  âœï¸ Edit Pricing Rule\n                </h3>\n                <button\n                  onClick={() => {\n                    setShowEditModal(false);\n                    setEditingRule(null);\n                  }}\n                  className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                Modify pricing rule for {editFormData.product_id} â€¢ Rule ID: {editFormData.rule_id}\n              </p>\n            </div>\n\n            {/* Modal Content */}\n            <div className=\"p-6 overflow-y-auto max-h-[70vh]\">\n              <form onSubmit={updateRule} className=\"space-y-6\">\n                {/* Rule ID Display */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Rule ID (Read-only)\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={editFormData.rule_id}\n                    disabled\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400\"\n                  />\n                </div>\n\n                {/* Product ID Display (non-editable for safety) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Product ID (Read-only)\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={editFormData.product_id}\n                    disabled\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Product ID cannot be changed to maintain data integrity\n                  </p>\n                </div>\n\n                {/* Price */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Price (USD) *\n                  </label>\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                      <span className=\"text-gray-500 dark:text-gray-400\">$</span>\n                    </div>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      value={editFormData.price_usd}\n                      onChange={(e) => setEditFormData({...editFormData, price_usd: e.target.value})}\n                      className=\"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      required\n                    />\n                  </div>\n                  {editingRule && editFormData.price_usd !== editingRule.price_usd.toString() && (\n                    <div className=\"mt-2 text-sm text-amber-600 dark:text-amber-400\">\n                      âš ï¸ Changing from ${editingRule.price_usd} to ${editFormData.price_usd}\n                    </div>\n                  )}\n                </div>\n\n                {/* Start Date */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    Start Date *\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={editFormData.start_date}\n                    onChange={(e) => setEditFormData({...editFormData, start_date: e.target.value})}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    required\n                  />\n                  {editingRule && editFormData.start_date !== editingRule.start_date && (\n                    <div className=\"mt-2 text-sm text-amber-600 dark:text-amber-400\">\n                      âš ï¸ Changing from {formatDate(editingRule.start_date)} to {formatDate(editFormData.start_date)}\n                    </div>\n                  )}\n                </div>\n\n                {/* Countries */}\n                <div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                      Countries *\n                    </label>\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        if (editFormData.countries.length === countries.length) {\n                          setEditFormData({...editFormData, countries: []});\n                        } else {\n                          setEditFormData({...editFormData, countries: [...countries]});\n                        }\n                      }}\n                      className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium\"\n                    >\n                      {editFormData.countries.length === countries.length ? 'Deselect All' : 'Select All'} ({countries.length})\n                    </button>\n                  </div>\n                  \n                  <div className=\"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2\">\n                    {countries.map(country => (\n                      <label key={country} className=\"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer\">\n                        <input\n                          type=\"checkbox\"\n                          checked={editFormData.countries.includes(country)}\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              setEditFormData({...editFormData, countries: [...editFormData.countries, country]});\n                            } else {\n                              setEditFormData({...editFormData, countries: editFormData.countries.filter(c => c !== country)});\n                            }\n                          }}\n                          className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500\"\n                        />\n                        <span className=\"text-gray-900 dark:text-gray-100 font-medium\">{country}</span>\n                      </label>\n                    ))}\n                  </div>\n                  \n                  <div className=\"mt-2 flex items-center justify-between text-xs\">\n                    <span className=\"text-gray-500 dark:text-gray-400\">\n                      {editFormData.countries.length} of {countries.length} countries selected\n                    </span>\n                    {editingRule && JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort()) && (\n                      <span className=\"text-amber-600 dark:text-amber-400 font-medium\">\n                        âš ï¸ Countries modified\n                      </span>\n                    )}\n                  </div>\n                </div>\n\n                {/* Change Summary */}\n                {editingRule && (\n                  editFormData.price_usd !== editingRule.price_usd.toString() ||\n                  editFormData.start_date !== editingRule.start_date ||\n                  JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort())\n                ) && (\n                  <div className=\"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\">\n                    <h4 className=\"font-medium text-amber-800 dark:text-amber-200 mb-2\">\n                      ðŸ“ Changes Summary\n                    </h4>\n                    <div className=\"text-sm text-amber-700 dark:text-amber-300 space-y-1\">\n                      {editFormData.price_usd !== editingRule.price_usd.toString() && (\n                        <div>â€¢ Price: ${editingRule.price_usd} â†’ ${editFormData.price_usd}</div>\n                      )}\n                      {editFormData.start_date !== editingRule.start_date && (\n                        <div>â€¢ Start Date: {formatDate(editingRule.start_date)} â†’ {formatDate(editFormData.start_date)}</div>\n                      )}\n                      {JSON.stringify(editFormData.countries.sort()) !== JSON.stringify(editingRule.countries.sort()) && (\n                        <div>â€¢ Countries: {editingRule.countries.length} â†’ {editFormData.countries.length} selected</div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* Form Actions */}\n                <div className=\"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\">\n                  <button\n                    type=\"submit\"\n                    disabled={!editFormData.price_usd || !editFormData.start_date || editFormData.countries.length === 0}\n                    className=\"flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl\"\n                  >\n                    ðŸ’¾ Save Changes\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setShowEditModal(false);\n                      setEditingRule(null);\n                    }}\n                    className=\"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Data Provenance Modal */}\n      {showDataProvenance && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl max-h-[80vh] overflow-hidden\">\n            {/* Modal Header */}\n            <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                  ðŸ“Š Data Provenance: Rule {showDataProvenance.ruleId}\n                </h3>\n                <button\n                  onClick={() => setShowDataProvenance(null)}\n                  className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                This shows the underlying data that led to the creation of this pricing rule\n              </p>\n            </div>\n\n            {/* Modal Content */}\n            <div className=\"p-6 overflow-y-auto max-h-[60vh]\">\n              {showDataProvenance.data ? (\n                <div className=\"space-y-6\">\n                  {/* Rule Summary */}\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n                    <h4 className=\"font-semibold text-blue-900 dark:text-blue-200 mb-2\">Rule Summary</h4>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <span className=\"font-medium\">Product:</span> {showDataProvenance.data.product_id}\n                      </div>\n                      <div>\n                        <span className=\"font-medium\">Countries:</span> {showDataProvenance.data.countries?.join(', ')}\n                      </div>\n                      <div>\n                        <span className=\"font-medium\">USD Price:</span> ${showDataProvenance.data.price_usd}\n                      </div>\n                      <div>\n                        <span className=\"font-medium\">Date Range:</span> {showDataProvenance.data.start_date} â†’ {showDataProvenance.data.end_date || 'ongoing'}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Underlying Events */}\n                  <div>\n                    <h4 className=\"font-semibold text-gray-900 dark:text-gray-100 mb-3\">\n                      ðŸ” Underlying Events ({showDataProvenance.data.events_analyzed || 0} events)\n                    </h4>\n                    <div className=\"bg-gray-50 dark:bg-gray-900 rounded-lg p-4\">\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-3\">\n                        These are the actual pricing events from your database that led to this rule:\n                      </div>\n                      \n                      {/* Events Table */}\n                      <div className=\"overflow-x-auto\">\n                        <table className=\"w-full text-xs\">\n                          <thead>\n                            <tr className=\"bg-gray-200 dark:bg-gray-700\">\n                              <th className=\"p-2 text-left\">Trial Start</th>\n                              <th className=\"p-2 text-left\">Conversion</th>\n                              <th className=\"p-2 text-left\">Actual Price</th>\n                              <th className=\"p-2 text-left\">Country</th>\n                              <th className=\"p-2 text-left\">User ID</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {(showDataProvenance.data.sample_events || []).map((event, index) => (\n                              <tr key={index} className=\"border-b border-gray-200 dark:border-gray-600\">\n                                <td className=\"p-2\">{event.trial_start_date}</td>\n                                <td className=\"p-2\">{event.conversion_date}</td>\n                                <td className=\"p-2 font-mono\">${event.actual_price}</td>\n                                <td className=\"p-2\">{event.country}</td>\n                                <td className=\"p-2 font-mono text-xs\">{event.user_id?.substring(0, 8)}...</td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Price Analysis */}\n                  <div>\n                    <h4 className=\"font-semibold text-gray-900 dark:text-gray-100 mb-3\">\n                      ðŸ’° Price Analysis\n                    </h4>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {/* Actual Prices Seen */}\n                      <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4\">\n                        <h5 className=\"font-medium text-green-900 dark:text-green-200 mb-2\">Actual Prices Charged</h5>\n                        <div className=\"text-sm space-y-1\">\n                          {(showDataProvenance.data.actual_prices || []).map((price, index) => (\n                            <div key={index} className=\"flex justify-between\">\n                              <span className=\"font-mono\">${price}</span>\n                              <span className=\"text-xs text-gray-500\">\n                                {showDataProvenance.data.price_counts?.[price] || 0} events\n                              </span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n\n                      {/* Clustering Logic */}\n                      <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4\">\n                        <h5 className=\"font-medium text-yellow-900 dark:text-yellow-200 mb-2\">USD Clustering</h5>\n                        <div className=\"text-sm space-y-2\">\n                          <div>\n                            <span className=\"font-medium\">Target USD:</span> ${showDataProvenance.data.price_usd}\n                          </div>\n                          <div>\n                            <span className=\"font-medium\">Price Range:</span> ${showDataProvenance.data.price_range?.min || 0} - ${showDataProvenance.data.price_range?.max || 0}\n                          </div>\n                          <div>\n                            <span className=\"font-medium\">Variance:</span> {showDataProvenance.data.price_variance || 0}%\n                          </div>\n                          <div className=\"text-xs text-gray-600 dark:text-gray-400\">\n                            Prices were clustered within 15% tolerance to account for FX fluctuations and rounding\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Detection Logic */}\n                  <div>\n                    <h4 className=\"font-semibold text-gray-900 dark:text-gray-100 mb-3\">\n                      ðŸ”¬ Detection Logic\n                    </h4>\n                    <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4\">\n                      <div className=\"text-sm space-y-2\">\n                        <div>\n                          <span className=\"font-medium\">Method:</span> {showDataProvenance.data.detection_method || 'USD price clustering'}\n                        </div>\n                        <div>\n                          <span className=\"font-medium\">Confidence:</span> {showDataProvenance.data.confidence_score || 'High'}\n                        </div>\n                        <div>\n                          <span className=\"font-medium\">Notes:</span> {showDataProvenance.data.notes || 'Auto-generated from conversion events'}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-8\">\n                  <div className=\"text-gray-500 dark:text-gray-400\">\n                    Loading data provenance information...\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Modal Footer */}\n            <div className=\"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900\">\n              <div className=\"flex justify-end\">\n                <button\n                  onClick={() => setShowDataProvenance(null)}\n                  className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md\"\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Rule History Modal */}\n      {showRuleHistory && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden\">\n            {/* Modal Header */}\n            <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                  ðŸ“œ Rule History: {showRuleHistory.productId}\n                </h3>\n                <button\n                  onClick={() => setShowRuleHistory(null)}\n                  className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                Complete chronological history of pricing rule changes (newest first)\n              </p>\n            </div>\n\n            {/* Modal Content */}\n            <div className=\"p-6 overflow-y-auto max-h-[60vh]\">\n              {showRuleHistory.data?.history && showRuleHistory.data.history.length > 0 ? (\n                <div className=\"space-y-6\">\n                  {/* Summary Stats */}\n                  <div className=\"grid grid-cols-3 gap-4 mb-6\">\n                    <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 text-center\">\n                      <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                        {showRuleHistory.data.history.filter(e => e.action === 'created').length}\n                      </div>\n                      <div className=\"text-sm text-green-800 dark:text-green-300\">Rules Created</div>\n                    </div>\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 text-center\">\n                      <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\n                        {showRuleHistory.data.history.filter(e => e.action === 'updated').length}\n                      </div>\n                      <div className=\"text-sm text-blue-800 dark:text-blue-300\">Rules Updated</div>\n                    </div>\n                    <div className=\"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 text-center\">\n                      <div className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n                        {showRuleHistory.data.history.filter(e => e.action === 'deleted').length}\n                      </div>\n                      <div className=\"text-sm text-red-800 dark:text-red-300\">Rules Deleted</div>\n                    </div>\n                  </div>\n\n                  {/* Rule History Timeline */}\n                  <div className=\"space-y-4\">\n                    <h4 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4\">\n                      ðŸ“… Chronological History (Newest First)\n                    </h4>\n                    \n                    {showRuleHistory.data.history.map((entry, index) => {\n                      // Check if this rule still exists and can be edited\n                      const currentRule = rules.find(r => r.rule_id === entry.rule_data.rule_id);\n                      const canEdit = entry.action !== 'deleted' && currentRule;\n                      \n                      return (\n                        <div \n                          key={entry.entry_id}\n                          className={`relative p-6 rounded-xl border-l-4 shadow-lg ${\n                            entry.action === 'created' ? 'bg-green-50 border-green-400 dark:bg-green-900/20' :\n                            entry.action === 'updated' ? 'bg-blue-50 border-blue-400 dark:bg-blue-900/20' :\n                            'bg-red-50 border-red-400 dark:bg-red-900/20'\n                          }`}\n                        >\n                          {/* Timeline connector */}\n                          {index < showRuleHistory.data.history.length - 1 && (\n                            <div className=\"absolute left-0 bottom-0 w-1 h-6 bg-gray-300 transform translate-y-full\"></div>\n                          )}\n                          \n                          <div className=\"flex items-start justify-between\">\n                            <div className=\"flex-1\">\n                              {/* Action Badge and Main Info */}\n                              <div className=\"flex items-center gap-4 mb-3\">\n                                <span className={`px-3 py-1 text-sm font-bold rounded-full ${\n                                  entry.action === 'created' ? 'bg-green-100 text-green-800' :\n                                  entry.action === 'updated' ? 'bg-blue-100 text-blue-800' :\n                                  'bg-red-100 text-red-800'\n                                }`}>\n                                  {entry.action === 'created' ? 'âœ… CREATED' :\n                                   entry.action === 'updated' ? 'ðŸ“ UPDATED' : 'ðŸ—‘ï¸ DELETED'}\n                                </span>\n                                \n                                <div className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">\n                                  ${entry.rule_data.price_usd}\n                                </div>\n                                \n                                <div className=\"text-sm font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full\">\n                                  {entry.rule_data.countries?.length} countries\n                                </div>\n                                \n                                <div className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded font-mono\">\n                                  {entry.rule_data.rule_id}\n                                </div>\n                              </div>\n                              \n                              {/* Rule Details Grid */}\n                              <div className=\"grid grid-cols-2 gap-6 mb-4\">\n                                <div>\n                                  <div className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Date Range</div>\n                                  <div className=\"text-base text-gray-900 dark:text-gray-100\">\n                                    {formatDate(entry.rule_data.start_date)} â†’ {formatDate(entry.rule_data.end_date) || 'Ongoing'}\n                                  </div>\n                                </div>\n                                <div>\n                                  <div className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Countries Applied</div>\n                                  <div className=\"text-sm text-gray-900 dark:text-gray-100\">\n                                    {entry.rule_data.countries?.slice(0, 3).join(', ')}\n                                    {entry.rule_data.countries?.length > 3 && ` +${entry.rule_data.countries.length - 3} more`}\n                                  </div>\n                                </div>\n                              </div>\n                              \n                              {/* User Notes */}\n                              {entry.user_notes && (\n                                <div className=\"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-600 mb-4\">\n                                  <div className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Notes</div>\n                                  <div className=\"text-sm text-gray-600 dark:text-gray-400\">{entry.user_notes}</div>\n                                </div>\n                              )}\n                              \n                              {/* Action Buttons */}\n                              <div className=\"flex gap-3\">\n                                {canEdit && (\n                                  <button\n                                    onClick={() => {\n                                      setShowRuleHistory(null); // Close history modal\n                                      openEditModal(currentRule); // Open edit modal\n                                    }}\n                                    className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\"\n                                  >\n                                    âœï¸ Edit This Rule\n                                  </button>\n                                )}\n                                \n                                <button\n                                  onClick={() => {\n                                    setShowRuleHistory(null);\n                                    loadDataProvenance(entry.rule_data.rule_id);\n                                  }}\n                                  className=\"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\"\n                                >\n                                  ðŸ“Š View Data Source\n                                </button>\n                                \n                                {canEdit && (\n                                  <button\n                                    onClick={() => {\n                                      if (window.confirm(`Are you sure you want to delete rule ${entry.rule_data.rule_id}?`)) {\n                                        deleteRule(entry.rule_data.rule_id);\n                                        setShowRuleHistory(null);\n                                      }\n                                    }}\n                                    className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm\"\n                                  >\n                                    ðŸ—‘ï¸ Delete Rule\n                                  </button>\n                                )}\n                              </div>\n                            </div>\n                            \n                            {/* Timestamp */}\n                            <div className=\"text-right text-sm text-gray-500 dark:text-gray-400 ml-6\">\n                              <div className=\"font-medium\">{new Date(entry.timestamp).toLocaleDateString()}</div>\n                              <div>{new Date(entry.timestamp).toLocaleTimeString()}</div>\n                              {!canEdit && entry.action !== 'deleted' && (\n                                <div className=\"text-xs text-red-500 mt-1\">Rule no longer exists</div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-12\">\n                  <div className=\"text-6xl mb-4\">ðŸ“œ</div>\n                  <div className=\"text-xl font-medium text-gray-600 dark:text-gray-400 mb-2\">\n                    No Rule History Yet\n                  </div>\n                  <div className=\"text-sm text-gray-500 dark:text-gray-500\">\n                    Create your first pricing rule to start tracking changes\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Modal Footer */}\n            <div className=\"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900\">\n              <div className=\"flex justify-between items-center\">\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  {showRuleHistory.data?.total_count || 0} total changes tracked\n                </div>\n                <button\n                  onClick={() => setShowRuleHistory(null)}\n                  className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium\"\n                >\n                  Close History\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PricingManagementPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}