{"ast":null,"code":"var _jsxFileName = \"/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/pages/CohortAnalyzerPage.js\",\n  _s = $RefreshSig$();\n// client/src/pages/CohortAnalyzerPage.js\n// COHORT DEFINITION:\n// A user is part of the cohort ONLY if they:\n// 1. Exist in the database\n// 2. Have a \"trial started\" event within the specified date range\n// This is enforced using the enforce_trial_started flag in API calls\n// IMPORTANT: Users who do not meet both criteria are EXCLUDED from all analysis.\n// All events analyzed are ONLY from users in this cohort.\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { api } from '../services/api'; // Assuming your API service is here\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { ChevronDown, ChevronRight, PlusCircle, XCircle, AlertTriangle, Loader, Filter } from 'lucide-react';\nimport Select from 'react-select';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip as ChartTooltip, Legend as ChartLegend } from 'chart.js';\nimport { Line as ChartLine } from 'react-chartjs-2';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, ChartTooltip, ChartLegend);\n\n// Custom styles for react-select\nconst customSelectStyles = {\n  control: (base, state) => ({\n    ...base,\n    background: '#FFFFFF',\n    borderColor: state.isFocused ? '#4F46E5' : '#CBD5E0',\n    boxShadow: state.isFocused ? '0 0 0 1px #4F46E5' : 'none',\n    '&:hover': {\n      borderColor: '#4F46E5'\n    },\n    padding: '2px',\n    fontSize: '0.9rem'\n  }),\n  option: (base, state) => ({\n    ...base,\n    backgroundColor: state.isSelected ? '#4F46E5' : state.isFocused ? '#EEF2FF' : 'transparent',\n    color: state.isSelected ? 'white' : '#1A202C',\n    '&:hover': {\n      backgroundColor: state.isSelected ? '#4F46E5' : '#EEF2FF'\n    },\n    cursor: 'pointer',\n    fontSize: '0.9rem'\n  }),\n  multiValue: base => ({\n    ...base,\n    backgroundColor: '#EEF2FF',\n    border: '1px solid #E2E8F0'\n  }),\n  multiValueLabel: base => ({\n    ...base,\n    color: '#4F46E5',\n    fontWeight: 500\n  }),\n  multiValueRemove: base => ({\n    ...base,\n    color: '#4F46E5',\n    '&:hover': {\n      backgroundColor: '#4F46E5',\n      color: 'white'\n    }\n  }),\n  menu: base => ({\n    ...base,\n    zIndex: 100,\n    boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',\n    backgroundColor: '#FFFFFF'\n  }),\n  placeholder: base => ({\n    ...base,\n    color: '#718096'\n  }),\n  input: base => ({\n    ...base,\n    color: '#1A202C'\n  }),\n  singleValue: base => ({\n    ...base,\n    color: '#1A202C'\n  })\n};\n\n// For dark mode\nconst darkModeSelectStyles = {\n  ...customSelectStyles,\n  control: (base, state) => ({\n    ...customSelectStyles.control(base, state),\n    background: '#1F2937',\n    borderColor: state.isFocused ? '#4F46E5' : '#4B5563',\n    '&:hover': {\n      borderColor: '#4F46E5'\n    }\n  }),\n  option: (base, state) => ({\n    ...customSelectStyles.option(base, state),\n    backgroundColor: state.isSelected ? '#4F46E5' : state.isFocused ? '#374151' : '#1F2937',\n    color: state.isSelected ? 'white' : '#F3F4F6'\n  }),\n  multiValue: base => ({\n    ...customSelectStyles.multiValue(base),\n    backgroundColor: '#374151',\n    border: '1px solid #4B5563'\n  }),\n  multiValueLabel: base => ({\n    ...customSelectStyles.multiValueLabel(base),\n    color: '#F3F4F6'\n  }),\n  multiValueRemove: base => ({\n    ...customSelectStyles.multiValueRemove(base),\n    color: '#F3F4F6',\n    '&:hover': {\n      backgroundColor: '#4F46E5',\n      color: 'white'\n    }\n  }),\n  menu: base => ({\n    ...customSelectStyles.menu(base),\n    backgroundColor: '#1F2937',\n    border: '1px solid #4B5563'\n  }),\n  placeholder: base => ({\n    ...customSelectStyles.placeholder(base),\n    color: '#9CA3AF'\n  }),\n  input: base => ({\n    ...base,\n    color: '#F3F4F6'\n  }),\n  singleValue: base => ({\n    ...base,\n    color: '#F3F4F6'\n  })\n};\n\n// Define the color coding for the user timeline table\nconst timelineColors = {\n  default: {\n    bg: 'bg-gray-100 dark:bg-gray-700',\n    text: 'text-gray-500 dark:text-gray-400'\n  },\n  trial_started: {\n    bg: 'bg-yellow-100 dark:bg-yellow-900/50',\n    text: 'text-yellow-800 dark:text-yellow-200'\n  },\n  trial_converted: {\n    bg: 'bg-green-100 dark:bg-green-900/50',\n    text: 'text-green-800 dark:text-green-200'\n  },\n  trial_cancelled: {\n    bg: 'bg-red-100 dark:bg-red-900/50',\n    text: 'text-red-800 dark:text-red-200'\n  },\n  conversion_cancelled: {\n    bg: 'bg-green-50 dark:bg-green-900/30',\n    text: 'text-green-600 dark:text-green-300'\n  },\n  refunded: {\n    bg: 'bg-red-50 dark:bg-red-900/30',\n    text: 'text-red-600 dark:text-red-300'\n  }\n};\n\n// New component for displaying filter stats\nconst FilterStatsDisplay = ({\n  filterStats\n}) => {\n  var _filtering_steps;\n  if (!filterStats) return null;\n  const {\n    filtering_steps,\n    base_cohort_count,\n    final_cohort_count\n  } = filterStats;\n\n  // Calculate percentages\n  const calculatePercentage = (count, total) => {\n    if (!total) return 0;\n    return (count / total * 100).toFixed(1);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mb-6 p-4 border rounded-lg bg-white dark:bg-gray-700 shadow-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2 mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(Filter, {\n        size: 18,\n        className: \"text-indigo-600 dark:text-indigo-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-semibold text-gray-700 dark:text-white\",\n        children: \"Cohort Filtering Statistics\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col md:flex-row items-center justify-between mb-4 p-3 bg-indigo-50 dark:bg-indigo-900/30 rounded-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-300\",\n          children: \"Base Cohort\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xl font-bold text-indigo-600 dark:text-indigo-300\",\n          children: base_cohort_count\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400\",\n          children: \"100%\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hidden md:block text-gray-400\",\n        children: \"\\u2192\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this), filtering_steps.slice(1).map((step, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 dark:text-gray-300\",\n          children: [\"After \", step.step]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xl font-bold text-indigo-600 dark:text-indigo-300\",\n          children: step.users_count\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400\",\n          children: [calculatePercentage(step.users_count, base_cohort_count), \"% of base\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 25\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 21\n      }, this)), final_cohort_count !== ((_filtering_steps = filtering_steps[filtering_steps.length - 1]) === null || _filtering_steps === void 0 ? void 0 : _filtering_steps.users_count) && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block text-gray-400\",\n          children: \"\\u2192\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-600 dark:text-gray-300\",\n            children: \"Final Cohort\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xl font-bold text-indigo-600 dark:text-indigo-300\",\n            children: final_cohort_count\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 dark:text-gray-400\",\n            children: [calculatePercentage(final_cohort_count, base_cohort_count), \"% of base\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overflow-x-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"min-w-full text-sm border dark:border-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"bg-gray-50 dark:bg-gray-700\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n              children: \"Filter Step\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n              children: \"Description\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",\n              children: \"Users Count\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",\n              children: \"Users Filtered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\",\n              children: \"% of Base\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          className: \"bg-white dark:bg-gray-800\",\n          children: filtering_steps.map((step, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: index % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700',\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n              children: step.step\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n              children: step.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\",\n              children: step.users_count\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\",\n              children: step.users_filtered || 0\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\",\n              children: [calculatePercentage(step.users_count, base_cohort_count), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 9\n  }, this);\n};\n\n// Add this Tooltip component before the main CohortAnalyzerPage component\n_c = FilterStatsDisplay;\nconst EstimatedRevenueTooltip = ({\n  data,\n  position,\n  onClose\n}) => {\n  if (!data) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md\",\n    style: {\n      left: Math.min(position.x, window.innerWidth - 400),\n      top: Math.max(position.y - 100, 10)\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-start mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-semibold text-gray-800 dark:text-white\",\n        children: \"Estimated Revenue Calculation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"text-gray-500 hover:text-gray-700\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3 text-sm\",\n      children: [(() => {\n        const breakdown = data.breakdown || {};\n        const trialConverted = breakdown.trial_converted || {};\n        const initialPurchase = breakdown.initial_purchase || {};\n        const showTrialRatio = trialConverted.actual_revenue > 0;\n        const showInitialRatio = initialPurchase.actual_revenue > 0;\n        if (!showTrialRatio && !showInitialRatio) return null;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg border border-blue-200 dark:border-blue-700 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2\",\n            children: \"\\uD83C\\uDFAF Refund Rate Analysis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 29\n          }, this), showTrialRatio && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs font-medium text-blue-700 dark:text-blue-300\",\n              children: \"Trial Conversion Refund Rate:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm font-bold text-blue-900 dark:text-blue-100\",\n              children: (() => {\n                const revenue = trialConverted.actual_revenue || 0;\n                const estimatedRefunds = trialConverted.estimated_refunds || 0;\n                const refundRate = revenue > 0 ? estimatedRefunds / revenue * 100 : 0;\n                return `${estimatedRefunds.toFixed(2)} / ${revenue.toFixed(2)} = ${refundRate.toFixed(1)}%`;\n              })()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-blue-600 dark:text-blue-400\",\n              children: [\"$\", (trialConverted.estimated_refunds || 0).toFixed(2), \" estimated refunds on $\", (trialConverted.actual_revenue || 0).toFixed(2), \" revenue\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 33\n          }, this), showInitialRatio && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs font-medium text-blue-700 dark:text-blue-300\",\n              children: \"Initial Purchase Refund Rate:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm font-bold text-blue-900 dark:text-blue-100\",\n              children: (() => {\n                const revenue = initialPurchase.actual_revenue || 0;\n                const estimatedRefunds = initialPurchase.estimated_refunds || 0;\n                const refundRate = revenue > 0 ? estimatedRefunds / revenue * 100 : 0;\n                return `${estimatedRefunds.toFixed(2)} / ${revenue.toFixed(2)} = ${refundRate.toFixed(1)}%`;\n              })()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-blue-600 dark:text-blue-400\",\n              children: [\"$\", (initialPurchase.estimated_refunds || 0).toFixed(2), \" estimated refunds on $\", (initialPurchase.actual_revenue || 0).toFixed(2), \" revenue\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 25\n        }, this);\n      })(), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-medium text-gray-700 dark:text-gray-300\",\n          children: \"Formula:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded\",\n          children: data.formula\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-medium text-gray-700 dark:text-gray-300\",\n          children: \"Calculation:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded\",\n          children: data.calculation\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-medium text-gray-700 dark:text-gray-300\",\n          children: \"Components:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs space-y-1\",\n          children: Object.entries(data.components || {}).map(([key, value]) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600 dark:text-gray-400\",\n              children: [key, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-mono\",\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 33\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-t pt-2\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between font-medium\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Result:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-green-600 dark:text-green-400\",\n            children: data.result\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 276,\n    columnNumber: 9\n  }, this);\n};\n_c2 = EstimatedRevenueTooltip;\nconst CohortAnalyzerPage = () => {\n  _s();\n  var _analysisResult$summa, _analysisResult$summa2, _analysisResult$summa3, _analysisResult$summa4, _analysisResult$summa5, _analysisResult$cohor, _analysisResult$cohor2, _analysisResult$cohor3, _analysisResult$cohor4, _analysisResult$cohor5, _analysisResult$cohor6, _analysisResult$cohor7, _analysisResult$cohor8, _analysisResult$cohor9, _analysisResult$cohor0, _analysisResult$cohor1, _analysisResult$cohor10, _analysisResult$cohor11, _analysisResult$cohor12, _analysisResult$cohor13, _analysisResult$cohor14, _analysisResult$cohor15, _analysisResult$cohor16, _analysisResult$cohor17, _analysisResult$cohor18, _analysisResult$cohor19, _analysisResult$cohor20, _analysisResult$cohor21, _analysisResult$cohor22, _analysisResult$cohor23, _analysisResult$cohor24, _userTimelineData$use, _userTimelineData$val;\n  const initialFilters = {\n    date_from_str: '',\n    date_to_str: '',\n    optional_filters: [] // [{id: uuid, property_name: '', property_values: [], property_source: 'event/user'}]\n  };\n  const [filters, setFilters] = useState(initialFilters);\n  const [availableEventProperties, setAvailableEventProperties] = useState([]);\n  const [availableUserProperties, setAvailableUserProperties] = useState([]);\n  const [propertyValueOptions, setPropertyValueOptions] = useState({}); // { 'prop_key': ['val1', 'val2'] }\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [analysisResult, setAnalysisResult] = useState(null);\n  const [error, setError] = useState(null);\n  const [showLifecycleTables, setShowLifecycleTables] = useState(false);\n  const [activePropertyDiscovery, setActivePropertyDiscovery] = useState(false);\n  const [propertyDiscoveryMessage, setPropertyDiscoveryMessage] = useState('');\n  const [isInitializing, setIsInitializing] = useState(true);\n\n  // User timeline state\n  const [userTimelineData, setUserTimelineData] = useState(null);\n  const [isLoadingTimeline, setIsLoadingTimeline] = useState(false);\n  const [timelineError, setTimelineError] = useState(null);\n\n  // Event Revenue Timeline state - NEW FEATURE\n  const [eventRevenueTimelineData, setEventRevenueTimelineData] = useState(null);\n  const [isLoadingEventRevenueTimeline, setIsLoadingEventRevenueTimeline] = useState(false);\n  const [eventRevenueTimelineError, setEventRevenueTimelineError] = useState(null);\n  const [selectedUserId, setSelectedUserId] = useState('');\n  const [selectedProductId, setSelectedProductId] = useState('');\n  const [availableUsers, setAvailableUsers] = useState([]);\n  const [availableProducts, setAvailableProducts] = useState([]);\n\n  // Add state for cohort definition warning\n  const [cohortDefinitionWarning, setCohortDefinitionWarning] = useState(null);\n\n  // Add state for tooltip\n  const [tooltipData, setTooltipData] = useState(null);\n  const [tooltipPosition, setTooltipPosition] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // Add state for product selection at component level\n  const [selectedProducts, setSelectedProducts] = React.useState({});\n\n  // State for lifecycle table global product selection (single selector for all tables)\n  const [globalSelectedProduct, setGlobalSelectedProduct] = React.useState(\"\");\n\n  // State for chart modal\n  const [showChartModal, setShowChartModal] = React.useState(false);\n\n  // Load saved filters from localStorage on component mount\n  useEffect(() => {\n    const savedFilters = localStorage.getItem('cohortAnalyzerFilters');\n    if (savedFilters) {\n      try {\n        const parsedFilters = JSON.parse(savedFilters);\n        setFilters(prev => ({\n          ...prev,\n          ...parsedFilters,\n          optional_filters: parsedFilters.optional_filters || [] // Ensure optional_filters exists\n        }));\n      } catch (error) {\n        console.error('Error loading saved filters:', error);\n      }\n    }\n  }, []);\n\n  // Save filters to localStorage whenever they change\n  useEffect(() => {\n    const filtersToSave = {\n      date_from_str: filters.date_from_str,\n      date_to_str: filters.date_to_str,\n      optional_filters: filters.optional_filters\n    };\n    localStorage.setItem('cohortAnalyzerFilters', JSON.stringify(filtersToSave));\n  }, [filters.date_from_str, filters.date_to_str, filters.optional_filters]);\n\n  // Define fetchDiscoverableProperties BEFORE it's used in the useEffect\n  const fetchDiscoverableProperties = useCallback(async () => {\n    try {\n      const data = await api.getDiscoverableCohortProperties();\n      setAvailableEventProperties(data.event_properties || []);\n      setAvailableUserProperties(data.user_properties || []);\n\n      // Check if we got an empty response and need to enable properties\n      if ((!data.event_properties || data.event_properties.length === 0) && (!data.user_properties || data.user_properties.length === 0)) {\n        if (data.status === \"discovery_initiated\") {\n          setPropertyDiscoveryMessage(data.message || \"Property discovery auto-triggered. Please wait...\");\n          setActivePropertyDiscovery(true);\n          // Poll for completion\n          const checkDiscoveryInterval = setInterval(async () => {\n            try {\n              const status = await api.getPropertyDiscoveryStatus();\n              if (status.status === 'completed') {\n                clearInterval(checkDiscoveryInterval);\n                setActivePropertyDiscovery(false);\n                setPropertyDiscoveryMessage(\"Discovery completed! Refreshing properties...\");\n                // Refresh properties after a delay\n                setTimeout(fetchDiscoverableProperties, 1000);\n              }\n            } catch (err) {\n              console.error(\"Error checking discovery status:\", err);\n            }\n          }, 3000);\n        }\n      }\n    } catch (err) {\n      console.error(\"Error fetching discoverable properties:\", err);\n      if (err.code === \"tables_missing\") {\n        // Specific error for missing tables - try to enable properties automatically\n        try {\n          await api.enableCohortProperties();\n          setPropertyDiscoveryMessage(\"Property system initialized. Please wait while we discover properties...\");\n          // Give time for the initialization and then try again\n          setTimeout(fetchDiscoverableProperties, 2000);\n        } catch (enableErr) {\n          setError(\"Could not initialize property system. Please try again or check server logs.\");\n        }\n      } else {\n        setError(\"Could not load filter property lists. Try triggering discovery or check console.\");\n      }\n    }\n  }, []);\n  const getPropertyDiscoveryStatus = useCallback(async () => {\n    try {\n      const status = await api.getPropertyDiscoveryStatus();\n      if (status.active) {\n        setActivePropertyDiscovery(true);\n        setPropertyDiscoveryMessage(status.message || \"Property discovery in progress...\");\n      } else if (status.status === 'completed') {\n        setActivePropertyDiscovery(false);\n      }\n    } catch (err) {\n      console.error(\"Error checking discovery status:\", err);\n    }\n  }, []);\n\n  // Initialize properties and fetch discoverable properties on mount\n  useEffect(() => {\n    const initializeProperties = async () => {\n      setIsInitializing(true);\n      try {\n        // First try to enable properties to ensure tables exist\n        await api.enableCohortProperties();\n        // Check discovery status\n        await getPropertyDiscoveryStatus();\n        // Then fetch the properties\n        await fetchDiscoverableProperties();\n      } catch (err) {\n        console.error(\"Error initializing properties:\", err);\n        setError(\"Could not initialize property system. Please check server logs.\");\n      } finally {\n        setIsInitializing(false);\n      }\n    };\n    initializeProperties();\n  }, [fetchDiscoverableProperties, getPropertyDiscoveryStatus]);\n  const handleFilterChange = (type, value, index = -1) => {\n    setFilters(prev => {\n      const newFilters = {\n        ...prev\n      };\n      if (type === 'date_from_str' || type === 'date_to_str') {\n        newFilters[type] = value;\n      } else if (type === 'optional_filter_property') {\n        newFilters.optional_filters[index].property_name = value;\n        newFilters.optional_filters[index].property_values = []; // Reset values\n        if (value) fetchPropertyValues(value, 'user', 'optional_filter_' + index);\n      } else if (type === 'optional_filter_values') {\n        // Assuming value is an array from a multi-select component\n        newFilters.optional_filters[index].property_values = value;\n      } else if (type.startsWith('optional_filter_')) {\n        const field = type.substring('optional_filter_'.length); // 'property', 'values', 'source'\n        if (field === 'property') {\n          newFilters.optional_filters[index].property_name = value;\n          newFilters.optional_filters[index].property_values = []; // Reset values\n          if (value && newFilters.optional_filters[index].property_source) {\n            fetchPropertyValues(value, newFilters.optional_filters[index].property_source, `optional_filter_${index}`);\n          }\n        } else if (field === 'values') {\n          newFilters.optional_filters[index].property_values = value; // Assuming array\n        } else if (field === 'source') {\n          newFilters.optional_filters[index].property_source = value;\n          // If property name already exists, re-fetch values for new source\n          if (newFilters.optional_filters[index].property_name) {\n            fetchPropertyValues(newFilters.optional_filters[index].property_name, value, `optional_filter_${index}`);\n          }\n        }\n      }\n      return newFilters;\n    });\n  };\n  const fetchPropertyValues = async (propertyName, propertySource, filterIdentifier) => {\n    if (!propertyName || !propertySource) return;\n    try {\n      const data = await api.getDiscoverableCohortPropertyValues(propertyName, propertySource);\n      setPropertyValueOptions(prev => ({\n        ...prev,\n        [filterIdentifier + '_' + propertyName]: data.values || []\n      }));\n    } catch (err) {\n      console.error(`Error fetching values for ${propertyName}:`, err);\n      setPropertyValueOptions(prev => ({\n        ...prev,\n        [filterIdentifier + '_' + propertyName]: []\n      }));\n    }\n  };\n  const addOptionalFilter = () => {\n    setFilters(prev => ({\n      ...prev,\n      optional_filters: [...prev.optional_filters, {\n        id: Date.now().toString(),\n        property_name: '',\n        property_values: [],\n        property_source: 'event'\n      }]\n    }));\n  };\n  const removeOptionalFilter = idToRemove => {\n    setFilters(prev => ({\n      ...prev,\n      optional_filters: prev.optional_filters.filter(f => f.id !== idToRemove)\n    }));\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n    setAnalysisResult(null);\n    setUserTimelineData(null);\n    setTimelineError(null);\n\n    // Reset event revenue timeline state\n    setEventRevenueTimelineData(null);\n    setEventRevenueTimelineError(null);\n    setSelectedUserId('');\n    setSelectedProductId('');\n\n    // Reset warning state\n    setCohortDefinitionWarning(null);\n    try {\n      // Basic validation\n      if (!filters.date_from_str || !filters.date_to_str) {\n        throw new Error(\"Start Date and End Date are required.\");\n      }\n\n      // Remove the check that requires primary filter when secondary filters exist\n      // We'll allow analysis without a primary filter\n\n      // Check primary filter has values if property is selected\n      if (filters.optional_filters.length > 0 && filters.optional_filters[0].property_name && filters.optional_filters[0].property_values.length === 0) {\n        throw new Error(\"Please select values for the optional filters or clear the property selection.\");\n      }\n\n      // Validate secondary filters\n      for (const filter of filters.optional_filters) {\n        if (!filter.property_name || filter.property_values.length === 0) {\n          throw new Error(`Optional filter is incomplete. Please select both property and values for all filters or remove unused ones.`);\n        }\n      }\n\n      // Define precise cohort filtering requirements for the backend\n      // Define precise cohort filtering requirements for the backend\n      // This ensures ONLY users with a trial started event in the specified date range are included\n      const cohortFilters = {\n        ...filters,\n        enforce_trial_started: true,\n        // Add flag to inform backend to enforce trial started requirement\n        cohort_definition: {\n          required_event: \"RC Trial started\",\n          date_range: {\n            from: filters.date_from_str,\n            to: filters.date_to_str\n          },\n          strict_filtering: true // Only include events from users in this cohort\n        }\n      };\n      const result = await api.analyzeCohortData(cohortFilters);\n      if (result.error) {\n        setError(result.error);\n      } else {\n        // Verify that the backend properly applied our cohort definition\n        // by checking if trial_started user count matches the total cohort users\n        if (result.cohort_event_occurrence && result.cohort_event_occurrence.trial_started && result.summary_stats && result.summary_stats.total_users_in_final_cohort) {\n          const trialStartedUsers = result.cohort_event_occurrence.trial_started.user_count;\n          const totalCohortUsers = result.summary_stats.total_users_in_final_cohort;\n\n          // The counts should match if cohort definition was applied correctly\n          if (trialStartedUsers !== totalCohortUsers) {\n            const warningMessage = `Warning: Cohort definition may not be correctly applied. ` + `Cohort users (${totalCohortUsers}) should equal ` + `trial started users (${trialStartedUsers}).`;\n            console.warn(warningMessage);\n            setCohortDefinitionWarning(warningMessage);\n          }\n        }\n        setAnalysisResult(result);\n        // Fetch timeline data after successful analysis\n        fetchUserTimeline();\n        // Fetch event revenue timeline data (aggregate mode)\n        fetchEventRevenueTimeline();\n      }\n    } catch (err) {\n      console.error(\"Analysis error:\", err);\n      setError(err.message || \"Analysis failed. Please check that you have selected valid filter criteria.\");\n    }\n    setIsLoading(false);\n  };\n  const fetchUserTimeline = async () => {\n    setIsLoadingTimeline(true);\n    try {\n      console.log('[DEBUG] fetchUserTimeline called with filters:', filters);\n      // Use only the basic filters that the unified pipeline expects\n      const timelineData = await api.getCohortUserTimeline(filters);\n      console.log('[DEBUG] fetchUserTimeline response:', timelineData);\n      if (timelineData.error) {\n        console.log('[DEBUG] fetchUserTimeline error:', timelineData.error);\n        setTimelineError(timelineData.error);\n      } else {\n        console.log('[DEBUG] Setting userTimelineData:', timelineData);\n        setUserTimelineData(timelineData);\n      }\n    } catch (err) {\n      console.error(\"Timeline fetch error:\", err);\n      setTimelineError(err.message || \"Could not load user timeline data.\");\n    }\n    setIsLoadingTimeline(false);\n  };\n  const fetchEventRevenueTimeline = async (distinctId = null, productId = null) => {\n    setIsLoadingEventRevenueTimeline(true);\n    setEventRevenueTimelineError(null);\n    try {\n      console.log('[DEBUG] fetchEventRevenueTimeline called with filters:', filters, 'distinctId:', distinctId, 'productId:', productId);\n      // Use only the basic filters that the unified pipeline expects\n      const timelineData = await api.getUserEventRevenueTimeline(filters, distinctId, productId);\n      console.log('[DEBUG] fetchEventRevenueTimeline response:', timelineData);\n      if (timelineData.error) {\n        console.log('[DEBUG] fetchEventRevenueTimeline error:', timelineData.error);\n        setEventRevenueTimelineError(timelineData.error);\n      } else {\n        console.log('[DEBUG] Setting eventRevenueTimelineData:', timelineData);\n        setEventRevenueTimelineData(timelineData);\n\n        // Update available users and products from the response\n        if (timelineData.available_users) {\n          setAvailableUsers(timelineData.available_users);\n        }\n        if (timelineData.available_products) {\n          setAvailableProducts(timelineData.available_products);\n        }\n      }\n    } catch (err) {\n      console.error(\"Event revenue timeline fetch error:\", err);\n      setEventRevenueTimelineError(err.message || \"Could not load event revenue timeline data.\");\n    }\n    setIsLoadingEventRevenueTimeline(false);\n  };\n\n  // Function to determine cell state based on user's event history\n  // Returns the event state for a day (used for cell background color)\n  const getCellState = (userProductKey, date, eventMap) => {\n    // If this user has no events on this date, return default state\n    if (!eventMap[userProductKey] || !eventMap[userProductKey][date]) {\n      // Look for the most recent event before this date to maintain state\n      let mostRecentEventDate = null;\n      let mostRecentState = 'default';\n      if (eventMap[userProductKey]) {\n        // Find the most recent event before this date\n        for (const eventDate in eventMap[userProductKey]) {\n          if (eventDate <= date && (!mostRecentEventDate || eventDate > mostRecentEventDate)) {\n            mostRecentEventDate = eventDate;\n            // Get the last event of that day which would determine state going forward\n            const events = eventMap[userProductKey][eventDate];\n            const lastEvent = events[events.length - 1];\n\n            // Determine the state based on the last event\n            if (lastEvent.type === 'RC Trial started') {\n              mostRecentState = 'trial_started';\n            } else if (lastEvent.type === 'RC Trial converted') {\n              mostRecentState = 'trial_converted';\n            } else if (lastEvent.type === 'RC Trial cancelled') {\n              mostRecentState = 'trial_cancelled';\n            } else if (lastEvent.type === 'RC Initial purchase') {\n              mostRecentState = 'trial_converted'; // Use same color as trial converted\n            } else if (lastEvent.type === 'RC Renewal') {\n              mostRecentState = 'trial_converted'; // Use same color for renewals\n            } else if (lastEvent.type === 'RC Cancellation') {\n              mostRecentState = lastEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n            }\n          }\n        }\n      }\n      return mostRecentState;\n    }\n\n    // Get the first event for this user on this date (which determines cell color)\n    const firstEvent = eventMap[userProductKey][date][0];\n\n    // Return cell state based on the first event type\n    if (firstEvent.type === 'RC Trial started') {\n      return 'trial_started';\n    } else if (firstEvent.type === 'RC Trial converted') {\n      return 'trial_converted';\n    } else if (firstEvent.type === 'RC Trial cancelled') {\n      return 'trial_cancelled';\n    } else if (firstEvent.type === 'RC Initial purchase') {\n      return 'trial_converted'; // Use same color as trial converted for initial purchase\n    } else if (firstEvent.type === 'RC Renewal') {\n      return 'trial_converted'; // Use same color for renewals\n    } else if (firstEvent.type === 'RC Cancellation') {\n      // If cancellation has refund flag, use refunded color\n      return firstEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n    }\n    return 'default';\n  };\n\n  // Function to get events for a specific date (returns an array of events)\n  const getEventsForDate = (userProductKey, date, eventMap) => {\n    if (!eventMap[userProductKey] || !eventMap[userProductKey][date]) {\n      return [];\n    }\n    return eventMap[userProductKey][date];\n  };\n  const triggerPropertyDiscovery = async () => {\n    setActivePropertyDiscovery(true);\n    setPropertyDiscoveryMessage('Property discovery initiated...');\n    try {\n      const result = await api.triggerCohortPropertyDiscovery(); // Updated API method name\n      setPropertyDiscoveryMessage(result.message + \" Refresh page after a few moments to see updated filter options.\");\n      // Optionally, could poll for completion or auto-refresh discoverable props\n      setTimeout(() => fetchDiscoverableProperties(), 5000); // Re-fetch after a delay\n    } catch (err) {\n      setPropertyDiscoveryMessage('Error triggering discovery: ' + (err.message || 'Unknown error'));\n    }\n    // setActivePropertyDiscovery(false); // Keep message displayed\n  };\n  const renderLifecycleTable = (title, ratesData, denominatorKey = \"rate_denominator_count\") => {\n    // Add debugging\n    console.log(`[DEBUG] renderLifecycleTable called for \"${title}\"`);\n    console.log(`[DEBUG] ratesData:`, ratesData);\n    if (!ratesData) {\n      console.log(`[DEBUG] No ratesData for \"${title}\"`);\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-500 dark:text-gray-300\",\n        children: [\"Lifecycle rate data not available for \", title, \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 840,\n        columnNumber: 20\n      }, this);\n    }\n\n    // Handle new product-based format\n    const isNewFormat = ratesData.rates_by_product || ratesData.aggregate_rates;\n    console.log(`[DEBUG] isNewFormat: ${isNewFormat} for \"${title}\"`);\n    if (isNewFormat) {\n      const aggregateRates = ratesData.aggregate_rates;\n      const productRates = ratesData.rates_by_product || {};\n      console.log(`[DEBUG] aggregateRates:`, aggregateRates);\n      console.log(`[DEBUG] productRates:`, productRates);\n      if (!aggregateRates || !aggregateRates.rates_by_day || Object.keys(aggregateRates.rates_by_day).length === 0) {\n        console.log(`[DEBUG] No valid aggregateRates for \"${title}\"`);\n\n        // Show raw data for debugging\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-lg font-semibold text-gray-900 dark:text-white mb-2\",\n            children: [title, \" - Debug Info\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 860,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 dark:text-gray-400 mb-2\",\n            children: \"Raw data structure (for debugging):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 861,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n            className: \"text-xs bg-gray-100 dark:bg-gray-800 p-2 rounded overflow-x-auto\",\n            children: JSON.stringify(ratesData, null, 2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 862,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 859,\n          columnNumber: 21\n        }, this);\n      }\n\n      // Determine which rates to display based on global product selector\n      const displayRates = globalSelectedProduct && productRates[globalSelectedProduct] ? productRates[globalSelectedProduct] : aggregateRates;\n      const ratesByDay = displayRates.rates_by_day;\n      const sortedDays = Object.keys(ratesByDay).map(Number).sort((a, b) => a - b);\n\n      // Prepare row data for the transposed table\n      const rowData = [{\n        metric: \"Raw Daily Cancellation %\",\n        dataKey: \"raw_daily_cancellation_rate\"\n      }, {\n        metric: \"Smoothed Daily Cancellation %\",\n        dataKey: \"smoothed_daily_cancellation_rate\"\n      }, {\n        metric: \"Raw Cumulative Cancellation %\",\n        dataKey: \"raw_cumulative_cancellation_rate\"\n      }, {\n        metric: \"Smoothed Cumulative Cancellation %\",\n        dataKey: \"smoothed_cumulative_cancellation_rate\"\n      }, {\n        metric: \"Raw Daily Refund %\",\n        dataKey: \"raw_daily_refund_rate\"\n      }, {\n        metric: \"Smoothed Daily Refund %\",\n        dataKey: \"smoothed_daily_refund_rate\"\n      }, {\n        metric: \"Raw Cumulative Refund %\",\n        dataKey: \"raw_cumulative_refund_rate\"\n      }, {\n        metric: \"Smoothed Cumulative Refund %\",\n        dataKey: \"smoothed_cumulative_refund_rate\"\n      }];\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-lg font-semibold text-gray-900 dark:text-white mb-4\",\n          children: title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 915,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"font-semibold text-blue-800 dark:text-blue-200 mb-2\",\n            children: \"Smoothing Method Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 919,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Method:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 922,\n                  columnNumber: 36\n                }, this), \" \", displayRates.smoothing_method || 'none']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 922,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Quality:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 923,\n                  columnNumber: 36\n                }, this), \" \", displayRates.smoothing_quality || 'N/A']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 923,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Sample Size:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 924,\n                  columnNumber: 36\n                }, this), \" \", displayRates.total_sample_size || 0]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 924,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 921,\n              columnNumber: 29\n            }, this), displayRates.smoothing_details && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Data Characteristics:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 928,\n                  columnNumber: 40\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 928,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"ml-4 mt-1\",\n                children: displayRates.smoothing_details.cancellation && /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                    children: [\"Early Concentration: \", displayRates.smoothing_details.cancellation.early_concentration]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 932,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                    children: [\"Sparsity: \", displayRates.smoothing_details.cancellation.sparsity]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 933,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                    children: [\"Max Rate: \", displayRates.smoothing_details.cancellation.max_rate]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 934,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 929,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 927,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 920,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 918,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700\",\n                children: \"Metric\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 948,\n                columnNumber: 33\n              }, this), rowData.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ${index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'} text-gray-900 dark:text-white font-medium`,\n                children: row.metric\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 952,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 947,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1 overflow-x-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex\",\n                children: sortedDays.map(day => {\n                  const dayStr = day.toString();\n                  const dayData = ratesByDay[dayStr];\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700\",\n                      children: [\"Day \", day]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 970,\n                      columnNumber: 49\n                    }, this), rowData.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: `px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ${index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'} text-gray-500 dark:text-gray-300`,\n                      children: [dayData ? (dayData[row.dataKey] || 0).toFixed(2) : '0.00', \"%\"]\n                    }, index, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 976,\n                      columnNumber: 53\n                    }, this))]\n                  }, dayStr, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 968,\n                    columnNumber: 45\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 962,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 961,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 945,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 944,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 914,\n        columnNumber: 17\n      }, this);\n    }\n\n    // Fall back to legacy format handling if needed\n    if (!ratesData.rates_by_day || Object.keys(ratesData.rates_by_day).length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-500 dark:text-gray-300\",\n        children: [\"No lifecycle rate data available for \", title, \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 995,\n        columnNumber: 20\n      }, this);\n    }\n    const sortedDays = Object.keys(ratesData.rates_by_day).map(Number).sort((a, b) => a - b);\n    const ratesDenominator = ratesData[denominatorKey] || 0;\n\n    // Legacy format with transposed layout\n    const legacyRowData = [{\n      metric: \"Daily Cancel %\",\n      dataKey: \"cancelled_daily_pct\"\n    }, {\n      metric: \"Cumulative Cancel %\",\n      dataKey: \"cancelled_cumulative_pct\"\n    }, {\n      metric: \"Daily Convert %\",\n      dataKey: \"converted_daily_pct\"\n    }, {\n      metric: \"Cumulative Convert %\",\n      dataKey: \"converted_cumulative_pct\"\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-lg font-semibold mb-2 text-gray-900 dark:text-white\",\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1011,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-600 dark:text-gray-400 mb-3\",\n        children: [\"Based on \", ratesDenominator, \" users. \", ratesData.message]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1012,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700\",\n              children: \"Metric\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1021,\n              columnNumber: 29\n            }, this), legacyRowData.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ${index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'} text-gray-900 dark:text-white font-medium`,\n              children: row.metric\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1025,\n              columnNumber: 33\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1020,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-x-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: sortedDays.map(day => {\n                const dayStr = day.toString();\n                const dayData = ratesData.rates_by_day[dayStr];\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700\",\n                    children: [\"Day \", day]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1043,\n                    columnNumber: 45\n                  }, this), legacyRowData.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ${index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'} text-gray-500 dark:text-gray-300`,\n                    children: [dayData ? (dayData[row.dataKey] || 0).toFixed(2) : '0.00', \"%\"]\n                  }, index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1049,\n                    columnNumber: 49\n                  }, this))]\n                }, dayStr, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1041,\n                  columnNumber: 41\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1035,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1034,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1017,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1010,\n      columnNumber: 13\n    }, this);\n  };\n  const formatCurrency = value => {\n    if (value === null || value === undefined) return \"N/A\";\n    return value.toLocaleString('en-US', {\n      style: 'currency',\n      currency: 'USD'\n    });\n  };\n\n  // Prepare data for the chart\n  const chartData = (analysisResult === null || analysisResult === void 0 ? void 0 : analysisResult.daily_data.map(d => {\n    const actualNetRevenue = d.cumulative_revenue_actual_net || 0;\n    // Dotted line: actual net cumulative revenue + (estimated additional from pending trials) + (net effect of estimated future refunds on actual revenue)\n    // The estimated_future_refunds_on_actual_revenue_amount is an *amount* to be subtracted.\n    const projectedNetRevenue = actualNetRevenue + (d.estimated_additional_revenue_from_pending_trials_net_refund || 0) - (d.estimated_future_refunds_on_actual_revenue_amount || 0);\n    const trialsStarted = d.daily_trials_started || 0;\n    const trialsConverted = d.daily_trials_converted_actual || 0;\n    const trialsCancelled = d.daily_trials_cancelled_actual || 0;\n    const trialsEnded = trialsConverted + trialsCancelled;\n    const trialsPending = d.daily_trials_started - trialsEnded;\n    return {\n      date: d.date,\n      // Absolute values - Daily\n      daily_trials_started: trialsStarted,\n      daily_trials_ended: trialsEnded,\n      daily_trials_pending: trialsPending,\n      daily_conversions: trialsConverted,\n      daily_conversions_net_refunds: trialsConverted - (d.daily_refund_count_actual || 0),\n      daily_estimated_conversions_net_refunds: trialsConverted - (d.daily_estimated_refunds || 0),\n      daily_refunds: d.daily_refund_count_actual || 0,\n      // Money values - Daily\n      daily_revenue: d.daily_revenue_actual || 0,\n      daily_revenue_net: d.daily_revenue_actual_net || 0,\n      daily_estimated_revenue: d.daily_estimated_revenue || 0,\n      // Absolute values - Cumulative\n      cumulative_trials_started: d.cumulative_trials_started || 0,\n      cumulative_trials_ended: (d.cumulative_trials_converted_actual || 0) + (d.cumulative_trials_cancelled_actual || 0),\n      cumulative_trials_pending: d.cumulative_trials_started - ((d.cumulative_trials_converted_actual || 0) + (d.cumulative_trials_cancelled_actual || 0)),\n      cumulative_conversions: d.cumulative_trials_converted_actual || 0,\n      cumulative_conversions_net_refunds: (d.cumulative_trials_converted_actual || 0) - (d.cumulative_refund_count_actual || 0),\n      cumulative_estimated_conversions_net_refunds: (d.cumulative_trials_converted_actual || 0) - (d.cumulative_estimated_refunds || 0),\n      cumulative_refunds: d.cumulative_refund_count_actual || 0,\n      // Money values - Cumulative\n      cumulative_revenue: d.cumulative_revenue_actual || 0,\n      cumulative_revenue_net: actualNetRevenue,\n      cumulative_estimated_revenue: projectedNetRevenue\n    };\n  })) || [];\n  const [visibleAbsoluteMetrics, setVisibleAbsoluteMetrics] = useState({\n    daily_trials_started: true,\n    daily_trials_ended: false,\n    daily_trials_pending: false,\n    daily_conversions: true,\n    daily_conversions_net_refunds: false,\n    daily_estimated_conversions_net_refunds: false,\n    daily_refunds: false,\n    cumulative_trials_started: true,\n    cumulative_trials_ended: false,\n    cumulative_trials_pending: false,\n    cumulative_conversions: true,\n    cumulative_conversions_net_refunds: false,\n    cumulative_estimated_conversions_net_refunds: false,\n    cumulative_refunds: false\n  });\n  const [visibleMoneyMetrics, setVisibleMoneyMetrics] = useState({\n    daily_revenue: true,\n    daily_revenue_net: false,\n    daily_estimated_revenue: false,\n    cumulative_revenue: false,\n    cumulative_revenue_net: true,\n    cumulative_estimated_revenue: true\n  });\n  const toggleAbsoluteMetric = metricKey => {\n    setVisibleAbsoluteMetrics(prev => ({\n      ...prev,\n      [metricKey]: !prev[metricKey]\n    }));\n  };\n  const toggleMoneyMetric = metricKey => {\n    setVisibleMoneyMetrics(prev => ({\n      ...prev,\n      [metricKey]: !prev[metricKey]\n    }));\n  };\n\n  // Add this function to determine which styles to use based on dark mode detection\n  const getSelectTheme = () => {\n    const isDarkMode = document.documentElement.classList.contains('dark') || window.matchMedia('(prefers-color-scheme: dark)').matches;\n    return isDarkMode ? darkModeSelectStyles : customSelectStyles;\n  };\n\n  // Chart Modal Component\n  const ChartModal = () => {\n    if (!showChartModal || !(analysisResult !== null && analysisResult !== void 0 && analysisResult.lifecycle_rates)) return null;\n    const lifecycleRates = analysisResult.lifecycle_rates;\n\n    // Get chart data for different scenarios\n    const getChartData = (ratesData, title, type = 'cancellation_refund') => {\n      if (!(ratesData !== null && ratesData !== void 0 && ratesData.rates_by_day)) return null;\n      const days = Object.keys(ratesData.rates_by_day).map(Number).sort((a, b) => a - b);\n      let datasets = [];\n      if (type === 'cancellation_refund') {\n        // Cancellation/Refund scenario\n        datasets = [{\n          label: 'Raw Cumulative Cancellation %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d;\n            return ((_ratesData$rates_by_d = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d === void 0 ? void 0 : _ratesData$rates_by_d.raw_cumulative_cancellation_rate) || 0;\n          }),\n          borderColor: 'rgb(255, 99, 132)',\n          backgroundColor: 'rgba(255, 99, 132, 0.1)',\n          borderDash: [],\n          tension: 0.1\n        }, {\n          label: 'Smoothed Cumulative Cancellation %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d2;\n            return ((_ratesData$rates_by_d2 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d2 === void 0 ? void 0 : _ratesData$rates_by_d2.smoothed_cumulative_cancellation_rate) || 0;\n          }),\n          borderColor: 'rgb(255, 99, 132)',\n          backgroundColor: 'rgba(255, 99, 132, 0.3)',\n          borderDash: [5, 5],\n          tension: 0.1\n        }, {\n          label: 'Raw Cumulative Refund %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d3;\n            return ((_ratesData$rates_by_d3 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d3 === void 0 ? void 0 : _ratesData$rates_by_d3.raw_cumulative_refund_rate) || 0;\n          }),\n          borderColor: 'rgb(54, 162, 235)',\n          backgroundColor: 'rgba(54, 162, 235, 0.1)',\n          borderDash: [],\n          tension: 0.1\n        }, {\n          label: 'Smoothed Cumulative Refund %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d4;\n            return ((_ratesData$rates_by_d4 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d4 === void 0 ? void 0 : _ratesData$rates_by_d4.smoothed_cumulative_refund_rate) || 0;\n          }),\n          borderColor: 'rgb(54, 162, 235)',\n          backgroundColor: 'rgba(54, 162, 235, 0.3)',\n          borderDash: [5, 5],\n          tension: 0.1\n        }];\n      } else if (type === 'conversion_cancellation') {\n        // Trial Conversion/Cancellation scenario\n        datasets = [{\n          label: 'Raw Cumulative Conversion %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d5;\n            return ((_ratesData$rates_by_d5 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d5 === void 0 ? void 0 : _ratesData$rates_by_d5.raw_cumulative_conversion_rate) || 0;\n          }),\n          borderColor: 'rgb(75, 192, 192)',\n          backgroundColor: 'rgba(75, 192, 192, 0.1)',\n          borderDash: [],\n          tension: 0.1\n        }, {\n          label: 'Smoothed Cumulative Conversion %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d6;\n            return ((_ratesData$rates_by_d6 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d6 === void 0 ? void 0 : _ratesData$rates_by_d6.smoothed_cumulative_conversion_rate) || 0;\n          }),\n          borderColor: 'rgb(75, 192, 192)',\n          backgroundColor: 'rgba(75, 192, 192, 0.3)',\n          borderDash: [5, 5],\n          tension: 0.1\n        }, {\n          label: 'Raw Cumulative Cancellation %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d7;\n            return ((_ratesData$rates_by_d7 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d7 === void 0 ? void 0 : _ratesData$rates_by_d7.raw_cumulative_cancellation_rate) || 0;\n          }),\n          borderColor: 'rgb(255, 99, 132)',\n          backgroundColor: 'rgba(255, 99, 132, 0.1)',\n          borderDash: [],\n          tension: 0.1\n        }, {\n          label: 'Smoothed Cumulative Cancellation %',\n          data: days.map(day => {\n            var _ratesData$rates_by_d8;\n            return ((_ratesData$rates_by_d8 = ratesData.rates_by_day[day.toString()]) === null || _ratesData$rates_by_d8 === void 0 ? void 0 : _ratesData$rates_by_d8.smoothed_cumulative_cancellation_rate) || 0;\n          }),\n          borderColor: 'rgb(255, 99, 132)',\n          backgroundColor: 'rgba(255, 99, 132, 0.3)',\n          borderDash: [5, 5],\n          tension: 0.1\n        }];\n      }\n      return {\n        labels: days.map(day => `Day ${day}`),\n        datasets: datasets\n      };\n    };\n    const chartOptions = {\n      responsive: true,\n      plugins: {\n        legend: {\n          position: 'top'\n        },\n        title: {\n          display: true,\n          text: 'Raw vs Smoothed Cumulative Rates'\n        }\n      },\n      scales: {\n        y: {\n          beginAtZero: true,\n          title: {\n            display: true,\n            text: 'Percentage (%)'\n          }\n        },\n        x: {\n          title: {\n            display: true,\n            text: 'Days'\n          }\n        }\n      }\n    };\n\n    // Determine which rates to use based on global product selector\n    const getDisplayRates = ratesData => {\n      if (!ratesData) return null;\n      if (globalSelectedProduct && ratesData.rates_by_product && ratesData.rates_by_product[globalSelectedProduct]) {\n        return ratesData.rates_by_product[globalSelectedProduct];\n      }\n      return ratesData.aggregate_rates || ratesData;\n    };\n    const trialToOutcomeRates = getDisplayRates(lifecycleRates.trial_to_outcome_rates);\n    const cancellationRefundRates = getDisplayRates(lifecycleRates.trial_to_cancellation_rates || lifecycleRates.trial_to_refund_rates);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between items-center mb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl font-bold text-gray-900 dark:text-white\",\n              children: \"Lifecycle Rate Charts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1298,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowChartModal(false),\n              className: \"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\",\n              children: /*#__PURE__*/_jsxDEV(XCircle, {\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1305,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1301,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1297,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 lg:grid-cols-2 gap-6\",\n            children: [trialToOutcomeRates && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-semibold mb-4 text-gray-900 dark:text-white\",\n                children: \"Trial to Outcome (Conversion vs Cancellation)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1313,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(ChartLine, {\n                data: getChartData(trialToOutcomeRates, 'Trial to Outcome', 'conversion_cancellation'),\n                options: chartOptions\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1316,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1312,\n              columnNumber: 33\n            }, this), cancellationRefundRates && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-semibold mb-4 text-gray-900 dark:text-white\",\n                children: \"Cancellation vs Refund Rates\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1326,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(ChartLine, {\n                data: getChartData(cancellationRefundRates, 'Cancellation vs Refund', 'cancellation_refund'),\n                options: chartOptions\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1329,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1325,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1309,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-6 text-sm text-gray-600 dark:text-gray-400\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Legend:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1338,\n                columnNumber: 32\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1338,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list-disc list-inside mt-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Solid lines represent raw data\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1340,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Dashed lines represent smoothed curves\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1341,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"The smoothing algorithm first smooths cumulative rates, then derives daily rates\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1342,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1339,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1337,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1296,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1295,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1294,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 max-w-full mx-auto bg-white dark:bg-gray-800 min-h-screen\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 border-gray-200 dark:border-gray-600\",\n      children: \"Cohort Analyzer\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1353,\n      columnNumber: 13\n    }, this), isInitializing ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md\",\n      children: [/*#__PURE__*/_jsxDEV(Loader, {\n        className: \"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1357,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-700 dark:text-white\",\n        children: \"Initializing cohort analyzer...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1358,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1356,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6 border-b border-gray-200 dark:border-gray-600 pb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"date_from_str\",\n            className: \"block text-sm font-medium text-gray-700 dark:text-white mb-2\",\n            children: \"Start Date *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1364,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            id: \"date_from_str\",\n            value: filters.date_from_str,\n            onChange: e => handleFilterChange('date_from_str', e.target.value),\n            className: \"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1365,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1363,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"date_to_str\",\n            className: \"block text-sm font-medium text-gray-700 dark:text-white mb-2\",\n            children: \"End Date *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1369,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            id: \"date_to_str\",\n            value: filters.date_to_str,\n            onChange: e => handleFilterChange('date_to_str', e.target.value),\n            className: \"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1370,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1368,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1362,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6 p-5 border rounded-md border-teal-200 dark:border-teal-500 bg-teal-50 dark:bg-teal-900/40\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-gray-800 dark:text-white\",\n            children: \"Additional Event/User Property Filters\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1378,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: addOptionalFilter,\n            className: \"p-1.5 bg-teal-100 dark:bg-teal-600 text-teal-700 dark:text-white rounded-full hover:bg-teal-200 dark:hover:bg-teal-500 transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(PlusCircle, {\n              size: 18\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1384,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1379,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1377,\n          columnNumber: 25\n        }, this), filters.optional_filters.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600 dark:text-gray-300 italic mb-2\",\n          children: \"No additional filters. Click the + button to add a filter.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1388,\n          columnNumber: 29\n        }, this), filters.optional_filters.map((filter, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-4 gap-3 items-end mb-4 p-4 border-t dark:border-gray-600 bg-white dark:bg-gray-600 rounded-md shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-xs font-medium text-gray-600 dark:text-white mb-1\",\n              children: \"Source Type\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1393,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: filter.property_source,\n              onChange: e => handleFilterChange(`optional_filter_source`, e.target.value, index),\n              className: \"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"event\",\n                children: \"Event Property\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1397,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"user\",\n                children: \"User Property\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1398,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1394,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1392,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-xs font-medium text-gray-600 dark:text-white mb-1\",\n              children: \"Property Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1402,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: filter.property_name,\n              onChange: e => handleFilterChange(`optional_filter_property`, e.target.value, index),\n              className: \"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"-- Select Property --\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1406,\n                columnNumber: 41\n              }, this), (filter.property_source === 'event' ? availableEventProperties : availableUserProperties).map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: p.key,\n                children: p.display_name || p.key\n              }, p.key, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1407,\n                columnNumber: 141\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1403,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1401,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-xs font-medium text-gray-600 dark:text-white mb-1\",\n              children: \"Property Value(s)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1411,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              isMulti: true,\n              isDisabled: !filter.property_name || !filter.property_source,\n              options: (propertyValueOptions[`optional_filter_${index}_` + filter.property_name] || []).map(val => ({\n                value: val,\n                label: val\n              })),\n              value: filter.property_values.map(val => ({\n                value: val,\n                label: val\n              })),\n              onChange: selected => handleFilterChange(`optional_filter_values`, selected ? selected.map(option => option.value) : [], index),\n              styles: getSelectTheme(),\n              placeholder: \"Select values...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1412,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1410,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => removeOptionalFilter(filter.id),\n              className: \"p-1.5 bg-red-100 dark:bg-red-700 text-red-600 dark:text-white rounded-full hover:bg-red-200 dark:hover:bg-red-600 transition-colors\",\n              children: /*#__PURE__*/_jsxDEV(XCircle, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1425,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1423,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1422,\n            columnNumber: 33\n          }, this)]\n        }, filter.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1391,\n          columnNumber: 29\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1376,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mt-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: isLoading,\n          className: \"px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-md shadow hover:bg-indigo-700 disabled:opacity-50 flex items-center transition-colors\",\n          children: isLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Loader, {\n              className: \"animate-spin mr-2\",\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1437,\n              columnNumber: 37\n            }, this), \"Analyzing...\"]\n          }, void 0, true) : 'Analyze Cohort'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1433,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: triggerPropertyDiscovery,\n          disabled: activePropertyDiscovery,\n          className: \"px-5 py-2.5 bg-teal-600 text-white text-sm font-medium rounded-md hover:bg-teal-700 disabled:opacity-50 flex items-center transition-colors\",\n          children: activePropertyDiscovery ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Loader, {\n              className: \"animate-spin mr-2\",\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1446,\n              columnNumber: 37\n            }, this), \"Discovery Running...\"]\n          }, void 0, true) : \"Discover Filter Properties\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1442,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1432,\n        columnNumber: 21\n      }, this), propertyDiscoveryMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3 p-3 bg-teal-50 dark:bg-teal-900/40 border border-teal-200 dark:border-teal-600 rounded-md\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-teal-700 dark:text-teal-300\",\n          children: propertyDiscoveryMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1454,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1453,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1361,\n      columnNumber: 17\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-4 p-4 bg-red-100 dark:bg-red-800 text-red-700 dark:text-white rounded-md shadow-md border border-red-300 dark:border-red-600\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n          className: \"mr-2 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1463,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium block\",\n            children: \"Analysis Error:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1465,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"block mt-1\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1466,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1464,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1462,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1461,\n      columnNumber: 17\n    }, this), cohortDefinitionWarning && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n          className: \"mr-2 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1475,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium block\",\n            children: \"Cohort Definition Warning:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1477,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"block mt-1\",\n            children: cohortDefinitionWarning\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1478,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"block mt-1 text-sm italic\",\n            children: \"The backend may not be correctly filtering users based on trial started events.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1479,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1476,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1474,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1473,\n      columnNumber: 17\n    }, this), analysisResult && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-4 text-gray-800 dark:text-white\",\n        children: \"Analysis Results\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1487,\n        columnNumber: 21\n      }, this), analysisResult.filter_stats && /*#__PURE__*/_jsxDEV(FilterStatsDisplay, {\n        filterStats: analysisResult.filter_stats\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1491,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-700 dark:text-white\",\n            children: \"Cohort Users (Trial Started)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1496,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-2xl font-bold text-indigo-600 dark:text-indigo-300\",\n            children: ((_analysisResult$summa = analysisResult.summary_stats) === null || _analysisResult$summa === void 0 ? void 0 : _analysisResult$summa.total_users_in_final_cohort) || 0\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1497,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 dark:text-gray-300\",\n            children: \"Unique users who had an 'RC Trial started' event in the selected date range (and match primary filter if applied).\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1498,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1495,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-700 dark:text-white\",\n            children: \"Events Analyzed (Cohort Only)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1501,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-2xl font-bold text-indigo-600 dark:text-indigo-300\",\n            children: ((_analysisResult$summa2 = analysisResult.summary_stats) === null || _analysisResult$summa2 === void 0 ? void 0 : _analysisResult$summa2.total_events_analyzed) || 0\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1502,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 dark:text-gray-300\",\n            children: \"Events from users in the trial started cohort\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1503,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1500,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-700 dark:text-white\",\n            children: \"Cohort ARPC (Overall)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1506,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-2xl font-bold text-indigo-600 dark:text-indigo-300\",\n            children: formatCurrency((_analysisResult$summa3 = analysisResult.summary_stats) === null || _analysisResult$summa3 === void 0 ? void 0 : _analysisResult$summa3.arpc_cohort)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1507,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 dark:text-gray-300\",\n            children: [\"Basis: \", (_analysisResult$summa4 = analysisResult.summary_stats) === null || _analysisResult$summa4 === void 0 ? void 0 : _analysisResult$summa4.arpc_datapoints, \" users. \", (_analysisResult$summa5 = analysisResult.summary_stats) === null || _analysisResult$summa5 === void 0 ? void 0 : _analysisResult$summa5.arpc_calculation_basis]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1508,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 dark:text-gray-300 italic\",\n            children: \"See per-product breakdown below\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1509,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1505,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1494,\n        columnNumber: 21\n      }, this), eventRevenueTimelineData && eventRevenueTimelineData.arpc_per_product && Object.keys(eventRevenueTimelineData.arpc_per_product).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-gray-700 dark:text-white mb-3\",\n          children: \"ARPC Per Product\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1516,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-50 dark:bg-gray-600 rounded-lg p-3\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3\",\n            children: Object.entries(eventRevenueTimelineData.arpc_per_product).map(([productId, arpcData]) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-white dark:bg-gray-700 rounded-md p-3 border border-gray-200 dark:border-gray-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs font-medium text-gray-600 dark:text-gray-300 truncate\",\n                title: productId,\n                children: productId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1521,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-lg font-bold text-green-600 dark:text-green-400 leading-tight\",\n                children: typeof arpcData === 'object' ? formatCurrency(arpcData.arpc) : formatCurrency(arpcData)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1524,\n                columnNumber: 45\n              }, this), typeof arpcData === 'object' && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-500 dark:text-gray-400 mt-1 space-y-0.5\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [arpcData.event_count, \" events\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1529,\n                  columnNumber: 53\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [arpcData.unique_users, \" users\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1530,\n                  columnNumber: 53\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: formatCurrency(arpcData.total_revenue)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1531,\n                  columnNumber: 53\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1528,\n                columnNumber: 49\n              }, this)]\n            }, productId, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1520,\n              columnNumber: 41\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1518,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1517,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1515,\n        columnNumber: 25\n      }, this), analysisResult.event_user_counts && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-gray-700 dark:text-white mb-3\",\n          children: \"Unique Users Per Event Type\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1543,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-x-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full text-sm border dark:border-gray-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"bg-gray-50 dark:bg-gray-700\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"Event Type\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1548,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"Unique Users\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1549,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"Total Events\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1550,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"Events Per User\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1551,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1547,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1546,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              className: \"bg-white dark:bg-gray-800\",\n              children: Object.entries(analysisResult.event_user_counts).map(([eventType, counts], index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: index % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700',\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n                  children: eventType\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1557,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: counts.unique_users || 0\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1558,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: counts.total_events || 0\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1559,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: counts.unique_users > 0 ? (counts.total_events / counts.unique_users).toFixed(2) : '0.00'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1560,\n                  columnNumber: 49\n                }, this)]\n              }, eventType, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1556,\n                columnNumber: 45\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1554,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1545,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1544,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1542,\n        columnNumber: 25\n      }, this), analysisResult.cohort_event_occurrence && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-gray-700 dark:text-white mb-3\",\n          children: \"Cohort Event Occurrence\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1574,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600 dark:text-gray-300 mb-2\",\n          children: [\"Number of users in the cohort who have had each event at least once.\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"italic\",\n            children: \" Note: Cohort is defined as users in the database who have a \\\"Trial started\\\" event within the selected date range. All other users are excluded.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1577,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1575,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-x-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full text-sm border dark:border-gray-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"bg-gray-50 dark:bg-gray-700\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"Event\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1583,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"User Count\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1584,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\",\n                  children: \"% of Cohort\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1585,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1582,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1581,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              className: \"bg-white dark:bg-gray-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-indigo-50 dark:bg-indigo-900/30\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-white\",\n                  children: \"Trial Started\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1591,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor = analysisResult.cohort_event_occurrence.trial_started) === null || _analysisResult$cohor === void 0 ? void 0 : (_analysisResult$cohor2 = _analysisResult$cohor.user_count) === null || _analysisResult$cohor2 === void 0 ? void 0 : _analysisResult$cohor2.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1592,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: \"100%\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1595,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1590,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"Trial Ended (Total)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1602,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor3 = analysisResult.cohort_event_occurrence.trial_ended) === null || _analysisResult$cohor3 === void 0 ? void 0 : (_analysisResult$cohor4 = _analysisResult$cohor3.user_count) === null || _analysisResult$cohor4 === void 0 ? void 0 : _analysisResult$cohor4.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1603,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor5 = analysisResult.cohort_event_occurrence.trial_ended) !== null && _analysisResult$cohor5 !== void 0 && _analysisResult$cohor5.percentage ? analysisResult.cohort_event_occurrence.trial_ended.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1606,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1601,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-50 dark:bg-gray-700 pl-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\",\n                  children: \"\\u2192 Trial Converted\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1614,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor6 = analysisResult.cohort_event_occurrence.trial_converted) === null || _analysisResult$cohor6 === void 0 ? void 0 : (_analysisResult$cohor7 = _analysisResult$cohor6.user_count) === null || _analysisResult$cohor7 === void 0 ? void 0 : _analysisResult$cohor7.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1615,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor8 = analysisResult.cohort_event_occurrence.trial_converted) !== null && _analysisResult$cohor8 !== void 0 && _analysisResult$cohor8.percentage ? analysisResult.cohort_event_occurrence.trial_converted.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1618,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1613,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-50 dark:bg-gray-700\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\",\n                  children: \"\\u2192 Trial Cancelled\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1626,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor9 = analysisResult.cohort_event_occurrence.trial_cancelled) === null || _analysisResult$cohor9 === void 0 ? void 0 : (_analysisResult$cohor0 = _analysisResult$cohor9.user_count) === null || _analysisResult$cohor0 === void 0 ? void 0 : _analysisResult$cohor0.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1627,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor1 = analysisResult.cohort_event_occurrence.trial_cancelled) !== null && _analysisResult$cohor1 !== void 0 && _analysisResult$cohor1.percentage ? analysisResult.cohort_event_occurrence.trial_cancelled.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1630,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1625,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"Initial Purchase\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1638,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor10 = analysisResult.cohort_event_occurrence.initial_purchase) === null || _analysisResult$cohor10 === void 0 ? void 0 : (_analysisResult$cohor11 = _analysisResult$cohor10.user_count) === null || _analysisResult$cohor11 === void 0 ? void 0 : _analysisResult$cohor11.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1639,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor12 = analysisResult.cohort_event_occurrence.initial_purchase) !== null && _analysisResult$cohor12 !== void 0 && _analysisResult$cohor12.percentage ? analysisResult.cohort_event_occurrence.initial_purchase.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1642,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1637,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-50 dark:bg-gray-700\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"Renewal\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1650,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor13 = analysisResult.cohort_event_occurrence.renewal) === null || _analysisResult$cohor13 === void 0 ? void 0 : (_analysisResult$cohor14 = _analysisResult$cohor13.user_count) === null || _analysisResult$cohor14 === void 0 ? void 0 : _analysisResult$cohor14.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1651,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor15 = analysisResult.cohort_event_occurrence.renewal) !== null && _analysisResult$cohor15 !== void 0 && _analysisResult$cohor15.percentage ? analysisResult.cohort_event_occurrence.renewal.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1654,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1649,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\",\n                  children: \"RC Cancellation (Total)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1662,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor16 = analysisResult.cohort_event_occurrence.rc_cancellation) === null || _analysisResult$cohor16 === void 0 ? void 0 : (_analysisResult$cohor17 = _analysisResult$cohor16.user_count) === null || _analysisResult$cohor17 === void 0 ? void 0 : _analysisResult$cohor17.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1663,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor18 = analysisResult.cohort_event_occurrence.rc_cancellation) !== null && _analysisResult$cohor18 !== void 0 && _analysisResult$cohor18.percentage ? analysisResult.cohort_event_occurrence.rc_cancellation.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1666,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1661,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-50 dark:bg-gray-700\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\",\n                  children: \"\\u2192 Refund (revenue < 0)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1674,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor19 = analysisResult.cohort_event_occurrence.rc_refund) === null || _analysisResult$cohor19 === void 0 ? void 0 : (_analysisResult$cohor20 = _analysisResult$cohor19.user_count) === null || _analysisResult$cohor20 === void 0 ? void 0 : _analysisResult$cohor20.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1675,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor21 = analysisResult.cohort_event_occurrence.rc_refund) !== null && _analysisResult$cohor21 !== void 0 && _analysisResult$cohor21.percentage ? analysisResult.cohort_event_occurrence.rc_refund.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1678,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1673,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-50 dark:bg-gray-700\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\",\n                  children: \"\\u2192 Cancelled (revenue = 0)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1686,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: ((_analysisResult$cohor22 = analysisResult.cohort_event_occurrence.rc_cancel_no_refund) === null || _analysisResult$cohor22 === void 0 ? void 0 : (_analysisResult$cohor23 = _analysisResult$cohor22.user_count) === null || _analysisResult$cohor23 === void 0 ? void 0 : _analysisResult$cohor23.toLocaleString()) || '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1687,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\",\n                  children: (_analysisResult$cohor24 = analysisResult.cohort_event_occurrence.rc_cancel_no_refund) !== null && _analysisResult$cohor24 !== void 0 && _analysisResult$cohor24.percentage ? analysisResult.cohort_event_occurrence.rc_cancel_no_refund.percentage.toFixed(1) + '%' : '0%'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1690,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1685,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1588,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1580,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1579,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1573,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowLifecycleTables(!showLifecycleTables),\n          className: \"text-indigo-600 dark:text-indigo-300 hover:underline text-sm mb-2\",\n          children: [showLifecycleTables ? /*#__PURE__*/_jsxDEV(ChevronDown, {\n            className: \"inline mr-1\",\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1704,\n            columnNumber: 52\n          }, this) : /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: \"inline mr-1\",\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1704,\n            columnNumber: 103\n          }, this), \"Show/Hide Lifecycle Rate Tables\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1702,\n          columnNumber: 25\n        }, this), (() => {\n          console.log('[DEBUG] showLifecycleTables:', showLifecycleTables, 'lifecycle_rates exists:', !!(analysisResult !== null && analysisResult !== void 0 && analysisResult.lifecycle_rates));\n          if (showLifecycleTables && analysisResult !== null && analysisResult !== void 0 && analysisResult.lifecycle_rates) {\n            console.log('[DEBUG] Lifecycle tables section should render!', analysisResult.lifecycle_rates);\n            console.log('[DEBUG] Available lifecycle rate keys:', Object.keys(analysisResult.lifecycle_rates));\n          }\n          return null;\n        })()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1701,\n        columnNumber: 21\n      }, this), showLifecycleTables && (analysisResult === null || analysisResult === void 0 ? void 0 : analysisResult.lifecycle_rates) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-6 mb-8 p-4 border-t dark:border-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-blue-800 dark:text-blue-200 mb-3\",\n            children: \"Enhanced Product-Based Lifecycle Analysis System\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1723,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold mb-2\",\n                children: \"Key Improvements:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1728,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"list-disc ml-5 space-y-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Fixed Cumulative Calculation:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1730,\n                    columnNumber: 49\n                  }, this), \" Now shows actual percentage of cohort that performs action, not forced 100%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1730,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Product-Level Granularity:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1731,\n                    columnNumber: 49\n                  }, this), \" Analyze lifecycle patterns per product ID\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1731,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Intelligent Smoothing:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1732,\n                    columnNumber: 49\n                  }, this), \" Adaptive smoothing that handles high-early, low-later patterns effectively\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1732,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Extended Lookback:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1733,\n                    columnNumber: 49\n                  }, this), \" Automatically extends lookback 30-60 days when sample size < 100\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1733,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1729,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1727,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-semibold mb-2\",\n                children: \"Metrics Displayed:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1737,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"list-disc ml-5 space-y-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Raw Daily Rates:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1739,\n                    columnNumber: 49\n                  }, this), \" Actual percentage of cohort performing action on specific day\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1739,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Smoothed Daily Rates:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1740,\n                    columnNumber: 49\n                  }, this), \" Algorithm-enhanced rates accounting for data sparsity\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1740,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Cumulative Rates:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1741,\n                    columnNumber: 49\n                  }, this), \" Total percentage who have performed action by day X (using smoothed data)\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1741,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Separate Tracking:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1742,\n                    columnNumber: 49\n                  }, this), \" 14 days for refunds, 400 days for cancellations\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1742,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1738,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1736,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1726,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1722,\n          columnNumber: 29\n        }, this), (() => {\n          // Get all available product IDs from lifecycle rates\n          const allAvailableProducts = new Set();\n          const lifecycleRates = analysisResult.lifecycle_rates || {};\n          Object.values(lifecycleRates).forEach(rateData => {\n            if (rateData && rateData.rates_by_product) {\n              Object.keys(rateData.rates_by_product).forEach(productId => {\n                allAvailableProducts.add(productId);\n              });\n            }\n          });\n          const productList = Array.from(allAvailableProducts).sort();\n          if (productList.length > 0) {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-6 p-4 bg-green-50 dark:bg-green-900/30 rounded-lg border border-green-200 dark:border-green-700\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    className: \"font-semibold text-green-800 dark:text-green-200 mb-1\",\n                    children: \"Product Analysis Filter\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1769,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-green-700 dark:text-green-300\",\n                    children: \"Select a specific product to analyze, or view aggregate data across all products.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1770,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1768,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"text-sm font-medium text-green-700 dark:text-green-300\",\n                    children: \"Product:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1775,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: globalSelectedProduct,\n                    onChange: e => setGlobalSelectedProduct(e.target.value),\n                    className: \"px-4 py-2 border border-green-300 dark:border-green-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-green-500\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"All Products (Aggregate)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1783,\n                      columnNumber: 57\n                    }, this), productList.map(productId => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: productId,\n                      children: [\"Product \", productId]\n                    }, productId, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1785,\n                      columnNumber: 61\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1778,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setShowChartModal(true),\n                    className: \"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors duration-200 flex items-center space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"\\uD83D\\uDCCA\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1794,\n                      columnNumber: 57\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"View Charts\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1795,\n                      columnNumber: 57\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1790,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1774,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1767,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1766,\n              columnNumber: 41\n            }, this);\n          }\n          return null;\n        })(), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-8\",\n          children: [analysisResult.lifecycle_rates.trial_to_cancellation_rates && renderLifecycleTable(\"Trial Converted -> Cancellation Rates\", analysisResult.lifecycle_rates.trial_to_cancellation_rates), analysisResult.lifecycle_rates.trial_to_refund_rates && renderLifecycleTable(\"Trial Converted -> Refund Rates\", analysisResult.lifecycle_rates.trial_to_refund_rates), analysisResult.lifecycle_rates.initial_purchase_to_cancellation_rates && renderLifecycleTable(\"Initial Purchase -> Cancellation Rates\", analysisResult.lifecycle_rates.initial_purchase_to_cancellation_rates), analysisResult.lifecycle_rates.initial_purchase_to_refund_rates && renderLifecycleTable(\"Initial Purchase -> Refund Rates\", analysisResult.lifecycle_rates.initial_purchase_to_refund_rates), analysisResult.lifecycle_rates.renewal_to_cancellation_rates && renderLifecycleTable(\"Renewal -> Cancellation Rates\", analysisResult.lifecycle_rates.renewal_to_cancellation_rates), analysisResult.lifecycle_rates.renewal_to_refund_rates && renderLifecycleTable(\"Renewal -> Refund Rates\", analysisResult.lifecycle_rates.renewal_to_refund_rates), analysisResult.lifecycle_rates.trial_to_outcome_rates && renderLifecycleTable(\"Trial to Outcome Rates\", analysisResult.lifecycle_rates.trial_to_outcome_rates)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1806,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1720,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-xl font-semibold mb-3 text-gray-700 dark:text-white\",\n        children: \"Daily Performance Charts\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1842,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-semibold text-gray-700 dark:text-white mb-2\",\n          children: \"Absolute Values\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1846,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4 flex flex-wrap gap-2\",\n          children: Object.keys(visibleAbsoluteMetrics).map(key => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleAbsoluteMetric(key),\n            className: `px-3 py-1 text-xs rounded-full ${visibleAbsoluteMetrics[key] ? 'bg-blue-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white'}`,\n            children: key.split('_').join(' ')\n          }, key, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1849,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1847,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\",\n          children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n            width: \"100%\",\n            height: \"100%\",\n            children: /*#__PURE__*/_jsxDEV(LineChart, {\n              data: chartData,\n              margin: {\n                top: 5,\n                right: 30,\n                left: 20,\n                bottom: 5\n              },\n              children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n                strokeDasharray: \"3 3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1858,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n                dataKey: \"date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1859,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(YAxis, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1860,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n                formatter: value => typeof value === 'number' ? value.toLocaleString() : value\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1861,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(ChartLegend, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1862,\n                columnNumber: 37\n              }, this), visibleAbsoluteMetrics.daily_trials_started && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_trials_started\",\n                stroke: \"#8884d8\",\n                name: \"Daily Trials Started\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1866,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_trials_ended && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_trials_ended\",\n                stroke: \"#82ca9d\",\n                name: \"Daily Trials Ended\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1869,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_trials_pending && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_trials_pending\",\n                stroke: \"#ffc658\",\n                name: \"Daily Trials Pending\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1872,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_conversions && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_conversions\",\n                stroke: \"#ff7300\",\n                name: \"Daily Conversions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1875,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_conversions_net_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_conversions_net_refunds\",\n                stroke: \"#ff0000\",\n                name: \"Daily Conv. Net Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1878,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_estimated_conversions_net_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_estimated_conversions_net_refunds\",\n                stroke: \"#b967ff\",\n                name: \"Daily Est. Conv. Net Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1881,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.daily_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_refunds\",\n                stroke: \"#ff67b3\",\n                name: \"Daily Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1884,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_trials_started && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_trials_started\",\n                stroke: \"#8884d8\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Trials Started\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1889,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_trials_ended && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_trials_ended\",\n                stroke: \"#82ca9d\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Trials Ended\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1892,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_trials_pending && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_trials_pending\",\n                stroke: \"#ffc658\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Trials Pending\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1895,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_conversions && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_conversions\",\n                stroke: \"#ff7300\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Conversions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1898,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_conversions_net_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_conversions_net_refunds\",\n                stroke: \"#ff0000\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Conv. Net Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1901,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_estimated_conversions_net_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_estimated_conversions_net_refunds\",\n                stroke: \"#b967ff\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Est. Conv. Net Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1904,\n                columnNumber: 41\n              }, this), visibleAbsoluteMetrics.cumulative_refunds && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_refunds\",\n                stroke: \"#ff67b3\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Refunds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1907,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1857,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1856,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1855,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1845,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"font-semibold text-gray-700 dark:text-white mb-2\",\n          children: \"Revenue Values\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1916,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4 flex flex-wrap gap-2\",\n          children: Object.keys(visibleMoneyMetrics).map(key => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleMoneyMetric(key),\n            className: `px-3 py-1 text-xs rounded-full ${visibleMoneyMetrics[key] ? 'bg-green-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white'}`,\n            children: key.split('_').join(' ')\n          }, key, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1919,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1917,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\",\n          children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n            width: \"100%\",\n            height: \"100%\",\n            children: /*#__PURE__*/_jsxDEV(LineChart, {\n              data: chartData,\n              margin: {\n                top: 5,\n                right: 30,\n                left: 20,\n                bottom: 5\n              },\n              children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n                strokeDasharray: \"3 3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1928,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n                dataKey: \"date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1929,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(YAxis, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1930,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n                formatter: value => formatCurrency(value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1931,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(ChartLegend, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1932,\n                columnNumber: 37\n              }, this), visibleMoneyMetrics.daily_revenue && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_revenue\",\n                stroke: \"#00b300\",\n                name: \"Daily Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1936,\n                columnNumber: 41\n              }, this), visibleMoneyMetrics.daily_revenue_net && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_revenue_net\",\n                stroke: \"#00e600\",\n                name: \"Daily Net Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1939,\n                columnNumber: 41\n              }, this), visibleMoneyMetrics.daily_estimated_revenue && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"daily_estimated_revenue\",\n                stroke: \"#4dff4d\",\n                name: \"Daily Est. Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1942,\n                columnNumber: 41\n              }, this), visibleMoneyMetrics.cumulative_revenue && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_revenue\",\n                stroke: \"#009900\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1947,\n                columnNumber: 41\n              }, this), visibleMoneyMetrics.cumulative_revenue_net && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_revenue_net\",\n                stroke: \"#00cc00\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Net Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1950,\n                columnNumber: 41\n              }, this), visibleMoneyMetrics.cumulative_estimated_revenue && /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"cumulative_estimated_revenue\",\n                stroke: \"#00e600\",\n                strokeDasharray: \"5 5\",\n                name: \"Cum. Est. Revenue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1953,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1927,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1926,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1925,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1915,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1486,\n      columnNumber: 17\n    }, this), eventRevenueTimelineData ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between items-center mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-800 dark:text-white\",\n          children: \"Daily Event & Revenue Timeline\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1966,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full\",\n            children: selectedUserId && selectedProductId ? 'Detailed View' : 'Aggregate View'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1968,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1967,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1965,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 border rounded-lg bg-gray-50 dark:bg-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"user-select\",\n            className: \"block text-sm font-medium text-gray-700 dark:text-white mb-2\",\n            children: \"Select User (Optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1977,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            id: \"user-select\",\n            isClearable: true,\n            isSearchable: true,\n            options: availableUsers.map(user => ({\n              value: user,\n              label: user\n            })),\n            value: selectedUserId ? {\n              value: selectedUserId,\n              label: selectedUserId\n            } : null,\n            onChange: selected => {\n              const newUserId = selected ? selected.value : '';\n              setSelectedUserId(newUserId);\n              fetchEventRevenueTimeline(newUserId, selectedProductId);\n            },\n            styles: getSelectTheme(),\n            placeholder: \"Type to search users...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1980,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1976,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"product-select\",\n            className: \"block text-sm font-medium text-gray-700 dark:text-white mb-2\",\n            children: \"Select Product (Optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1999,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            id: \"product-select\",\n            isClearable: true,\n            isSearchable: true,\n            options: availableProducts.map(product => ({\n              value: product,\n              label: product\n            })),\n            value: selectedProductId ? {\n              value: selectedProductId,\n              label: selectedProductId\n            } : null,\n            onChange: selected => {\n              const newProductId = selected ? selected.value : '';\n              setSelectedProductId(newProductId);\n              fetchEventRevenueTimeline(selectedUserId, newProductId);\n            },\n            styles: getSelectTheme(),\n            placeholder: \"Type to search products...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2002,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1998,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1975,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full text-sm border dark:border-gray-600\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-gray-50 dark:bg-gray-700\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10 min-w-[200px]\",\n                children: \"Metric\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2027,\n                columnNumber: 37\n              }, this), eventRevenueTimelineData.dates.map(date => /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap min-w-[80px]\",\n                children: date\n              }, date, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2031,\n                columnNumber: 41\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2026,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2025,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"bg-white dark:bg-gray-800\",\n            children: (() => {\n              // Define all metrics with their categories and data extraction logic\n              const metrics = [\n              // Daily Absolute Values\n              {\n                key: 'daily_trial_started',\n                label: 'Trial Started',\n                category: 'daily_absolute',\n                categoryLabel: 'Daily Absolute Values',\n                getValue: (date, index) => {\n                  var _eventRows$trial_star, _eventRows$trial_star2;\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? ((_eventRows$trial_star = eventRows.trial_started) === null || _eventRows$trial_star === void 0 ? void 0 : _eventRows$trial_star[date]) || 0 : ((_eventRows$trial_star2 = eventRows.trial_started) === null || _eventRows$trial_star2 === void 0 ? void 0 : _eventRows$trial_star2[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_trials_started) || 0;\n                }\n              }, {\n                key: 'daily_trial_pending',\n                label: 'Trial Pending',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$trial_pend;\n                  // FIXED: Use the backend-calculated trial_pending value directly\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$trial_pend = eventRows.trial_pending) === null || _eventRows$trial_pend === void 0 ? void 0 : _eventRows$trial_pend[date]) || 0;\n                }\n              }, {\n                key: 'daily_trial_ended',\n                label: 'Trial Ended',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$trial_ende;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$trial_ende = eventRows.trial_ended) === null || _eventRows$trial_ende === void 0 ? void 0 : _eventRows$trial_ende[date]) || 0;\n                }\n              }, {\n                key: 'daily_trial_cancelled',\n                label: 'Trial Cancelled',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$trial_canc;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$trial_canc = eventRows.trial_canceled) === null || _eventRows$trial_canc === void 0 ? void 0 : _eventRows$trial_canc[date]) || 0;\n                }\n              }, {\n                key: 'daily_trial_converted',\n                label: 'Trial Converted',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$trial_conv, _eventRows$trial_conv2;\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? ((_eventRows$trial_conv = eventRows.trial_converted) === null || _eventRows$trial_conv === void 0 ? void 0 : _eventRows$trial_conv[date]) || 0 : ((_eventRows$trial_conv2 = eventRows.trial_converted) === null || _eventRows$trial_conv2 === void 0 ? void 0 : _eventRows$trial_conv2[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_conversions) || 0;\n                }\n              }, {\n                key: 'daily_initial_purchase',\n                label: 'Initial Purchase',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$initial_pu;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$initial_pu = eventRows.initial_purchase) === null || _eventRows$initial_pu === void 0 ? void 0 : _eventRows$initial_pu[date]) || 0;\n                }\n              }, {\n                key: 'daily_subscription_active',\n                label: 'Subscription Active',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$subscripti;\n                  // FIXED: Use the backend-calculated subscription_active value directly\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$subscripti = eventRows.subscription_active) === null || _eventRows$subscripti === void 0 ? void 0 : _eventRows$subscripti[date]) || 0;\n                }\n              }, {\n                key: 'daily_subscription_cancelled',\n                label: 'Subscription Cancelled',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$subscripti2;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$subscripti2 = eventRows.subscription_cancelled) === null || _eventRows$subscripti2 === void 0 ? void 0 : _eventRows$subscripti2[date]) || 0;\n                }\n              }, {\n                key: 'daily_refund',\n                label: 'Refund',\n                category: 'daily_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$refund, _eventRows$refund2;\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? ((_eventRows$refund = eventRows.refund) === null || _eventRows$refund === void 0 ? void 0 : _eventRows$refund[date]) || 0 : ((_eventRows$refund2 = eventRows.refund) === null || _eventRows$refund2 === void 0 ? void 0 : _eventRows$refund2[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_refunds) || 0;\n                }\n              },\n              // Daily Revenue\n              {\n                key: 'daily_revenue',\n                label: 'Revenue (Actual)',\n                category: 'daily_revenue',\n                categoryLabel: 'Daily Revenue',\n                getValue: (date, index) => {\n                  var _estimateRows$current, _estimateRows$current2;\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const value = selectedUserId || selectedProductId ? ((_estimateRows$current = estimateRows.current_revenue) === null || _estimateRows$current === void 0 ? void 0 : _estimateRows$current[date]) || 0 : ((_estimateRows$current2 = estimateRows.current_revenue) === null || _estimateRows$current2 === void 0 ? void 0 : _estimateRows$current2[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_revenue) || 0;\n                  return formatCurrency(value);\n                }\n              }, {\n                key: 'daily_est_revenue',\n                label: 'Est. Revenue',\n                category: 'daily_revenue',\n                isEstimatedRevenue: true,\n                getValue: (date, index) => {\n                  var _estimateRows$estimat, _estimateRows$estimat2;\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const value = selectedUserId || selectedProductId ? ((_estimateRows$estimat = estimateRows.estimated_net_revenue) === null || _estimateRows$estimat === void 0 ? void 0 : _estimateRows$estimat[date]) || 0 : ((_estimateRows$estimat2 = estimateRows.estimated_revenue) === null || _estimateRows$estimat2 === void 0 ? void 0 : _estimateRows$estimat2[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_estimated_revenue) || 0;\n                  return formatCurrency(value);\n                },\n                getTooltipData: (date, index) => {\n                  var _estimateRows$estimat3, _estimateRows$estimat4;\n                  // Mock calculation data - this would come from the backend in reality\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const actualValue = selectedUserId || selectedProductId ? ((_estimateRows$estimat3 = estimateRows.estimated_net_revenue) === null || _estimateRows$estimat3 === void 0 ? void 0 : _estimateRows$estimat3[date]) || 0 : ((_estimateRows$estimat4 = estimateRows.estimated_revenue) === null || _estimateRows$estimat4 === void 0 ? void 0 : _estimateRows$estimat4[date]) || (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_estimated_revenue) || 0;\n\n                  // Mock data structure - backend should provide this\n                  return {\n                    formula: \"Est_Revenue = (Active_Trials  Trial_Conv_Rate  Avg_Revenue) + (Active_Subs  (1 - Churn_Rate)  Avg_Revenue) - (Expected_Refunds  Avg_Refund)\",\n                    calculation: `(${(chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_trials_pending) || 0}  0.15  $9.99) + (${(chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_trials_pending) || 0}  0.95  $9.99) - (${(chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_refunds) || 0}  $9.99)`,\n                    components: {\n                      \"Active Trials\": (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_trials_pending) || 0,\n                      \"Trial Conversion Rate\": \"15%\",\n                      \"Active Subscriptions\": \"N/A\",\n                      \"Churn Rate\": \"5%\",\n                      \"Avg Revenue\": \"$9.99\",\n                      \"Expected Refunds\": (chartDay === null || chartDay === void 0 ? void 0 : chartDay.daily_refunds) || 0,\n                      \"Avg Refund\": \"$9.99\"\n                    },\n                    result: formatCurrency(actualValue)\n                  };\n                }\n              },\n              // Cumulative Absolute Values\n              {\n                key: 'cumulative_trial_started',\n                label: 'Trial Started',\n                category: 'cumulative_absolute',\n                categoryLabel: 'Cumulative Absolute Values',\n                getValue: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$trial_star3;\n                    return sum + (((_eventRows$trial_star3 = eventRows.trial_started) === null || _eventRows$trial_star3 === void 0 ? void 0 : _eventRows$trial_star3[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_trials_started) || 0;\n                }\n              }, {\n                key: 'cumulative_trial_pending',\n                label: 'Trial Pending',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$trial_pend2;\n                  // This is a point-in-time value, same as daily pending\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$trial_pend2 = eventRows.trial_pending) === null || _eventRows$trial_pend2 === void 0 ? void 0 : _eventRows$trial_pend2[date]) || 0;\n                }\n              }, {\n                key: 'cumulative_trial_ended',\n                label: 'Trial Ended',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$trial_ende2;\n                    return sum + (((_eventRows$trial_ende2 = eventRows.trial_ended) === null || _eventRows$trial_ende2 === void 0 ? void 0 : _eventRows$trial_ende2[d]) || 0);\n                  }, 0);\n                }\n              }, {\n                key: 'cumulative_trial_cancelled',\n                label: 'Trial Cancelled',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$trial_canc2;\n                    return sum + (((_eventRows$trial_canc2 = eventRows.trial_canceled) === null || _eventRows$trial_canc2 === void 0 ? void 0 : _eventRows$trial_canc2[d]) || 0);\n                  }, 0) : chartData ? chartData.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$trial_canc3;\n                    return sum + (((_eventRows$trial_canc3 = eventRows.trial_canceled) === null || _eventRows$trial_canc3 === void 0 ? void 0 : _eventRows$trial_canc3[d.date]) || 0);\n                  }, 0) : 0;\n                }\n              }, {\n                key: 'cumulative_trial_converted',\n                label: 'Trial Converted',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$trial_conv3;\n                    return sum + (((_eventRows$trial_conv3 = eventRows.trial_converted) === null || _eventRows$trial_conv3 === void 0 ? void 0 : _eventRows$trial_conv3[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_conversions) || 0;\n                }\n              }, {\n                key: 'cumulative_initial_purchase',\n                label: 'Initial Purchase',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$cumulative;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$initial_pu2;\n                    return sum + (((_eventRows$initial_pu2 = eventRows.initial_purchase) === null || _eventRows$initial_pu2 === void 0 ? void 0 : _eventRows$initial_pu2[d]) || 0);\n                  }, 0) : ((_eventRows$cumulative = eventRows.cumulative_initial_purchase) === null || _eventRows$cumulative === void 0 ? void 0 : _eventRows$cumulative[date]) || 0;\n                }\n              }, {\n                key: 'cumulative_subscription_active',\n                label: 'Subscription Active',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  var _eventRows$subscripti3;\n                  // This is a point-in-time value, same as daily subscription_active\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return ((_eventRows$subscripti3 = eventRows.subscription_active) === null || _eventRows$subscripti3 === void 0 ? void 0 : _eventRows$subscripti3[date]) || 0;\n                }\n              }, {\n                key: 'cumulative_subscription_cancelled',\n                label: 'Subscription Cancelled',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$subscripti4;\n                    return sum + (((_eventRows$subscripti4 = eventRows.subscription_cancelled) === null || _eventRows$subscripti4 === void 0 ? void 0 : _eventRows$subscripti4[d]) || 0);\n                  }, 0);\n                }\n              }, {\n                key: 'cumulative_refund',\n                label: 'Refund',\n                category: 'cumulative_absolute',\n                getValue: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const eventRows = eventRevenueTimelineData.event_rows || {};\n                  return selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _eventRows$refund3;\n                    return sum + (((_eventRows$refund3 = eventRows.refund) === null || _eventRows$refund3 === void 0 ? void 0 : _eventRows$refund3[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_refunds) || 0;\n                }\n              },\n              // Cumulative Revenue\n              {\n                key: 'cumulative_revenue',\n                label: 'Revenue (Actual)',\n                category: 'cumulative_revenue',\n                categoryLabel: 'Cumulative Revenue',\n                getValue: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const value = selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _estimateRows$current3;\n                    return sum + (((_estimateRows$current3 = estimateRows.current_revenue) === null || _estimateRows$current3 === void 0 ? void 0 : _estimateRows$current3[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_revenue) || 0;\n                  return formatCurrency(value);\n                }\n              }, {\n                key: 'cumulative_est_revenue',\n                label: 'Est. Revenue',\n                category: 'cumulative_revenue',\n                isEstimatedRevenue: true,\n                getValue: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const value = selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _estimateRows$estimat5;\n                    return sum + (((_estimateRows$estimat5 = estimateRows.estimated_net_revenue) === null || _estimateRows$estimat5 === void 0 ? void 0 : _estimateRows$estimat5[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_estimated_revenue) || 0;\n                  return formatCurrency(value);\n                },\n                getTooltipData: (date, index) => {\n                  const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                  const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                  const actualValue = selectedUserId || selectedProductId ? eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => {\n                    var _estimateRows$estimat6;\n                    return sum + (((_estimateRows$estimat6 = estimateRows.estimated_net_revenue) === null || _estimateRows$estimat6 === void 0 ? void 0 : _estimateRows$estimat6[d]) || 0);\n                  }, 0) : (chartDay === null || chartDay === void 0 ? void 0 : chartDay.cumulative_estimated_revenue) || 0;\n                  return {\n                    formula: \"Cumulative_Est_Revenue = (Daily_Est_Revenue) from start to date\",\n                    calculation: `Sum of daily estimated revenue from start date to ${date}`,\n                    components: {\n                      \"Period\": `Start to ${date}`,\n                      \"Days\": index + 1,\n                      \"Avg Daily Est\": formatCurrency(actualValue / (index + 1))\n                    },\n                    result: formatCurrency(actualValue)\n                  };\n                }\n              }];\n\n              // Group metrics by category for styling\n              const categoryColors = {\n                daily_absolute: 'bg-blue-50 dark:bg-blue-900/30',\n                daily_revenue: 'bg-green-50 dark:bg-green-900/30',\n                cumulative_absolute: 'bg-indigo-50 dark:bg-indigo-900/30',\n                cumulative_revenue: 'bg-emerald-50 dark:bg-emerald-900/30'\n              };\n              return metrics.map((metric, metricIndex) => {\n                const isFirstInCategory = metricIndex === 0 || metrics[metricIndex - 1].category !== metric.category;\n                return /*#__PURE__*/_jsxDEV(React.Fragment, {\n                  children: [isFirstInCategory && metric.categoryLabel && /*#__PURE__*/_jsxDEV(\"tr\", {\n                    className: `${categoryColors[metric.category]} border-t-2 border-gray-300 dark:border-gray-500`,\n                    children: /*#__PURE__*/_jsxDEV(\"td\", {\n                      colSpan: eventRevenueTimelineData.dates.length + 1,\n                      className: \"p-2 border-b dark:border-gray-600 text-center font-semibold text-gray-700 dark:text-white\",\n                      children: metric.categoryLabel\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2354,\n                      columnNumber: 57\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2353,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                    className: metricIndex % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700',\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10 bg-inherit\",\n                      children: metric.label\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2362,\n                      columnNumber: 53\n                    }, this), eventRevenueTimelineData.dates.map((date, dateIndex) => /*#__PURE__*/_jsxDEV(\"td\", {\n                      className: `p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 whitespace-nowrap ${metric.isEstimatedRevenue ? 'cursor-help hover:bg-yellow-50 dark:hover:bg-yellow-900/20' : ''}`,\n                      onMouseEnter: metric.isEstimatedRevenue ? e => {\n                        const tooltipData = metric.getTooltipData(date, dateIndex);\n                        setTooltipData(tooltipData);\n                        setTooltipPosition({\n                          x: e.clientX,\n                          y: e.clientY\n                        });\n                      } : undefined,\n                      onMouseLeave: metric.isEstimatedRevenue ? () => {\n                        setTooltipData(null);\n                      } : undefined,\n                      children: metric.getValue(date, dateIndex)\n                    }, date, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2366,\n                      columnNumber: 57\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2361,\n                    columnNumber: 49\n                  }, this)]\n                }, metric.key, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2350,\n                  columnNumber: 45\n                }, this);\n              });\n            })()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2037,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2024,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2023,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1964,\n      columnNumber: 17\n    }, this) : isLoadingEventRevenueTimeline ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4\",\n      children: [/*#__PURE__*/_jsxDEV(Loader, {\n        className: \"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2394,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-700 dark:text-white\",\n        children: \"Loading event revenue timeline...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2395,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2393,\n      columnNumber: 17\n    }, this) : eventRevenueTimelineError ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n          className: \"mr-2 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2400,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium block\",\n            children: \"Event Revenue Timeline Error:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2402,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"block mt-1\",\n            children: eventRevenueTimelineError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2403,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2401,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2399,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2398,\n      columnNumber: 17\n    }, this) : null, userTimelineData ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between items-center mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold text-gray-700 dark:text-white\",\n          children: \"User Timeline\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2413,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full\",\n            children: [userTimelineData.unique_users_count || userTimelineData.total_users, \" Unique Users\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2415,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium px-3 py-1 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100 rounded-full\",\n            children: [userTimelineData.total_user_product_combinations || ((_userTimelineData$use = userTimelineData.users) === null || _userTimelineData$use === void 0 ? void 0 : _userTimelineData$use.length), \" User-Product Combinations\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2418,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium px-3 py-1 bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-100 rounded-full\",\n            children: [((_userTimelineData$val = userTimelineData.valid_product_ids) === null || _userTimelineData$val === void 0 ? void 0 : _userTimelineData$val.length) || 0, \" Unique Products\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2421,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2414,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2412,\n        columnNumber: 21\n      }, this), userTimelineData.filter_stats && /*#__PURE__*/_jsxDEV(FilterStatsDisplay, {\n        filterStats: userTimelineData.filter_stats\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2429,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-3 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.default.bg} ${timelineColors.default.text}`,\n            children: \"No Event\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2435,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.trial_started.bg} ${timelineColors.trial_started.text}`,\n            children: \"Trial Started\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2436,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.trial_converted.bg} ${timelineColors.trial_converted.text}`,\n            children: \"Trial Converted\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2437,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.trial_cancelled.bg} ${timelineColors.trial_cancelled.text}`,\n            children: \"Trial Cancelled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2438,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.conversion_cancelled.bg} ${timelineColors.conversion_cancelled.text}`,\n            children: \"Conversion Cancelled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2439,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `px-3 py-2 rounded ${timelineColors.refunded.bg} ${timelineColors.refunded.text}`,\n            children: \"Refunded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2440,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2434,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative flex items-center bg-gray-100 dark:bg-gray-700 p-2 rounded text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: \"Multiple events on the same day:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2443,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative mr-8 px-4 py-2 rounded bg-green-100 dark:bg-green-900/50\",\n              style: {\n                minWidth: \"180px\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-800 dark:text-green-200\",\n                children: \"Trial Converted\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2446,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center\",\n                children: \"3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2447,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-1 flex flex-col gap-1 w-full\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"px-1 py-0.5 text-[9px] w-full text-center rounded bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200\",\n                  children: \"Trial started\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2451,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"px-1 py-0.5 text-[9px] w-full text-center rounded bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300\",\n                  children: \"Refunded\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2454,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2450,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2445,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-gray-600 dark:text-gray-300\",\n              children: \"The cell is colored by the first event, with a counter and full-text badges for each additional event\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2459,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2444,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2442,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2433,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full text-sm border dark:border-gray-600\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-gray-50 dark:bg-gray-700\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10\",\n                children: \"User ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2468,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-[150px] bg-gray-50 dark:bg-gray-700 z-10\",\n                children: \"Product ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2469,\n                columnNumber: 37\n              }, this), userTimelineData.dates.map(date => /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap\",\n                children: date\n              }, date, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2471,\n                columnNumber: 41\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2467,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2466,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"bg-white dark:bg-gray-800\",\n            children: userTimelineData.users.map((user, index) => {\n              // Get background colors for alternating users (not user-product rows)\n              const isNewUser = index === 0 || userTimelineData.users[index - 1].id !== user.id;\n              const userBgClass = isNewUser ? index % 4 < 2 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-700' : '';\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: userBgClass,\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10\",\n                  style: {\n                    backgroundColor: 'inherit'\n                  },\n                  children: isNewUser ? user.id : ''\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2483,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 border-b dark:border-gray-600 font-medium text-green-700 dark:text-green-300 sticky left-[150px] z-10\",\n                  style: {\n                    backgroundColor: 'inherit'\n                  },\n                  children: user.product_id\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2486,\n                  columnNumber: 41\n                }, this), userTimelineData.dates.map(date => {\n                  const cellState = getCellState(user.user_product_key, date, userTimelineData.events);\n                  const events = getEventsForDate(user.user_product_key, date, userTimelineData.events);\n                  const hasEvents = events.length > 0;\n                  return /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: `p-2 border dark:border-gray-600 text-xs relative ${timelineColors[cellState].bg}`,\n                    children: hasEvents ? /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex flex-col items-center\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: `text-center w-full ${timelineColors[cellState].text} font-medium`,\n                        children: events[0].type.replace('RC ', '')\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2500,\n                        columnNumber: 61\n                      }, this), events.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-1 flex flex-col items-center w-full gap-1\",\n                        children: events.slice(1).map((additionalEvent, idx) => {\n                          const eventType = additionalEvent.type.replace('RC ', '');\n                          let badgeState = 'default';\n\n                          // Determine appropriate color for this event\n                          if (additionalEvent.type === 'RC Trial started') badgeState = 'trial_started';else if (additionalEvent.type === 'RC Trial converted') badgeState = 'trial_converted';else if (additionalEvent.type === 'RC Trial cancelled') badgeState = 'trial_cancelled';else if (additionalEvent.type === 'RC Cancellation') {\n                            badgeState = additionalEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n                          } else if (additionalEvent.type === 'RC Initial purchase') {\n                            badgeState = 'trial_converted';\n                          } else if (additionalEvent.type === 'RC Renewal') {\n                            badgeState = 'trial_converted';\n                          }\n                          return /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: `px-1 py-0.5 text-[9px] w-full text-center rounded ${timelineColors[badgeState].bg} ${timelineColors[badgeState].text}`,\n                            title: `${eventType} at ${additionalEvent.time} for ${additionalEvent.product_id}`,\n                            children: eventType\n                          }, idx, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 2525,\n                            columnNumber: 77\n                          }, this);\n                        })\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2506,\n                        columnNumber: 65\n                      }, this), events.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center\",\n                        children: events.length\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2539,\n                        columnNumber: 65\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2498,\n                      columnNumber: 57\n                    }, this) : ''\n                  }, date, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2495,\n                    columnNumber: 49\n                  }, this);\n                })]\n              }, user.user_product_key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2482,\n                columnNumber: 37\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2475,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2465,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2464,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2411,\n      columnNumber: 17\n    }, this) : isLoadingTimeline ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4\",\n      children: [/*#__PURE__*/_jsxDEV(Loader, {\n        className: \"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2556,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-700 dark:text-white\",\n        children: \"Loading user timeline data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2557,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2555,\n      columnNumber: 17\n    }, this) : timelineError ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n          className: \"mr-2 flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2562,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium block\",\n            children: \"Timeline Error:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2564,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"block mt-1\",\n            children: timelineError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2565,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2563,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2561,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2560,\n      columnNumber: 17\n    }, this) : null, /*#__PURE__*/_jsxDEV(EstimatedRevenueTooltip, {\n      data: tooltipData,\n      position: tooltipPosition,\n      onClose: () => setTooltipData(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2572,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ChartModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2577,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1352,\n    columnNumber: 9\n  }, this);\n};\n_s(CohortAnalyzerPage, \"Tz4tekeo74q4r22NB/5gxxfChkI=\");\n_c3 = CohortAnalyzerPage;\nexport default CohortAnalyzerPage;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"FilterStatsDisplay\");\n$RefreshReg$(_c2, \"EstimatedRevenueTooltip\");\n$RefreshReg$(_c3, \"CohortAnalyzerPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","api","LineChart","Line","XAxis","YAxis","CartesianGrid","Tooltip","Legend","ResponsiveContainer","ChevronDown","ChevronRight","PlusCircle","XCircle","AlertTriangle","Loader","Filter","Select","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","ChartTooltip","ChartLegend","ChartLine","jsxDEV","_jsxDEV","Fragment","_Fragment","register","customSelectStyles","control","base","state","background","borderColor","isFocused","boxShadow","padding","fontSize","option","backgroundColor","isSelected","color","cursor","multiValue","border","multiValueLabel","fontWeight","multiValueRemove","menu","zIndex","placeholder","input","singleValue","darkModeSelectStyles","timelineColors","default","bg","text","trial_started","trial_converted","trial_cancelled","conversion_cancelled","refunded","FilterStatsDisplay","filterStats","_filtering_steps","filtering_steps","base_cohort_count","final_cohort_count","calculatePercentage","count","total","toFixed","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","slice","map","step","index","users_count","length","description","users_filtered","_c","EstimatedRevenueTooltip","data","position","onClose","style","left","Math","min","x","window","innerWidth","top","max","y","onClick","breakdown","trialConverted","initialPurchase","initial_purchase","showTrialRatio","actual_revenue","showInitialRatio","revenue","estimatedRefunds","estimated_refunds","refundRate","formula","calculation","Object","entries","components","key","value","result","_c2","CohortAnalyzerPage","_s","_analysisResult$summa","_analysisResult$summa2","_analysisResult$summa3","_analysisResult$summa4","_analysisResult$summa5","_analysisResult$cohor","_analysisResult$cohor2","_analysisResult$cohor3","_analysisResult$cohor4","_analysisResult$cohor5","_analysisResult$cohor6","_analysisResult$cohor7","_analysisResult$cohor8","_analysisResult$cohor9","_analysisResult$cohor0","_analysisResult$cohor1","_analysisResult$cohor10","_analysisResult$cohor11","_analysisResult$cohor12","_analysisResult$cohor13","_analysisResult$cohor14","_analysisResult$cohor15","_analysisResult$cohor16","_analysisResult$cohor17","_analysisResult$cohor18","_analysisResult$cohor19","_analysisResult$cohor20","_analysisResult$cohor21","_analysisResult$cohor22","_analysisResult$cohor23","_analysisResult$cohor24","_userTimelineData$use","_userTimelineData$val","initialFilters","date_from_str","date_to_str","optional_filters","filters","setFilters","availableEventProperties","setAvailableEventProperties","availableUserProperties","setAvailableUserProperties","propertyValueOptions","setPropertyValueOptions","isLoading","setIsLoading","analysisResult","setAnalysisResult","error","setError","showLifecycleTables","setShowLifecycleTables","activePropertyDiscovery","setActivePropertyDiscovery","propertyDiscoveryMessage","setPropertyDiscoveryMessage","isInitializing","setIsInitializing","userTimelineData","setUserTimelineData","isLoadingTimeline","setIsLoadingTimeline","timelineError","setTimelineError","eventRevenueTimelineData","setEventRevenueTimelineData","isLoadingEventRevenueTimeline","setIsLoadingEventRevenueTimeline","eventRevenueTimelineError","setEventRevenueTimelineError","selectedUserId","setSelectedUserId","selectedProductId","setSelectedProductId","availableUsers","setAvailableUsers","availableProducts","setAvailableProducts","cohortDefinitionWarning","setCohortDefinitionWarning","tooltipData","setTooltipData","tooltipPosition","setTooltipPosition","selectedProducts","setSelectedProducts","globalSelectedProduct","setGlobalSelectedProduct","showChartModal","setShowChartModal","savedFilters","localStorage","getItem","parsedFilters","JSON","parse","prev","console","filtersToSave","setItem","stringify","fetchDiscoverableProperties","getDiscoverableCohortProperties","event_properties","user_properties","status","message","checkDiscoveryInterval","setInterval","getPropertyDiscoveryStatus","clearInterval","setTimeout","err","code","enableCohortProperties","enableErr","active","initializeProperties","handleFilterChange","type","newFilters","property_name","property_values","fetchPropertyValues","startsWith","field","substring","property_source","propertyName","propertySource","filterIdentifier","getDiscoverableCohortPropertyValues","values","addOptionalFilter","id","Date","now","toString","removeOptionalFilter","idToRemove","filter","f","handleSubmit","e","preventDefault","Error","cohortFilters","enforce_trial_started","cohort_definition","required_event","date_range","from","to","strict_filtering","analyzeCohortData","cohort_event_occurrence","summary_stats","total_users_in_final_cohort","trialStartedUsers","user_count","totalCohortUsers","warningMessage","warn","fetchUserTimeline","fetchEventRevenueTimeline","log","timelineData","getCohortUserTimeline","distinctId","productId","getUserEventRevenueTimeline","available_users","available_products","getCellState","userProductKey","date","eventMap","mostRecentEventDate","mostRecentState","eventDate","events","lastEvent","has_refund","firstEvent","getEventsForDate","triggerPropertyDiscovery","triggerCohortPropertyDiscovery","renderLifecycleTable","title","ratesData","denominatorKey","isNewFormat","rates_by_product","aggregate_rates","aggregateRates","productRates","rates_by_day","keys","displayRates","ratesByDay","sortedDays","Number","sort","a","b","rowData","metric","dataKey","smoothing_method","smoothing_quality","total_sample_size","smoothing_details","cancellation","early_concentration","sparsity","max_rate","row","day","dayStr","dayData","ratesDenominator","legacyRowData","formatCurrency","undefined","toLocaleString","currency","chartData","daily_data","d","actualNetRevenue","cumulative_revenue_actual_net","projectedNetRevenue","estimated_additional_revenue_from_pending_trials_net_refund","estimated_future_refunds_on_actual_revenue_amount","trialsStarted","daily_trials_started","trialsConverted","daily_trials_converted_actual","trialsCancelled","daily_trials_cancelled_actual","trialsEnded","trialsPending","daily_trials_ended","daily_trials_pending","daily_conversions","daily_conversions_net_refunds","daily_refund_count_actual","daily_estimated_conversions_net_refunds","daily_estimated_refunds","daily_refunds","daily_revenue","daily_revenue_actual","daily_revenue_net","daily_revenue_actual_net","daily_estimated_revenue","cumulative_trials_started","cumulative_trials_ended","cumulative_trials_converted_actual","cumulative_trials_cancelled_actual","cumulative_trials_pending","cumulative_conversions","cumulative_conversions_net_refunds","cumulative_refund_count_actual","cumulative_estimated_conversions_net_refunds","cumulative_estimated_refunds","cumulative_refunds","cumulative_revenue","cumulative_revenue_actual","cumulative_revenue_net","cumulative_estimated_revenue","visibleAbsoluteMetrics","setVisibleAbsoluteMetrics","visibleMoneyMetrics","setVisibleMoneyMetrics","toggleAbsoluteMetric","metricKey","toggleMoneyMetric","getSelectTheme","isDarkMode","document","documentElement","classList","contains","matchMedia","matches","ChartModal","lifecycle_rates","lifecycleRates","getChartData","days","datasets","label","_ratesData$rates_by_d","raw_cumulative_cancellation_rate","borderDash","tension","_ratesData$rates_by_d2","smoothed_cumulative_cancellation_rate","_ratesData$rates_by_d3","raw_cumulative_refund_rate","_ratesData$rates_by_d4","smoothed_cumulative_refund_rate","_ratesData$rates_by_d5","raw_cumulative_conversion_rate","_ratesData$rates_by_d6","smoothed_cumulative_conversion_rate","_ratesData$rates_by_d7","_ratesData$rates_by_d8","labels","chartOptions","responsive","plugins","legend","display","scales","beginAtZero","getDisplayRates","trialToOutcomeRates","trial_to_outcome_rates","cancellationRefundRates","trial_to_cancellation_rates","trial_to_refund_rates","options","onSubmit","htmlFor","onChange","target","required","p","display_name","isMulti","isDisabled","val","selected","styles","disabled","filter_stats","total_events_analyzed","arpc_cohort","arpc_datapoints","arpc_calculation_basis","arpc_per_product","arpcData","arpc","event_count","unique_users","total_revenue","event_user_counts","eventType","counts","total_events","trial_ended","percentage","renewal","rc_cancellation","rc_refund","rc_cancel_no_refund","allAvailableProducts","Set","forEach","rateData","add","productList","Array","initial_purchase_to_cancellation_rates","initial_purchase_to_refund_rates","renewal_to_cancellation_rates","renewal_to_refund_rates","split","join","width","height","margin","right","bottom","strokeDasharray","formatter","stroke","name","isClearable","isSearchable","user","newUserId","product","newProductId","dates","metrics","category","categoryLabel","getValue","_eventRows$trial_star","_eventRows$trial_star2","chartDay","find","eventRows","event_rows","_eventRows$trial_pend","trial_pending","_eventRows$trial_ende","_eventRows$trial_canc","trial_canceled","_eventRows$trial_conv","_eventRows$trial_conv2","_eventRows$initial_pu","_eventRows$subscripti","subscription_active","_eventRows$subscripti2","subscription_cancelled","_eventRows$refund","_eventRows$refund2","refund","_estimateRows$current","_estimateRows$current2","estimateRows","estimate_rows","current_revenue","isEstimatedRevenue","_estimateRows$estimat","_estimateRows$estimat2","estimated_net_revenue","estimated_revenue","getTooltipData","_estimateRows$estimat3","_estimateRows$estimat4","actualValue","reduce","sum","_eventRows$trial_star3","_eventRows$trial_pend2","_eventRows$trial_ende2","_eventRows$trial_canc2","_eventRows$trial_canc3","_eventRows$trial_conv3","_eventRows$cumulative","_eventRows$initial_pu2","cumulative_initial_purchase","_eventRows$subscripti3","_eventRows$subscripti4","_eventRows$refund3","_estimateRows$current3","_estimateRows$estimat5","_estimateRows$estimat6","categoryColors","daily_absolute","cumulative_absolute","metricIndex","isFirstInCategory","colSpan","dateIndex","onMouseEnter","clientX","clientY","onMouseLeave","unique_users_count","total_users","total_user_product_combinations","users","valid_product_ids","minWidth","isNewUser","userBgClass","product_id","cellState","user_product_key","hasEvents","replace","additionalEvent","idx","badgeState","time","_c3","$RefreshReg$"],"sources":["/Users/joshuakaufman/untitled folder 3/orchestrator/dashboard/client/src/pages/CohortAnalyzerPage.js"],"sourcesContent":["// client/src/pages/CohortAnalyzerPage.js\n// COHORT DEFINITION:\n// A user is part of the cohort ONLY if they:\n// 1. Exist in the database\n// 2. Have a \"trial started\" event within the specified date range\n// This is enforced using the enforce_trial_started flag in API calls\n// IMPORTANT: Users who do not meet both criteria are EXCLUDED from all analysis.\n// All events analyzed are ONLY from users in this cohort.\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { api } from '../services/api'; // Assuming your API service is here\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { ChevronDown, ChevronRight, PlusCircle, XCircle, AlertTriangle, Loader, Filter } from 'lucide-react';\nimport Select from 'react-select';\nimport {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip as ChartTooltip,\n    Legend as ChartLegend,\n} from 'chart.js';\nimport { Line as ChartLine } from 'react-chartjs-2';\n\nChartJS.register(\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    ChartTooltip,\n    ChartLegend\n);\n\n// Custom styles for react-select\nconst customSelectStyles = {\n  control: (base, state) => ({\n    ...base,\n    background: '#FFFFFF',\n    borderColor: state.isFocused ? '#4F46E5' : '#CBD5E0',\n    boxShadow: state.isFocused ? '0 0 0 1px #4F46E5' : 'none',\n    '&:hover': {\n      borderColor: '#4F46E5',\n    },\n    padding: '2px',\n    fontSize: '0.9rem',\n  }),\n  option: (base, state) => ({\n    ...base,\n    backgroundColor: state.isSelected \n      ? '#4F46E5' \n      : state.isFocused \n        ? '#EEF2FF' \n        : 'transparent',\n    color: state.isSelected ? 'white' : '#1A202C',\n    '&:hover': {\n      backgroundColor: state.isSelected ? '#4F46E5' : '#EEF2FF',\n    },\n    cursor: 'pointer',\n    fontSize: '0.9rem',\n  }),\n  multiValue: (base) => ({\n    ...base,\n    backgroundColor: '#EEF2FF',\n    border: '1px solid #E2E8F0',\n  }),\n  multiValueLabel: (base) => ({\n    ...base,\n    color: '#4F46E5',\n    fontWeight: 500,\n  }),\n  multiValueRemove: (base) => ({\n    ...base,\n    color: '#4F46E5',\n    '&:hover': {\n      backgroundColor: '#4F46E5',\n      color: 'white',\n    },\n  }),\n  menu: (base) => ({\n    ...base,\n    zIndex: 100,\n    boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',\n    backgroundColor: '#FFFFFF',\n  }),\n  placeholder: (base) => ({\n    ...base,\n    color: '#718096',\n  }),\n  input: (base) => ({\n    ...base,\n    color: '#1A202C',\n  }),\n  singleValue: (base) => ({\n    ...base,\n    color: '#1A202C',\n  }),\n};\n\n// For dark mode\nconst darkModeSelectStyles = {\n  ...customSelectStyles,\n  control: (base, state) => ({\n    ...customSelectStyles.control(base, state),\n    background: '#1F2937',\n    borderColor: state.isFocused ? '#4F46E5' : '#4B5563',\n    '&:hover': {\n      borderColor: '#4F46E5',\n    },\n  }),\n  option: (base, state) => ({\n    ...customSelectStyles.option(base, state),\n    backgroundColor: state.isSelected \n      ? '#4F46E5' \n      : state.isFocused \n        ? '#374151' \n        : '#1F2937',\n    color: state.isSelected ? 'white' : '#F3F4F6',\n  }),\n  multiValue: (base) => ({\n    ...customSelectStyles.multiValue(base),\n    backgroundColor: '#374151',\n    border: '1px solid #4B5563',\n  }),\n  multiValueLabel: (base) => ({\n    ...customSelectStyles.multiValueLabel(base),\n    color: '#F3F4F6',\n  }),\n  multiValueRemove: (base) => ({\n    ...customSelectStyles.multiValueRemove(base),\n    color: '#F3F4F6',\n    '&:hover': {\n      backgroundColor: '#4F46E5',\n      color: 'white',\n    },\n  }),\n  menu: (base) => ({\n    ...customSelectStyles.menu(base),\n    backgroundColor: '#1F2937',\n    border: '1px solid #4B5563',\n  }),\n  placeholder: (base) => ({\n    ...customSelectStyles.placeholder(base),\n    color: '#9CA3AF',\n  }),\n  input: (base) => ({\n    ...base,\n    color: '#F3F4F6',\n  }),\n  singleValue: (base) => ({\n    ...base,\n    color: '#F3F4F6',\n  }),\n};\n\n// Define the color coding for the user timeline table\nconst timelineColors = {\n  default: {\n    bg: 'bg-gray-100 dark:bg-gray-700',\n    text: 'text-gray-500 dark:text-gray-400'\n  },\n  trial_started: {\n    bg: 'bg-yellow-100 dark:bg-yellow-900/50',\n    text: 'text-yellow-800 dark:text-yellow-200'\n  },\n  trial_converted: {\n    bg: 'bg-green-100 dark:bg-green-900/50',\n    text: 'text-green-800 dark:text-green-200'\n  },\n  trial_cancelled: {\n    bg: 'bg-red-100 dark:bg-red-900/50',\n    text: 'text-red-800 dark:text-red-200'\n  },\n  conversion_cancelled: {\n    bg: 'bg-green-50 dark:bg-green-900/30',\n    text: 'text-green-600 dark:text-green-300'\n  },\n  refunded: {\n    bg: 'bg-red-50 dark:bg-red-900/30',\n    text: 'text-red-600 dark:text-red-300'\n  }\n};\n\n// New component for displaying filter stats\nconst FilterStatsDisplay = ({ filterStats }) => {\n    if (!filterStats) return null;\n    \n    const { filtering_steps, base_cohort_count, final_cohort_count } = filterStats;\n    \n    // Calculate percentages\n    const calculatePercentage = (count, total) => {\n        if (!total) return 0;\n        return ((count / total) * 100).toFixed(1);\n    };\n    \n    return (\n        <div className=\"mb-6 p-4 border rounded-lg bg-white dark:bg-gray-700 shadow-sm\">\n            <div className=\"flex items-center gap-2 mb-3\">\n                <Filter size={18} className=\"text-indigo-600 dark:text-indigo-400\" />\n                <h3 className=\"text-lg font-semibold text-gray-700 dark:text-white\">Cohort Filtering Statistics</h3>\n            </div>\n            \n            <div className=\"flex flex-col md:flex-row items-center justify-between mb-4 p-3 bg-indigo-50 dark:bg-indigo-900/30 rounded-md\">\n                <div className=\"text-center\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">Base Cohort</div>\n                    <div className=\"text-xl font-bold text-indigo-600 dark:text-indigo-300\">{base_cohort_count}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">100%</div>\n                </div>\n                \n                <div className=\"hidden md:block text-gray-400\"></div>\n                \n                {filtering_steps.slice(1).map((step, index) => (\n                    <div key={index} className=\"text-center\">\n                        <div className=\"text-sm text-gray-600 dark:text-gray-300\">After {step.step}</div>\n                        <div className=\"text-xl font-bold text-indigo-600 dark:text-indigo-300\">{step.users_count}</div>\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                            {calculatePercentage(step.users_count, base_cohort_count)}% of base\n                        </div>\n                    </div>\n                ))}\n                \n                {/* If there's a significant difference between final count and last step */}\n                {final_cohort_count !== (filtering_steps[filtering_steps.length - 1]?.users_count) && (\n                    <>\n                        <div className=\"hidden md:block text-gray-400\"></div>\n                        <div className=\"text-center\">\n                            <div className=\"text-sm text-gray-600 dark:text-gray-300\">Final Cohort</div>\n                            <div className=\"text-xl font-bold text-indigo-600 dark:text-indigo-300\">{final_cohort_count}</div>\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                {calculatePercentage(final_cohort_count, base_cohort_count)}% of base\n                            </div>\n                        </div>\n                    </>\n                )}\n            </div>\n            \n            <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                    <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                        <tr>\n                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Filter Step</th>\n                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Description</th>\n                            <th className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">Users Count</th>\n                            <th className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">Users Filtered</th>\n                            <th className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white\">% of Base</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"bg-white dark:bg-gray-800\">\n                        {filtering_steps.map((step, index) => (\n                            <tr key={index} className={index % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700'}>\n                                <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">{step.step}</td>\n                                <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">{step.description}</td>\n                                <td className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\">{step.users_count}</td>\n                                <td className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\">\n                                    {step.users_filtered || 0}\n                                </td>\n                                <td className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300\">\n                                    {calculatePercentage(step.users_count, base_cohort_count)}%\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n};\n\n// Add this Tooltip component before the main CohortAnalyzerPage component\nconst EstimatedRevenueTooltip = ({ data, position, onClose }) => {\n    if (!data) return null;\n    \n    return (\n        <div \n            className=\"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md\"\n            style={{\n                left: Math.min(position.x, window.innerWidth - 400),\n                top: Math.max(position.y - 100, 10),\n            }}\n        >\n            <div className=\"flex justify-between items-start mb-2\">\n                <h4 className=\"font-semibold text-gray-800 dark:text-white\">Estimated Revenue Calculation</h4>\n                <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700\"></button>\n            </div>\n            \n            <div className=\"space-y-3 text-sm\">\n                {/* NEW: Refund Rate Ratios - Show prominently at the top */}\n                {(() => {\n                    const breakdown = data.breakdown || {};\n                    const trialConverted = breakdown.trial_converted || {};\n                    const initialPurchase = breakdown.initial_purchase || {};\n                    \n                    const showTrialRatio = trialConverted.actual_revenue > 0;\n                    const showInitialRatio = initialPurchase.actual_revenue > 0;\n                    \n                    if (!showTrialRatio && !showInitialRatio) return null;\n                    \n                    return (\n                        <div className=\"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg border border-blue-200 dark:border-blue-700 mb-3\">\n                            <div className=\"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2\">\n                                 Refund Rate Analysis\n                            </div>\n                            \n                            {showTrialRatio && (\n                                <div className=\"mb-2\">\n                                    <div className=\"text-xs font-medium text-blue-700 dark:text-blue-300\">\n                                        Trial Conversion Refund Rate:\n                                    </div>\n                                    <div className=\"text-sm font-bold text-blue-900 dark:text-blue-100\">\n                                        {(() => {\n                                            const revenue = trialConverted.actual_revenue || 0;\n                                            const estimatedRefunds = trialConverted.estimated_refunds || 0;\n                                            const refundRate = revenue > 0 ? (estimatedRefunds / revenue) * 100 : 0;\n                                            return `${estimatedRefunds.toFixed(2)} / ${revenue.toFixed(2)} = ${refundRate.toFixed(1)}%`;\n                                        })()}\n                                    </div>\n                                    <div className=\"text-xs text-blue-600 dark:text-blue-400\">\n                                        ${(trialConverted.estimated_refunds || 0).toFixed(2)} estimated refunds on ${(trialConverted.actual_revenue || 0).toFixed(2)} revenue\n                                    </div>\n                                </div>\n                            )}\n                            \n                            {showInitialRatio && (\n                                <div>\n                                    <div className=\"text-xs font-medium text-blue-700 dark:text-blue-300\">\n                                        Initial Purchase Refund Rate:\n                                    </div>\n                                    <div className=\"text-sm font-bold text-blue-900 dark:text-blue-100\">\n                                        {(() => {\n                                            const revenue = initialPurchase.actual_revenue || 0;\n                                            const estimatedRefunds = initialPurchase.estimated_refunds || 0;\n                                            const refundRate = revenue > 0 ? (estimatedRefunds / revenue) * 100 : 0;\n                                            return `${estimatedRefunds.toFixed(2)} / ${revenue.toFixed(2)} = ${refundRate.toFixed(1)}%`;\n                                        })()}\n                                    </div>\n                                    <div className=\"text-xs text-blue-600 dark:text-blue-400\">\n                                        ${(initialPurchase.estimated_refunds || 0).toFixed(2)} estimated refunds on ${(initialPurchase.actual_revenue || 0).toFixed(2)} revenue\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    );\n                })()}\n                \n                <div>\n                    <div className=\"font-medium text-gray-700 dark:text-gray-300\">Formula:</div>\n                    <div className=\"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                        {data.formula}\n                    </div>\n                </div>\n                \n                <div>\n                    <div className=\"font-medium text-gray-700 dark:text-gray-300\">Calculation:</div>\n                    <div className=\"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded\">\n                        {data.calculation}\n                    </div>\n                </div>\n                \n                <div>\n                    <div className=\"font-medium text-gray-700 dark:text-gray-300\">Components:</div>\n                    <div className=\"text-xs space-y-1\">\n                        {Object.entries(data.components || {}).map(([key, value]) => (\n                            <div key={key} className=\"flex justify-between\">\n                                <span className=\"text-gray-600 dark:text-gray-400\">{key}:</span>\n                                <span className=\"font-mono\">{value}</span>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n                \n                <div className=\"border-t pt-2\">\n                    <div className=\"flex justify-between font-medium\">\n                        <span>Result:</span>\n                        <span className=\"text-green-600 dark:text-green-400\">{data.result}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst CohortAnalyzerPage = () => {\n    const initialFilters = {\n        date_from_str: '',\n        date_to_str: '',\n        optional_filters: [], // [{id: uuid, property_name: '', property_values: [], property_source: 'event/user'}]\n    };\n\n    const [filters, setFilters] = useState(initialFilters);\n    const [availableEventProperties, setAvailableEventProperties] = useState([]);\n    const [availableUserProperties, setAvailableUserProperties] = useState([]);\n    const [propertyValueOptions, setPropertyValueOptions] = useState({}); // { 'prop_key': ['val1', 'val2'] }\n\n    const [isLoading, setIsLoading] = useState(false);\n    const [analysisResult, setAnalysisResult] = useState(null);\n    const [error, setError] = useState(null);\n    \n    const [showLifecycleTables, setShowLifecycleTables] = useState(false);\n    const [activePropertyDiscovery, setActivePropertyDiscovery] = useState(false);\n    const [propertyDiscoveryMessage, setPropertyDiscoveryMessage] = useState('');\n    const [isInitializing, setIsInitializing] = useState(true);\n    \n    // User timeline state\n    const [userTimelineData, setUserTimelineData] = useState(null);\n    const [isLoadingTimeline, setIsLoadingTimeline] = useState(false);\n    const [timelineError, setTimelineError] = useState(null);\n    \n    // Event Revenue Timeline state - NEW FEATURE\n    const [eventRevenueTimelineData, setEventRevenueTimelineData] = useState(null);\n    const [isLoadingEventRevenueTimeline, setIsLoadingEventRevenueTimeline] = useState(false);\n    const [eventRevenueTimelineError, setEventRevenueTimelineError] = useState(null);\n    const [selectedUserId, setSelectedUserId] = useState('');\n    const [selectedProductId, setSelectedProductId] = useState('');\n    const [availableUsers, setAvailableUsers] = useState([]);\n    const [availableProducts, setAvailableProducts] = useState([]);\n    \n    // Add state for cohort definition warning\n    const [cohortDefinitionWarning, setCohortDefinitionWarning] = useState(null);\n    \n    // Add state for tooltip\n    const [tooltipData, setTooltipData] = useState(null);\n    const [tooltipPosition, setTooltipPosition] = useState({ x: 0, y: 0 });\n\n    // Add state for product selection at component level\n    const [selectedProducts, setSelectedProducts] = React.useState({});\n\n    // State for lifecycle table global product selection (single selector for all tables)\n    const [globalSelectedProduct, setGlobalSelectedProduct] = React.useState(\"\");\n    \n    // State for chart modal\n    const [showChartModal, setShowChartModal] = React.useState(false);\n\n    // Load saved filters from localStorage on component mount\n    useEffect(() => {\n        const savedFilters = localStorage.getItem('cohortAnalyzerFilters');\n        if (savedFilters) {\n            try {\n                const parsedFilters = JSON.parse(savedFilters);\n                setFilters(prev => ({\n                    ...prev,\n                    ...parsedFilters,\n                    optional_filters: parsedFilters.optional_filters || [] // Ensure optional_filters exists\n                }));\n            } catch (error) {\n                console.error('Error loading saved filters:', error);\n            }\n        }\n    }, []);\n\n    // Save filters to localStorage whenever they change\n    useEffect(() => {\n        const filtersToSave = {\n            date_from_str: filters.date_from_str,\n            date_to_str: filters.date_to_str,\n            optional_filters: filters.optional_filters\n        };\n        localStorage.setItem('cohortAnalyzerFilters', JSON.stringify(filtersToSave));\n    }, [filters.date_from_str, filters.date_to_str, filters.optional_filters]);\n\n    // Define fetchDiscoverableProperties BEFORE it's used in the useEffect\n    const fetchDiscoverableProperties = useCallback(async () => {\n        try {\n            const data = await api.getDiscoverableCohortProperties();\n            setAvailableEventProperties(data.event_properties || []);\n            setAvailableUserProperties(data.user_properties || []);\n            \n            // Check if we got an empty response and need to enable properties\n            if ((!data.event_properties || data.event_properties.length === 0) && \n                (!data.user_properties || data.user_properties.length === 0)) {\n                if (data.status === \"discovery_initiated\") {\n                    setPropertyDiscoveryMessage(data.message || \"Property discovery auto-triggered. Please wait...\");\n                    setActivePropertyDiscovery(true);\n                    // Poll for completion\n                    const checkDiscoveryInterval = setInterval(async () => {\n                        try {\n                            const status = await api.getPropertyDiscoveryStatus();\n                            if (status.status === 'completed') {\n                                clearInterval(checkDiscoveryInterval);\n                                setActivePropertyDiscovery(false);\n                                setPropertyDiscoveryMessage(\"Discovery completed! Refreshing properties...\");\n                                // Refresh properties after a delay\n                                setTimeout(fetchDiscoverableProperties, 1000);\n                            }\n                        } catch (err) {\n                            console.error(\"Error checking discovery status:\", err);\n                        }\n                    }, 3000);\n                }\n            }\n        } catch (err) {\n            console.error(\"Error fetching discoverable properties:\", err);\n            if (err.code === \"tables_missing\") {\n                // Specific error for missing tables - try to enable properties automatically\n                try {\n                    await api.enableCohortProperties();\n                    setPropertyDiscoveryMessage(\"Property system initialized. Please wait while we discover properties...\");\n                    // Give time for the initialization and then try again\n                    setTimeout(fetchDiscoverableProperties, 2000);\n                } catch (enableErr) {\n                    setError(\"Could not initialize property system. Please try again or check server logs.\");\n                }\n            } else {\n                setError(\"Could not load filter property lists. Try triggering discovery or check console.\");\n            }\n        }\n    }, []);\n\n    const getPropertyDiscoveryStatus = useCallback(async () => {\n        try {\n            const status = await api.getPropertyDiscoveryStatus();\n            if (status.active) {\n                setActivePropertyDiscovery(true);\n                setPropertyDiscoveryMessage(status.message || \"Property discovery in progress...\");\n            } else if (status.status === 'completed') {\n                setActivePropertyDiscovery(false);\n            }\n        } catch (err) {\n            console.error(\"Error checking discovery status:\", err);\n        }\n    }, []);\n\n    // Initialize properties and fetch discoverable properties on mount\n    useEffect(() => {\n        const initializeProperties = async () => {\n            setIsInitializing(true);\n            try {\n                // First try to enable properties to ensure tables exist\n                await api.enableCohortProperties();\n                // Check discovery status\n                await getPropertyDiscoveryStatus();\n                // Then fetch the properties\n                await fetchDiscoverableProperties();\n            } catch (err) {\n                console.error(\"Error initializing properties:\", err);\n                setError(\"Could not initialize property system. Please check server logs.\");\n            } finally {\n                setIsInitializing(false);\n            }\n        };\n        \n        initializeProperties();\n    }, [fetchDiscoverableProperties, getPropertyDiscoveryStatus]);\n\n    const handleFilterChange = (type, value, index = -1) => {\n        setFilters(prev => {\n            const newFilters = { ...prev };\n            if (type === 'date_from_str' || type === 'date_to_str') {\n                newFilters[type] = value;\n            } else if (type === 'optional_filter_property') {\n                newFilters.optional_filters[index].property_name = value;\n                newFilters.optional_filters[index].property_values = []; // Reset values\n                if (value) fetchPropertyValues(value, 'user', 'optional_filter_' + index);\n            } else if (type === 'optional_filter_values') {\n                // Assuming value is an array from a multi-select component\n                newFilters.optional_filters[index].property_values = value;\n            } else if (type.startsWith('optional_filter_')) {\n                const field = type.substring('optional_filter_'.length); // 'property', 'values', 'source'\n                if (field === 'property') {\n                    newFilters.optional_filters[index].property_name = value;\n                    newFilters.optional_filters[index].property_values = []; // Reset values\n                    if (value && newFilters.optional_filters[index].property_source) {\n                        fetchPropertyValues(value, newFilters.optional_filters[index].property_source, `optional_filter_${index}`);\n                    }\n                } else if (field === 'values') {\n                    newFilters.optional_filters[index].property_values = value; // Assuming array\n                } else if (field === 'source') {\n                    newFilters.optional_filters[index].property_source = value;\n                    // If property name already exists, re-fetch values for new source\n                    if (newFilters.optional_filters[index].property_name) {\n                         fetchPropertyValues(newFilters.optional_filters[index].property_name, value, `optional_filter_${index}`);\n                    }\n                }\n            }\n            return newFilters;\n        });\n    };\n\n    const fetchPropertyValues = async (propertyName, propertySource, filterIdentifier) => {\n        if (!propertyName || !propertySource) return;\n        try {\n            const data = await api.getDiscoverableCohortPropertyValues(propertyName, propertySource);\n            setPropertyValueOptions(prev => ({ ...prev, [filterIdentifier + '_' + propertyName]: data.values || [] }));\n        } catch (err) {\n            console.error(`Error fetching values for ${propertyName}:`, err);\n             setPropertyValueOptions(prev => ({ ...prev, [filterIdentifier + '_' + propertyName]: [] }));\n        }\n    };\n\n    const addOptionalFilter = () => {\n        setFilters(prev => ({\n            ...prev,\n            optional_filters: [...prev.optional_filters, { id: Date.now().toString(), property_name: '', property_values: [], property_source: 'event' }]\n        }));\n    };\n\n    const removeOptionalFilter = (idToRemove) => {\n        setFilters(prev => ({\n            ...prev,\n            optional_filters: prev.optional_filters.filter(f => f.id !== idToRemove)\n        }));\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setIsLoading(true);\n        setError(null);\n        setAnalysisResult(null);\n        setUserTimelineData(null);\n        setTimelineError(null);\n        \n        // Reset event revenue timeline state\n        setEventRevenueTimelineData(null);\n        setEventRevenueTimelineError(null);\n        setSelectedUserId('');\n        setSelectedProductId('');\n        \n        // Reset warning state\n        setCohortDefinitionWarning(null);\n        \n        try {\n            // Basic validation\n            if (!filters.date_from_str || !filters.date_to_str) {\n                throw new Error(\"Start Date and End Date are required.\");\n            }\n\n            // Remove the check that requires primary filter when secondary filters exist\n            // We'll allow analysis without a primary filter\n            \n            // Check primary filter has values if property is selected\n            if (filters.optional_filters.length > 0 && filters.optional_filters[0].property_name && filters.optional_filters[0].property_values.length === 0) {\n                throw new Error(\"Please select values for the optional filters or clear the property selection.\");\n            }\n\n            // Validate secondary filters\n            for (const filter of filters.optional_filters) {\n                if (!filter.property_name || filter.property_values.length === 0) {\n                    throw new Error(`Optional filter is incomplete. Please select both property and values for all filters or remove unused ones.`);\n                }\n            }\n\n            // Define precise cohort filtering requirements for the backend\n            // Define precise cohort filtering requirements for the backend\n            // This ensures ONLY users with a trial started event in the specified date range are included\n            const cohortFilters = {\n                ...filters,\n                enforce_trial_started: true, // Add flag to inform backend to enforce trial started requirement\n                cohort_definition: {\n                    required_event: \"RC Trial started\",\n                    date_range: {\n                        from: filters.date_from_str,\n                        to: filters.date_to_str\n                    },\n                    strict_filtering: true // Only include events from users in this cohort\n                }\n            };\n\n            const result = await api.analyzeCohortData(cohortFilters);\n            if (result.error) {\n                setError(result.error);\n            } else {\n                // Verify that the backend properly applied our cohort definition\n                // by checking if trial_started user count matches the total cohort users\n                if (result.cohort_event_occurrence && \n                    result.cohort_event_occurrence.trial_started && \n                    result.summary_stats && \n                    result.summary_stats.total_users_in_final_cohort) {\n                    \n                    const trialStartedUsers = result.cohort_event_occurrence.trial_started.user_count;\n                    const totalCohortUsers = result.summary_stats.total_users_in_final_cohort;\n                    \n                    // The counts should match if cohort definition was applied correctly\n                    if (trialStartedUsers !== totalCohortUsers) {\n                        const warningMessage = \n                            `Warning: Cohort definition may not be correctly applied. ` +\n                            `Cohort users (${totalCohortUsers}) should equal ` +\n                            `trial started users (${trialStartedUsers}).`;\n                        \n                        console.warn(warningMessage);\n                        setCohortDefinitionWarning(warningMessage);\n                    }\n                }\n                \n                setAnalysisResult(result);\n                // Fetch timeline data after successful analysis\n                fetchUserTimeline();\n                // Fetch event revenue timeline data (aggregate mode)\n                fetchEventRevenueTimeline();\n            }\n        } catch (err) {\n            console.error(\"Analysis error:\", err);\n            setError(err.message || \"Analysis failed. Please check that you have selected valid filter criteria.\");\n        }\n        setIsLoading(false);\n    };\n\n    const fetchUserTimeline = async () => {\n        setIsLoadingTimeline(true);\n        try {\n            console.log('[DEBUG] fetchUserTimeline called with filters:', filters);\n            // Use only the basic filters that the unified pipeline expects\n            const timelineData = await api.getCohortUserTimeline(filters);\n            console.log('[DEBUG] fetchUserTimeline response:', timelineData);\n            if (timelineData.error) {\n                console.log('[DEBUG] fetchUserTimeline error:', timelineData.error);\n                setTimelineError(timelineData.error);\n            } else {\n                console.log('[DEBUG] Setting userTimelineData:', timelineData);\n                setUserTimelineData(timelineData);\n            }\n        } catch (err) {\n            console.error(\"Timeline fetch error:\", err);\n            setTimelineError(err.message || \"Could not load user timeline data.\");\n        }\n        setIsLoadingTimeline(false);\n    };\n    \n    const fetchEventRevenueTimeline = async (distinctId = null, productId = null) => {\n        setIsLoadingEventRevenueTimeline(true);\n        setEventRevenueTimelineError(null);\n        \n        try {\n            console.log('[DEBUG] fetchEventRevenueTimeline called with filters:', filters, 'distinctId:', distinctId, 'productId:', productId);\n            // Use only the basic filters that the unified pipeline expects\n            const timelineData = await api.getUserEventRevenueTimeline(filters, distinctId, productId);\n            console.log('[DEBUG] fetchEventRevenueTimeline response:', timelineData);\n            if (timelineData.error) {\n                console.log('[DEBUG] fetchEventRevenueTimeline error:', timelineData.error);\n                setEventRevenueTimelineError(timelineData.error);\n            } else {\n                console.log('[DEBUG] Setting eventRevenueTimelineData:', timelineData);\n                setEventRevenueTimelineData(timelineData);\n                \n                // Update available users and products from the response\n                if (timelineData.available_users) {\n                    setAvailableUsers(timelineData.available_users);\n                }\n                if (timelineData.available_products) {\n                    setAvailableProducts(timelineData.available_products);\n                }\n            }\n        } catch (err) {\n            console.error(\"Event revenue timeline fetch error:\", err);\n            setEventRevenueTimelineError(err.message || \"Could not load event revenue timeline data.\");\n        }\n        setIsLoadingEventRevenueTimeline(false);\n    };\n    \n    // Function to determine cell state based on user's event history\n    // Returns the event state for a day (used for cell background color)\n    const getCellState = (userProductKey, date, eventMap) => {\n        // If this user has no events on this date, return default state\n        if (!eventMap[userProductKey] || !eventMap[userProductKey][date]) {\n            // Look for the most recent event before this date to maintain state\n            let mostRecentEventDate = null;\n            let mostRecentState = 'default';\n            \n            if (eventMap[userProductKey]) {\n                // Find the most recent event before this date\n                for (const eventDate in eventMap[userProductKey]) {\n                    if (eventDate <= date && (!mostRecentEventDate || eventDate > mostRecentEventDate)) {\n                        mostRecentEventDate = eventDate;\n                        // Get the last event of that day which would determine state going forward\n                        const events = eventMap[userProductKey][eventDate];\n                        const lastEvent = events[events.length - 1];\n                        \n                        // Determine the state based on the last event\n                        if (lastEvent.type === 'RC Trial started') {\n                            mostRecentState = 'trial_started';\n                        } else if (lastEvent.type === 'RC Trial converted') {\n                            mostRecentState = 'trial_converted';\n                        } else if (lastEvent.type === 'RC Trial cancelled') {\n                            mostRecentState = 'trial_cancelled';\n                        } else if (lastEvent.type === 'RC Initial purchase') {\n                            mostRecentState = 'trial_converted';  // Use same color as trial converted\n                        } else if (lastEvent.type === 'RC Renewal') {\n                            mostRecentState = 'trial_converted';  // Use same color for renewals\n                        } else if (lastEvent.type === 'RC Cancellation') {\n                            mostRecentState = lastEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n                        }\n                    }\n                }\n            }\n            \n            return mostRecentState;\n        }\n        \n        // Get the first event for this user on this date (which determines cell color)\n        const firstEvent = eventMap[userProductKey][date][0];\n        \n        // Return cell state based on the first event type\n        if (firstEvent.type === 'RC Trial started') {\n            return 'trial_started';\n        } else if (firstEvent.type === 'RC Trial converted') {\n            return 'trial_converted';\n        } else if (firstEvent.type === 'RC Trial cancelled') {\n            return 'trial_cancelled';\n        } else if (firstEvent.type === 'RC Initial purchase') {\n            return 'trial_converted';  // Use same color as trial converted for initial purchase\n        } else if (firstEvent.type === 'RC Renewal') {\n            return 'trial_converted';  // Use same color for renewals\n        } else if (firstEvent.type === 'RC Cancellation') {\n            // If cancellation has refund flag, use refunded color\n            return firstEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n        }\n        \n        return 'default';\n    };\n    \n    // Function to get events for a specific date (returns an array of events)\n    const getEventsForDate = (userProductKey, date, eventMap) => {\n        if (!eventMap[userProductKey] || !eventMap[userProductKey][date]) {\n            return [];\n        }\n        return eventMap[userProductKey][date];\n    };\n\n    const triggerPropertyDiscovery = async () => {\n        setActivePropertyDiscovery(true);\n        setPropertyDiscoveryMessage('Property discovery initiated...');\n        try {\n            const result = await api.triggerCohortPropertyDiscovery(); // Updated API method name\n            setPropertyDiscoveryMessage(result.message + \" Refresh page after a few moments to see updated filter options.\");\n            // Optionally, could poll for completion or auto-refresh discoverable props\n            setTimeout(() => fetchDiscoverableProperties(), 5000); // Re-fetch after a delay\n        } catch (err) {\n             setPropertyDiscoveryMessage('Error triggering discovery: ' + (err.message || 'Unknown error'));\n        }\n        // setActivePropertyDiscovery(false); // Keep message displayed\n    }\n\n    const renderLifecycleTable = (title, ratesData, denominatorKey = \"rate_denominator_count\") => {\n        // Add debugging\n        console.log(`[DEBUG] renderLifecycleTable called for \"${title}\"`);\n        console.log(`[DEBUG] ratesData:`, ratesData);\n        \n        if (!ratesData) {\n            console.log(`[DEBUG] No ratesData for \"${title}\"`);\n            return <p className=\"text-sm text-gray-500 dark:text-gray-300\">Lifecycle rate data not available for {title}.</p>;\n        }\n        \n        // Handle new product-based format\n        const isNewFormat = ratesData.rates_by_product || ratesData.aggregate_rates;\n        console.log(`[DEBUG] isNewFormat: ${isNewFormat} for \"${title}\"`);\n        \n        if (isNewFormat) {\n            const aggregateRates = ratesData.aggregate_rates;\n            const productRates = ratesData.rates_by_product || {};\n            \n            console.log(`[DEBUG] aggregateRates:`, aggregateRates);\n            console.log(`[DEBUG] productRates:`, productRates);\n            \n            if (!aggregateRates || !aggregateRates.rates_by_day || Object.keys(aggregateRates.rates_by_day).length === 0) {\n                console.log(`[DEBUG] No valid aggregateRates for \"${title}\"`);\n                \n                // Show raw data for debugging\n                return (\n                    <div className=\"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg\">\n                        <h4 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">{title} - Debug Info</h4>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">Raw data structure (for debugging):</p>\n                        <pre className=\"text-xs bg-gray-100 dark:bg-gray-800 p-2 rounded overflow-x-auto\">\n                            {JSON.stringify(ratesData, null, 2)}\n                        </pre>\n                    </div>\n                );\n            }\n            \n            // Determine which rates to display based on global product selector\n            const displayRates = globalSelectedProduct && productRates[globalSelectedProduct] \n                ? productRates[globalSelectedProduct] \n                : aggregateRates;\n            \n            const ratesByDay = displayRates.rates_by_day;\n            const sortedDays = Object.keys(ratesByDay).map(Number).sort((a, b) => a - b);\n            \n            // Prepare row data for the transposed table\n            const rowData = [\n                {\n                    metric: \"Raw Daily Cancellation %\",\n                    dataKey: \"raw_daily_cancellation_rate\"\n                },\n                {\n                    metric: \"Smoothed Daily Cancellation %\", \n                    dataKey: \"smoothed_daily_cancellation_rate\"\n                },\n                {\n                    metric: \"Raw Cumulative Cancellation %\",\n                    dataKey: \"raw_cumulative_cancellation_rate\"\n                },\n                {\n                    metric: \"Smoothed Cumulative Cancellation %\",\n                    dataKey: \"smoothed_cumulative_cancellation_rate\"\n                },\n                {\n                    metric: \"Raw Daily Refund %\",\n                    dataKey: \"raw_daily_refund_rate\"\n                },\n                {\n                    metric: \"Smoothed Daily Refund %\",\n                    dataKey: \"smoothed_daily_refund_rate\"\n                },\n                {\n                    metric: \"Raw Cumulative Refund %\",\n                    dataKey: \"raw_cumulative_refund_rate\"\n                },\n                {\n                    metric: \"Smoothed Cumulative Refund %\",\n                    dataKey: \"smoothed_cumulative_refund_rate\"\n                }\n            ];\n            \n            return (\n                <div className=\"mb-6\">\n                    <h4 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{title}</h4>\n                    \n                    {/* Smoothing Information */}\n                    <div className=\"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg\">\n                        <h5 className=\"font-semibold text-blue-800 dark:text-blue-200 mb-2\">Smoothing Method Information</h5>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300\">\n                            <div>\n                                <p><strong>Method:</strong> {displayRates.smoothing_method || 'none'}</p>\n                                <p><strong>Quality:</strong> {displayRates.smoothing_quality || 'N/A'}</p>\n                                <p><strong>Sample Size:</strong> {displayRates.total_sample_size || 0}</p>\n                            </div>\n                            {displayRates.smoothing_details && (\n                                <div>\n                                    <p><strong>Data Characteristics:</strong></p>\n                                    <ul className=\"ml-4 mt-1\">\n                                        {displayRates.smoothing_details.cancellation && (\n                                            <>\n                                                <li>Early Concentration: {displayRates.smoothing_details.cancellation.early_concentration}</li>\n                                                <li>Sparsity: {displayRates.smoothing_details.cancellation.sparsity}</li>\n                                                <li>Max Rate: {displayRates.smoothing_details.cancellation.max_rate}</li>\n                                            </>\n                                        )}\n                                    </ul>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                    \n                    {/* Transposed Table with Frozen First Column */}\n                    <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n                        <div className=\"flex\">\n                            {/* Frozen First Column */}\n                            <div className=\"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700\">\n                                <div className=\"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700\">\n                                    Metric\n                                </div>\n                                {rowData.map((row, index) => (\n                                    <div key={index} className={`px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ${\n                                        index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'\n                                    } text-gray-900 dark:text-white font-medium`}>\n                                        {row.metric}\n                                    </div>\n                                ))}\n                            </div>\n                            \n                            {/* Scrollable Data Columns */}\n                            <div className=\"flex-1 overflow-x-auto\">\n                                <div className=\"flex\">\n                                    {sortedDays.map((day) => {\n                                        const dayStr = day.toString();\n                                        const dayData = ratesByDay[dayStr];\n                                        \n                                        return (\n                                            <div key={dayStr} className=\"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0\">\n                                                {/* Header */}\n                                                <div className=\"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700\">\n                                                    Day {day}\n                                                </div>\n                                                \n                                                {/* Data Cells */}\n                                                {rowData.map((row, index) => (\n                                                    <div key={index} className={`px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ${\n                                                        index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'\n                                                    } text-gray-500 dark:text-gray-300`}>\n                                                        {dayData ? (dayData[row.dataKey] || 0).toFixed(2) : '0.00'}%\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        );\n                                    })}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n        \n        // Fall back to legacy format handling if needed\n        if (!ratesData.rates_by_day || Object.keys(ratesData.rates_by_day).length === 0) {\n            return <p className=\"text-sm text-gray-500 dark:text-gray-300\">No lifecycle rate data available for {title}.</p>;\n        }\n        \n        const sortedDays = Object.keys(ratesData.rates_by_day).map(Number).sort((a, b) => a - b);\n        const ratesDenominator = ratesData[denominatorKey] || 0;\n        \n        // Legacy format with transposed layout\n        const legacyRowData = [\n            { metric: \"Daily Cancel %\", dataKey: \"cancelled_daily_pct\" },\n            { metric: \"Cumulative Cancel %\", dataKey: \"cancelled_cumulative_pct\" },\n            { metric: \"Daily Convert %\", dataKey: \"converted_daily_pct\" },\n            { metric: \"Cumulative Convert %\", dataKey: \"converted_cumulative_pct\" }\n        ];\n        \n        return (\n            <div className=\"mb-6\">\n                <h4 className=\"text-lg font-semibold mb-2 text-gray-900 dark:text-white\">{title}</h4>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-3\">\n                    Based on {ratesDenominator} users. {ratesData.message}\n                </p>\n                \n                {/* Transposed Legacy Table */}\n                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n                    <div className=\"flex\">\n                        {/* Frozen First Column */}\n                        <div className=\"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700\">\n                            <div className=\"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700\">\n                                Metric\n                            </div>\n                            {legacyRowData.map((row, index) => (\n                                <div key={index} className={`px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ${\n                                    index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'\n                                } text-gray-900 dark:text-white font-medium`}>\n                                    {row.metric}\n                                </div>\n                            ))}\n                        </div>\n                        \n                        {/* Scrollable Data Columns */}\n                        <div className=\"flex-1 overflow-x-auto\">\n                            <div className=\"flex\">\n                                {sortedDays.map((day) => {\n                                    const dayStr = day.toString();\n                                    const dayData = ratesData.rates_by_day[dayStr];\n                                    \n                                    return (\n                                        <div key={dayStr} className=\"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0\">\n                                            {/* Header */}\n                                            <div className=\"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700\">\n                                                Day {day}\n                                            </div>\n                                            \n                                            {/* Data Cells */}\n                                            {legacyRowData.map((row, index) => (\n                                                <div key={index} className={`px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ${\n                                                    index % 2 === 0 ? 'bg-white dark:bg-gray-900' : 'bg-gray-50 dark:bg-gray-800'\n                                                } text-gray-500 dark:text-gray-300`}>\n                                                    {dayData ? (dayData[row.dataKey] || 0).toFixed(2) : '0.00'}%\n                                                </div>\n                                            ))}\n                                        </div>\n                                    );\n                                })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    const formatCurrency = (value) => {\n        if (value === null || value === undefined) return \"N/A\";\n        return value.toLocaleString('en-US', { style: 'currency', currency: 'USD' });\n    };\n    \n    // Prepare data for the chart\n    const chartData = analysisResult?.daily_data.map(d => {\n        const actualNetRevenue = d.cumulative_revenue_actual_net || 0;\n        // Dotted line: actual net cumulative revenue + (estimated additional from pending trials) + (net effect of estimated future refunds on actual revenue)\n        // The estimated_future_refunds_on_actual_revenue_amount is an *amount* to be subtracted.\n        const projectedNetRevenue = actualNetRevenue + \n                                    (d.estimated_additional_revenue_from_pending_trials_net_refund || 0) -\n                                    (d.estimated_future_refunds_on_actual_revenue_amount || 0);\n        \n        const trialsStarted = d.daily_trials_started || 0;\n        const trialsConverted = d.daily_trials_converted_actual || 0;\n        const trialsCancelled = d.daily_trials_cancelled_actual || 0;\n        const trialsEnded = trialsConverted + trialsCancelled;\n        const trialsPending = d.daily_trials_started - trialsEnded;\n        \n        return {\n            date: d.date,\n            // Absolute values - Daily\n            daily_trials_started: trialsStarted,\n            daily_trials_ended: trialsEnded,\n            daily_trials_pending: trialsPending,\n            daily_conversions: trialsConverted,\n            daily_conversions_net_refunds: trialsConverted - (d.daily_refund_count_actual || 0),\n            daily_estimated_conversions_net_refunds: trialsConverted - (d.daily_estimated_refunds || 0),\n            daily_refunds: d.daily_refund_count_actual || 0,\n            \n            // Money values - Daily\n            daily_revenue: d.daily_revenue_actual || 0,\n            daily_revenue_net: d.daily_revenue_actual_net || 0,\n            daily_estimated_revenue: d.daily_estimated_revenue || 0,\n            \n            // Absolute values - Cumulative\n            cumulative_trials_started: d.cumulative_trials_started || 0,\n            cumulative_trials_ended: (d.cumulative_trials_converted_actual || 0) + (d.cumulative_trials_cancelled_actual || 0),\n            cumulative_trials_pending: d.cumulative_trials_started - ((d.cumulative_trials_converted_actual || 0) + (d.cumulative_trials_cancelled_actual || 0)),\n            cumulative_conversions: d.cumulative_trials_converted_actual || 0,\n            cumulative_conversions_net_refunds: (d.cumulative_trials_converted_actual || 0) - (d.cumulative_refund_count_actual || 0),\n            cumulative_estimated_conversions_net_refunds: (d.cumulative_trials_converted_actual || 0) - (d.cumulative_estimated_refunds || 0),\n            cumulative_refunds: d.cumulative_refund_count_actual || 0,\n            \n            // Money values - Cumulative\n            cumulative_revenue: d.cumulative_revenue_actual || 0,\n            cumulative_revenue_net: actualNetRevenue,\n            cumulative_estimated_revenue: projectedNetRevenue,\n        };\n    }) || [];\n    \n    const [visibleAbsoluteMetrics, setVisibleAbsoluteMetrics] = useState({\n        daily_trials_started: true,\n        daily_trials_ended: false,\n        daily_trials_pending: false,\n        daily_conversions: true,\n        daily_conversions_net_refunds: false,\n        daily_estimated_conversions_net_refunds: false,\n        daily_refunds: false,\n        cumulative_trials_started: true,\n        cumulative_trials_ended: false,\n        cumulative_trials_pending: false,\n        cumulative_conversions: true,\n        cumulative_conversions_net_refunds: false,\n        cumulative_estimated_conversions_net_refunds: false,\n        cumulative_refunds: false,\n    });\n    \n    const [visibleMoneyMetrics, setVisibleMoneyMetrics] = useState({\n        daily_revenue: true,\n        daily_revenue_net: false,\n        daily_estimated_revenue: false,\n        cumulative_revenue: false,\n        cumulative_revenue_net: true,\n        cumulative_estimated_revenue: true,\n    });\n\n    const toggleAbsoluteMetric = (metricKey) => {\n        setVisibleAbsoluteMetrics(prev => ({...prev, [metricKey]: !prev[metricKey]}));\n    };\n    \n    const toggleMoneyMetric = (metricKey) => {\n        setVisibleMoneyMetrics(prev => ({...prev, [metricKey]: !prev[metricKey]}));\n    };\n\n    // Add this function to determine which styles to use based on dark mode detection\n    const getSelectTheme = () => {\n        const isDarkMode = document.documentElement.classList.contains('dark') || \n                          window.matchMedia('(prefers-color-scheme: dark)').matches;\n        return isDarkMode ? darkModeSelectStyles : customSelectStyles;\n    };\n\n    // Chart Modal Component\n    const ChartModal = () => {\n        if (!showChartModal || !analysisResult?.lifecycle_rates) return null;\n\n        const lifecycleRates = analysisResult.lifecycle_rates;\n        \n        // Get chart data for different scenarios\n        const getChartData = (ratesData, title, type = 'cancellation_refund') => {\n            if (!ratesData?.rates_by_day) return null;\n\n            const days = Object.keys(ratesData.rates_by_day).map(Number).sort((a, b) => a - b);\n            \n            let datasets = [];\n            \n            if (type === 'cancellation_refund') {\n                // Cancellation/Refund scenario\n                datasets = [\n                    {\n                        label: 'Raw Cumulative Cancellation %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.raw_cumulative_cancellation_rate || 0),\n                        borderColor: 'rgb(255, 99, 132)',\n                        backgroundColor: 'rgba(255, 99, 132, 0.1)',\n                        borderDash: [],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Smoothed Cumulative Cancellation %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.smoothed_cumulative_cancellation_rate || 0),\n                        borderColor: 'rgb(255, 99, 132)',\n                        backgroundColor: 'rgba(255, 99, 132, 0.3)',\n                        borderDash: [5, 5],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Raw Cumulative Refund %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.raw_cumulative_refund_rate || 0),\n                        borderColor: 'rgb(54, 162, 235)',\n                        backgroundColor: 'rgba(54, 162, 235, 0.1)',\n                        borderDash: [],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Smoothed Cumulative Refund %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.smoothed_cumulative_refund_rate || 0),\n                        borderColor: 'rgb(54, 162, 235)',\n                        backgroundColor: 'rgba(54, 162, 235, 0.3)',\n                        borderDash: [5, 5],\n                        tension: 0.1\n                    }\n                ];\n            } else if (type === 'conversion_cancellation') {\n                // Trial Conversion/Cancellation scenario\n                datasets = [\n                    {\n                        label: 'Raw Cumulative Conversion %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.raw_cumulative_conversion_rate || 0),\n                        borderColor: 'rgb(75, 192, 192)',\n                        backgroundColor: 'rgba(75, 192, 192, 0.1)',\n                        borderDash: [],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Smoothed Cumulative Conversion %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.smoothed_cumulative_conversion_rate || 0),\n                        borderColor: 'rgb(75, 192, 192)',\n                        backgroundColor: 'rgba(75, 192, 192, 0.3)',\n                        borderDash: [5, 5],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Raw Cumulative Cancellation %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.raw_cumulative_cancellation_rate || 0),\n                        borderColor: 'rgb(255, 99, 132)',\n                        backgroundColor: 'rgba(255, 99, 132, 0.1)',\n                        borderDash: [],\n                        tension: 0.1\n                    },\n                    {\n                        label: 'Smoothed Cumulative Cancellation %',\n                        data: days.map(day => ratesData.rates_by_day[day.toString()]?.smoothed_cumulative_cancellation_rate || 0),\n                        borderColor: 'rgb(255, 99, 132)',\n                        backgroundColor: 'rgba(255, 99, 132, 0.3)',\n                        borderDash: [5, 5],\n                        tension: 0.1\n                    }\n                ];\n            }\n\n            return {\n                labels: days.map(day => `Day ${day}`),\n                datasets: datasets\n            };\n        };\n\n        const chartOptions = {\n            responsive: true,\n            plugins: {\n                legend: {\n                    position: 'top',\n                },\n                title: {\n                    display: true,\n                    text: 'Raw vs Smoothed Cumulative Rates'\n                }\n            },\n            scales: {\n                y: {\n                    beginAtZero: true,\n                    title: {\n                        display: true,\n                        text: 'Percentage (%)'\n                    }\n                },\n                x: {\n                    title: {\n                        display: true,\n                        text: 'Days'\n                    }\n                }\n            }\n        };\n\n        // Determine which rates to use based on global product selector\n        const getDisplayRates = (ratesData) => {\n            if (!ratesData) return null;\n            if (globalSelectedProduct && ratesData.rates_by_product && ratesData.rates_by_product[globalSelectedProduct]) {\n                return ratesData.rates_by_product[globalSelectedProduct];\n            }\n            return ratesData.aggregate_rates || ratesData;\n        };\n\n        const trialToOutcomeRates = getDisplayRates(lifecycleRates.trial_to_outcome_rates);\n        const cancellationRefundRates = getDisplayRates(lifecycleRates.trial_to_cancellation_rates || lifecycleRates.trial_to_refund_rates);\n\n        return (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto\">\n                    <div className=\"p-6\">\n                        <div className=\"flex justify-between items-center mb-6\">\n                            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                                Lifecycle Rate Charts\n                            </h2>\n                            <button\n                                onClick={() => setShowChartModal(false)}\n                                className=\"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n                            >\n                                <XCircle size={24} />\n                            </button>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                            {/* Trial to Outcome Chart */}\n                            {trialToOutcomeRates && (\n                                <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\">\n                                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">\n                                        Trial to Outcome (Conversion vs Cancellation)\n                                    </h3>\n                                    <ChartLine \n                                        data={getChartData(trialToOutcomeRates, 'Trial to Outcome', 'conversion_cancellation')}\n                                        options={chartOptions}\n                                    />\n                                </div>\n                            )}\n\n                            {/* Cancellation/Refund Chart */}\n                            {cancellationRefundRates && (\n                                <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\">\n                                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">\n                                        Cancellation vs Refund Rates\n                                    </h3>\n                                    <ChartLine \n                                        data={getChartData(cancellationRefundRates, 'Cancellation vs Refund', 'cancellation_refund')}\n                                        options={chartOptions}\n                                    />\n                                </div>\n                            )}\n                        </div>\n\n                        <div className=\"mt-6 text-sm text-gray-600 dark:text-gray-400\">\n                            <p><strong>Legend:</strong></p>\n                            <ul className=\"list-disc list-inside mt-2\">\n                                <li>Solid lines represent raw data</li>\n                                <li>Dashed lines represent smoothed curves</li>\n                                <li>The smoothing algorithm first smooths cumulative rates, then derives daily rates</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    return (\n        <div className=\"p-6 max-w-full mx-auto bg-white dark:bg-gray-800 min-h-screen\">\n            <h1 className=\"text-3xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 border-gray-200 dark:border-gray-600\">Cohort Analyzer</h1>\n\n            {isInitializing ? (\n                <div className=\"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md\">\n                    <Loader className=\"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\" />\n                    <p className=\"text-gray-700 dark:text-white\">Initializing cohort analyzer...</p>\n                </div>\n            ) : (\n                <form onSubmit={handleSubmit} className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md mb-8\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6 border-b border-gray-200 dark:border-gray-600 pb-6\">\n                        <div>\n                            <label htmlFor=\"date_from_str\" className=\"block text-sm font-medium text-gray-700 dark:text-white mb-2\">Start Date *</label>\n                            <input type=\"date\" id=\"date_from_str\" value={filters.date_from_str} onChange={e => handleFilterChange('date_from_str', e.target.value)}\n                                className=\"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white\" required />\n                        </div>\n                        <div>\n                            <label htmlFor=\"date_to_str\" className=\"block text-sm font-medium text-gray-700 dark:text-white mb-2\">End Date *</label>\n                            <input type=\"date\" id=\"date_to_str\" value={filters.date_to_str} onChange={e => handleFilterChange('date_to_str', e.target.value)}\n                                className=\"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white\" required />\n                        </div>\n                    </div>\n\n                    {/* Optional Filters Section */}\n                    <div className=\"mb-6 p-5 border rounded-md border-teal-200 dark:border-teal-500 bg-teal-50 dark:bg-teal-900/40\">\n                        <div className=\"flex justify-between items-center mb-3\">\n                            <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white\">Additional Event/User Property Filters</h3>\n                            <button \n                                type=\"button\" \n                                onClick={addOptionalFilter}\n                                className=\"p-1.5 bg-teal-100 dark:bg-teal-600 text-teal-700 dark:text-white rounded-full hover:bg-teal-200 dark:hover:bg-teal-500 transition-colors\"\n                            >\n                                <PlusCircle size={18} />\n                            </button>\n                        </div>\n                        {filters.optional_filters.length === 0 && (\n                            <p className=\"text-sm text-gray-600 dark:text-gray-300 italic mb-2\">No additional filters. Click the + button to add a filter.</p>\n                        )}\n                        {filters.optional_filters.map((filter, index) => (\n                            <div key={filter.id} className=\"grid grid-cols-1 md:grid-cols-4 gap-3 items-end mb-4 p-4 border-t dark:border-gray-600 bg-white dark:bg-gray-600 rounded-md shadow-sm\">\n                                <div>\n                                    <label className=\"block text-xs font-medium text-gray-600 dark:text-white mb-1\">Source Type</label>\n                                    <select value={filter.property_source}\n                                            onChange={e => handleFilterChange(`optional_filter_source`, e.target.value, index)}\n                                            className=\"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\">\n                                        <option value=\"event\">Event Property</option>\n                                        <option value=\"user\">User Property</option>\n                                    </select>\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-medium text-gray-600 dark:text-white mb-1\">Property Name</label>\n                                    <select value={filter.property_name}\n                                            onChange={e => handleFilterChange(`optional_filter_property`, e.target.value, index)}\n                                            className=\"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\">\n                                        <option value=\"\">-- Select Property --</option>\n                                        {(filter.property_source === 'event' ? availableEventProperties : availableUserProperties).map(p => <option key={p.key} value={p.key}>{p.display_name || p.key}</option>)}\n                                    </select>\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-medium text-gray-600 dark:text-white mb-1\">Property Value(s)</label>\n                                    <Select\n                                        isMulti\n                                        isDisabled={!filter.property_name || !filter.property_source}\n                                        options={(propertyValueOptions[`optional_filter_${index}_` + filter.property_name] || []).map(val => ({ value: val, label: val }))}\n                                        value={filter.property_values.map(val => ({ value: val, label: val }))}\n                                        onChange={(selected) => handleFilterChange(`optional_filter_values`, selected ? selected.map(option => option.value) : [], index)}\n                                        styles={getSelectTheme()}\n                                        placeholder=\"Select values...\"\n                                    />\n                                </div>\n                                <div className=\"flex justify-end\">\n                                    <button type=\"button\" onClick={() => removeOptionalFilter(filter.id)}\n                                            className=\"p-1.5 bg-red-100 dark:bg-red-700 text-red-600 dark:text-white rounded-full hover:bg-red-200 dark:hover:bg-red-600 transition-colors\">\n                                        <XCircle size={18} />\n                                    </button>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n\n                    <div className=\"flex items-center justify-between mt-8\">\n                        <button type=\"submit\" disabled={isLoading}\n                                className=\"px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-md shadow hover:bg-indigo-700 disabled:opacity-50 flex items-center transition-colors\">\n                            {isLoading ? (\n                                <>\n                                    <Loader className=\"animate-spin mr-2\" size={16} />\n                                    Analyzing...\n                                </>\n                            ) : 'Analyze Cohort'}\n                        </button>\n                        <button type=\"button\" onClick={triggerPropertyDiscovery} disabled={activePropertyDiscovery}\n                                className=\"px-5 py-2.5 bg-teal-600 text-white text-sm font-medium rounded-md hover:bg-teal-700 disabled:opacity-50 flex items-center transition-colors\">\n                            {activePropertyDiscovery ? (\n                                <>\n                                    <Loader className=\"animate-spin mr-2\" size={16} />\n                                    Discovery Running...\n                                </>\n                            ) : \"Discover Filter Properties\"}\n                        </button>\n                    </div>\n                    {propertyDiscoveryMessage && (\n                        <div className=\"mt-3 p-3 bg-teal-50 dark:bg-teal-900/40 border border-teal-200 dark:border-teal-600 rounded-md\">\n                            <p className=\"text-sm text-teal-700 dark:text-teal-300\">{propertyDiscoveryMessage}</p>\n                        </div>\n                    )}\n                </form>\n            )}\n\n            {error && (\n                <div className=\"my-4 p-4 bg-red-100 dark:bg-red-800 text-red-700 dark:text-white rounded-md shadow-md border border-red-300 dark:border-red-600\">\n                    <div className=\"flex items-center\">\n                        <AlertTriangle className=\"mr-2 flex-shrink-0\" />\n                        <div>\n                            <span className=\"font-medium block\">Analysis Error:</span>\n                            <span className=\"block mt-1\">{error}</span>\n                        </div>\n                    </div>\n                </div>\n            )}\n            \n            {cohortDefinitionWarning && (\n                <div className=\"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\">\n                    <div className=\"flex items-center\">\n                        <AlertTriangle className=\"mr-2 flex-shrink-0\" />\n                        <div>\n                            <span className=\"font-medium block\">Cohort Definition Warning:</span>\n                            <span className=\"block mt-1\">{cohortDefinitionWarning}</span>\n                            <span className=\"block mt-1 text-sm italic\">The backend may not be correctly filtering users based on trial started events.</span>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {analysisResult && (\n                <div className=\"mt-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md\">\n                    <h2 className=\"text-2xl font-bold mb-4 text-gray-800 dark:text-white\">Analysis Results</h2>\n                    \n                    {/* Add the filter stats display component */}\n                    {analysisResult.filter_stats && (\n                        <FilterStatsDisplay filterStats={analysisResult.filter_stats} />\n                    )}\n                    \n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                        <div className=\"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white\">Cohort Users (Trial Started)</h3>\n                            <p className=\"text-2xl font-bold text-indigo-600 dark:text-indigo-300\">{analysisResult.summary_stats?.total_users_in_final_cohort || 0}</p>\n                            <p className=\"text-xs text-gray-500 dark:text-gray-300\">Unique users who had an 'RC Trial started' event in the selected date range (and match primary filter if applied).</p>\n                        </div>\n                        <div className=\"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white\">Events Analyzed (Cohort Only)</h3>\n                            <p className=\"text-2xl font-bold text-indigo-600 dark:text-indigo-300\">{analysisResult.summary_stats?.total_events_analyzed || 0}</p>\n                            <p className=\"text-xs text-gray-500 dark:text-gray-300\">Events from users in the trial started cohort</p>\n                        </div>\n                        <div className=\"p-4 bg-gray-50 dark:bg-gray-600 rounded-md\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white\">Cohort ARPC (Overall)</h3>\n                            <p className=\"text-2xl font-bold text-indigo-600 dark:text-indigo-300\">{formatCurrency(analysisResult.summary_stats?.arpc_cohort)}</p>\n                            <p className=\"text-xs text-gray-500 dark:text-gray-300\">Basis: {analysisResult.summary_stats?.arpc_datapoints} users. {analysisResult.summary_stats?.arpc_calculation_basis}</p>\n                            <p className=\"text-xs text-gray-500 dark:text-gray-300 italic\">See per-product breakdown below</p>\n                        </div>\n                    </div>\n\n                    {/* Per-Product ARPC Breakdown - REDESIGNED FOR COMPACTNESS */}\n                    {eventRevenueTimelineData && eventRevenueTimelineData.arpc_per_product && Object.keys(eventRevenueTimelineData.arpc_per_product).length > 0 && (\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white mb-3\">ARPC Per Product</h3>\n                            <div className=\"bg-gray-50 dark:bg-gray-600 rounded-lg p-3\">\n                                <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3\">\n                                    {Object.entries(eventRevenueTimelineData.arpc_per_product).map(([productId, arpcData]) => (\n                                        <div key={productId} className=\"bg-white dark:bg-gray-700 rounded-md p-3 border border-gray-200 dark:border-gray-600\">\n                                            <div className=\"text-xs font-medium text-gray-600 dark:text-gray-300 truncate\" title={productId}>\n                                                {productId}\n                                            </div>\n                                            <div className=\"text-lg font-bold text-green-600 dark:text-green-400 leading-tight\">\n                                                {typeof arpcData === 'object' ? formatCurrency(arpcData.arpc) : formatCurrency(arpcData)}\n                                            </div>\n                                            {typeof arpcData === 'object' && (\n                                                <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1 space-y-0.5\">\n                                                    <div>{arpcData.event_count} events</div>\n                                                    <div>{arpcData.unique_users} users</div>\n                                                    <div className=\"font-medium\">{formatCurrency(arpcData.total_revenue)}</div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {analysisResult.event_user_counts && (\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white mb-3\">Unique Users Per Event Type</h3>\n                            <div className=\"overflow-x-auto\">\n                                <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                                    <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                        <tr>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Event Type</th>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Unique Users</th>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Total Events</th>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Events Per User</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"bg-white dark:bg-gray-800\">\n                                        {Object.entries(analysisResult.event_user_counts).map(([eventType, counts], index) => (\n                                            <tr key={eventType} className={index % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700'}>\n                                                <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">{eventType}</td>\n                                                <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">{counts.unique_users || 0}</td>\n                                                <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">{counts.total_events || 0}</td>\n                                                <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                    {counts.unique_users > 0 ? (counts.total_events / counts.unique_users).toFixed(2) : '0.00'}\n                                                </td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Cohort Event Occurrence Table */}\n                    {analysisResult.cohort_event_occurrence && (\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-semibold text-gray-700 dark:text-white mb-3\">Cohort Event Occurrence</h3>\n                            <p className=\"text-sm text-gray-600 dark:text-gray-300 mb-2\">\n                                Number of users in the cohort who have had each event at least once. \n                                <span className=\"italic\"> Note: Cohort is defined as users in the database who have a \"Trial started\" event within the selected date range. All other users are excluded.</span>\n                            </p>\n                            <div className=\"overflow-x-auto\">\n                                <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                                    <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                        <tr>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">Event</th>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">User Count</th>\n                                            <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white\">% of Cohort</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"bg-white dark:bg-gray-800\">\n                                        {/* Trial Started */}\n                                        <tr className=\"bg-indigo-50 dark:bg-indigo-900/30\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-white\">Trial Started</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_started?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                100%\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* Trial Ended */}\n                                        <tr>\n                                            <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">Trial Ended (Total)</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_ended?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_ended?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.trial_ended.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* Trial Converted */}\n                                        <tr className=\"bg-gray-50 dark:bg-gray-700 pl-4\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\"> Trial Converted</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_converted?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_converted?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.trial_converted.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* Trial Cancelled */}\n                                        <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\"> Trial Cancelled</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_cancelled?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.trial_cancelled?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.trial_cancelled.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* Initial Purchase */}\n                                        <tr>\n                                            <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">Initial Purchase</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.initial_purchase?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.initial_purchase?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.initial_purchase.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* Renewal */}\n                                        <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">Renewal</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.renewal?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.renewal?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.renewal.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* RC Cancellation */}\n                                        <tr>\n                                            <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300\">RC Cancellation (Total)</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_cancellation?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_cancellation?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.rc_cancellation.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* RC Refund (revenue < 0) */}\n                                        <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\"> Refund (revenue &lt; 0)</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_refund?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_refund?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.rc_refund.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                        \n                                        {/* RC Cancelled (revenue = 0) */}\n                                        <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <td className=\"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300\"> Cancelled (revenue = 0)</td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_cancel_no_refund?.user_count?.toLocaleString() || '0'}\n                                            </td>\n                                            <td className=\"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300\">\n                                                {analysisResult.cohort_event_occurrence.rc_cancel_no_refund?.percentage ? \n                                                    analysisResult.cohort_event_occurrence.rc_cancel_no_refund.percentage.toFixed(1) + '%' : '0%'}\n                                            </td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    )}\n\n                    <div className=\"mb-4\">\n                        <button onClick={() => setShowLifecycleTables(!showLifecycleTables)}\n                                className=\"text-indigo-600 dark:text-indigo-300 hover:underline text-sm mb-2\">\n                            {showLifecycleTables ? <ChevronDown className=\"inline mr-1\" size={16}/> : <ChevronRight className=\"inline mr-1\" size={16}/>}\n                            Show/Hide Lifecycle Rate Tables\n                        </button>\n                        {/* DEBUG: Moved outside JSX */}\n                        {(() => {\n                            console.log('[DEBUG] showLifecycleTables:', showLifecycleTables, 'lifecycle_rates exists:', !!analysisResult?.lifecycle_rates);\n                            if (showLifecycleTables && analysisResult?.lifecycle_rates) {\n                                console.log('[DEBUG] Lifecycle tables section should render!', analysisResult.lifecycle_rates);\n                                console.log('[DEBUG] Available lifecycle rate keys:', Object.keys(analysisResult.lifecycle_rates));\n                            }\n                            return null;\n                        })()}\n                    </div>\n\n                    {/* Fixed: Replaced IIFE with direct conditional rendering */}\n                    {showLifecycleTables && analysisResult?.lifecycle_rates && (\n                        <div className=\"space-y-6 mb-8 p-4 border-t dark:border-gray-600\">\n                            {/* System Information Banner */}\n                            <div className=\"mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700\">\n                                <h3 className=\"text-lg font-semibold text-blue-800 dark:text-blue-200 mb-3\">\n                                    Enhanced Product-Based Lifecycle Analysis System\n                                </h3>\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300\">\n                                    <div>\n                                        <h4 className=\"font-semibold mb-2\">Key Improvements:</h4>\n                                        <ul className=\"list-disc ml-5 space-y-1\">\n                                            <li><strong>Fixed Cumulative Calculation:</strong> Now shows actual percentage of cohort that performs action, not forced 100%</li>\n                                            <li><strong>Product-Level Granularity:</strong> Analyze lifecycle patterns per product ID</li>\n                                            <li><strong>Intelligent Smoothing:</strong> Adaptive smoothing that handles high-early, low-later patterns effectively</li>\n                                            <li><strong>Extended Lookback:</strong> Automatically extends lookback 30-60 days when sample size &lt; 100</li>\n                                        </ul>\n                                    </div>\n                                    <div>\n                                        <h4 className=\"font-semibold mb-2\">Metrics Displayed:</h4>\n                                        <ul className=\"list-disc ml-5 space-y-1\">\n                                            <li><strong>Raw Daily Rates:</strong> Actual percentage of cohort performing action on specific day</li>\n                                            <li><strong>Smoothed Daily Rates:</strong> Algorithm-enhanced rates accounting for data sparsity</li>\n                                            <li><strong>Cumulative Rates:</strong> Total percentage who have performed action by day X (using smoothed data)</li>\n                                            <li><strong>Separate Tracking:</strong> 14 days for refunds, 400 days for cancellations</li>\n                                        </ul>\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Global Product Selector for Lifecycle Tables */}\n                            {(() => {\n                                // Get all available product IDs from lifecycle rates\n                                const allAvailableProducts = new Set();\n                                const lifecycleRates = analysisResult.lifecycle_rates || {};\n                                \n                                Object.values(lifecycleRates).forEach(rateData => {\n                                    if (rateData && rateData.rates_by_product) {\n                                        Object.keys(rateData.rates_by_product).forEach(productId => {\n                                            allAvailableProducts.add(productId);\n                                        });\n                                    }\n                                });\n                                \n                                const productList = Array.from(allAvailableProducts).sort();\n                                \n                                if (productList.length > 0) {\n                                    return (\n                                        <div className=\"mb-6 p-4 bg-green-50 dark:bg-green-900/30 rounded-lg border border-green-200 dark:border-green-700\">\n                                            <div className=\"flex items-center justify-between\">\n                                                <div>\n                                                    <h4 className=\"font-semibold text-green-800 dark:text-green-200 mb-1\">Product Analysis Filter</h4>\n                                                    <p className=\"text-sm text-green-700 dark:text-green-300\">\n                                                        Select a specific product to analyze, or view aggregate data across all products.\n                                                    </p>\n                                                </div>\n                                                <div className=\"flex items-center space-x-3\">\n                                                    <label className=\"text-sm font-medium text-green-700 dark:text-green-300\">\n                                                        Product:\n                                                    </label>\n                                                    <select \n                                                        value={globalSelectedProduct}\n                                                        onChange={(e) => setGlobalSelectedProduct(e.target.value)}\n                                                        className=\"px-4 py-2 border border-green-300 dark:border-green-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-green-500\"\n                                                    >\n                                                        <option value=\"\">All Products (Aggregate)</option>\n                                                        {productList.map(productId => (\n                                                            <option key={productId} value={productId}>\n                                                                Product {productId}\n                                                            </option>\n                                                        ))}\n                                                    </select>\n                                                    <button\n                                                        onClick={() => setShowChartModal(true)}\n                                                        className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors duration-200 flex items-center space-x-2\"\n                                                    >\n                                                        <span></span>\n                                                        <span>View Charts</span>\n                                                    </button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    );\n                                }\n                                return null;\n                            })()}\n\n                            {/* Lifecycle Rate Tables */}\n                            <div className=\"space-y-8\">\n                                {/* Trial Conversion to Cancellation/Refund */}\n                                {analysisResult.lifecycle_rates.trial_to_cancellation_rates && (\n                                    renderLifecycleTable(\"Trial Converted -> Cancellation Rates\", analysisResult.lifecycle_rates.trial_to_cancellation_rates)\n                                )}\n                                \n                                {analysisResult.lifecycle_rates.trial_to_refund_rates && (\n                                    renderLifecycleTable(\"Trial Converted -> Refund Rates\", analysisResult.lifecycle_rates.trial_to_refund_rates)\n                                )}\n                                \n                                {/* Initial Purchase to Cancellation/Refund */}\n                                {analysisResult.lifecycle_rates.initial_purchase_to_cancellation_rates && (\n                                    renderLifecycleTable(\"Initial Purchase -> Cancellation Rates\", analysisResult.lifecycle_rates.initial_purchase_to_cancellation_rates)\n                                )}\n                                \n                                {analysisResult.lifecycle_rates.initial_purchase_to_refund_rates && (\n                                    renderLifecycleTable(\"Initial Purchase -> Refund Rates\", analysisResult.lifecycle_rates.initial_purchase_to_refund_rates)\n                                )}\n                                \n                                {/* Renewal to Cancellation/Refund */}\n                                {analysisResult.lifecycle_rates.renewal_to_cancellation_rates && (\n                                    renderLifecycleTable(\"Renewal -> Cancellation Rates\", analysisResult.lifecycle_rates.renewal_to_cancellation_rates)\n                                )}\n                                \n                                {analysisResult.lifecycle_rates.renewal_to_refund_rates && (\n                                    renderLifecycleTable(\"Renewal -> Refund Rates\", analysisResult.lifecycle_rates.renewal_to_refund_rates)\n                                )}\n                                \n                                {/* Legacy format support */}\n                                {analysisResult.lifecycle_rates.trial_to_outcome_rates && (\n                                    renderLifecycleTable(\"Trial to Outcome Rates\", analysisResult.lifecycle_rates.trial_to_outcome_rates)\n                                )}\n                            </div>\n                        </div>\n                    )}\n\n                    <h3 className=\"text-xl font-semibold mb-3 text-gray-700 dark:text-white\">Daily Performance Charts</h3>\n                    \n                    {/* Absolute Values Chart */}\n                    <div className=\"mb-6\">\n                        <h4 className=\"font-semibold text-gray-700 dark:text-white mb-2\">Absolute Values</h4>\n                        <div className=\"mb-4 flex flex-wrap gap-2\">\n                            {Object.keys(visibleAbsoluteMetrics).map(key => (\n                                <button key={key} onClick={() => toggleAbsoluteMetric(key)}\n                                        className={`px-3 py-1 text-xs rounded-full ${visibleAbsoluteMetrics[key] ? 'bg-blue-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white'}`}>\n                                    {key.split('_').join(' ')}\n                                </button>\n                            ))}\n                        </div>\n                        <div className=\"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\">\n                            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                                <LineChart data={chartData} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n                                    <CartesianGrid strokeDasharray=\"3 3\" />\n                                    <XAxis dataKey=\"date\" />\n                                    <YAxis />\n                                    <Tooltip formatter={(value) => typeof value === 'number' ? value.toLocaleString() : value} />\n                                    <ChartLegend />\n                                    \n                                    {/* Daily metrics */}\n                                    {visibleAbsoluteMetrics.daily_trials_started && (\n                                        <Line type=\"monotone\" dataKey=\"daily_trials_started\" stroke=\"#8884d8\" name=\"Daily Trials Started\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_trials_ended && (\n                                        <Line type=\"monotone\" dataKey=\"daily_trials_ended\" stroke=\"#82ca9d\" name=\"Daily Trials Ended\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_trials_pending && (\n                                        <Line type=\"monotone\" dataKey=\"daily_trials_pending\" stroke=\"#ffc658\" name=\"Daily Trials Pending\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_conversions && (\n                                        <Line type=\"monotone\" dataKey=\"daily_conversions\" stroke=\"#ff7300\" name=\"Daily Conversions\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_conversions_net_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"daily_conversions_net_refunds\" stroke=\"#ff0000\" name=\"Daily Conv. Net Refunds\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_estimated_conversions_net_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"daily_estimated_conversions_net_refunds\" stroke=\"#b967ff\" name=\"Daily Est. Conv. Net Refunds\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.daily_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"daily_refunds\" stroke=\"#ff67b3\" name=\"Daily Refunds\" />\n                                    )}\n                                    \n                                    {/* Cumulative metrics */}\n                                    {visibleAbsoluteMetrics.cumulative_trials_started && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_trials_started\" stroke=\"#8884d8\" strokeDasharray=\"5 5\" name=\"Cum. Trials Started\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_trials_ended && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_trials_ended\" stroke=\"#82ca9d\" strokeDasharray=\"5 5\" name=\"Cum. Trials Ended\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_trials_pending && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_trials_pending\" stroke=\"#ffc658\" strokeDasharray=\"5 5\" name=\"Cum. Trials Pending\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_conversions && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_conversions\" stroke=\"#ff7300\" strokeDasharray=\"5 5\" name=\"Cum. Conversions\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_conversions_net_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_conversions_net_refunds\" stroke=\"#ff0000\" strokeDasharray=\"5 5\" name=\"Cum. Conv. Net Refunds\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_estimated_conversions_net_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_estimated_conversions_net_refunds\" stroke=\"#b967ff\" strokeDasharray=\"5 5\" name=\"Cum. Est. Conv. Net Refunds\" />\n                                    )}\n                                    {visibleAbsoluteMetrics.cumulative_refunds && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_refunds\" stroke=\"#ff67b3\" strokeDasharray=\"5 5\" name=\"Cum. Refunds\" />\n                                    )}\n                                </LineChart>\n                            </ResponsiveContainer>\n                        </div>\n                    </div>\n                    \n                    {/* Money Values Chart */}\n                    <div className=\"mb-6\">\n                        <h4 className=\"font-semibold text-gray-700 dark:text-white mb-2\">Revenue Values</h4>\n                        <div className=\"mb-4 flex flex-wrap gap-2\">\n                            {Object.keys(visibleMoneyMetrics).map(key => (\n                                <button key={key} onClick={() => toggleMoneyMetric(key)}\n                                        className={`px-3 py-1 text-xs rounded-full ${visibleMoneyMetrics[key] ? 'bg-green-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white'}`}>\n                                    {key.split('_').join(' ')}\n                                </button>\n                            ))}\n                        </div>\n                        <div className=\"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg\">\n                            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                                <LineChart data={chartData} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n                                    <CartesianGrid strokeDasharray=\"3 3\" />\n                                    <XAxis dataKey=\"date\" />\n                                    <YAxis />\n                                    <Tooltip formatter={(value) => formatCurrency(value)} />\n                                    <ChartLegend />\n                                    \n                                    {/* Daily metrics */}\n                                    {visibleMoneyMetrics.daily_revenue && (\n                                        <Line type=\"monotone\" dataKey=\"daily_revenue\" stroke=\"#00b300\" name=\"Daily Revenue\" />\n                                    )}\n                                    {visibleMoneyMetrics.daily_revenue_net && (\n                                        <Line type=\"monotone\" dataKey=\"daily_revenue_net\" stroke=\"#00e600\" name=\"Daily Net Revenue\" />\n                                    )}\n                                    {visibleMoneyMetrics.daily_estimated_revenue && (\n                                        <Line type=\"monotone\" dataKey=\"daily_estimated_revenue\" stroke=\"#4dff4d\" name=\"Daily Est. Revenue\" />\n                                    )}\n                                    \n                                    {/* Cumulative metrics */}\n                                    {visibleMoneyMetrics.cumulative_revenue && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_revenue\" stroke=\"#009900\" strokeDasharray=\"5 5\" name=\"Cum. Revenue\" />\n                                    )}\n                                    {visibleMoneyMetrics.cumulative_revenue_net && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_revenue_net\" stroke=\"#00cc00\" strokeDasharray=\"5 5\" name=\"Cum. Net Revenue\" />\n                                    )}\n                                    {visibleMoneyMetrics.cumulative_estimated_revenue && (\n                                        <Line type=\"monotone\" dataKey=\"cumulative_estimated_revenue\" stroke=\"#00e600\" strokeDasharray=\"5 5\" name=\"Cum. Est. Revenue\" />\n                                    )}\n                                </LineChart>\n                            </ResponsiveContainer>\n                        </div>\n                    </div>\n                </div>\n            )}\n                    \n            {/* Event Revenue Timeline Table - NEW FEATURE - MOVED ABOVE USER TIMELINE - ENHANCED WITH ALL METRICS */}\n            {eventRevenueTimelineData ? (\n                <div className=\"mb-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                        <h2 className=\"text-2xl font-bold text-gray-800 dark:text-white\">Daily Event & Revenue Timeline</h2>\n                        <div className=\"flex gap-2\">\n                            <span className=\"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full\">\n                                {selectedUserId && selectedProductId ? 'Detailed View' : 'Aggregate View'}\n                            </span>\n                        </div>\n                    </div>\n                    \n                    {/* User and Product Selection */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 border rounded-lg bg-gray-50 dark:bg-gray-600\">\n                        <div>\n                            <label htmlFor=\"user-select\" className=\"block text-sm font-medium text-gray-700 dark:text-white mb-2\">\n                                Select User (Optional)\n                            </label>\n                            <Select\n                                id=\"user-select\"\n                                isClearable\n                                isSearchable\n                                options={availableUsers.map(user => ({ \n                                    value: user, \n                                    label: user \n                                }))}\n                                value={selectedUserId ? { value: selectedUserId, label: selectedUserId } : null}\n                                onChange={(selected) => {\n                                    const newUserId = selected ? selected.value : '';\n                                    setSelectedUserId(newUserId);\n                                    fetchEventRevenueTimeline(newUserId, selectedProductId);\n                                }}\n                                styles={getSelectTheme()}\n                                placeholder=\"Type to search users...\"\n                            />\n                        </div>\n                        <div>\n                            <label htmlFor=\"product-select\" className=\"block text-sm font-medium text-gray-700 dark:text-white mb-2\">\n                                Select Product (Optional)\n                            </label>\n                            <Select\n                                id=\"product-select\"\n                                isClearable\n                                isSearchable\n                                options={availableProducts.map(product => ({ \n                                    value: product, \n                                    label: product \n                                }))}\n                                value={selectedProductId ? { value: selectedProductId, label: selectedProductId } : null}\n                                onChange={(selected) => {\n                                    const newProductId = selected ? selected.value : '';\n                                    setSelectedProductId(newProductId);\n                                    fetchEventRevenueTimeline(selectedUserId, newProductId);\n                                }}\n                                styles={getSelectTheme()}\n                                placeholder=\"Type to search products...\"\n                            />\n                        </div>\n                    </div>\n                    \n                    {/* Enhanced Event Revenue Timeline Table */}\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                <tr>\n                                    <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10 min-w-[200px]\">\n                                        Metric\n                                    </th>\n                                    {eventRevenueTimelineData.dates.map(date => (\n                                        <th key={date} className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap min-w-[80px]\">\n                                            {date}\n                                        </th>\n                                    ))}\n                                </tr>\n                            </thead>\n                            <tbody className=\"bg-white dark:bg-gray-800\">\n                                {(() => {\n                                    // Define all metrics with their categories and data extraction logic\n                                    const metrics = [\n                                        // Daily Absolute Values\n                                        {\n                                            key: 'daily_trial_started',\n                                            label: 'Trial Started',\n                                            category: 'daily_absolute',\n                                            categoryLabel: 'Daily Absolute Values',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    (eventRows.trial_started?.[date] || 0) : \n                                                    (eventRows.trial_started?.[date] || chartDay?.daily_trials_started || 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_trial_pending',\n                                            label: 'Trial Pending',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                // FIXED: Use the backend-calculated trial_pending value directly\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.trial_pending?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_trial_ended',\n                                            label: 'Trial Ended',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.trial_ended?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_trial_cancelled',\n                                            label: 'Trial Cancelled',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.trial_canceled?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_trial_converted',\n                                            label: 'Trial Converted',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    (eventRows.trial_converted?.[date] || 0) : \n                                                    (eventRows.trial_converted?.[date] || chartDay?.daily_conversions || 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_initial_purchase',\n                                            label: 'Initial Purchase',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.initial_purchase?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_subscription_active',\n                                            label: 'Subscription Active',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                // FIXED: Use the backend-calculated subscription_active value directly\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.subscription_active?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_subscription_cancelled',\n                                            label: 'Subscription Cancelled',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.subscription_cancelled?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_refund',\n                                            label: 'Refund',\n                                            category: 'daily_absolute',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    (eventRows.refund?.[date] || 0) : \n                                                    (eventRows.refund?.[date] || chartDay?.daily_refunds || 0);\n                                            }\n                                        },\n                                        \n                                        // Daily Revenue\n                                        {\n                                            key: 'daily_revenue',\n                                            label: 'Revenue (Actual)',\n                                            category: 'daily_revenue',\n                                            categoryLabel: 'Daily Revenue',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const value = (selectedUserId || selectedProductId) ? \n                                                    (estimateRows.current_revenue?.[date] || 0) : \n                                                    (estimateRows.current_revenue?.[date] || chartDay?.daily_revenue || 0);\n                                                return formatCurrency(value);\n                                            }\n                                        },\n                                        {\n                                            key: 'daily_est_revenue',\n                                            label: 'Est. Revenue',\n                                            category: 'daily_revenue',\n                                            isEstimatedRevenue: true,\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const value = (selectedUserId || selectedProductId) ? \n                                                    (estimateRows.estimated_net_revenue?.[date] || 0) : \n                                                    (estimateRows.estimated_revenue?.[date] || chartDay?.daily_estimated_revenue || 0);\n                                                return formatCurrency(value);\n                                            },\n                                            getTooltipData: (date, index) => {\n                                                // Mock calculation data - this would come from the backend in reality\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const actualValue = (selectedUserId || selectedProductId) ? \n                                                    (estimateRows.estimated_net_revenue?.[date] || 0) : \n                                                    (estimateRows.estimated_revenue?.[date] || chartDay?.daily_estimated_revenue || 0);\n                                                \n                                                // Mock data structure - backend should provide this\n                                                return {\n                                                    formula: \"Est_Revenue = (Active_Trials  Trial_Conv_Rate  Avg_Revenue) + (Active_Subs  (1 - Churn_Rate)  Avg_Revenue) - (Expected_Refunds  Avg_Refund)\",\n                                                    calculation: `(${chartDay?.daily_trials_pending || 0}  0.15  $9.99) + (${chartDay?.daily_trials_pending || 0}  0.95  $9.99) - (${chartDay?.daily_refunds || 0}  $9.99)`,\n                                                    components: {\n                                                        \"Active Trials\": chartDay?.daily_trials_pending || 0,\n                                                        \"Trial Conversion Rate\": \"15%\",\n                                                        \"Active Subscriptions\": \"N/A\",\n                                                        \"Churn Rate\": \"5%\",\n                                                        \"Avg Revenue\": \"$9.99\",\n                                                        \"Expected Refunds\": chartDay?.daily_refunds || 0,\n                                                        \"Avg Refund\": \"$9.99\"\n                                                    },\n                                                    result: formatCurrency(actualValue)\n                                                };\n                                            }\n                                        },\n                                        \n                                        // Cumulative Absolute Values\n                                        {\n                                            key: 'cumulative_trial_started',\n                                            label: 'Trial Started',\n                                            category: 'cumulative_absolute',\n                                            categoryLabel: 'Cumulative Absolute Values',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.trial_started?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_trials_started || 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_trial_pending',\n                                            label: 'Trial Pending',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                // This is a point-in-time value, same as daily pending\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.trial_pending?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_trial_ended',\n                                            label: 'Trial Ended',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.trial_ended?.[d] || 0), 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_trial_cancelled',\n                                            label: 'Trial Cancelled',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.trial_canceled?.[d] || 0), 0) : \n                                                    (chartData ? chartData.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.trial_canceled?.[d.date] || 0), 0) : 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_trial_converted',\n                                            label: 'Trial Converted',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.trial_converted?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_conversions || 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_initial_purchase',\n                                            label: 'Initial Purchase',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.initial_purchase?.[d] || 0), 0) : \n                                                    (eventRows.cumulative_initial_purchase?.[date] || 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_subscription_active',\n                                            label: 'Subscription Active',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                // This is a point-in-time value, same as daily subscription_active\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRows.subscription_active?.[date] || 0;\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_subscription_cancelled',\n                                            label: 'Subscription Cancelled',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.subscription_cancelled?.[d] || 0), 0);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_refund',\n                                            label: 'Refund',\n                                            category: 'cumulative_absolute',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const eventRows = eventRevenueTimelineData.event_rows || {};\n                                                return (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (eventRows.refund?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_refunds || 0);\n                                            }\n                                        },\n                                        \n                                        // Cumulative Revenue\n                                        {\n                                            key: 'cumulative_revenue',\n                                            label: 'Revenue (Actual)',\n                                            category: 'cumulative_revenue',\n                                            categoryLabel: 'Cumulative Revenue',\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const value = (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (estimateRows.current_revenue?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_revenue || 0);\n                                                return formatCurrency(value);\n                                            }\n                                        },\n                                        {\n                                            key: 'cumulative_est_revenue',\n                                            label: 'Est. Revenue',\n                                            category: 'cumulative_revenue',\n                                            isEstimatedRevenue: true,\n                                            getValue: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const value = (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (estimateRows.estimated_net_revenue?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_estimated_revenue || 0);\n                                                return formatCurrency(value);\n                                            },\n                                            getTooltipData: (date, index) => {\n                                                const chartDay = chartData ? chartData.find(d => d.date === date) : null;\n                                                const estimateRows = eventRevenueTimelineData.estimate_rows || {};\n                                                const actualValue = (selectedUserId || selectedProductId) ? \n                                                    eventRevenueTimelineData.dates.slice(0, index + 1).reduce((sum, d) => sum + (estimateRows.estimated_net_revenue?.[d] || 0), 0) : \n                                                    (chartDay?.cumulative_estimated_revenue || 0);\n                                                \n                                                return {\n                                                    formula: \"Cumulative_Est_Revenue = (Daily_Est_Revenue) from start to date\",\n                                                    calculation: `Sum of daily estimated revenue from start date to ${date}`,\n                                                    components: {\n                                                        \"Period\": `Start to ${date}`,\n                                                        \"Days\": index + 1,\n                                                        \"Avg Daily Est\": formatCurrency(actualValue / (index + 1)),\n                                                    },\n                                                    result: formatCurrency(actualValue)\n                                                };\n                                            }\n                                        }\n                                    ];\n\n                                    // Group metrics by category for styling\n                                    const categoryColors = {\n                                        daily_absolute: 'bg-blue-50 dark:bg-blue-900/30',\n                                        daily_revenue: 'bg-green-50 dark:bg-green-900/30', \n                                        cumulative_absolute: 'bg-indigo-50 dark:bg-indigo-900/30',\n                                        cumulative_revenue: 'bg-emerald-50 dark:bg-emerald-900/30'\n                                    };\n\n                                    return metrics.map((metric, metricIndex) => {\n                                        const isFirstInCategory = metricIndex === 0 || metrics[metricIndex - 1].category !== metric.category;\n                                        \n                                        return (\n                                            <React.Fragment key={metric.key}>\n                                                {/* Category header row */}\n                                                {isFirstInCategory && metric.categoryLabel && (\n                                                    <tr className={`${categoryColors[metric.category]} border-t-2 border-gray-300 dark:border-gray-500`}>\n                                                        <td colSpan={eventRevenueTimelineData.dates.length + 1} className=\"p-2 border-b dark:border-gray-600 text-center font-semibold text-gray-700 dark:text-white\">\n                                                            {metric.categoryLabel}\n                                                        </td>\n                                                    </tr>\n                                                )}\n                                                \n                                                {/* Metric data row */}\n                                                <tr className={metricIndex % 2 === 0 ? '' : 'bg-gray-50 dark:bg-gray-700'}>\n                                                    <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10 bg-inherit\">\n                                                        {metric.label}\n                                                    </td>\n                                                    {eventRevenueTimelineData.dates.map((date, dateIndex) => (\n                                                        <td \n                                                            key={date} \n                                                            className={`p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 whitespace-nowrap ${\n                                                                metric.isEstimatedRevenue ? 'cursor-help hover:bg-yellow-50 dark:hover:bg-yellow-900/20' : ''\n                                                            }`}\n                                                            onMouseEnter={metric.isEstimatedRevenue ? (e) => {\n                                                                const tooltipData = metric.getTooltipData(date, dateIndex);\n                                                                setTooltipData(tooltipData);\n                                                                setTooltipPosition({ x: e.clientX, y: e.clientY });\n                                                            } : undefined}\n                                                            onMouseLeave={metric.isEstimatedRevenue ? () => {\n                                                                setTooltipData(null);\n                                                            } : undefined}\n                                                        >\n                                                            {metric.getValue(date, dateIndex)}\n                                                        </td>\n                                                    ))}\n                                                </tr>\n                                            </React.Fragment>\n                                        );\n                                    });\n                                })()}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            ) : isLoadingEventRevenueTimeline ? (\n                <div className=\"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4\">\n                    <Loader className=\"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\" />\n                    <p className=\"text-gray-700 dark:text-white\">Loading event revenue timeline...</p>\n                </div>\n            ) : eventRevenueTimelineError ? (\n                <div className=\"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\">\n                    <div className=\"flex items-center\">\n                        <AlertTriangle className=\"mr-2 flex-shrink-0\" />\n                        <div>\n                            <span className=\"font-medium block\">Event Revenue Timeline Error:</span>\n                            <span className=\"block mt-1\">{eventRevenueTimelineError}</span>\n                        </div>\n                    </div>\n                </div>\n            ) : null}\n\n            {/* User Timeline Table */}\n            {userTimelineData ? (\n                <div className=\"mb-8\">\n                    <div className=\"flex justify-between items-center mb-3\">\n                        <h3 className=\"text-xl font-semibold text-gray-700 dark:text-white\">User Timeline</h3>\n                        <div className=\"flex gap-2\">\n                            <span className=\"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full\">\n                                {userTimelineData.unique_users_count || userTimelineData.total_users} Unique Users\n                            </span>\n                            <span className=\"text-sm font-medium px-3 py-1 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100 rounded-full\">\n                                {userTimelineData.total_user_product_combinations || userTimelineData.users?.length} User-Product Combinations\n                            </span>\n                            <span className=\"text-sm font-medium px-3 py-1 bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-100 rounded-full\">\n                                {userTimelineData.valid_product_ids?.length || 0} Unique Products\n                            </span>\n                        </div>\n                    </div>\n                    \n                    {/* Add filter stats display for timeline too */}\n                    {userTimelineData.filter_stats && (\n                        <FilterStatsDisplay filterStats={userTimelineData.filter_stats} />\n                    )}\n                    \n                    {/* Legend */}\n                    <div className=\"mb-4\">\n                        <div className=\"flex flex-wrap gap-3 mb-2\">\n                            <div className={`px-3 py-2 rounded ${timelineColors.default.bg} ${timelineColors.default.text}`}>No Event</div>\n                            <div className={`px-3 py-2 rounded ${timelineColors.trial_started.bg} ${timelineColors.trial_started.text}`}>Trial Started</div>\n                            <div className={`px-3 py-2 rounded ${timelineColors.trial_converted.bg} ${timelineColors.trial_converted.text}`}>Trial Converted</div>\n                            <div className={`px-3 py-2 rounded ${timelineColors.trial_cancelled.bg} ${timelineColors.trial_cancelled.text}`}>Trial Cancelled</div>\n                            <div className={`px-3 py-2 rounded ${timelineColors.conversion_cancelled.bg} ${timelineColors.conversion_cancelled.text}`}>Conversion Cancelled</div>\n                            <div className={`px-3 py-2 rounded ${timelineColors.refunded.bg} ${timelineColors.refunded.text}`}>Refunded</div>\n                        </div>\n                        <div className=\"relative flex items-center bg-gray-100 dark:bg-gray-700 p-2 rounded text-sm\">\n                            <span className=\"mr-2\">Multiple events on the same day:</span>\n                            <div className=\"flex items-center\">\n                                <div className=\"relative mr-8 px-4 py-2 rounded bg-green-100 dark:bg-green-900/50\" style={{minWidth: \"180px\"}}>\n                                    <span className=\"text-green-800 dark:text-green-200\">Trial Converted</span>\n                                    <div className=\"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center\">\n                                        3\n                                    </div>\n                                    <div className=\"mt-1 flex flex-col gap-1 w-full\">\n                                        <div className=\"px-1 py-0.5 text-[9px] w-full text-center rounded bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200\">\n                                            Trial started\n                                        </div>\n                                        <div className=\"px-1 py-0.5 text-[9px] w-full text-center rounded bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300\">\n                                            Refunded\n                                        </div>\n                                    </div>\n                                </div>\n                                <span className=\"text-gray-600 dark:text-gray-300\">The cell is colored by the first event, with a counter and full-text badges for each additional event</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full text-sm border dark:border-gray-600\">\n                            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                <tr>\n                                    <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10\">User ID</th>\n                                    <th className=\"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-[150px] bg-gray-50 dark:bg-gray-700 z-10\">Product ID</th>\n                                    {userTimelineData.dates.map(date => (\n                                        <th key={date} className=\"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap\">{date}</th>\n                                    ))}\n                                </tr>\n                            </thead>\n                            <tbody className=\"bg-white dark:bg-gray-800\">\n                                {userTimelineData.users.map((user, index) => {\n                                    // Get background colors for alternating users (not user-product rows)\n                                    const isNewUser = index === 0 || userTimelineData.users[index-1].id !== user.id;\n                                    const userBgClass = isNewUser ? (index % 4 < 2 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-700') : ''; \n                                    \n                                    return (\n                                    <tr key={user.user_product_key} className={userBgClass}>\n                                        <td className=\"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10\" style={{backgroundColor: 'inherit'}}>\n                                            {isNewUser ? user.id : ''}\n                                        </td>\n                                        <td className=\"p-2 border-b dark:border-gray-600 font-medium text-green-700 dark:text-green-300 sticky left-[150px] z-10\" style={{backgroundColor: 'inherit'}}>\n                                            {user.product_id}\n                                        </td>\n                                        {userTimelineData.dates.map(date => {\n                                            const cellState = getCellState(user.user_product_key, date, userTimelineData.events);\n                                            const events = getEventsForDate(user.user_product_key, date, userTimelineData.events);\n                                            const hasEvents = events.length > 0;\n                                            \n                                            return (\n                                                <td key={date} \n                                                    className={`p-2 border dark:border-gray-600 text-xs relative ${timelineColors[cellState].bg}`}>\n                                                    {hasEvents ? (\n                                                        <div className=\"flex flex-col items-center\">\n                                                            {/* Main event - full display */}\n                                                            <div className={`text-center w-full ${timelineColors[cellState].text} font-medium`}>\n                                                                {events[0].type.replace('RC ', '')}\n                                                            </div>\n                                                            \n                                                            {/* Show badges for multiple events with full names */}\n                                                            {events.length > 1 && (\n                                                                <div className=\"mt-1 flex flex-col items-center w-full gap-1\">\n                                                                    {/* Skip the first event (already shown above) and show badges for additional events */}\n                                                                    {events.slice(1).map((additionalEvent, idx) => {\n                                                                        const eventType = additionalEvent.type.replace('RC ', '');\n                                                                        let badgeState = 'default';\n                                                                        \n                                                                        // Determine appropriate color for this event\n                                                                        if (additionalEvent.type === 'RC Trial started') badgeState = 'trial_started';\n                                                                        else if (additionalEvent.type === 'RC Trial converted') badgeState = 'trial_converted';\n                                                                        else if (additionalEvent.type === 'RC Trial cancelled') badgeState = 'trial_cancelled';\n                                                                        else if (additionalEvent.type === 'RC Cancellation') {\n                                                                            badgeState = additionalEvent.has_refund ? 'refunded' : 'conversion_cancelled';\n                                                                        } else if (additionalEvent.type === 'RC Initial purchase') {\n                                                                            badgeState = 'trial_converted';\n                                                                        } else if (additionalEvent.type === 'RC Renewal') {\n                                                                            badgeState = 'trial_converted';\n                                                                        }\n                                                                        \n                                                                        return (\n                                                                            <div \n                                                                                key={idx} \n                                                                                className={`px-1 py-0.5 text-[9px] w-full text-center rounded ${timelineColors[badgeState].bg} ${timelineColors[badgeState].text}`}\n                                                                                title={`${eventType} at ${additionalEvent.time} for ${additionalEvent.product_id}`}\n                                                                            >\n                                                                                {eventType}\n                                                                            </div>\n                                                                        );\n                                                                    })}\n                                                                </div>\n                                                            )}\n                                                            \n                                                            {/* Show a small indicator when there are multiple events */}\n                                                            {events.length > 1 && (\n                                                                <div className=\"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center\">\n                                                                    {events.length}\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    ) : ''}\n                                                </td>\n                                            );\n                                        })}\n                                    </tr>\n                                );})}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            ) : isLoadingTimeline ? (\n                <div className=\"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4\">\n                    <Loader className=\"animate-spin mr-2 text-indigo-600 dark:text-indigo-400\" />\n                    <p className=\"text-gray-700 dark:text-white\">Loading user timeline data...</p>\n                </div>\n            ) : timelineError ? (\n                <div className=\"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600\">\n                    <div className=\"flex items-center\">\n                        <AlertTriangle className=\"mr-2 flex-shrink-0\" />\n                        <div>\n                            <span className=\"font-medium block\">Timeline Error:</span>\n                            <span className=\"block mt-1\">{timelineError}</span>\n                        </div>\n                    </div>\n                </div>\n            ) : null}\n            \n            {/* Estimated Revenue Tooltip */}\n            <EstimatedRevenueTooltip \n                data={tooltipData} \n                position={tooltipPosition} \n                onClose={() => setTooltipData(null)} \n            />\n            <ChartModal />\n        </div>\n    );\n};\n\nexport default CohortAnalyzerPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}