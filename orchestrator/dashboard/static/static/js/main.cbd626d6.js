/*! For license information please see main.cbd626d6.js.LICENSE.txt */
(()=>{var e={14:e=>{e.exports=function(){return!1}},61:e=>{e.exports=function(e,t){return e<t}},143:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},149:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},219:(e,t,r)=>{"use strict";var n=r(3763),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return n.isMemo(e)?i:o[e.$$typeof]||a}o[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[n.Memo]=i;var c=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;e.exports=function e(t,r,n){if("string"!==typeof r){if(m){var a=p(r);a&&a!==m&&e(t,a,n)}var i=d(r);u&&(i=i.concat(u(r)));for(var o=l(t),f=l(r),g=0;g<i.length;++g){var x=i[g];if(!s[x]&&(!n||!n[x])&&(!f||!f[x])&&(!o||!o[x])){var b=h(r,x);try{c(t,x,b)}catch(y){}}}}return t}},320:e=>{e.exports=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}},396:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},438:(e,t,r)=>{var n=r(2622);e.exports=function(e){return n(this,e).get(e)}},539:(e,t,r)=>{var n=r(9742),a=r(7498),s=r(3279);e.exports=function(e){return e&&e.length?n(e,s,a):void 0}},579:(e,t,r)=>{"use strict";e.exports=r(1153)},620:(e,t,r)=>{var n=r(6913),a=r(4052),s=r(2761);e.exports=function(e){return"string"==typeof e||!a(e)&&s(e)&&"[object String]"==n(e)}},643:(e,t,r)=>{var n=r(7676)("toUpperCase");e.exports=n},644:e=>{e.exports=function(e){return e!==e}},705:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},715:e=>{var t="\\ud800-\\udfff",r="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",s="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+n+"|"+a+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[s,i,o].join("|")+")"+c+l+")*"),u="(?:"+[s+n+"?",n,i,o,r].join("|")+")",h=RegExp(a+"(?="+a+")|"+u+d,"g");e.exports=function(e){return e.match(h)||[]}},755:(e,t,r)=>{var n=r(8895),a=r(7116);e.exports=function e(t,r,s,i,o){var l=-1,c=t.length;for(s||(s=a),o||(o=[]);++l<c;){var d=t[l];r>0&&s(d)?r>1?e(d,r-1,s,i,o):n(o,d):i||(o[o.length]=d)}return o}},793:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},801:(e,t,r)=>{var n=r(1141),a=r(6686),s=r(9841),i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=o.test(e);return r||l.test(e)?c(e.slice(2),r?2:8):i.test(e)?NaN:+e}},914:(e,t,r)=>{var n=r(9841);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},929:(e,t,r)=>{var n=r(3211),a=r(6571),s=r(9194),i=r(6686);e.exports=function(e,t,r){if(!i(r))return!1;var o=typeof t;return!!("number"==o?a(r)&&s(t,r.length):"string"==o&&t in r)&&n(r[t],e)}},977:(e,t,r)=>{var n=r(9096),a=r(4416);e.exports=function(e,t){return e&&e.length?a(e,n(t,2)):[]}},1069:(e,t,r)=>{var n=r(8541);e.exports=function(e){return null==e?"":n(e)}},1141:(e,t,r)=>{var n=r(143),a=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(a,""):e}},1143:(e,t,r)=>{var n=r(3028)(Object.keys,Object);e.exports=n},1153:(e,t,r)=>{"use strict";var n=r(5043),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,s={},c=null,d=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,n)&&!l.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:a,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},1170:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},1268:(e,t,r)=>{var n=r(5428),a=r(7574),s=r(6832),i=s&&s.isTypedArray,o=i?a(i):n;e.exports=o},1310:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},1340:(e,t,r)=>{var n=r(3211);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},1497:(e,t,r)=>{"use strict";var n=r(3218);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,r,a,s,i){if(i!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return r.PropTypes=r,r}},1558:e=>{e.exports=function(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}},1629:(e,t,r)=>{var n=r(6913),a=r(6686);e.exports=function(e){if(!a(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1714:(e,t,r)=>{var n=r(1340);e.exports=function(e,t){var r=this.__data__,a=n(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}},1733:(e,t,r)=>{var n=r(1775),a=r(4664),s=r(9096);e.exports=function(e,t){var r={};return t=s(t,3),a(e,function(e,a,s){n(r,a,t(e,a,s))}),r}},1775:(e,t,r)=>{var n=r(5654);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},1946:(e,t,r)=>{var n=r(1340);e.exports=function(e){return n(this.__data__,e)>-1}},2070:(e,t,r)=>{var n=r(7937)(r(6552),"Set");e.exports=n},2074:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},2154:(e,t,r)=>{var n=r(5575),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return a.call(t,e)?t[e]:void 0}},2165:(e,t,r)=>{var n=r(5652);e.exports=function(e,t){var r;return n(e,function(e,n,a){return!(r=t(e,n,a))}),!!r}},2322:(e,t,r)=>{var n=r(6913),a=r(5990),s=r(2761),i=Function.prototype,o=Object.prototype,l=i.toString,c=o.hasOwnProperty,d=l.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=n(e))return!1;var t=a(e);if(null===t)return!0;var r=c.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==d}},2520:(e,t,r)=>{var n=r(5816),a=r(9096),s=r(9140),i=Math.max;e.exports=function(e,t,r){var o=null==e?0:e.length;if(!o)return-1;var l=null==r?0:s(r);return l<0&&(l=i(o+l,0)),n(e,a(t,3),l)}},2536:(e,t,r)=>{var n=r(149),a=r(2969),s=r(9096),i=r(8883),o=r(320),l=r(7574),c=r(5893),d=r(3279),u=r(4052);e.exports=function(e,t,r){t=t.length?n(t,function(e){return u(e)?function(t){return a(t,1===e.length?e[0]:e)}:e}):[d];var h=-1;t=n(t,l(s));var p=i(e,function(e,r,a){return{criteria:n(t,function(t){return t(e)}),index:++h,value:e}});return o(p,function(e,t){return c(e,t,r)})}},2541:e=>{e.exports=function(e){return function(){return e}}},2587:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},2597:(e,t,r)=>{var n=r(4052),a=r(9841),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!a(e))||(i.test(e)||!s.test(e)||null!=t&&e in Object(t))}},2622:(e,t,r)=>{var n=r(705);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},2662:(e,t,r)=>{var n=r(5575);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},2730:(e,t,r)=>{"use strict";var n=r(5043),a=r(8853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,r,n,a,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,r,n){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,b);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),k=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),O=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var I,L=Object.assign;function F(e){if(void 0===I)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);I=t&&t[1]||""}return"\n"+I+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=n.stack.split("\n"),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||a[i]!==s[o]){var l="\n"+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case j:return"Fragment";case k:return"Portal";case N:return"Profiler";case w:return"StrictMode";case E:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case O:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return V(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=q(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function X(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){J(e,t);var r=W(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&K(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(s(92));if(te(r)){if(1<r.length)throw Error(s(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function se(e,t){var r=W(t.value),n=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=fe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var xe=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,je=null,we=null;function Ne(e){if(e=ya(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=_a(t),ke(e.stateNode,e.type,t))}}function Se(e){je?we?we.push(e):we=[e]:je=e}function Oe(){if(je){var e=je,t=we;if(we=je=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ce(e,t){return e(t)}function Ee(){}var Pe=!1;function Ae(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Ce(e,t,r)}finally{Pe=!1,(null!==je||null!==we)&&(Ee(),Oe())}}function Te(e,t){var r=e.stateNode;if(null===r)return null;var n=_a(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(s(231,t,typeof r));return r}var Me=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Me=!1}function De(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Ie=!1,Le=null,Fe=!1,Be=null,Ue={onError:function(e){Ie=!0,Le=e}};function ze(e,t,r,n,a,s,i,o,l){Ie=!1,Le=null,De.apply(Ue,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(n=a.return)){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return We(a),e;if(i===n)return We(a),t;i=i.sibling}throw Error(s(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(s(189))}}if(r.alternate!==n)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var $e=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Xe=a.unstable_requestPaint,Je=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,st=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=268435455&r;if(0!==i){var o=i&~a;0!==o?n=ut(o):0!==(s&=i)&&(n=ut(s))}else 0!==(i=r&~a)?n=ut(i):0!==s&&(n=ut(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-it(t)),n|=e[r],t&=~a;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-it(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var yt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,kt,jt,wt,Nt,St=!1,Ot=[],Ct=null,Et=null,Pt=null,At=new Map,Tt=new Map,Mt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tt.delete(t.pointerId)}}function It(e,t,r,n,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ya(t))&&kt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ba(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void Nt(e.priority,function(){jt(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ya(r))&&kt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);ve=n,r.target.dispatchEvent(n),ve=null,t.shift()}return!0}function Bt(e,t,r){Ft(e)&&r.delete(t)}function Ut(){St=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==Et&&Ft(Et)&&(Et=null),null!==Pt&&Ft(Pt)&&(Pt=null),At.forEach(Bt),Tt.forEach(Bt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return zt(t,e)}if(0<Ot.length){zt(Ot[0],e);for(var r=1;r<Ot.length;r++){var n=Ot[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&zt(Ct,e),null!==Et&&zt(Et,e),null!==Pt&&zt(Pt,e),At.forEach(t),Tt.forEach(t),r=0;r<Mt.length;r++)(n=Mt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Mt.length&&null===(r=Mt[0]).blockedOn;)Lt(r),null===r.blockedOn&&Mt.shift()}var Ht=v.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,r,n){var a=yt,s=Ht.transition;Ht.transition=null;try{yt=1,$t(e,t,r,n)}finally{yt=a,Ht.transition=s}}function Gt(e,t,r,n){var a=yt,s=Ht.transition;Ht.transition=null;try{yt=4,$t(e,t,r,n)}finally{yt=a,Ht.transition=s}}function $t(e,t,r,n){if(Wt){var a=Yt(e,t,r,n);if(null===a)Wn(e,t,n,Kt,r),Dt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return Ct=It(Ct,e,t,r,n,a),!0;case"dragenter":return Et=It(Et,e,t,r,n,a),!0;case"mouseover":return Pt=It(Pt,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return At.set(s,It(At.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Tt.set(s,It(Tt.get(s)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var s=ya(a);if(null!==s&&_t(s),null===(s=Yt(e,t,r,n))&&Wn(e,t,n,Kt,r),s===a)break;a=s}null!==a&&n.stopPropagation()}else Wn(e,t,n,null,r)}}var Kt=null;function Yt(e,t,r,n){if(Kt=null,null!==(e=ba(e=_e(n))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Qt,n=r.length,a="value"in Jt?Jt.value:Jt.textContent,s=a.length;for(e=0;e<n&&r[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===a[s-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,s){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var sr,ir,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ar(lr),dr=L({},lr,{view:0,detail:0}),ur=ar(dr),hr=L({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(sr=e.screenX-or.screenX,ir=e.screenY-or.screenY):ir=sr=0,or=e),sr)},movementY:function(e){return"movementY"in e?e.movementY:ir}}),pr=ar(hr),mr=ar(L({},hr,{dataTransfer:0})),fr=ar(L({},dr,{relatedTarget:0})),gr=ar(L({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),xr=L({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=ar(xr),yr=ar(L({},lr,{data:0})),vr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function wr(){return jr}var Nr=L({},dr,{key:function(e){if(e.key){var t=vr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_r[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=ar(Nr),Or=ar(L({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cr=ar(L({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wr})),Er=ar(L({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=L({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ar=ar(Pr),Tr=[9,13,27,32],Mr=d&&"CompositionEvent"in window,Rr=null;d&&"documentMode"in document&&(Rr=document.documentMode);var Dr=d&&"TextEvent"in window&&!Rr,Ir=d&&(!Mr||Rr&&8<Rr&&11>=Rr),Lr=String.fromCharCode(32),Fr=!1;function Br(e,t){switch(e){case"keyup":return-1!==Tr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zr=!1;var Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function Wr(e,t,r,n){Se(n),0<(t=Gn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qr=null,Gr=null;function $r(e){Fn(e,0)}function Kr(e){if($(va(e)))return e}function Yr(e,t){if("change"===e)return t}var Xr=!1;if(d){var Jr;if(d){var Qr="oninput"in document;if(!Qr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Qr="function"===typeof Zr.oninput}Jr=Qr}else Jr=!1;Xr=Jr&&(!document.documentMode||9<document.documentMode)}function en(){qr&&(qr.detachEvent("onpropertychange",tn),Gr=qr=null)}function tn(e){if("value"===e.propertyName&&Kr(Gr)){var t=[];Wr(t,Gr,e,_e(e)),Ae($r,t)}}function rn(e,t,r){"focusin"===e?(en(),Gr=r,(qr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kr(Gr)}function an(e,t){if("click"===e)return Kr(t)}function sn(e,t){if("input"===e||"change"===e)return Kr(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!u.call(t,a)||!on(e[a],t[a]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=K((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=hn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&un(r.ownerDocument.documentElement,r)){if(null!==n&&pn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=void 0===n.end?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=dn(r,s);var i=dn(r,n);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fn=d&&"documentMode"in document&&11>=document.documentMode,gn=null,xn=null,bn=null,yn=!1;function vn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;yn||null==gn||gn!==K(n)||("selectionStart"in(n=gn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=Gn(xn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function _n(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var kn={animationend:_n("Animation","AnimationEnd"),animationiteration:_n("Animation","AnimationIteration"),animationstart:_n("Animation","AnimationStart"),transitionend:_n("Transition","TransitionEnd")},jn={},wn={};function Nn(e){if(jn[e])return jn[e];if(!kn[e])return e;var t,r=kn[e];for(t in r)if(r.hasOwnProperty(t)&&t in wn)return jn[e]=r[t];return e}d&&(wn=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var Sn=Nn("animationend"),On=Nn("animationiteration"),Cn=Nn("animationstart"),En=Nn("transitionend"),Pn=new Map,An="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(e,t){Pn.set(e,t),l(t,[e])}for(var Mn=0;Mn<An.length;Mn++){var Rn=An[Mn];Tn(Rn.toLowerCase(),"on"+(Rn[0].toUpperCase()+Rn.slice(1)))}Tn(Sn,"onAnimationEnd"),Tn(On,"onAnimationIteration"),Tn(Cn,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(En,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),In=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function Ln(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,i,o,l,c){if(ze.apply(this,arguments),Ie){if(!Ie)throw Error(s(198));var d=Le;Ie=!1,Le=null,Fe||(Fe=!0,Be=d)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Ln(a,o,c),s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Ln(a,o,c),s=l}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Bn(e,t){var r=t[fa];void 0===r&&(r=t[fa]=new Set);var n=e+"__bubble";r.has(n)||(Hn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),Hn(r,e,n,t)}var zn="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[zn]){e[zn]=!0,i.forEach(function(t){"selectionchange"!==t&&(In.has(t)||Un(t,!1,e),Un(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zn]||(t[zn]=!0,Un("selectionchange",!1,t))}}function Hn(e,t,r,n){switch(Xt(t)){case 1:var a=qt;break;case 4:a=Gt;break;default:a=$t}r=a.bind(null,t,r,e),a=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Wn(e,t,r,n,a){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===i)for(i=n.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;i=i.return}for(;null!==o;){if(null===(i=ba(o)))return;if(5===(l=i.tag)||6===l){n=s=i;continue e}o=o.parentNode}}n=n.return}Ae(function(){var n=s,a=_e(r),i=[];e:{var o=Pn.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Sr;break;case"focusin":c="focus",l=fr;break;case"focusout":c="blur",l=fr;break;case"beforeblur":case"afterblur":l=fr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cr;break;case Sn:case On:case Cn:l=gr;break;case En:l=Er;break;case"scroll":l=ur;break;case"wheel":l=Ar;break;case"copy":case"cut":case"paste":l=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Or}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=n;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Te(m,h))&&d.push(qn(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,r,a),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===ve||!(c=r.relatedTarget||r.fromElement)||!ba(c)&&!c[ma])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?ba(c):null)&&(c!==(u=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=pr,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Or,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:va(l),p=null==c?o:va(c),(o=new d(f,m+"leave",l,r,a)).target=u,o.relatedTarget=p,f=null,ba(a)===n&&((d=new d(h,m+"enter",c,r,a)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=$n(p))m++;for(p=0,f=h;f;f=$n(f))p++;for(;0<m-p;)d=$n(d),m--;for(;0<p-m;)h=$n(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=$n(d),h=$n(h)}d=null}else d=null;null!==l&&Kn(i,o,l,d,!1),null!==c&&null!==u&&Kn(i,u,c,d,!0)}if("select"===(l=(o=n?va(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yr;else if(Hr(o))if(Xr)g=sn;else{g=nn;var x=rn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Wr(i,g,r,a):(x&&x(e,o,n),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=n?va(n):window,e){case"focusin":(Hr(x)||"true"===x.contentEditable)&&(gn=x,xn=n,bn=null);break;case"focusout":bn=xn=gn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,vn(i,r,a);break;case"selectionchange":if(fn)break;case"keydown":case"keyup":vn(i,r,a)}var b;if(Mr)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else zr?Br(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(Ir&&"ko"!==r.locale&&(zr||"onCompositionStart"!==y?"onCompositionEnd"===y&&zr&&(b=er()):(Qt="value"in(Jt=a)?Jt.value:Jt.textContent,zr=!0)),0<(x=Gn(n,y)).length&&(y=new yr(y,e,null,r,a),i.push({event:y,listeners:x}),b?y.data=b:null!==(b=Ur(r))&&(y.data=b))),(b=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Fr=!0,Lr);case"textInput":return(e=t.data)===Lr&&Fr?null:e;default:return null}}(e,r):function(e,t){if(zr)return"compositionend"===e||!Mr&&Br(e,t)?(e=er(),Zt=Qt=Jt=null,zr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ir&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Gn(n,"onBeforeInput")).length&&(a=new yr("onBeforeInput","beforeinput",null,r,a),i.push({event:a,listeners:n}),a.data=b))}Fn(i,t)})}function qn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Te(e,r))&&n.unshift(qn(e,s,a)),null!=(s=Te(e,t))&&n.push(qn(e,s,a))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kn(e,t,r,n,a){for(var s=t._reactName,i=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Te(r,s))&&i.unshift(qn(r,l,o)):a||null!=(l=Te(r,s))&&i.push(qn(r,l,o))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var Yn=/\r\n?/g,Xn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Xn,"")}function Qn(e,t,r){if(t=Jn(t),Jn(e)!==t&&r)throw Error(s(425))}function Zn(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(oa)}:na;function oa(e){setTimeout(function(){throw e})}function la(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void Vt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);Vt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,pa="__reactProps$"+ua,ma="__reactContainer$"+ua,fa="__reactEvents$"+ua,ga="__reactListeners$"+ua,xa="__reactHandles$"+ua;function ba(e){var t=e[ha];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ma]||r[ha]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=da(e);null!==e;){if(r=e[ha])return r;e=da(e)}return t}r=(e=r).parentNode}return null}function ya(e){return!(e=e[ha]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function va(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function _a(e){return e[pa]||null}var ka=[],ja=-1;function wa(e){return{current:e}}function Na(e){0>ja||(e.current=ka[ja],ka[ja]=null,ja--)}function Sa(e,t){ja++,ka[ja]=e.current,e.current=t}var Oa={},Ca=wa(Oa),Ea=wa(!1),Pa=Oa;function Aa(e,t){var r=e.type.contextTypes;if(!r)return Oa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in r)s[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ta(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Na(Ea),Na(Ca)}function Ra(e,t,r){if(Ca.current!==Oa)throw Error(s(168));Sa(Ca,t),Sa(Ea,r)}function Da(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(s(108,H(e)||"Unknown",a));return L({},r,n)}function Ia(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Oa,Pa=Ca.current,Sa(Ca,e),Sa(Ea,Ea.current),!0}function La(e,t,r){var n=e.stateNode;if(!n)throw Error(s(169));r?(e=Da(e,t,Pa),n.__reactInternalMemoizedMergedChildContext=e,Na(Ea),Na(Ca),Sa(Ca,e)):Na(Ea),Sa(Ea,r)}var Fa=null,Ba=!1,Ua=!1;function za(e){null===Fa?Fa=[e]:Fa.push(e)}function Va(){if(!Ua&&null!==Fa){Ua=!0;var e=0,t=yt;try{var r=Fa;for(yt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Fa=null,Ba=!1}catch(a){throw null!==Fa&&(Fa=Fa.slice(e+1)),$e(Ze,Va),a}finally{yt=t,Ua=!1}}return null}var Ha=[],Wa=0,qa=null,Ga=0,$a=[],Ka=0,Ya=null,Xa=1,Ja="";function Qa(e,t){Ha[Wa++]=Ga,Ha[Wa++]=qa,qa=e,Ga=t}function Za(e,t,r){$a[Ka++]=Xa,$a[Ka++]=Ja,$a[Ka++]=Ya,Ya=e;var n=Xa;e=Ja;var a=32-it(n)-1;n&=~(1<<a),r+=1;var s=32-it(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Xa=1<<32-it(t)+a|r<<a|n,Ja=s+e}else Xa=1<<s|r<<a|n,Ja=e}function es(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ts(e){for(;e===qa;)qa=Ha[--Wa],Ha[Wa]=null,Ga=Ha[--Wa],Ha[Wa]=null;for(;e===Ya;)Ya=$a[--Ka],$a[Ka]=null,Ja=$a[--Ka],$a[Ka]=null,Xa=$a[--Ka],$a[Ka]=null}var rs=null,ns=null,as=!1,ss=null;function is(e,t){var r=Ac(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function os(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,ns=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Ya?{id:Xa,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Ac(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rs=e,ns=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(as){var t=ns;if(t){var r=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ca(r.nextSibling);var n=rs;t&&os(e,t)?is(n,r):(e.flags=-4097&e.flags|2,as=!1,rs=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,rs=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function us(e){if(e!==rs)return!1;if(!as)return ds(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=ns)){if(ls(e))throw hs(),Error(s(418));for(;t;)is(e,t),t=ca(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ns=ca(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ns=null}}else ns=rs?ca(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=ns;e;)e=ca(e.nextSibling)}function ps(){ns=rs=null,as=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var fs=v.ReactCurrentBatchConfig;function gs(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var n=r.stateNode}if(!n)throw Error(s(147,e));var a=n,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!r._owner)throw Error(s(290,e))}return e}function xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function i(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Lc(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===j?u(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===T&&bs(s)===t.type)?((n=a(t,r.props)).ref=gs(e,t,r),n.return=e,n):((n=Rc(r.type,r.key,r.props,null,e.mode,n)).ref=gs(e,t,r),n.return=e,n)}function d(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fc(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function u(e,t,r,n,s){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,s)).return=e,t):((t=a(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(r=Rc(t.type,t.key,t.props,null,e.mode,r)).ref=gs(e,null,t),r.return=e,r;case k:return(t=Fc(t,e.mode,r)).return=e,t;case T:return h(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;xs(e,t)}return null}function p(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return r.key===a?c(e,t,r,n):null;case k:return r.key===a?d(e,t,r,n):null;case T:return p(e,t,(a=r._init)(r._payload),n)}if(te(r)||D(r))return null!==a?null:u(e,t,r,n,null);xs(e,r)}return null}function m(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case k:return d(t,e=e.get(null===n.key?r:n.key)||null,n,a);case T:return m(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||D(n))return u(t,e=e.get(r)||null,n,a,null);xs(t,n)}return null}function f(a,s,o,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var x=p(a,u,o[f],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(a,u),s=i(x,s,f),null===d?c=x:d.sibling=x,d=x,u=g}if(f===o.length)return r(a,u),as&&Qa(a,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(a,o[f],l))&&(s=i(u,s,f),null===d?c=u:d.sibling=u,d=u);return as&&Qa(a,f),c}for(u=n(a,u);f<o.length;f++)null!==(g=m(u,a,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=i(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),as&&Qa(a,f),c}function g(a,o,l,c){var d=D(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=o,g=o=0,x=null,b=l.next();null!==f&&!b.done;g++,b=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var y=p(a,f,b.value,c);if(null===y){null===f&&(f=x);break}e&&f&&null===y.alternate&&t(a,f),o=i(y,o,g),null===u?d=y:u.sibling=y,u=y,f=x}if(b.done)return r(a,f),as&&Qa(a,g),d;if(null===f){for(;!b.done;g++,b=l.next())null!==(b=h(a,b.value,c))&&(o=i(b,o,g),null===u?d=b:u.sibling=b,u=b);return as&&Qa(a,g),d}for(f=n(a,f);!b.done;g++,b=l.next())null!==(b=m(f,a,g,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?g:b.key),o=i(b,o,g),null===u?d=b:u.sibling=b,u=b);return e&&f.forEach(function(e){return t(a,e)}),as&&Qa(a,g),d}return function e(n,s,i,l){if("object"===typeof i&&null!==i&&i.type===j&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case _:e:{for(var c=i.key,d=s;null!==d;){if(d.key===c){if((c=i.type)===j){if(7===d.tag){r(n,d.sibling),(s=a(d,i.props.children)).return=n,n=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===T&&bs(c)===d.type){r(n,d.sibling),(s=a(d,i.props)).ref=gs(n,d,i),s.return=n,n=s;break e}r(n,d);break}t(n,d),d=d.sibling}i.type===j?((s=Dc(i.props.children,n.mode,l,i.key)).return=n,n=s):((l=Rc(i.type,i.key,i.props,null,n.mode,l)).ref=gs(n,s,i),l.return=n,n=l)}return o(n);case k:e:{for(d=i.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){r(n,s.sibling),(s=a(s,i.children||[])).return=n,n=s;break e}r(n,s);break}t(n,s),s=s.sibling}(s=Fc(i,n.mode,l)).return=n,n=s}return o(n);case T:return e(n,s,(d=i._init)(i._payload),l)}if(te(i))return f(n,s,i,l);if(D(i))return g(n,s,i,l);xs(n,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(r(n,s.sibling),(s=a(s,i)).return=n,n=s):(r(n,s),(s=Lc(i,n.mode,l)).return=n,n=s),o(n)):r(n,s)}}var vs=ys(!0),_s=ys(!1),ks=wa(null),js=null,ws=null,Ns=null;function Ss(){Ns=ws=js=null}function Os(e){var t=ks.current;Na(ks),e._currentValue=t}function Cs(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Es(e,t){js=e,Ns=ws=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(Ns!==e)if(e={context:e,memoizedValue:t,next:null},null===ws){if(null===js)throw Error(s(308));ws=e,js.dependencies={lanes:0,firstContext:e}}else ws=ws.next=e;return t}var As=null;function Ts(e){null===As?As=[e]:As.push(e)}function Ms(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Ts(t)):(r.next=a.next,a.next=r),t.interleaved=r,Rs(e,n)}function Rs(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ds=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Cl)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Rs(e,r)}return null===(a=n.interleaved)?(t.next=t,Ts(n)):(t.next=a.next,a.next=t),n.interleaved=t,Rs(e,r)}function Us(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}function zs(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?a=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vs(e,t,r,n){var a=e.updateQueue;Ds=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(i=0,d=c=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=r,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Ds=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Il|=i,e.lanes=i,e.memoizedState=u}}function Hs(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(s(191,a));a.call(n)}}}var Ws={},qs=wa(Ws),Gs=wa(Ws),$s=wa(Ws);function Ks(e){if(e===Ws)throw Error(s(174));return e}function Ys(e,t){switch(Sa($s,t),Sa(Gs,e),Sa(qs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Na(qs),Sa(qs,t)}function Xs(){Na(qs),Na(Gs),Na($s)}function Js(e){Ks($s.current);var t=Ks(qs.current),r=le(t,e.type);t!==r&&(Sa(Gs,e),Sa(qs,r))}function Qs(e){Gs.current===e&&(Na(qs),Na(Gs))}var Zs=wa(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ri(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ni=v.ReactCurrentDispatcher,ai=v.ReactCurrentBatchConfig,si=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function pi(){throw Error(s(321))}function mi(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function fi(e,t,r,n,a,i){if(si=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ni.current=null===e||null===e.memoizedState?Qi:Zi,e=r(n,a),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(s(301));i+=1,li=oi=null,t.updateQueue=null,ni.current=eo,e=r(n,a)}while(di)}if(ni.current=Ji,t=null!==oi&&null!==oi.next,si=0,li=oi=ii=null,ci=!1,t)throw Error(s(300));return e}function gi(){var e=0!==ui;return ui=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function bi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function yi(e,t){return"function"===typeof t?t(e):t}function vi(e){var t=bi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var n=oi,a=n.baseQueue,i=r.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(null!==a){i=a.next,n=n.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((si&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=n):c=c.next=h,ii.lanes|=u,Il|=u}d=d.next}while(null!==d&&d!==i);null===c?o=n:c.next=l,on(n,t.memoizedState)||(yo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{i=a.lane,ii.lanes|=i,Il|=i,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function _i(e){var t=bi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);on(i,t.memoizedState)||(yo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function ki(){}function ji(e,t){var r=ii,n=bi(),a=t(),i=!on(n.memoizedState,a);if(i&&(n.memoizedState=a,yo=!0),n=n.queue,Di(Si.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(r.flags|=2048,Pi(9,Ni.bind(null,r,n,a,t),void 0,null),null===El)throw Error(s(349));0!==(30&si)||wi(r,t,a)}return a}function wi(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ni(e,t,r,n){t.value=r,t.getSnapshot=n,Oi(t)&&Ci(e)}function Si(e,t,r){return r(function(){Oi(t)&&Ci(e)})}function Oi(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(n){return!0}}function Ci(e){var t=Rs(e,1);null!==t&&rc(t,e,1,-1)}function Ei(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:e},t.queue=e,e=e.dispatch=$i.bind(null,ii,e),[t.memoizedState,e]}function Pi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ai(){return bi().memoizedState}function Ti(e,t,r,n){var a=xi();ii.flags|=e,a.memoizedState=Pi(1|t,r,void 0,void 0===n?null:n)}function Mi(e,t,r,n){var a=bi();n=void 0===n?null:n;var s=void 0;if(null!==oi){var i=oi.memoizedState;if(s=i.destroy,null!==n&&mi(n,i.deps))return void(a.memoizedState=Pi(t,r,s,n))}ii.flags|=e,a.memoizedState=Pi(1|t,r,s,n)}function Ri(e,t){return Ti(8390656,8,e,t)}function Di(e,t){return Mi(2048,8,e,t)}function Ii(e,t){return Mi(4,2,e,t)}function Li(e,t){return Mi(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bi(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Mi(4,4,Fi.bind(null,t,e),r)}function Ui(){}function zi(e,t){var r=bi();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Vi(e,t){var r=bi();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&mi(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hi(e,t,r){return 0===(21&si)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=r):(on(r,t)||(r=ft(),ii.lanes|=r,Il|=r,e.baseState=!0),t)}function Wi(e,t){var r=yt;yt=0!==r&&4>r?r:4,e(!0);var n=ai.transition;ai.transition={};try{e(!1),t()}finally{yt=r,ai.transition=n}}function qi(){return bi().memoizedState}function Gi(e,t,r){var n=tc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ki(e))Yi(t,r);else if(null!==(r=Ms(e,t,r,n))){rc(r,e,n,ec()),Xi(r,t,n)}}function $i(e,t,r){var n=tc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ki(e))Yi(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,on(o,i)){var l=t.interleaved;return null===l?(a.next=a,Ts(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Ms(e,t,a,n))&&(rc(r,e,n,a=ec()),Xi(r,t,n))}}function Ki(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Yi(e,t){di=ci=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xi(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}var Ji={readContext:Ps,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},Qi={readContext:Ps,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:Ri,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ti(4194308,4,Fi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ti(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ti(4,2,e,t)},useMemo:function(e,t){var r=xi();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xi();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Gi.bind(null,ii,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ei,useDebugValue:Ui,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ei(!1),t=e[0];return e=Wi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ii,a=xi();if(as){if(void 0===r)throw Error(s(407));r=r()}else{if(r=t(),null===El)throw Error(s(349));0!==(30&si)||wi(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,Ri(Si.bind(null,n,i,e),[e]),n.flags|=2048,Pi(9,Ni.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=xi(),t=El.identifierPrefix;if(as){var r=Ja;t=":"+t+"R"+(r=(Xa&~(1<<32-it(Xa)-1)).toString(32)+r),0<(r=ui++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Ps,useCallback:zi,useContext:Ps,useEffect:Di,useImperativeHandle:Bi,useInsertionEffect:Ii,useLayoutEffect:Li,useMemo:Vi,useReducer:vi,useRef:Ai,useState:function(){return vi(yi)},useDebugValue:Ui,useDeferredValue:function(e){return Hi(bi(),oi.memoizedState,e)},useTransition:function(){return[vi(yi)[0],bi().memoizedState]},useMutableSource:ki,useSyncExternalStore:ji,useId:qi,unstable_isNewReconciler:!1},eo={readContext:Ps,useCallback:zi,useContext:Ps,useEffect:Di,useImperativeHandle:Bi,useInsertionEffect:Ii,useLayoutEffect:Li,useMemo:Vi,useReducer:_i,useRef:Ai,useState:function(){return _i(yi)},useDebugValue:Ui,useDeferredValue:function(e){var t=bi();return null===oi?t.memoizedState=e:Hi(t,oi.memoizedState,e)},useTransition:function(){return[_i(yi)[0],bi().memoizedState]},useMutableSource:ki,useSyncExternalStore:ji,useId:qi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var r in t=L({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ro(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:L({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),s=Fs(n,a);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Bs(e,s,a))&&(rc(t,e,a,n),Us(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),s=Fs(n,a);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Bs(e,s,a))&&(rc(t,e,a,n),Us(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),a=Fs(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Bs(e,a,n))&&(rc(t,e,n,r),Us(t,e,n))}};function ao(e,t,r,n,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(a,s))}function so(e,t,r){var n=!1,a=Oa,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(a=Ta(t)?Pa:Ca.current,s=(n=null!==(n=t.contextTypes)&&void 0!==n)?Aa(e,a):Oa),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function io(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function oo(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Is(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Ps(s):(s=Ta(t)?Pa:Ca.current,a.context=Aa(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ro(e,t,s,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&no.enqueueReplaceState(a,a.state,null),Vs(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var r="",n=t;do{r+=z(n),n=n.return}while(n);var a=r}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function co(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,r){(r=Fs(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Wl||(Wl=!0,ql=n),uo(0,t)},r}function mo(e,t,r){(r=Fs(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(r.callback=function(){uo(0,t),"function"!==typeof n&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function fo(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ho;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Nc.bind(null,e,t,r),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Fs(-1,1)).tag=2,Bs(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bo=v.ReactCurrentOwner,yo=!1;function vo(e,t,r,n){t.child=null===e?_s(t,null,r,n):vs(t,e.child,r,n)}function _o(e,t,r,n,a){r=r.render;var s=t.ref;return Es(t,a),n=fi(e,t,r,n,s,a),r=gi(),null===e||yo?(as&&r&&es(t),t.flags|=1,vo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function ko(e,t,r,n,a){if(null===e){var s=r.type;return"function"!==typeof s||Tc(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Rc(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,jo(e,t,s,n,a))}if(s=e.child,0===(e.lanes&a)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(i,n)&&e.ref===t.ref)return Wo(e,t,a)}return t.flags|=1,(e=Mc(s,n)).ref=t.ref,e.return=t,t.child=e}function jo(e,t,r,n,a){if(null!==e){var s=e.memoizedProps;if(ln(s,n)&&e.ref===t.ref){if(yo=!1,t.pendingProps=n=s,0===(e.lanes&a))return t.lanes=e.lanes,Wo(e,t,a);0!==(131072&e.flags)&&(yo=!0)}}return So(e,t,r,n,a)}function wo(e,t,r){var n=t.pendingProps,a=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sa(Ml,Tl),Tl|=r;else{if(0===(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sa(Ml,Tl),Tl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:r,Sa(Ml,Tl),Tl|=n}else null!==s?(n=s.baseLanes|r,t.memoizedState=null):n=r,Sa(Ml,Tl),Tl|=n;return vo(e,t,a,r),t.child}function No(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,r,n,a){var s=Ta(r)?Pa:Ca.current;return s=Aa(t,s),Es(t,a),r=fi(e,t,r,n,s,a),n=gi(),null===e||yo?(as&&n&&es(t),t.flags|=1,vo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function Oo(e,t,r,n,a){if(Ta(r)){var s=!0;Ia(t)}else s=!1;if(Es(t,a),null===t.stateNode)Ho(e,t),so(t,r,n),oo(t,r,n,a),n=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;"object"===typeof c&&null!==c?c=Ps(c):c=Aa(t,c=Ta(r)?Pa:Ca.current);var d=r.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==n||l!==c)&&io(t,i,n,c),Ds=!1;var h=t.memoizedState;i.state=h,Vs(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Ea.current||Ds?("function"===typeof d&&(ro(t,r,d,n),l=t.memoizedState),(o=Ds||ao(t,r,o,n,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Ls(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=r.contextType)&&null!==l?l=Ps(l):l=Aa(t,l=Ta(r)?Pa:Ca.current);var p=r.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,n,l),Ds=!1,h=t.memoizedState,i.state=h,Vs(t,n,i,a);var m=t.memoizedState;o!==u||h!==m||Ea.current||Ds?("function"===typeof p&&(ro(t,r,p,n),m=t.memoizedState),(c=Ds||ao(t,r,c,n,h,m,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(n,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,r,n,s,a)}function Co(e,t,r,n,a,s){No(e,t);var i=0!==(128&t.flags);if(!n&&!i)return a&&La(t,r,!1),Wo(e,t,s);n=t.stateNode,bo.current=t;var o=i&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=vs(t,e.child,null,s),t.child=vs(t,null,o,s)):vo(e,t,o,s),t.memoizedState=n.state,a&&La(t,r,!0),t.child}function Eo(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Ys(e,t.containerInfo)}function Po(e,t,r,n,a){return ps(),ms(a),t.flags|=256,vo(e,t,r,n),t.child}var Ao,To,Mo,Ro,Do={dehydrated:null,treeContext:null,retryLane:0};function Io(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,r){var n,a=t.pendingProps,i=Zs.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&i)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Sa(Zs,1&i),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Ic(l,a,0,null),e=Dc(e,a,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Io(r),t.memoizedState=Do,e):Fo(t,l));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,r,n,a,i,o){if(r)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,n=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ic({mode:"visible",children:n.children},a,0,null),(i=Dc(i,a,o,null)).flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!==(1&t.mode)&&vs(t,e.child,null,o),t.child.memoizedState=Io(o),t.memoizedState=Do,i);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var l=n.dgst;return n=l,Bo(e,t,o,n=co(i=Error(s(419)),n,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(n=El)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|o))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Rs(e,a),rc(n,e,a,-1))}return fc(),Bo(e,t,o,n=co(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Oc.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ns=ca(a.nextSibling),rs=t,as=!0,ss=null,null!==e&&($a[Ka++]=Xa,$a[Ka++]=Ja,$a[Ka++]=Ya,Xa=e.id,Ja=e.overflow,Ya=t),t=Fo(t,n.children),t.flags|=4096,t)}(e,t,l,a,n,i,r);if(o){o=a.fallback,l=t.mode,n=(i=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Mc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==n?o=Mc(n,o):(o=Dc(o,l,r,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Io(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Do,a}return e=(o=e.child).sibling,a=Mc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Fo(e,t){return(t=Ic({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,r,n){return null!==n&&ms(n),vs(t,e.child,null,r),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Cs(e.return,t,r)}function zo(e,t,r,n,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Vo(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(vo(e,t,n.children,r),0!==(2&(n=Zs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,r,t);else if(19===e.tag)Uo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Sa(Zs,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===ei(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),zo(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ei(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}zo(t,!0,r,null,s);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Il|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(r=Mc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Mc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function qo(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $o(e,t,r){var n=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return Ta(t.type)&&Ma(),Go(t),null;case 3:return n=t.stateNode,Xs(),Na(Ea),Na(Ca),ri(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ic(ss),ss=null))),To(e,t),Go(t),null;case 5:Qs(t);var a=Ks($s.current);if(r=t.type,null!==e&&null!=t.stateNode)Mo(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(s(166));return Go(t),null}if(e=Ks(qs.current),us(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ha]=t,n[pa]=i,e=0!==(1&t.mode),r){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(a=0;a<Dn.length;a++)Bn(Dn[a],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":X(n,i),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Bn("invalid",n);break;case"textarea":ae(n,i),Bn("invalid",n)}for(var l in be(r,i),a=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==i.suppressHydrationWarning&&Qn(n.textContent,c,e),a=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Qn(n.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bn("scroll",n)}switch(r){case"input":G(n),Z(n,i,!0);break;case"textarea":G(n),ie(n);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[ha]=t,e[pa]=n,Ao(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(r,n),r){case"dialog":Bn("cancel",e),Bn("close",e),a=n;break;case"iframe":case"object":case"embed":Bn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Dn.length;a++)Bn(Dn[a],e);a=n;break;case"source":Bn("error",e),a=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),a=n;break;case"details":Bn("toggle",e),a=n;break;case"input":X(e,n),a=Y(e,n),Bn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=L({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Bn("invalid",e)}for(i in be(r,a),c=a)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==r||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Bn("scroll",e):null!=d&&y(e,i,d,l))}switch(r){case"input":G(e),Z(e,n,!1);break;case"textarea":G(e),ie(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?re(e,!!n.multiple,i,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));if(r=Ks($s.current),Ks(qs.current),us(t)){if(n=t.stateNode,r=t.memoizedProps,n[ha]=t,(i=n.nodeValue!==r)&&null!==(e=rs))switch(e.tag){case 3:Qn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qn(n.nodeValue,r,0!==(1&e.mode))}i&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[ha]=t,t.stateNode=n}return Go(t),null;case 13:if(Na(Zs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,i=!1;else if(i=us(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[ha]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),i=!1}else null!==ss&&(ic(ss),ss=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return Xs(),To(e,t),null===e&&Vn(t.stateNode.containerInfo),Go(t),null;case 10:return Os(t.type._context),Go(t),null;case 19:if(Na(Zs),null===(i=t.memoizedState))return Go(t),null;if(n=0!==(128&t.flags),null===(l=i.rendering))if(n)qo(i,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,qo(i,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(i=r).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Sa(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Vl&&(t.flags|=128,n=!0,qo(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ei(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),qo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!as)return Go(t),null}else 2*Je()-i.renderingStartTime>Vl&&1073741824!==r&&(t.flags|=128,n=!0,qo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=i.last)?r.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,r=Zs.current,Sa(Zs,n?1&r|2:1&r),t):(Go(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Tl)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ko(e,t){switch(ts(t),t.tag){case 1:return Ta(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),Na(Ea),Na(Ca),ri(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qs(t),null;case 13:if(Na(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Na(Zs),null;case 4:return Xs(),null;case 10:return Os(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ao=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},To=function(){},Mo=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ks(qs.current);var s,i=null;switch(r){case"input":a=Y(e,a),n=Y(e,n),i=[];break;case"select":a=L({},a,{value:void 0}),n=L({},n,{value:void 0}),i=[];break;case"textarea":a=ne(e,a),n=ne(e,n),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in be(r,n),r=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Bn("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Ro=function(e,t,r,n){r!==n&&(t.flags|=4)};var Yo=!1,Xo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Qo=null;function Zo(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){wc(e,t,n)}else r.current=null}function el(e,t,r){try{r()}catch(n){wc(e,t,n)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&el(t,r,s)}a=a.next}while(a!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function al(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[fa],delete t[ga],delete t[xa])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var dl=null,ul=!1;function hl(e,t,r){for(r=r.child;null!==r;)pl(e,t,r),r=r.sibling}function pl(e,t,r){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(at,r)}catch(o){}switch(r.tag){case 5:Xo||Zo(r,t);case 6:var n=dl,a=ul;dl=null,hl(e,t,r),ul=a,null!==(dl=n)&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):dl.removeChild(r.stateNode));break;case 18:null!==dl&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?la(e.parentNode,r):1===e.nodeType&&la(e,r),Vt(e)):la(dl,r.stateNode));break;case 4:n=dl,a=ul,dl=r.stateNode.containerInfo,ul=!0,hl(e,t,r),dl=n,ul=a;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&el(r,t,i),a=a.next}while(a!==n)}hl(e,t,r);break;case 1:if(!Xo&&(Zo(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){wc(r,t,o)}hl(e,t,r);break;case 21:hl(e,t,r);break;case 22:1&r.mode?(Xo=(n=Xo)||null!==r.memoizedState,hl(e,t,r),Xo=n):hl(e,t,r);break;default:hl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Jo),t.forEach(function(t){var n=Cc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function fl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(s(160));pl(i,o,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){wc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),xl(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(g){wc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){wc(e,e.return,g)}}break;case 1:fl(t,e),xl(e),512&n&&null!==r&&Zo(r,r.return);break;case 5:if(fl(t,e),xl(e),512&n&&null!==r&&Zo(r,r.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){wc(e,e.return,g)}}if(4&n&&null!=(a=e.stateNode)){var i=e.memoizedProps,o=null!==r?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(a,i),ye(l,o);var d=ye(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):y(a,u,h,d)}switch(l){case"input":Q(a,i);break;case"textarea":se(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?re(a,!!i.multiple,m,!1):p!==!!i.multiple&&(null!=i.defaultValue?re(a,!!i.multiple,i.defaultValue,!0):re(a,!!i.multiple,i.multiple?[]:"",!1))}a[pa]=i}catch(g){wc(e,e.return,g)}}break;case 6:if(fl(t,e),xl(e),4&n){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){wc(e,e.return,g)}}break;case 3:if(fl(t,e),xl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){wc(e,e.return,g)}break;case 4:default:fl(t,e),xl(e);break;case 13:fl(t,e),xl(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(zl=Je())),4&n&&ml(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(Xo=(d=Xo)||u,fl(t,e),Xo=d):fl(t,e),xl(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qo=e,u=e.child;null!==u;){for(h=Qo=u;null!==Qo;){switch(m=(p=Qo).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:Zo(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){n=p,r=p.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){wc(n,r,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==m?(m.return=p,Qo=m):_l(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){wc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){wc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),xl(e),4&n&&ml(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(il(r)){var n=r;break e}r=r.return}throw Error(s(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(he(a,""),n.flags&=-33),cl(e,ol(e),a);break;case 3:case 4:var i=n.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(s(161))}}catch(o){wc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,r){Qo=e,yl(e,t,r)}function yl(e,t,r){for(var n=0!==(1&e.mode);null!==Qo;){var a=Qo,s=a.child;if(22===a.tag&&n){var i=null!==a.memoizedState||Yo;if(!i){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Yo;var c=Xo;if(Yo=i,(Xo=l)&&!c)for(Qo=a;null!==Qo;)l=(i=Qo).child,22===i.tag&&null!==i.memoizedState?kl(a):null!==l?(l.return=i,Qo=l):kl(a);for(;null!==s;)Qo=s,yl(s,t,r),s=s.sibling;Qo=a,Yo=o,Xo=c}vl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Qo=s):vl(e)}}function vl(e){for(;null!==Qo;){var t=Qo;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Xo)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:to(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Hs(t,i,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Hs(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(s(163))}Xo||512&t.flags&&al(t)}catch(p){wc(t,t.return,p)}}if(t===e){Qo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Qo=r;break}Qo=t.return}}function _l(e){for(;null!==Qo;){var t=Qo;if(t===e){Qo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Qo=r;break}Qo=t.return}}function kl(e){for(;null!==Qo;){var t=Qo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(l){wc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(l){wc(t,a,l)}}var s=t.return;try{al(t)}catch(l){wc(t,s,l)}break;case 5:var i=t.return;try{al(t)}catch(l){wc(t,i,l)}}}catch(l){wc(t,t.return,l)}if(t===e){Qo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qo=o;break}Qo=t.return}}var jl,wl=Math.ceil,Nl=v.ReactCurrentDispatcher,Sl=v.ReactCurrentOwner,Ol=v.ReactCurrentBatchConfig,Cl=0,El=null,Pl=null,Al=0,Tl=0,Ml=wa(0),Rl=0,Dl=null,Il=0,Ll=0,Fl=0,Bl=null,Ul=null,zl=0,Vl=1/0,Hl=null,Wl=!1,ql=null,Gl=null,$l=!1,Kl=null,Yl=0,Xl=0,Jl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&Cl)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Al?Al&-Al:null!==fs.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,r,n){if(50<Xl)throw Xl=0,Jl=null,Error(s(185));xt(e,r,n),0!==(2&Cl)&&e===El||(e===El&&(0===(2&Cl)&&(Ll|=r),4===Rl&&oc(e,Al)),nc(e,n),1===r&&0===Cl&&0===(1&t.mode)&&(Vl=Je()+500,Ba&&Va()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-it(s),o=1<<i,l=a[i];-1===l?0!==(o&r)&&0===(o&n)||(a[i]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var n=ht(e,e===El?Al:0);if(0===n)null!==r&&Ke(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ke(r),1===t)0===e.tag?function(e){Ba=!0,za(e)}(lc.bind(null,e)):za(lc.bind(null,e)),ia(function(){0===(6&Cl)&&Va()}),r=null;else{switch(vt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Ec(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if(Ql=-1,Zl=0,0!==(6&Cl))throw Error(s(327));var r=e.callbackNode;if(kc()&&e.callbackNode!==r)return null;var n=ht(e,e===El?Al:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var a=Cl;Cl|=2;var i=mc();for(El===e&&Al===t||(Hl=null,Vl=Je()+500,hc(e,t));;)try{bc();break}catch(l){pc(e,l)}Ss(),Nl.current=i,Cl=a,null!==Pl?t=0:(El=null,Al=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(n=a,t=sc(e,a))),1===t)throw r=Dl,hc(e,0),oc(e,n),nc(e,Je()),r;if(6===t)oc(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!on(s(),a))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,n))&&(0!==(i=mt(e))&&(n=i,t=sc(e,i))),1===t))throw r=Dl,hc(e,0),oc(e,n),nc(e,Je()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(s(345));case 2:case 5:_c(e,Ul,Hl);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=zl+500-Je())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(_c.bind(null,e,Ul,Hl),t);break}_c(e,Ul,Hl);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-it(n);i=1<<o,(o=t[o])>a&&(a=o),n&=~i}if(n=a,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wl(n/1960))-n)){e.timeoutHandle=na(_c.bind(null,e,Ul,Hl),n);break}_c(e,Ul,Hl);break;default:throw Error(s(329))}}}return nc(e,Je()),e.callbackNode===r?ac.bind(null,e):null}function sc(e,t){var r=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=r,null!==t&&ic(t)),e}function ic(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-it(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!==(6&Cl))throw Error(s(327));kc();var t=ht(e,0);if(0===(1&t))return nc(e,Je()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var n=mt(e);0!==n&&(t=n,r=sc(e,n))}if(1===r)throw r=Dl,hc(e,0),oc(e,t),nc(e,Je()),r;if(6===r)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Ul,Hl),nc(e,Je()),null}function cc(e,t){var r=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=r)&&(Vl=Je()+500,Ba&&Va())}}function dc(e){null!==Kl&&0===Kl.tag&&0===(6&Cl)&&kc();var t=Cl;Cl|=1;var r=Ol.transition,n=yt;try{if(Ol.transition=null,yt=1,e)return e()}finally{yt=n,Ol.transition=r,0===(6&(Cl=t))&&Va()}}function uc(){Tl=Ml.current,Na(Ml)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Pl)for(r=Pl.return;null!==r;){var n=r;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Ma();break;case 3:Xs(),Na(Ea),Na(Ca),ri();break;case 5:Qs(n);break;case 4:Xs();break;case 13:case 19:Na(Zs);break;case 10:Os(n.type._context);break;case 22:case 23:uc()}r=r.return}if(El=e,Pl=e=Mc(e.current,null),Al=Tl=t,Rl=0,Dl=null,Fl=Ll=Il=0,Ul=Bl=null,null!==As){for(t=0;t<As.length;t++)if(null!==(n=(r=As[t]).interleaved)){r.interleaved=null;var a=n.next,s=r.pending;if(null!==s){var i=s.next;s.next=a,n.next=i}r.pending=n}As=null}return e}function pc(e,t){for(;;){var r=Pl;try{if(Ss(),ni.current=Ji,ci){for(var n=ii.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}ci=!1}if(si=0,li=oi=ii=null,di=!1,ui=0,Sl.current=null,null===r||null===r.return){Rl=1,Dl=t,Pl=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,xo(m,o,l,0,t),1&m.mode&&fo(i,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(i,d,t),fc();break e}c=Error(s(426))}else if(as&&1&l.mode){var x=go(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),ms(lo(c,l));break e}}i=c=lo(c,l),4!==Rl&&(Rl=2),null===Bl?Bl=[i]:Bl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,zs(i,po(0,c,t));break e;case 1:l=c;var b=i.type,y=i.stateNode;if(0===(128&i.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Gl||!Gl.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,zs(i,mo(i,l,t));break e}}i=i.return}while(null!==i)}vc(r)}catch(v){t=v,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function mc(){var e=Nl.current;return Nl.current=Ji,null===e?Ji:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===El||0===(268435455&Il)&&0===(268435455&Ll)||oc(El,Al)}function gc(e,t){var r=Cl;Cl|=2;var n=mc();for(El===e&&Al===t||(Hl=null,hc(e,t));;)try{xc();break}catch(a){pc(e,a)}if(Ss(),Cl=r,Nl.current=n,null!==Pl)throw Error(s(261));return El=null,Al=0,Rl}function xc(){for(;null!==Pl;)yc(Pl)}function bc(){for(;null!==Pl&&!Ye();)yc(Pl)}function yc(e){var t=jl(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?vc(e):Pl=t,Sl.current=null}function vc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=$o(r,t,Tl)))return void(Pl=r)}else{if(null!==(r=Ko(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Rl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Rl&&(Rl=5)}function _c(e,t,r){var n=yt,a=Ol.transition;try{Ol.transition=null,yt=1,function(e,t,r,n){do{kc()}while(null!==Kl);if(0!==(6&Cl))throw Error(s(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-it(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}(e,i),e===El&&(Pl=El=null,Al=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||$l||($l=!0,Ec(tt,function(){return kc(),null})),i=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||i){i=Ol.transition,Ol.transition=null;var o=yt;yt=1;var l=Cl;Cl|=4,Sl.current=null,function(e,t){if(ea=Wt,pn(e=hn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch(_){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==r||0!==a&&3!==h.nodeType||(l=o+a),h!==i||0!==n&&3!==h.nodeType||(c=o+n),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===r&&++d===a&&(l=o),p===i&&++u===n&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Wt=!1,Qo=t;null!==Qo;)if(e=(t=Qo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qo=e;else for(;null!==Qo;){t=Qo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),x);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(s(163))}}catch(_){wc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Qo=e;break}Qo=t.return}f=tl,tl=!1}(e,r),gl(r,e),mn(ta),Wt=!!ea,ta=ea=null,e.current=r,bl(r,e,a),Xe(),Cl=l,yt=o,Ol.transition=i}else e.current=r;if($l&&($l=!1,Kl=e,Yl=a),i=e.pendingLanes,0===i&&(Gl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nc(e,Je()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Wl)throw Wl=!1,e=ql,ql=null,e;0!==(1&Yl)&&0!==e.tag&&kc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,Va()}(e,t,r,n)}finally{Ol.transition=a,yt=n}return null}function kc(){if(null!==Kl){var e=vt(Yl),t=Ol.transition,r=yt;try{if(Ol.transition=null,yt=16>e?16:e,null===Kl)var n=!1;else{if(e=Kl,Kl=null,Yl=0,0!==(6&Cl))throw Error(s(331));var a=Cl;for(Cl|=4,Qo=e.current;null!==Qo;){var i=Qo,o=i.child;if(0!==(16&Qo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qo=d;null!==Qo;){var u=Qo;switch(u.tag){case 0:case 11:case 15:rl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Qo=h;else for(;null!==Qo;){var p=(u=Qo).sibling,m=u.return;if(sl(u),u===d){Qo=null;break}if(null!==p){p.return=m,Qo=p;break}Qo=m}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Qo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Qo=o;else e:for(;null!==Qo;){if(0!==(2048&(i=Qo).flags))switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,Qo=b;break e}Qo=i.return}}var y=e.current;for(Qo=y;null!==Qo;){var v=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==v)v.return=o,Qo=v;else e:for(o=y;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(k){wc(l,l.return,k)}if(l===o){Qo=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Qo=_;break e}Qo=l.return}}if(Cl=a,Va(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(at,e)}catch(k){}n=!0}return n}finally{yt=r,Ol.transition=t}}return!1}function jc(e,t,r){e=Bs(e,t=po(0,t=lo(r,t),1),1),t=ec(),null!==e&&(xt(e,1,t),nc(e,t))}function wc(e,t,r){if(3===e.tag)jc(e,e,r);else for(;null!==t;){if(3===t.tag){jc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Gl||!Gl.has(n))){t=Bs(t,e=mo(t,e=lo(r,e),1),1),e=ec(),null!==t&&(xt(t,1,e),nc(t,e));break}}t=t.return}}function Nc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,El===e&&(Al&r)===r&&(4===Rl||3===Rl&&(130023424&Al)===Al&&500>Je()-zl?hc(e,0):Fl|=r),nc(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var r=ec();null!==(e=Rs(e,t))&&(xt(e,t,r),nc(e,r))}function Oc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Sc(e,r)}function Cc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(t),Sc(e,r)}function Ec(e,t){return $e(e,t)}function Pc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,r,n){return new Pc(e,t,r,n)}function Tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var r=e.alternate;return null===r?((r=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rc(e,t,r,n,a,i){var o=2;if(n=e,"function"===typeof e)Tc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case j:return Dc(r.children,a,i,t);case w:o=8,a|=8;break;case N:return(e=Ac(12,r,t,2|a)).elementType=N,e.lanes=i,e;case E:return(e=Ac(13,r,t,a)).elementType=E,e.lanes=i,e;case P:return(e=Ac(19,r,t,a)).elementType=P,e.lanes=i,e;case M:return Ic(r,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case O:o=9;break e;case C:o=11;break e;case A:o=14;break e;case T:o=16,n=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(o,r,t,a)).elementType=e,t.type=n,t.lanes=i,t}function Dc(e,t,r,n){return(e=Ac(7,e,n,t)).lanes=r,e}function Ic(e,t,r,n){return(e=Ac(22,e,n,t)).elementType=M,e.lanes=r,e.stateNode={isHidden:!1},e}function Lc(e,t,r){return(e=Ac(6,e,null,t)).lanes=r,e}function Fc(e,t,r){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,a,s,i,o,l){return e=new Bc(e,t,r,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Is(s),e}function zc(e){if(!e)return Oa;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ta(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var r=e.type;if(Ta(r))return Da(e,r,t)}return t}function Vc(e,t,r,n,a,s,i,o,l){return(e=Uc(r,n,!0,e,0,s,0,o,l)).context=zc(null),r=e.current,(s=Fs(n=ec(),a=tc(r))).callback=void 0!==t&&null!==t?t:null,Bs(r,s,a),e.current.lanes=a,xt(e,a,n),nc(e,n),e}function Hc(e,t,r,n){var a=t.current,s=ec(),i=tc(a);return r=zc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Fs(s,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Bs(a,t,i))&&(rc(e,a,i,s),Us(e,a,i)),i}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Gc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}jl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ea.current)yo=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return yo=!1,function(e,t,r){switch(t.tag){case 3:Eo(t),ps();break;case 5:Js(t);break;case 1:Ta(t.type)&&Ia(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Sa(ks,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Sa(Zs,1&Zs.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Lo(e,t,r):(Sa(Zs,1&Zs.current),null!==(e=Wo(e,t,r))?e.sibling:null);Sa(Zs,1&Zs.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return Vo(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Sa(Zs,Zs.current),n)break;return null;case 22:case 23:return t.lanes=0,wo(e,t,r)}return Wo(e,t,r)}(e,t,r);yo=0!==(131072&e.flags)}else yo=!1,as&&0!==(1048576&t.flags)&&Za(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ho(e,t),e=t.pendingProps;var a=Aa(t,Ca.current);Es(t,r),a=fi(null,t,n,e,a,r);var i=gi();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ta(n)?(i=!0,Ia(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Is(t),a.updater=no,t.stateNode=a,a._reactInternals=t,oo(t,n,e,r),t=Co(null,t,n,!0,i,r)):(t.tag=0,as&&i&&es(t),vo(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Tc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(n),e=to(n,e),a){case 0:t=So(null,t,n,e,r);break e;case 1:t=Oo(null,t,n,e,r);break e;case 11:t=_o(null,t,n,e,r);break e;case 14:t=ko(null,t,n,to(n.type,e),r);break e}throw Error(s(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,So(e,t,n,a=t.elementType===n?a:to(n,a),r);case 1:return n=t.type,a=t.pendingProps,Oo(e,t,n,a=t.elementType===n?a:to(n,a),r);case 3:e:{if(Eo(t),null===e)throw Error(s(387));n=t.pendingProps,a=(i=t.memoizedState).element,Ls(e,t),Vs(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Po(e,t,n,r,a=lo(Error(s(423)),t));break e}if(n!==a){t=Po(e,t,n,r,a=lo(Error(s(424)),t));break e}for(ns=ca(t.stateNode.containerInfo.firstChild),rs=t,as=!0,ss=null,r=_s(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ps(),n===a){t=Wo(e,t,r);break e}vo(e,t,n,r)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),n=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,o=a.children,ra(n,a)?o=null:null!==i&&ra(n,i)&&(t.flags|=32),No(e,t),vo(e,t,o,r),t.child;case 6:return null===e&&cs(t),null;case 13:return Lo(e,t,r);case 4:return Ys(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=vs(t,null,n,r):vo(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,_o(e,t,n,a=t.elementType===n?a:to(n,a),r);case 7:return vo(e,t,t.pendingProps,r),t.child;case 8:case 12:return vo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Sa(ks,n._currentValue),n._currentValue=o,null!==i)if(on(i.value,o)){if(i.children===a.children&&!Ea.current){t=Wo(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===i.tag){(c=Fs(-1,r&-r)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,null!==(c=i.alternate)&&(c.lanes|=r),Cs(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),Cs(o,r,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}vo(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Es(t,r),n=n(a=Ps(a)),t.flags|=1,vo(e,t,n,r),t.child;case 14:return a=to(n=t.type,t.pendingProps),ko(e,t,n,a=to(n.type,a),r);case 15:return jo(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:to(n,a),Ho(e,t),t.tag=1,Ta(n)?(e=!0,Ia(t)):e=!1,Es(t,r),so(t,n,a),oo(t,n,a,r),Co(null,t,n,!0,e,r);case 19:return Vo(e,t,r);case 22:return wo(e,t,r)}throw Error(s(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if("function"===typeof a){var o=a;a=function(){var e=Wc(i);o.call(e)}}Hc(t,i,e,a)}else i=function(e,t,r,n,a){if(a){if("function"===typeof n){var s=n;n=function(){var e=Wc(i);s.call(e)}}var i=Vc(t,n,e,0,null,!1,0,"",Qc);return e._reactRootContainer=i,e[ma]=i.current,Vn(8===e.nodeType?e.parentNode:e),dc(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var o=n;n=function(){var e=Wc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[ma]=l.current,Vn(8===e.nodeType?e.parentNode:e),dc(function(){Hc(t,l,r,n)}),l}(r,t,e,a,n);return Wc(i)}Yc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hc(e,t,null,null)},Yc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Hc(null,e,null,null)}),t[ma]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mt.length&&0!==t&&t<Mt[r].priority;r++);Mt.splice(r,0,e),0===r&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ut(t.pendingLanes);0!==r&&(bt(t,1|r),nc(t,Je()),0===(6&Cl)&&(Vl=Je()+500,Va()))}break;case 13:dc(function(){var t=Rs(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}}),Gc(e,1)}},kt=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)rc(t,e,134217728,ec());Gc(e,134217728)}},jt=function(e){if(13===e.tag){var t=tc(e),r=Rs(e,t);if(null!==r)rc(r,e,t,ec());Gc(e,t)}},wt=function(){return yt},Nt=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}},ke=function(e,t,r){switch(t){case"input":if(Q(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=_a(n);if(!a)throw Error(s(90));$(n),Q(n,a)}}}break;case"textarea":se(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ce=cc,Ee=dc;var ed={usingClientEntryPoint:!1,Events:[ya,va,_a,Se,Oe,cc]},td={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{at=nd.inject(rd),st=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var r=!1,n="",a=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,a),e[ma]=t.current,Vn(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xc(e))throw Error(s(405));var n=null!=r&&r.hydratedSources||null,a=!1,i="",o=$c;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=Vc(t,null,e,1,null!=r?r:null,a,0,i,o),e[ma]=t.current,Vn(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[ma]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jc(r))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},2761:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2777:(e,t,r)=>{var n=r(5193),a=r(2761),s=Object.prototype,i=s.hasOwnProperty,o=s.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return a(e)&&i.call(e,"callee")&&!o.call(e,"callee")};e.exports=l},2866:(e,t,r)=>{var n=r(2969);e.exports=function(e){return function(t){return n(t,e)}}},2929:(e,t,r)=>{var n=r(6552).Uint8Array;e.exports=n},2969:(e,t,r)=>{var n=r(5324),a=r(914);e.exports=function(e,t){for(var r=0,s=(t=n(t,e)).length;null!=e&&r<s;)e=e[a(t[r++])];return r&&r==s?e:void 0}},3028:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},3097:(e,t,r)=>{var n=r(2969);e.exports=function(e,t,r){var a=null==e?void 0:n(e,t);return void 0===a?r:a}},3204:(e,t,r)=>{var n=r(3343),a=r(2777),s=r(4052),i=r(4543),o=r(9194),l=r(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=s(e),d=!r&&a(e),u=!r&&!d&&i(e),h=!r&&!d&&!u&&l(e),p=r||d||u||h,m=p?n(e.length,String):[],f=m.length;for(var g in e)!t&&!c.call(e,g)||p&&("length"==g||u&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||o(g,f))||m.push(g);return m}},3211:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3279:e=>{e.exports=function(e){return e}},3331:(e,t,r)=>{var n=r(9676),a=r(929),s=r(7303);e.exports=function(e){return function(t,r,i){return i&&"number"!=typeof i&&a(t,r,i)&&(r=i=void 0),t=s(t),void 0===r?(r=t,t=0):r=s(r),i=void 0===i?t<r?1:-1:s(i),n(t,r,i,e)}}},3343:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},3366:(e,t,r)=>{var n=r(7894),a=r(9057);e.exports=function(e,t){return null!=e&&a(e,t,n)}},3411:(e,t,r)=>{var n=r(149),a=r(9096),s=r(8883),i=r(4052);e.exports=function(e,t){return(i(e)?n:s)(e,a(t,3))}},3440:(e,t,r)=>{var n=r(6552)["__core-js_shared__"];e.exports=n},3538:(e,t,r)=>{var n=r(755),a=r(3411);e.exports=function(e,t){return n(a(e,t),1)}},3668:(e,t,r)=>{var n=r(8902),a=r(2587),s=r(8114);e.exports=function(e,t,r,i,o,l){var c=1&r,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var h=l.get(e),p=l.get(t);if(h&&p)return h==t&&p==e;var m=-1,f=!0,g=2&r?new n:void 0;for(l.set(e,t),l.set(t,e);++m<d;){var x=e[m],b=t[m];if(i)var y=c?i(b,x,m,t,e,l):i(x,b,m,e,t,l);if(void 0!==y){if(y)continue;f=!1;break}if(g){if(!a(t,function(e,t){if(!s(g,t)&&(x===e||o(x,e,r,i,l)))return g.push(t)})){f=!1;break}}else if(x!==b&&!o(x,b,r,i,l)){f=!1;break}}return l.delete(e),l.delete(t),f}},3713:(e,t,r)=>{var n=r(6140),a=r(1143),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return a(e);var t=[];for(var r in Object(e))s.call(e,r)&&"constructor"!=r&&t.push(r);return t}},3763:(e,t,r)=>{"use strict";e.exports=r(4983)},3781:(e,t,r)=>{var n=r(9417),a=r(8673);e.exports=function(e){for(var t=a(e),r=t.length;r--;){var s=t[r],i=e[s];t[r]=[s,i,n(i)]}return t}},3871:e=>{e.exports=function(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}},3892:e=>{e.exports=function(e){return this.__data__.has(e)}},3932:(e,t,r)=>{var n=r(396),a=r(2866),s=r(2597),i=r(914);e.exports=function(e){return s(e)?n(i(e)):a(e)}},3950:(e,t,r)=>{var n=r(6686),a=r(4757),s=r(801),i=Math.max,o=Math.min;e.exports=function(e,t,r){var l,c,d,u,h,p,m=0,f=!1,g=!1,x=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var r=l,n=c;return l=c=void 0,m=t,u=e.apply(n,r)}function y(e){var r=e-p;return void 0===p||r>=t||r<0||g&&e-m>=d}function v(){var e=a();if(y(e))return _(e);h=setTimeout(v,function(e){var r=t-(e-p);return g?o(r,d-(e-m)):r}(e))}function _(e){return h=void 0,x&&l?b(e):(l=c=void 0,u)}function k(){var e=a(),r=y(e);if(l=arguments,c=this,p=e,r){if(void 0===h)return function(e){return m=e,h=setTimeout(v,t),f?b(e):u}(p);if(g)return clearTimeout(h),h=setTimeout(v,t),b(p)}return void 0===h&&(h=setTimeout(v,t)),u}return t=s(t)||0,n(r)&&(f=!!r.leading,d=(g="maxWait"in r)?i(s(r.maxWait)||0,t):d,x="trailing"in r?!!r.trailing:x),k.cancel=function(){void 0!==h&&clearTimeout(h),m=0,l=p=c=h=void 0},k.flush=function(){return void 0===h?u:_(a())},k}},4020:e=>{e.exports=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}},4052:e=>{var t=Array.isArray;e.exports=t},4065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},4079:(e,t,r)=>{var n=r(8259),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,i=n(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,function(e,r,n,a){t.push(n?a.replace(s,"$1"):r||e)}),t});e.exports=i},4160:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},4190:(e,t,r)=>{var n=r(1340);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},4202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function b(){}function y(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=x.prototype;var v=y.prototype=new b;v.constructor=y,f(v,x.prototype),v.isPureReactComponent=!0;var _=Array.isArray,k=Object.prototype.hasOwnProperty,j={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,n){var a,s={},i=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,a)&&!w.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:r,type:e,key:i,ref:o,props:s,_owner:j.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var O=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function E(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return i=i(l=e),e=""===s?"."+C(l,0):s,_(i)?(a="",null!=e&&(a=e.replace(O,"$&/")+"/"),E(i,t,a,"",function(e){return e})):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(O,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",_(e))for(var c=0;c<e.length;c++){var d=s+C(o=e[c],c);l+=E(o,t,a,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=E(o=o.value,t,a,d=s+C(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var n=[],a=0;return E(e,n,"","",function(e){return t.call(r,e,a++)}),n}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var T={current:null},M={transition:null},R={ReactCurrentDispatcher:T,ReactCurrentBatchConfig:M,ReactCurrentOwner:j};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,r){P(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=a,t.Profiler=i,t.PureComponent=y,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),s=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=j.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!w.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:r,type:e.type,key:s,ref:i,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return T.current.useCallback(e,t)},t.useContext=function(e){return T.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return T.current.useDeferredValue(e)},t.useEffect=function(e,t){return T.current.useEffect(e,t)},t.useId=function(){return T.current.useId()},t.useImperativeHandle=function(e,t,r){return T.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return T.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return T.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return T.current.useMemo(e,t)},t.useReducer=function(e,t,r){return T.current.useReducer(e,t,r)},t.useRef=function(e){return T.current.useRef(e)},t.useState=function(e){return T.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return T.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return T.current.useTransition()},t.version="18.3.1"},4258:(e,t,r)=>{var n=r(5906)();e.exports=n},4262:(e,t,r)=>{var n=r(8895),a=r(4052);e.exports=function(e,t,r){var s=t(e);return a(e)?s:n(s,r(e))}},4391:(e,t,r)=>{"use strict";var n=r(7950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4416:(e,t,r)=>{var n=r(8902),a=r(5866),s=r(1558),i=r(8114),o=r(8182),l=r(2074);e.exports=function(e,t,r){var c=-1,d=a,u=e.length,h=!0,p=[],m=p;if(r)h=!1,d=s;else if(u>=200){var f=t?null:o(e);if(f)return l(f);h=!1,d=i,m=new n}else m=t?[]:p;e:for(;++c<u;){var g=e[c],x=t?t(g):g;if(g=r||0!==g?g:0,h&&x===x){for(var b=m.length;b--;)if(m[b]===x)continue e;t&&m.push(x),p.push(g)}else d(m,x,r)||(m!==p&&m.push(x),p.push(g))}return p}},4543:(e,t,r)=>{e=r.nmd(e);var n=r(6552),a=r(14),s=t&&!t.nodeType&&t,i=s&&e&&!e.nodeType&&e,o=i&&i.exports===s?n.Buffer:void 0,l=(o?o.isBuffer:void 0)||a;e.exports=l},4545:(e,t,r)=>{var n=r(7160);e.exports=function(){this.__data__=new n,this.size=0}},4552:(e,t,r)=>{var n=r(9812),a=Object.prototype,s=a.hasOwnProperty,i=a.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,o),r=e[o];try{e[o]=void 0;var n=!0}catch(l){}var a=i.call(e);return n&&(t?e[o]=r:delete e[o]),a}},4597:(e,t,r)=>{var n=r(2587),a=r(9096),s=r(2165),i=r(4052),o=r(929);e.exports=function(e,t,r){var l=i(e)?n:s;return r&&o(e,t,r)&&(t=void 0),l(e,a(t,3))}},4657:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},4664:(e,t,r)=>{var n=r(4258),a=r(8673);e.exports=function(e,t){return e&&n(e,t,a)}},4746:(e,t,r)=>{var n=r(5652);e.exports=function(e,t){var r=!0;return n(e,function(e,n,a){return r=!!t(e,n,a)}),r}},4757:(e,t,r)=>{var n=r(6552);e.exports=function(){return n.Date.now()}},4816:(e,t,r)=>{var n=r(7251),a=r(7159),s=r(438),i=r(9394),o=r(6874);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},4983:(e,t)=>{"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,a=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,i=r?Symbol.for("react.strict_mode"):60108,o=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,u=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,f=r?Symbol.for("react.memo"):60115,g=r?Symbol.for("react.lazy"):60116,x=r?Symbol.for("react.block"):60121,b=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,v=r?Symbol.for("react.scope"):60119;function _(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case d:case u:case s:case o:case i:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case f:case l:return e;default:return t}}case a:return t}}}function k(e){return _(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=h,t.Fragment=s,t.Lazy=g,t.Memo=f,t.Portal=a,t.Profiler=o,t.StrictMode=i,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||_(e)===d},t.isConcurrentMode=k,t.isContextConsumer=function(e){return _(e)===c},t.isContextProvider=function(e){return _(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return _(e)===h},t.isFragment=function(e){return _(e)===s},t.isLazy=function(e){return _(e)===g},t.isMemo=function(e){return _(e)===f},t.isPortal=function(e){return _(e)===a},t.isProfiler=function(e){return _(e)===o},t.isStrictMode=function(e){return _(e)===i},t.isSuspense=function(e){return _(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===u||e===o||e===i||e===p||e===m||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===b||e.$$typeof===y||e.$$typeof===v||e.$$typeof===x)},t.typeOf=_},5029:(e,t,r)=>{var n=r(6989),a=r(3097),s=r(3366),i=r(2597),o=r(9417),l=r(1310),c=r(914);e.exports=function(e,t){return i(e)&&o(t)?l(c(e),t):function(r){var i=a(r,e);return void 0===i&&i===t?s(r,e):n(t,i,3)}}},5043:(e,t,r)=>{"use strict";e.exports=r(4202)},5051:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5173:(e,t,r)=>{e.exports=r(1497)()},5193:(e,t,r)=>{var n=r(6913),a=r(2761);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},5204:(e,t,r)=>{var n=r(7937)(r(6552),"Map");e.exports=n},5268:(e,t,r)=>{var n=r(9160);e.exports=function(e){return n(e)&&e!=+e}},5295:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}},5324:(e,t,r)=>{var n=r(4052),a=r(2597),s=r(4079),i=r(1069);e.exports=function(e,t){return n(e)?e:a(e,t)?[e]:s(i(e))}},5387:(e,t,r)=>{var n=r(7937)(r(6552),"Promise");e.exports=n},5428:(e,t,r)=>{var n=r(6913),a=r(6173),s=r(2761),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&a(e.length)&&!!i[n(e)]}},5538:(e,t,r)=>{var n=r(7160),a=r(4545),s=r(793),i=r(7760),o=r(3892),l=r(6788);function c(e){var t=this.__data__=new n(e);this.size=t.size}c.prototype.clear=a,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=o,c.prototype.set=l,e.exports=c},5575:(e,t,r)=>{var n=r(7937)(Object,"create");e.exports=n},5636:(e,t,r)=>{var n=r(1170),a=Math.max;e.exports=function(e,t,r){return t=a(void 0===t?e.length-1:t,0),function(){for(var s=arguments,i=-1,o=a(s.length-t,0),l=Array(o);++i<o;)l[i]=s[t+i];i=-1;for(var c=Array(t+1);++i<t;)c[i]=s[i];return c[t]=r(l),n(e,this,c)}}},5647:(e,t,r)=>{var n=r(3279),a=r(5636),s=r(6350);e.exports=function(e,t){return s(a(e,t,n),e+"")}},5652:(e,t,r)=>{var n=r(4664),a=r(6516)(n);e.exports=a},5654:(e,t,r)=>{var n=r(7937),a=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=a},5713:e=>{e.exports=function(){}},5752:(e,t,r)=>{var n=r(9395),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,s,i,o){var l=1&r,c=n(e),d=c.length;if(d!=n(t).length&&!l)return!1;for(var u=d;u--;){var h=c[u];if(!(l?h in t:a.call(t,h)))return!1}var p=o.get(e),m=o.get(t);if(p&&m)return p==t&&m==e;var f=!0;o.set(e,t),o.set(t,e);for(var g=l;++u<d;){var x=e[h=c[u]],b=t[h];if(s)var y=l?s(b,x,h,t,e,o):s(x,b,h,e,t,o);if(!(void 0===y?x===b||i(x,b,r,s,o):y)){f=!1;break}g||(g="constructor"==h)}if(f&&!g){var v=e.constructor,_=t.constructor;v==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _||(f=!1)}return o.delete(e),o.delete(t),f}},5797:(e,t,r)=>{var n=r(4816);function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(a.Cache||n),r}a.Cache=n,e.exports=a},5816:e=>{e.exports=function(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}},5866:(e,t,r)=>{var n=r(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},5893:(e,t,r)=>{var n=r(6599);e.exports=function(e,t,r){for(var a=-1,s=e.criteria,i=t.criteria,o=s.length,l=r.length;++a<o;){var c=n(s[a],i[a]);if(c)return a>=l?c:c*("desc"==r[a]?-1:1)}return e.index-t.index}},5906:e=>{e.exports=function(e){return function(t,r,n){for(var a=-1,s=Object(t),i=n(t),o=i.length;o--;){var l=i[e?o:++a];if(!1===r(s[l],l,s))break}return t}}},5967:e=>{e.exports=function(e){return e.split("")}},5990:(e,t,r)=>{var n=r(3028)(Object.getPrototypeOf,Object);e.exports=n},6095:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},6140:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},6173:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6179:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6311:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6350:(e,t,r)=>{var n=r(8325),a=r(6578)(n);e.exports=a},6361:(e,t,r)=>{var n=r(6913),a=r(2761);e.exports=function(e){return!0===e||!1===e||a(e)&&"[object Boolean]"==n(e)}},6378:(e,t)=>{"use strict";var r,n=Symbol.for("react.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case s:case o:case i:case h:case p:return e;default:switch(e=e&&e.$$typeof){case d:case c:case u:case f:case m:case l:return e;default:return t}}case a:return t}}}r=Symbol.for("react.module.reference"),t.isFragment=function(e){return x(e)===s}},6399:(e,t,r)=>{var n=r(5538),a=r(3668),s=r(9987),i=r(5752),o=r(6924),l=r(4052),c=r(4543),d=r(1268),u="[object Arguments]",h="[object Array]",p="[object Object]",m=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,f,g,x){var b=l(e),y=l(t),v=b?h:o(e),_=y?h:o(t),k=(v=v==u?p:v)==p,j=(_=_==u?p:_)==p,w=v==_;if(w&&c(e)){if(!c(t))return!1;b=!0,k=!1}if(w&&!k)return x||(x=new n),b||d(e)?a(e,t,r,f,g,x):s(e,t,v,r,f,g,x);if(!(1&r)){var N=k&&m.call(e,"__wrapped__"),S=j&&m.call(t,"__wrapped__");if(N||S){var O=N?e.value():e,C=S?t.value():t;return x||(x=new n),g(O,C,r,f,x)}}return!!w&&(x||(x=new n),i(e,t,r,f,g,x))}},6516:(e,t,r)=>{var n=r(6571);e.exports=function(e,t){return function(r,a){if(null==r)return r;if(!n(r))return e(r,a);for(var s=r.length,i=t?s:-1,o=Object(r);(t?i--:++i<s)&&!1!==a(o[i],i,o););return r}}},6532:(e,t,r)=>{var n=r(5538),a=r(6989);e.exports=function(e,t,r,s){var i=r.length,o=i,l=!s;if(null==e)return!o;for(e=Object(e);i--;){var c=r[i];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<o;){var d=(c=r[i])[0],u=e[d],h=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var p=new n;if(s)var m=s(u,h,d,e,t,p);if(!(void 0===m?a(h,u,3,s,p):m))return!1}}return!0}},6552:(e,t,r)=>{var n=r(7105),a="object"==typeof self&&self&&self.Object===Object&&self,s=n||a||Function("return this")();e.exports=s},6571:(e,t,r)=>{var n=r(1629),a=r(6173);e.exports=function(e){return null!=e&&a(e.length)&&!n(e)}},6578:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var a=t(),s=16-(a-n);if(n=a,s>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},6599:(e,t,r)=>{var n=r(9841);e.exports=function(e,t){if(e!==t){var r=void 0!==e,a=null===e,s=e===e,i=n(e),o=void 0!==t,l=null===t,c=t===t,d=n(t);if(!l&&!d&&!i&&e>t||i&&o&&c&&!l&&!d||a&&o&&c||!r&&c||!s)return 1;if(!a&&!i&&!d&&e<t||d&&r&&s&&!a&&!i||l&&r&&s||!o&&s||!c)return-1}return 0}},6600:(e,t,r)=>{var n=r(7937)(r(6552),"WeakMap");e.exports=n},6604:(e,t,r)=>{var n=r(3331)();e.exports=n},6686:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6704:e=>{e.exports=function(e){return this.__data__.has(e)}},6745:(e,t,r)=>{var n=r(9742),a=r(61),s=r(3279);e.exports=function(e){return e&&e.length?n(e,s,a):void 0}},6788:(e,t,r)=>{var n=r(7160),a=r(5204),s=r(4816);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var i=r.__data__;if(!a||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new s(i)}return r.set(e,t),this.size=r.size,this}},6832:(e,t,r)=>{e=r.nmd(e);var n=r(7105),a=t&&!t.nodeType&&t,s=a&&e&&!e.nodeType&&e,i=s&&s.exports===a&&n.process,o=function(){try{var e=s&&s.require&&s.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(t){}}();e.exports=o},6874:(e,t,r)=>{var n=r(2622);e.exports=function(e,t){var r=n(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}},6913:(e,t,r)=>{var n=r(9812),a=r(4552),s=r(6095),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):s(e)}},6924:(e,t,r)=>{var n=r(7685),a=r(5204),s=r(5387),i=r(2070),o=r(6600),l=r(6913),c=r(6996),d="[object Map]",u="[object Promise]",h="[object Set]",p="[object WeakMap]",m="[object DataView]",f=c(n),g=c(a),x=c(s),b=c(i),y=c(o),v=l;(n&&v(new n(new ArrayBuffer(1)))!=m||a&&v(new a)!=d||s&&v(s.resolve())!=u||i&&v(new i)!=h||o&&v(new o)!=p)&&(v=function(e){var t=l(e),r="[object Object]"==t?e.constructor:void 0,n=r?c(r):"";if(n)switch(n){case f:return m;case g:return d;case x:return u;case b:return h;case y:return p}return t}),e.exports=v},6954:(e,t,r)=>{var n=r(1629),a=r(7857),s=r(6686),i=r(6996),o=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,h=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||a(e))&&(n(e)?h:o).test(i(e))}},6989:(e,t,r)=>{var n=r(6399),a=r(2761);e.exports=function e(t,r,s,i,o){return t===r||(null==t||null==r||!a(t)&&!a(r)?t!==t&&r!==r:n(t,r,s,i,e,o))}},6996:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(r){}try{return e+""}catch(r){}}return""}},7002:(e,t,r)=>{var n=r(5295),a=r(4746),s=r(9096),i=r(4052),o=r(929);e.exports=function(e,t,r){var l=i(e)?n:a;return r&&o(e,t,r)&&(t=void 0),l(e,s(t,3))}},7105:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},7116:(e,t,r)=>{var n=r(9812),a=r(2777),s=r(4052),i=n?n.isConcatSpreadable:void 0;e.exports=function(e){return s(e)||a(e)||!!(i&&e&&e[i])}},7159:(e,t,r)=>{var n=r(2622);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},7160:(e,t,r)=>{var n=r(7563),a=r(9935),s=r(4190),i=r(1946),o=r(1714);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},7234:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<s(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,r))c<a&&0>s(d,l)?(e[n]=d,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<a&&0>s(d,r)))break e;e[n]=d,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=n(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,r(c,t)}t=n(d)}}function _(e){if(g=!1,v(e),!f)if(null!==n(c))f=!0,M(k);else{var t=n(d);null!==t&&R(_,t.startTime-e)}}function k(e,r){f=!1,g&&(g=!1,b(S),S=-1),m=!0;var s=p;try{for(v(r),h=n(c);null!==h&&(!(h.expirationTime>r)||e&&!E());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var o=i(h.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?h.callback=o:h===n(c)&&a(c),v(r)}else a(c);h=n(c)}if(null!==h)var l=!0;else{var u=n(d);null!==u&&R(_,u.startTime-r),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,w=!1,N=null,S=-1,O=5,C=-1;function E(){return!(t.unstable_now()-C<O)}function P(){if(null!==N){var e=t.unstable_now();C=e;var r=!0;try{r=N(!0,e)}finally{r?j():(w=!1,N=null)}}else w=!1}if("function"===typeof y)j=function(){y(P)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,T=A.port2;A.port1.onmessage=P,j=function(){T.postMessage(null)}}else j=function(){x(P,0)};function M(e){N=e,w||(w=!0,j())}function R(e,r){S=x(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,M(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,r(d,e),null===n(c)&&e===n(d)&&(g?(b(S),S=-1):g=!0,R(_,s-i))):(e.sortIndex=o,r(c,e),f||m||(f=!0,M(k))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},7251:(e,t,r)=>{var n=r(8724),a=r(7160),s=r(5204);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||a),string:new n}}},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,i){if("function"!==typeof n)throw new TypeError("The listener must be a function");var o=new a(n,s||e,i),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function i(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)t.call(e,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,s=n.length,i=new Array(s);a<s;a++)i[a]=n[a].fn;return i},o.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,a,s,i){var o=r?r+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,a),!0;case 5:return d.fn.call(d.context,t,n,a,s),!0;case 6:return d.fn.call(d.context,t,n,a,s,i),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,p=d.length;for(c=0;c<p;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,n);break;case 4:d[c].fn.call(d[c].context,t,n,a);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,n,a){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return i(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||a&&!o.once||n&&o.context!==n||i(this,s);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||a&&!o[l].once||n&&o[l].context!==n)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:i(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&i(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},7303:(e,t,r)=>{var n=r(801),a=1/0;e.exports=function(e){return e?(e=n(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},7424:(e,t,r)=>{var n=r(755),a=r(2536),s=r(5647),i=r(929),o=s(function(e,t){if(null==e)return[];var r=t.length;return r>1&&i(e,t[0],t[1])?t=[]:r>2&&i(t[0],t[1],t[2])&&(t=[t[0]]),a(e,n(t,1),[])});e.exports=o},7498:e=>{e.exports=function(e,t){return e>t}},7529:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}},7563:e=>{e.exports=function(){this.__data__=[],this.size=0}},7574:e=>{e.exports=function(e){return function(t){return e(t)}}},7615:(e,t,r)=>{var n=r(5575);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},7676:(e,t,r)=>{var n=r(8189),a=r(6311),s=r(9115),i=r(1069);e.exports=function(e){return function(t){t=i(t);var r=a(t)?s(t):void 0,o=r?r[0]:t.charAt(0),l=r?n(r,1).join(""):t.slice(1);return o[e]()+l}}},7685:(e,t,r)=>{var n=r(7937)(r(6552),"DataView");e.exports=n},7760:e=>{e.exports=function(e){return this.__data__.get(e)}},7828:e=>{e.exports=function(){return[]}},7857:(e,t,r)=>{var n=r(3440),a=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!a&&a in e}},7894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7937:(e,t,r)=>{var n=r(6954),a=r(4657);e.exports=function(e,t){var r=a(e,t);return n(r)?r:void 0}},7950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(2730)},8114:e=>{e.exports=function(e,t){return e.has(t)}},8182:(e,t,r)=>{var n=r(2070),a=r(5713),s=r(2074),i=n&&1/s(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=i},8189:(e,t,r)=>{var n=r(3871);e.exports=function(e,t,r){var a=e.length;return r=void 0===r?a:r,!t&&r>=a?e:n(e,t,r)}},8210:function(e,t,r){var n;!function(){"use strict";var a,s=1e9,i={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},o=!0,l="[DecimalError] ",c=l+"Invalid argument: ",d=l+"Exponent out of range: ",u=Math.floor,h=Math.pow,p=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,m=1e7,f=9007199254740991,g=u(1286742750677284.5),x={};function b(e,t){var r,n,a,s,i,l,c,d,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),o?C(t,h):t;if(c=e.d,d=t.d,i=e.e,a=t.e,c=c.slice(),s=i-a){for(s<0?(n=c,s=-s,l=d.length):(n=d,a=i,l=c.length),s>(l=(i=Math.ceil(h/7))>l?i+1:l+1)&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for((l=c.length)-(s=d.length)<0&&(s=l,n=d,d=c,c=n),r=0;s;)r=(c[--s]=c[s]+d[s]+r)/m|0,c[s]%=m;for(r&&(c.unshift(r),++a),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=a,o?C(t,h):t}function y(e,t,r){if(e!==~~e||e<t||e>r)throw Error(c+e)}function v(e){var t,r,n,a=e.length-1,s="",i=e[0];if(a>0){for(s+=i,t=1;t<a;t++)(r=7-(n=e[t]+"").length)&&(s+=N(r)),s+=n;(r=7-(n=(i=e[t])+"").length)&&(s+=N(r))}else if(0===i)return"0";for(;i%10===0;)i/=10;return s+i}x.absoluteValue=x.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},x.comparedTo=x.cmp=function(e){var t,r,n,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(t=0,r=(n=s.d.length)<(a=e.d.length)?n:a;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1},x.decimalPlaces=x.dp=function(){var e=this,t=e.d.length-1,r=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)r--;return r<0?0:r},x.dividedBy=x.div=function(e){return _(this,new this.constructor(e))},x.dividedToIntegerBy=x.idiv=function(e){var t=this.constructor;return C(_(this,new t(e),0,1),t.precision)},x.equals=x.eq=function(e){return!this.cmp(e)},x.exponent=function(){return j(this)},x.greaterThan=x.gt=function(e){return this.cmp(e)>0},x.greaterThanOrEqualTo=x.gte=function(e){return this.cmp(e)>=0},x.isInteger=x.isint=function(){return this.e>this.d.length-2},x.isNegative=x.isneg=function(){return this.s<0},x.isPositive=x.ispos=function(){return this.s>0},x.isZero=function(){return 0===this.s},x.lessThan=x.lt=function(e){return this.cmp(e)<0},x.lessThanOrEqualTo=x.lte=function(e){return this.cmp(e)<1},x.logarithm=x.log=function(e){var t,r=this,n=r.constructor,s=n.precision,i=s+5;if(void 0===e)e=new n(10);else if((e=new n(e)).s<1||e.eq(a))throw Error(l+"NaN");if(r.s<1)throw Error(l+(r.s?"NaN":"-Infinity"));return r.eq(a)?new n(0):(o=!1,t=_(S(r,i),S(e,i),i),o=!0,C(t,s))},x.minus=x.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?E(t,e):b(t,(e.s=-e.s,e))},x.modulo=x.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(!(e=new n(e)).s)throw Error(l+"NaN");return r.s?(o=!1,t=_(r,e,0,1).times(e),o=!0,r.minus(t)):C(new n(r),a)},x.naturalExponential=x.exp=function(){return k(this)},x.naturalLogarithm=x.ln=function(){return S(this)},x.negated=x.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},x.plus=x.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?b(t,e):E(t,(e.s=-e.s,e))},x.precision=x.sd=function(e){var t,r,n,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(c+e);if(t=j(a)+1,r=7*(n=a.d.length-1)+1,n=a.d[n]){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r},x.squareRoot=x.sqrt=function(){var e,t,r,n,a,s,i,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(l+"NaN")}for(e=j(c),o=!1,0==(a=Math.sqrt(+c))||a==1/0?(((t=v(c.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=u((e+1)/2)-(e<0||e%2),n=new d(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):n=new d(a.toString()),a=i=(r=d.precision)+3;;)if(n=(s=n).plus(_(c,s,i+2)).times(.5),v(s.d).slice(0,i)===(t=v(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&"4999"==t){if(C(s,r+1,0),s.times(s).eq(c)){n=s;break}}else if("9999"!=t)break;i+=4}return o=!0,C(n,r)},x.times=x.mul=function(e){var t,r,n,a,s,i,l,c,d,u=this,h=u.constructor,p=u.d,f=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,(c=p.length)<(d=f.length)&&(s=p,p=f,f=s,i=c,c=d,d=i),s=[],n=i=c+d;n--;)s.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=s[a]+f[n]*p[a-n-1]+t,s[a--]=l%m|0,t=l/m|0;s[a]=(s[a]+t)%m|0}for(;!s[--i];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,o?C(e,h.precision):e},x.toDecimalPlaces=x.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),void 0===e?r:(y(e,0,s),void 0===t?t=n.rounding:y(t,0,8),C(r,e+j(r)+1,t))},x.toExponential=function(e,t){var r,n=this,a=n.constructor;return void 0===e?r=P(n,!0):(y(e,0,s),void 0===t?t=a.rounding:y(t,0,8),r=P(n=C(new a(n),e+1,t),!0,e+1)),r},x.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return void 0===e?P(a):(y(e,0,s),void 0===t?t=i.rounding:y(t,0,8),r=P((n=C(new i(a),e+j(a)+1,t)).abs(),!1,e+j(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)},x.toInteger=x.toint=function(){var e=this,t=e.constructor;return C(new t(e),j(e)+1,t.rounding)},x.toNumber=function(){return+this},x.toPower=x.pow=function(e){var t,r,n,s,i,c,d=this,h=d.constructor,p=+(e=new h(e));if(!e.s)return new h(a);if(!(d=new h(d)).s){if(e.s<1)throw Error(l+"Infinity");return d}if(d.eq(a))return d;if(n=h.precision,e.eq(a))return C(d,n);if(c=(t=e.e)>=(r=e.d.length-1),i=d.s,c){if((r=p<0?-p:p)<=f){for(s=new h(a),t=Math.ceil(n/7+4),o=!1;r%2&&A((s=s.times(d)).d,t),0!==(r=u(r/2));)A((d=d.times(d)).d,t);return o=!0,e.s<0?new h(a).div(s):C(s,n)}}else if(i<0)throw Error(l+"NaN");return i=i<0&&1&e.d[Math.max(t,r)]?-1:1,d.s=1,o=!1,s=e.times(S(d,n+12)),o=!0,(s=k(s)).s=i,s},x.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return void 0===e?n=P(a,(r=j(a))<=i.toExpNeg||r>=i.toExpPos):(y(e,1,s),void 0===t?t=i.rounding:y(t,0,8),n=P(a=C(new i(a),e,t),e<=(r=j(a))||r<=i.toExpNeg,e)),n},x.toSignificantDigits=x.tosd=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(y(e,1,s),void 0===t?t=r.rounding:y(t,0,8)),C(new r(this),e,t)},x.toString=x.valueOf=x.val=x.toJSON=function(){var e=this,t=j(e),r=e.constructor;return P(e,t<=r.toExpNeg||t>=r.toExpPos)};var _=function(){function e(e,t){var r,n=0,a=e.length;for(e=e.slice();a--;)r=e[a]*t+n,e[a]=r%m|0,n=r/m|0;return n&&e.unshift(n),e}function t(e,t,r,n){var a,s;if(r!=n)s=r>n?1:-1;else for(a=s=0;a<r;a++)if(e[a]!=t[a]){s=e[a]>t[a]?1:-1;break}return s}function r(e,t,r){for(var n=0;r--;)e[r]-=n,n=e[r]<t[r]?1:0,e[r]=n*m+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(n,a,s,i){var o,c,d,u,h,p,f,g,x,b,y,v,_,k,w,N,S,O,E=n.constructor,P=n.s==a.s?1:-1,A=n.d,T=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(l+"Division by zero");for(c=n.e-a.e,S=T.length,w=A.length,g=(f=new E(P)).d=[],d=0;T[d]==(A[d]||0);)++d;if(T[d]>(A[d]||0)&&--c,(v=null==s?s=E.precision:i?s+(j(n)-j(a))+1:s)<0)return new E(0);if(v=v/7+2|0,d=0,1==S)for(u=0,T=T[0],v++;(d<w||u)&&v--;d++)_=u*m+(A[d]||0),g[d]=_/T|0,u=_%T|0;else{for((u=m/(T[0]+1)|0)>1&&(T=e(T,u),A=e(A,u),S=T.length,w=A.length),k=S,b=(x=A.slice(0,S)).length;b<S;)x[b++]=0;(O=T.slice()).unshift(0),N=T[0],T[1]>=m/2&&++N;do{u=0,(o=t(T,x,S,b))<0?(y=x[0],S!=b&&(y=y*m+(x[1]||0)),(u=y/N|0)>1?(u>=m&&(u=m-1),1==(o=t(h=e(T,u),x,p=h.length,b=x.length))&&(u--,r(h,S<p?O:T,p))):(0==u&&(o=u=1),h=T.slice()),(p=h.length)<b&&h.unshift(0),r(x,h,b),-1==o&&(o=t(T,x,S,b=x.length))<1&&(u++,r(x,S<b?O:T,b)),b=x.length):0===o&&(u++,x=[0]),g[d++]=u,o&&x[0]?x[b++]=A[k]||0:(x=[A[k]],b=1)}while((k++<w||void 0!==x[0])&&v--)}return g[0]||g.shift(),f.e=c,C(f,i?s+j(f)+1:s)}}();function k(e,t){var r,n,s,i,l,c=0,u=0,p=e.constructor,m=p.precision;if(j(e)>16)throw Error(d+j(e));if(!e.s)return new p(a);for(null==t?(o=!1,l=m):l=t,i=new p(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(l+=Math.log(h(2,u))/Math.LN10*2+5|0,r=n=s=new p(a),p.precision=l;;){if(n=C(n.times(e),l),r=r.times(++c),v((i=s.plus(_(n,r,l))).d).slice(0,l)===v(s.d).slice(0,l)){for(;u--;)s=C(s.times(s),l);return p.precision=m,null==t?(o=!0,C(s,m)):s}s=i}}function j(e){for(var t=7*e.e,r=e.d[0];r>=10;r/=10)t++;return t}function w(e,t,r){if(t>e.LN10.sd())throw o=!0,r&&(e.precision=r),Error(l+"LN10 precision limit exceeded");return C(new e(e.LN10),t)}function N(e){for(var t="";e--;)t+="0";return t}function S(e,t){var r,n,s,i,c,d,u,h,p,m=1,f=e,g=f.d,x=f.constructor,b=x.precision;if(f.s<1)throw Error(l+(f.s?"NaN":"-Infinity"));if(f.eq(a))return new x(0);if(null==t?(o=!1,h=b):h=t,f.eq(10))return null==t&&(o=!0),w(x,h);if(h+=10,x.precision=h,n=(r=v(g)).charAt(0),i=j(f),!(Math.abs(i)<15e14))return u=w(x,h+2,b).times(i+""),f=S(new x(n+"."+r.slice(1)),h-10).plus(u),x.precision=b,null==t?(o=!0,C(f,b)):f;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=v((f=f.times(e)).d)).charAt(0),m++;for(i=j(f),n>1?(f=new x("0."+r),i++):f=new x(n+"."+r.slice(1)),d=c=f=_(f.minus(a),f.plus(a),h),p=C(f.times(f),h),s=3;;){if(c=C(c.times(p),h),v((u=d.plus(_(c,new x(s),h))).d).slice(0,h)===v(d.d).slice(0,h))return d=d.times(2),0!==i&&(d=d.plus(w(x,h+2,b).times(i+""))),d=_(d,new x(m),h),x.precision=b,null==t?(o=!0,C(d,b)):d;d=u,s+=2}}function O(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;48===t.charCodeAt(n);)++n;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(n,a)){if(a-=n,r=r-n-1,e.e=u(r/7),e.d=[],n=(r+1)%7,r<0&&(n+=7),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=7;n<a;)e.d.push(+t.slice(n,n+=7));n=7-(t=t.slice(n)).length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),o&&(e.e>g||e.e<-g))throw Error(d+r)}else e.s=0,e.e=0,e.d=[0];return e}function C(e,t,r){var n,a,s,i,l,c,p,f,x=e.d;for(i=1,s=x[0];s>=10;s/=10)i++;if((n=t-i)<0)n+=7,a=t,p=x[f=0];else{if((f=Math.ceil((n+1)/7))>=(s=x.length))return e;for(p=s=x[f],i=1;s>=10;s/=10)i++;a=(n%=7)-7+i}if(void 0!==r&&(l=p/(s=h(10,i-a-1))%10|0,c=t<0||void 0!==x[f+1]||p%s,c=r<4?(l||c)&&(0==r||r==(e.s<0?3:2)):l>5||5==l&&(4==r||c||6==r&&(n>0?a>0?p/h(10,i-a):0:x[f-1])%10&1||r==(e.s<0?8:7))),t<1||!x[0])return c?(s=j(e),x.length=1,t=t-s-1,x[0]=h(10,(7-t%7)%7),e.e=u(-t/7)||0):(x.length=1,x[0]=e.e=e.s=0),e;if(0==n?(x.length=f,s=1,f--):(x.length=f+1,s=h(10,7-n),x[f]=a>0?(p/h(10,i-a)%h(10,a)|0)*s:0),c)for(;;){if(0==f){(x[0]+=s)==m&&(x[0]=1,++e.e);break}if(x[f]+=s,x[f]!=m)break;x[f--]=0,s=1}for(n=x.length;0===x[--n];)x.pop();if(o&&(e.e>g||e.e<-g))throw Error(d+j(e));return e}function E(e,t){var r,n,a,s,i,l,c,d,u,h,p=e.constructor,f=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),o?C(t,f):t;if(c=e.d,h=t.d,n=t.e,d=e.e,c=c.slice(),i=d-n){for((u=i<0)?(r=c,i=-i,l=h.length):(r=h,n=d,l=c.length),i>(a=Math.max(Math.ceil(f/7),l)+2)&&(i=a,r.length=1),r.reverse(),a=i;a--;)r.push(0);r.reverse()}else{for((u=(a=c.length)<(l=h.length))&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){u=c[a]<h[a];break}i=0}for(u&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>i;){if(c[--a]<h[a]){for(s=a;s&&0===c[--s];)c[s]=m-1;--c[s],c[a]+=m}c[a]-=h[a]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(t.d=c,t.e=n,o?C(t,f):t):new p(0)}function P(e,t,r){var n,a=j(e),s=v(e.d),i=s.length;return t?(r&&(n=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+N(n):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+N(-a-1)+s,r&&(n=r-i)>0&&(s+=N(n))):a>=i?(s+=N(a+1-i),r&&(n=r-a-1)>0&&(s=s+"."+N(n))):((n=a+1)<i&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-i)>0&&(a+1===i&&(s+="."),s+=N(n))),e.s<0?"-"+s:s}function A(e,t){if(e.length>t)return e.length=t,!0}function T(e){if(!e||"object"!==typeof e)throw Error(l+"Object expected");var t,r,n,a=["precision",1,s,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(n=e[r=a[t]])){if(!(u(n)===n&&n>=a[t+1]&&n<=a[t+2]))throw Error(c+r+": "+n);this[r]=n}if(void 0!==(n=e[r="LN10"])){if(n!=Math.LN10)throw Error(c+r+": "+n);this[r]=new this(n)}return this}i=function e(t){var r,n,a;function s(e){var t=this;if(!(t instanceof s))return new s(e);if(t.constructor=s,e instanceof s)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(c+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):O(t,e.toString())}if("string"!==typeof e)throw Error(c+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!p.test(e))throw Error(c+e);O(t,e)}if(s.prototype=x,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=e,s.config=s.set=T,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<a.length;)t.hasOwnProperty(n=a[r++])||(t[n]=this[n]);return s.config(t),s}(i),i.default=i.Decimal=i,a=new i(1),void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)}()},8259:(e,t,r)=>{var n=r(5797);e.exports=function(e){var t=n(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}},8325:(e,t,r)=>{var n=r(2541),a=r(5654),s=r(3279),i=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:s;e.exports=i},8468:(e,t,r)=>{var n=r(5816),a=r(644),s=r(4020);e.exports=function(e,t,r){return t===t?s(e,t,r):n(e,a,r)}},8541:(e,t,r)=>{var n=r(9812),a=r(149),s=r(4052),i=r(9841),o=n?n.prototype:void 0,l=o?o.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(s(t))return a(t,e)+"";if(i(t))return l?l.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},8673:(e,t,r)=>{var n=r(3204),a=r(3713),s=r(6571);e.exports=function(e){return s(e)?n(e):a(e)}},8724:(e,t,r)=>{var n=r(7615),a=r(5051),s=r(2154),i=r(8734),o=r(2662);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},8734:(e,t,r)=>{var n=r(5575),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:a.call(t,e)}},8853:(e,t,r)=>{"use strict";e.exports=r(7234)},8883:(e,t,r)=>{var n=r(5652),a=r(6571);e.exports=function(e,t){var r=-1,s=a(e)?Array(e.length):[];return n(e,function(e,n,a){s[++r]=t(e,n,a)}),s}},8895:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}},8902:(e,t,r)=>{var n=r(4816),a=r(6179),s=r(6704);function i(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}i.prototype.add=i.prototype.push=a,i.prototype.has=s,e.exports=i},8990:(e,t,r)=>{var n=r(9995)(r(2520));e.exports=n},9057:(e,t,r)=>{var n=r(5324),a=r(2777),s=r(4052),i=r(9194),o=r(6173),l=r(914);e.exports=function(e,t,r){for(var c=-1,d=(t=n(t,e)).length,u=!1;++c<d;){var h=l(t[c]);if(!(u=null!=e&&r(e,h)))break;e=e[h]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&o(d)&&i(h,d)&&(s(e)||a(e))}},9062:(e,t,r)=>{"use strict";e.exports=r(6378)},9096:(e,t,r)=>{var n=r(9256),a=r(5029),s=r(3279),i=r(4052),o=r(3932);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?i(e)?a(e[0],e[1]):n(e):o(e)}},9115:(e,t,r)=>{var n=r(5967),a=r(6311),s=r(715);e.exports=function(e){return a(e)?s(e):n(e)}},9140:(e,t,r)=>{var n=r(7303);e.exports=function(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}},9160:(e,t,r)=>{var n=r(6913),a=r(2761);e.exports=function(e){return"number"==typeof e||a(e)&&"[object Number]"==n(e)}},9194:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},9256:(e,t,r)=>{var n=r(6532),a=r(3781),s=r(1310);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},9394:(e,t,r)=>{var n=r(2622);e.exports=function(e){return n(this,e).has(e)}},9395:(e,t,r)=>{var n=r(4262),a=r(9621),s=r(8673);e.exports=function(e){return n(e,s,a)}},9417:(e,t,r)=>{var n=r(6686);e.exports=function(e){return e===e&&!n(e)}},9621:(e,t,r)=>{var n=r(7529),a=r(7828),s=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,o=i?function(e){return null==e?[]:(e=Object(e),n(i(e),function(t){return s.call(e,t)}))}:a;e.exports=o},9676:e=>{var t=Math.ceil,r=Math.max;e.exports=function(e,n,a,s){for(var i=-1,o=r(t((n-e)/(a||1)),0),l=Array(o);o--;)l[s?o:++i]=e,e+=a;return l}},9686:e=>{e.exports=function(e){return null==e}},9742:(e,t,r)=>{var n=r(9841);e.exports=function(e,t,r){for(var a=-1,s=e.length;++a<s;){var i=e[a],o=t(i);if(null!=o&&(void 0===l?o===o&&!n(o):r(o,l)))var l=o,c=i}return c}},9812:(e,t,r)=>{var n=r(6552).Symbol;e.exports=n},9841:(e,t,r)=>{var n=r(6913),a=r(2761);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},9853:(e,t,r)=>{var n=r(6989);e.exports=function(e,t){return n(e,t)}},9889:(e,t,r)=>{var n=r(3950),a=r(6686);e.exports=function(e,t,r){var s=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(r)&&(s="leading"in r?!!r.leading:s,i="trailing"in r?!!r.trailing:i),n(e,t,{leading:s,maxWait:t,trailing:i})}},9935:(e,t,r)=>{var n=r(1340),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),--this.size,!0)}},9987:(e,t,r)=>{var n=r(9812),a=r(2929),s=r(3211),i=r(3668),o=r(4160),l=r(2074),c=n?n.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,r,n,c,u,h){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new a(e),new a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return s(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=o;case"[object Set]":var m=1&n;if(p||(p=l),e.size!=t.size&&!m)return!1;var f=h.get(e);if(f)return f==t;n|=2,h.set(e,t);var g=i(p(e),p(t),n,c,u,h);return h.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},9995:(e,t,r)=>{var n=r(9096),a=r(6571),s=r(8673);e.exports=function(e){return function(t,r,i){var o=Object(t);if(!a(t)){var l=n(r,3);t=s(t),r=function(e){return l(o[e],e,o)}}var c=e(t,r,i);return c>-1?o[l?t[c]:c]:void 0}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var s=Object.create(null);r.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,r.d(s,i),s}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,n)=>(r.f[n](e,t),t),[])),r.u=e=>"static/js/"+e+".d2a7903d.chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="ads-dashboard-client:";r.l=(n,a,s,i)=>{if(e[n])e[n].push(a);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",t+s),o.src=n),e[n]=[a];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(p);var a=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(r)),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="/",(()=>{var e={792:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var s=new Promise((r,n)=>a=e[t]=[r,n]);n.push(a[2]=s);var i=r.p+r.u(t),o=new Error;r.l(i,n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,s,i=n[0],o=n[1],l=n[2],c=0;if(i.some(t=>0!==e[t])){for(a in o)r.o(o,a)&&(r.m[a]=o[a]);if(l)l(r)}for(t&&t(n);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunkads_dashboard_client=self.webpackChunkads_dashboard_client||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e={};r.r(e),r.d(e,{hasBrowserEnv:()=>Kr,hasStandardBrowserEnv:()=>Xr,hasStandardBrowserWebWorkerEnv:()=>Jr,navigator:()=>Yr,origin:()=>Qr});var t={};r.r(t),r.d(t,{scaleBand:()=>wu,scaleDiverging:()=>rx,scaleDivergingLog:()=>nx,scaleDivergingPow:()=>sx,scaleDivergingSqrt:()=>ix,scaleDivergingSymlog:()=>ax,scaleIdentity:()=>Yp,scaleImplicit:()=>ku,scaleLinear:()=>Kp,scaleLog:()=>am,scaleOrdinal:()=>ju,scalePoint:()=>Su,scalePow:()=>pm,scaleQuantile:()=>Nm,scaleQuantize:()=>Sm,scaleRadial:()=>gm,scaleSequential:()=>Yg,scaleSequentialLog:()=>Xg,scaleSequentialPow:()=>Qg,scaleSequentialQuantile:()=>ex,scaleSequentialSqrt:()=>Zg,scaleSequentialSymlog:()=>Jg,scaleSqrt:()=>mm,scaleSymlog:()=>lm,scaleThreshold:()=>Om,scaleTime:()=>qg,scaleUtc:()=>Gg,tickFormat:()=>Gp});var n={};r.r(n),r.d(n,{Decoder:()=>IB,Encoder:()=>RB,PacketType:()=>MB,protocol:()=>TB});var a,s=r(5043),i=r.t(s,2),o=r(4391),l=r(7950),c=r.t(l,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,r,n){return void 0===r&&(r=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function b(e,t,r,n){void 0===n&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l=a.Pop,c=null,p=x();function x(){return(o.state||{idx:null}).idx}function b(){l=a.Pop;let e=x(),t=null==e?null:e-p;p=e,c&&c({action:l,location:v.location,delta:t})}function y(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"===typeof e?e:g(e);return r=r.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==p&&(p=0,o.replaceState(d({},o.state,{idx:p}),""));let v={get action(){return l},get location(){return e(s,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(u,b),c=e,()=>{s.removeEventListener(u,b),c=null}},createHref:e=>t(s,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=a.Push;let n=f(v.location,e,t);r&&r(n,e),p=x()+1;let d=m(n,p),u=v.createHref(n);try{o.pushState(d,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;s.location.assign(u)}i&&c&&c({action:l,location:v.location,delta:1})},replace:function(e,t){l=a.Replace;let n=f(v.location,e,t);r&&r(n,e),p=x();let s=m(n,p),d=v.createHref(n);o.replaceState(s,"",d),i&&c&&c({action:l,location:v.location,delta:0})},go:e=>o.go(e)};return v}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,r){return void 0===r&&(r="/"),_(e,t,r,!1)}function _(e,t,r,n){let a=D(("string"===typeof t?x(t):t).pathname||"/",r);if(null==a)return null;let s=k(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=R(a);i=T(s[o],e,n)}return i}function k(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(h(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let o=U([n,i.relativePath]),l=r.concat(i);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),k(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:A(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of j(e.path))a(e,t,n);else a(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===n.length)return a?[s,""]:[s];let i=j(n.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const w=/^:[\w-]+$/,N=3,S=2,O=1,C=10,E=-2,P=e=>"*"===e;function A(e,t){let r=e.split("/"),n=r.length;return r.some(P)&&(n+=E),t&&(n+=S),r.filter(e=>!P(e)).reduce((e,t)=>e+(w.test(t)?N:""===t?O:C),n)}function T(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===s?t:t.slice(s.length)||"/",d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&r&&!n[n.length-1].route.index&&(d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:U([s,d.pathname]),pathnameBase:z(U([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=U([s,d.pathnameBase]))}return i}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let s=new RegExp(a,t?void 0:"i");return[s,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1),l=n.reduce((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=o[r]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[n]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:i,pattern:e}}function R(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return p(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function I(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function F(e,t){let r=L(e);return t?r.map((e,t)=>t===r.length-1?e.pathname:e.pathnameBase):r.map(e=>e.pathnameBase)}function B(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=x(e):(a=d({},e),h(!a.pathname||!a.pathname.includes("?"),I("?","pathname","search",a)),h(!a.pathname||!a.pathname.includes("#"),I("#","pathname","hash",a)),h(!a.search||!a.search.includes("#"),I("#","search","hash",a)));let s,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)s=r;else{let e=t.length-1;if(!n&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?x(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:V(n),hash:H(a)}}(a,s),c=o&&"/"!==o&&o.endsWith("/"),u=(i||"."===o)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const q=["post","put","patch","delete"],G=(new Set(q),["get",...q]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function $(){return $=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$.apply(this,arguments)}const K=s.createContext(null);const Y=s.createContext(null);const X=s.createContext(null);const J=s.createContext(null);const Q=s.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=s.createContext(null);function ee(){return null!=s.useContext(J)}function te(){return ee()||h(!1),s.useContext(J).location}function re(e){s.useContext(X).static||s.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=s.useContext(Q);return e?function(){let{router:e}=pe(ue.UseNavigateStable),t=fe(he.UseNavigateStable),r=s.useRef(!1);re(()=>{r.current=!0});let n=s.useCallback(function(n,a){void 0===a&&(a={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,$({fromRouteId:t},a)))},[e,t]);return n}():function(){ee()||h(!1);let e=s.useContext(K),{basename:t,future:r,navigator:n}=s.useContext(X),{matches:a}=s.useContext(Q),{pathname:i}=te(),o=JSON.stringify(F(a,r.v7_relativeSplatPath)),l=s.useRef(!1);re(()=>{l.current=!0});let c=s.useCallback(function(r,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof r)return void n.go(r);let s=B(r,JSON.parse(o),i,"path"===a.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:U([t,s.pathname])),(a.replace?n.replace:n.push)(s,a.state,a)},[t,n,o,i,e]);return c}()}function ae(e,t){let{relative:r}=void 0===t?{}:t,{future:n}=s.useContext(X),{matches:a}=s.useContext(Q),{pathname:i}=te(),o=JSON.stringify(F(a,n.v7_relativeSplatPath));return s.useMemo(()=>B(e,JSON.parse(o),i,"path"===r),[e,o,i,r])}function se(e,t,r,n){ee()||h(!1);let{navigator:i}=s.useContext(X),{matches:o}=s.useContext(Q),l=o[o.length-1],c=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let u,p=te();if(t){var m;let e="string"===typeof t?x(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||h(!1),u=e}else u=p;let f=u.pathname||"/",g=f;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=v(e,{pathname:g});let y=de(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:U([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,r,n);return t&&y?s.createElement(J.Provider,{value:{location:$({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:a.Pop}},y):y}function ie(){let e=function(){var e;let t=s.useContext(Z),r=me(he.UseRouteError),n=fe(he.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),r?s.createElement("pre",{style:a},r):null,null)}const oe=s.createElement(ie,null);class le extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Q.Provider,{value:this.props.routeContext},s.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:r,children:n}=e,a=s.useContext(K);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),s.createElement(Q.Provider,{value:t},n)}function de(e,t,r,n){var a;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var i;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(i=n)&&i.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let o=e,l=null==(a=r)?void 0:a.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||h(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let s=0;s<o.length;s++){let e=o[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=s),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight((e,n,a)=>{let i,u=!1,h=null,p=null;var m;r&&(i=l&&n.route.id?l[n.route.id]:void 0,h=n.route.errorElement||oe,c&&(d<0&&0===a?(m="route-fallback",!1||ge[m]||(ge[m]=!0),u=!0,p=null):d===a&&(u=!0,p=n.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,a+1)),g=()=>{let t;return t=i?h:u?p:n.route.Component?s.createElement(n.route.Component,null):n.route.element?n.route.element:e,s.createElement(ce,{match:n,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===a)?s.createElement(le,{location:r.location,revalidation:r.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()},null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function pe(e){let t=s.useContext(K);return t||h(!1),t}function me(e){let t=s.useContext(Y);return t||h(!1),t}function fe(e){let t=function(){let e=s.useContext(Q);return e||h(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||h(!1),r.route.id}const ge={};function xe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function be(e){h(!1)}function ye(e){let{basename:t="/",children:r=null,location:n,navigationType:i=a.Pop,navigator:o,static:l=!1,future:c}=e;ee()&&h(!1);let d=t.replace(/^\/*/,"/"),u=s.useMemo(()=>({basename:d,navigator:o,static:l,future:$({v7_relativeSplatPath:!1},c)}),[d,c,o,l]);"string"===typeof n&&(n=x(n));let{pathname:p="/",search:m="",hash:f="",state:g=null,key:b="default"}=n,y=s.useMemo(()=>{let e=D(p,d);return null==e?null:{location:{pathname:e,search:m,hash:f,state:g,key:b},navigationType:i}},[d,p,m,f,g,b,i]);return null==y?null:s.createElement(X.Provider,{value:u},s.createElement(J.Provider,{children:r,value:y}))}function ve(e){let{children:t,location:r}=e;return se(_e(t),r)}new Promise(()=>{});s.Component;function _e(e,t){void 0===t&&(t=[]);let r=[];return s.Children.forEach(e,(e,n)=>{if(!s.isValidElement(e))return;let a=[...t,n];if(e.type===s.Fragment)return void r.push.apply(r,_e(e.props.children,a));e.type!==be&&h(!1),e.props.index&&e.props.children&&h(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=_e(e.props.children,a)),r.push(i)}),r}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ke.apply(this,arguments)}function je(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const we=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(dU){}new Map;const Ne=i.startTransition;c.flushSync,i.useId;function Se(e){let{basename:t,children:r,future:n,window:a}=e,i=s.useRef();null==i.current&&(i.current=function(e){return void 0===e&&(e={}),b(function(e,t){let{pathname:r,search:n,hash:a}=e.location;return f("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,e)}({window:a,v5Compat:!0}));let o=i.current,[l,c]=s.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},u=s.useCallback(e=>{d&&Ne?Ne(()=>c(e)):c(e)},[c,d]);return s.useLayoutEffect(()=>o.listen(u),[o,u]),s.useEffect(()=>xe(n),[n]),s.createElement(ye,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const Oe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ee=s.forwardRef(function(e,t){let r,{onClick:n,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:p}=e,m=je(e,we),{basename:f}=s.useContext(X),x=!1;if("string"===typeof d&&Ce.test(d)&&(r=d,Oe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),r=D(t.pathname,f);t.origin===e.origin&&null!=r?d=r+t.search+t.hash:x=!0}catch(dU){}let b=function(e,t){let{relative:r}=void 0===t?{}:t;ee()||h(!1);let{basename:n,navigator:a}=s.useContext(X),{hash:i,pathname:o,search:l}=ae(e,{relative:r}),c=o;return"/"!==n&&(c="/"===o?n:U([n,o])),a.createHref({pathname:c,search:l,hash:i})}(d,{relative:a}),y=function(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:l}=void 0===t?{}:t,c=ne(),d=te(),u=ae(e,{relative:o});return s.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let r=void 0!==n?n:g(d)===g(u);c(e,{replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,n,a,r,e,i,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:p});return s.createElement("a",ke({},m,{href:r||b,onClick:x||i?n:function(e){n&&n(e),e.defaultPrevented||y(e)},ref:t,target:c}))});var Pe,Ae;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ae||(Ae={}));function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function Me(e){var t=function(e,t){if("object"!=Te(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Te(t)?t:t+""}function Re(e,t,r){return(t=Me(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(t){Re(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Le(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Fe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Be=["color","size","strokeWidth","absoluteStrokeWidth","children"],Ue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ze=(e,t)=>{const r=(0,s.forwardRef)((r,n)=>{let{color:a="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:c}=r,d=Le(r,Be);return(0,s.createElement)("svg",Ie(Ie({ref:n},Fe),{},{width:i,height:i,stroke:a,strokeWidth:l?24*Number(o)/Number(i):o,className:"lucide lucide-".concat(Ue(e))},d),[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...(Array.isArray(c)?c:[c])||[]])});return r.displayName="".concat(e),r},Ve=ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),He=ze("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),We=ze("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),qe=ze("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ge=ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$e=ze("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ke=ze("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Ye=ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Xe=ze("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Je=ze("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Qe=ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ze=ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),et=ze("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),tt=ze("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),rt=ze("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),nt=ze("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),at=ze("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]),st=ze("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]),it=[{key:"name",label:"Name",defaultVisible:!0,alwaysVisible:!0},{key:"meta_trials_started",label:"Trials (Meta)",defaultVisible:!0},{key:"mixpanel_trials_started",label:"Trials (Mixpanel)",defaultVisible:!0},{key:"trial_accuracy_ratio",label:"Trial Accuracy Ratio",defaultVisible:!0},{key:"trial_conversion_rate",label:"Trial Conversion Rate",defaultVisible:!0},{key:"avg_trial_refund_rate",label:"Trial Refund Rate",defaultVisible:!0},{key:"meta_purchases",label:"Purchases (Meta)",defaultVisible:!0},{key:"mixpanel_purchases",label:"Purchases (Mixpanel)",defaultVisible:!0},{key:"purchase_accuracy_ratio",label:"Purchase Accuracy Ratio",defaultVisible:!0},{key:"purchase_refund_rate",label:"Purchase Refund Rate",defaultVisible:!0},{key:"spend",label:"Spend",defaultVisible:!0},{key:"estimated_revenue_adjusted",label:"Estimated Revenue (Adjusted)",defaultVisible:!0},{key:"profit",label:"Profit",defaultVisible:!0},{key:"estimated_roas",label:"ROAS",defaultVisible:!0},{key:"performance_impact_score",label:"Performance Impact Score",defaultVisible:!0},{key:"campaign_name",label:"Campaign",defaultVisible:!1},{key:"adset_name",label:"Ad Set",defaultVisible:!1},{key:"impressions",label:"Impressions",defaultVisible:!1},{key:"clicks",label:"Clicks",defaultVisible:!1},{key:"mixpanel_trials_ended",label:"Trials Ended (Mixpanel)",defaultVisible:!1},{key:"mixpanel_trials_in_progress",label:"Trials In Progress (Mixpanel)",defaultVisible:!1},{key:"mixpanel_refunds_usd",label:"Actual Refunds (Events)",defaultVisible:!1},{key:"mixpanel_revenue_usd",label:"Actual Revenue (Events)",defaultVisible:!1},{key:"mixpanel_conversions_net_refunds",label:"Net Conversions (Mixpanel)",defaultVisible:!1},{key:"mixpanel_cost_per_trial",label:"Cost per Trial (Mixpanel)",defaultVisible:!1},{key:"mixpanel_cost_per_purchase",label:"Cost per Purchase (Mixpanel)",defaultVisible:!1},{key:"meta_cost_per_trial",label:"Cost per Trial (Meta)",defaultVisible:!1},{key:"meta_cost_per_purchase",label:"Cost per Purchase (Meta)",defaultVisible:!1},{key:"click_to_trial_rate",label:"Click to Trial Rate",defaultVisible:!1},{key:"estimated_revenue_usd",label:"Estimated Revenue (Base)",defaultVisible:!1},{key:"mixpanel_revenue_net",label:"Net Actual Revenue",defaultVisible:!1},{key:"segment_accuracy_average",label:"Avg. Accuracy",defaultVisible:!1}],ot=()=>it.map(e=>e.key),lt=e=>{const t=ot(),r=t.filter(t=>!e.includes(t)),n=e.filter(e=>!t.includes(e));return{isValid:0===r.length&&0===n.length,missing:r,extra:n,expected:t.length,actual:e.length}},ct={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5001";const dt=new class{constructor(){this.baseUrl="".concat(ct,"/api/dashboard")}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="".concat(this.baseUrl).concat(e);console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - makeRequest called:",r,t);const n=Ie({headers:Ie({"Content-Type":"application/json"},t.headers)},t);try{console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - Fetching:",r,n);const e=await fetch(r,n),t=await e.json();if(console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - Response:",t),!e.ok)throw new Error(t.error||"HTTP error! status: ".concat(e.status));return t}catch(a){throw console.error("API request failed for ".concat(e,":"),a),a}}async getConfigurations(){return this.makeRequest("/configurations")}async getDashboardData(e){return this.makeRequest("/data",{method:"POST",body:JSON.stringify(e)})}async triggerCollection(e){try{const t=await fetch("".concat(ct,"/api/dashboard/collection/trigger"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.error||"Failed to trigger collection");return r}catch(t){throw console.error("Error triggering collection:",t),t}}async getCollectionStatus(e){try{const t=await fetch("".concat(ct,"/api/dashboard/collection/status/").concat(e)),r=await t.json();if(!t.ok)throw new Error(r.error||"Failed to fetch collection status");return r}catch(t){throw console.error("Error fetching collection status:",t),t}}async getCoverageSummary(e){try{const t=await fetch("".concat(ct,"/api/dashboard/coverage/").concat(e)),r=await t.json();if(!t.ok)throw new Error(r.error||"Failed to fetch coverage summary");return r}catch(t){throw console.error("Error fetching coverage summary:",t),t}}async healthCheck(){return this.makeRequest("/health")}async getChartData(e){return this.makeRequest("/chart-data",{method:"POST",body:JSON.stringify(e)})}async getAnalyticsData(e){console.log("\ud83d\udd0d ANALYTICS API - getAnalyticsData called with params:",e);const t=await this.makeRequest("/analytics/data",{method:"POST",body:JSON.stringify(e)});if(t&&t.data&&t.data.length>0){const e=t.data[0];console.log("\ud83d\udd0d ANALYTICS API - CRITICAL FIELD CHECK:",{total_records:t.data.length,first_record_keys:Object.keys(e),has_estimated_revenue_adjusted:"estimated_revenue_adjusted"in e,estimated_revenue_adjusted_value:e.estimated_revenue_adjusted,estimated_revenue_usd_value:e.estimated_revenue_usd,spend_value:e.spend,campaign_name:e.campaign_name})}else console.log("\ud83d\udd0d ANALYTICS API - No data returned or empty result:",t);return t}async getAnalyticsChartData(e){console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - getAnalyticsChartData called with:",e);const t=new URLSearchParams(e).toString();return console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - Query params:",t),console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25 DASHBOARD API - Full URL:","/analytics/chart-data?".concat(t)),this.makeRequest("/analytics/chart-data?".concat(t))}async runPipeline(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let r,n;t&&t.start_date&&t.end_date?(r=t.start_date,n=t.end_date):t&&t.date_from&&t.date_to?(r=t.date_from,n=t.date_to):(r=new Date(Date.now()-2592e6).toISOString().split("T")[0],n=(new Date).toISOString().split("T")[0]);const a={date_from:r,date_to:n,timeline_end_date:new Date(Date.now()+15552e6).toISOString().split("T")[0],pipeline_version:"3.0.0_refactored",use_conversion_probabilities:!0,optional_filters:[],secondary_filters:[],config:{product_filter:{include_patterns:[".*"],exclude_patterns:[],specific_product_ids:[]},lifecycle:{trial_window_days:7,cancellation_window_days:30,smoothing_enabled:!0},timeline:{include_estimates:!0,include_confidence_intervals:!1}}};e.ad_id?a.primary_user_filter={property_name:"abi_ad_id",property_values:[e.ad_id],property_source:"user"}:e.adset_id?a.primary_user_filter={property_name:"abi_ad_set_id",property_values:[e.adset_id],property_source:"user"}:e.campaign_id?a.primary_user_filter={property_name:"abi_campaign_id",property_values:[e.campaign_id],property_source:"user"}:a.primary_user_filter={property_name:"",property_values:[],property_source:"user"},console.log("\ud83d\udd0d Pipeline Debug: Sending V3 refactored parameters:",a);const s=await fetch("".concat(ct,"/api/v3/cohort/analyze-refactored"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),i=await s.json();if(!s.ok)throw new Error(i.error||"Failed to run pipeline");return i}catch(r){throw console.error("Error running pipeline:",r),r}}};var ut=r(579);const ht=new Map,pt=s.memo(e=>{let{entityType:t,entityId:r,currentROAS:n,conversionCount:a=0,breakdown:i="all",startDate:o,endDate:l,isBreakdownEntity:c=!1,calculationTooltip:d=null}=e;const[u,h]=(0,s.useState)([]),[p,m]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,b]=(0,s.useState)(null),[y,v]=(0,s.useState)({x:0,y:0}),_=(0,s.useRef)(null),k=(0,s.useMemo)(()=>((e,t,r,n,a)=>"".concat(e,"_").concat(t,"_").concat(r,"_").concat(n,"_").concat(a))(t,r,i,o,l),[t,r,i,o,l]),j=function(e){const t=parseFloat(e)||0;return t<.5?"text-red-400":t>=.5&&t<.75?"text-orange-400":t>=.75&&t<1?"text-yellow-400":t>=1&&t<1.25?"text-green-400":t>=1.25&&t<1.5?"text-blue-400":"text-purple-400"};(0,s.useEffect)(()=>{(async()=>{if(r&&o&&l){if(ht.has(k)){const e=ht.get(k);return h(e),void g(null)}m(!0),g(null);try{const e={entity_type:t,entity_id:r,breakdown:i,start_date:o,end_date:l},n=await dt.getAnalyticsChartData(e);n&&n.success&&n.chart_data?(ht.set(k,n.chart_data),h(n.chart_data)):g("Invalid API response")}catch(f){g(f.message)}finally{m(!1)}}})()},[k,t,r,i,o,l]);const w=(0,s.useCallback)(e=>{if(!_.current||u.length<2)return;const t=_.current.getBoundingClientRect(),r=e.clientX-t.left,n=Math.max(0,Math.min(56,r-2)),a=Math.round(n/56*(u.length-1));a>=0&&a<u.length&&(b(a),v({x:e.clientX-180,y:e.clientY-160}))},[u.length]),N=(0,s.useCallback)(()=>{b(null)},[]),S=e=>(parseFloat(e)||0).toFixed(2),O=j(n,a),C=u.length>=2&&u.some(e=>parseFloat(e.rolling_3d_roas)>0||parseFloat(e.daily_spend)>0||parseFloat(e.daily_estimated_revenue)>0);return(0,ut.jsxs)("div",{className:"flex items-center space-x-3 min-w-[120px] relative",children:[d?s.cloneElement(d,{},(0,ut.jsx)("span",{className:"font-medium text-sm ".concat(O),children:S(n)})):(0,ut.jsx)("span",{className:"font-medium text-sm ".concat(O),children:S(n)}),(0,ut.jsx)("div",{className:"min-w-[60px] relative",children:p?(0,ut.jsx)("div",{className:"w-[60px] h-[20px] bg-blue-200 animate-pulse rounded flex items-center justify-center text-xs",children:"\u23f3"}):f?(0,ut.jsx)("div",{className:"w-[60px] h-[20px] flex items-center justify-center text-red-400 text-xs border border-red-300",children:"\u274c"}):C?(()=>{const e=u.map(e=>parseFloat(e.rolling_3d_roas)||0),t=Math.min(...e),r=Math.max(...e)-t||.1,n=e.map((n,a)=>{const s=2+a/(e.length-1)*56,i=18-(n-t)/r*16;return"".concat(s,",").concat(i)}),a=[];for(let s=0;s<n.length-1;s++){const[t,r]=n[s].split(",").map(Number),[i,o]=n[s+1].split(",").map(Number),l=(r+o)/2,c="".concat((t+i)/2,",").concat(l),d=e[s],h=e[s+1],p=parseInt(u[s].daily_mixpanel_purchases)||0,m=parseInt(u[s+1].daily_mixpanel_purchases)||0,f=u[s].is_inactive||!1,g=u[s+1].is_inactive||!1,x=f?"text-gray-300 dark:text-gray-600":j(d,p),b=g?"text-gray-300 dark:text-gray-600":j(h,m);a.push({path:"M ".concat(n[s]," L ").concat(c),color:x,isInactive:f}),a.push({path:"M ".concat(c," L ").concat(n[s+1]),color:b,isInactive:g})}return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("svg",{ref:_,width:"60",height:"20",className:"overflow-visible cursor-crosshair",onMouseMove:w,onMouseLeave:N,children:[(0,ut.jsx)("line",{x1:30,y1:2,x2:30,y2:18,stroke:"#FFFFFF",strokeWidth:"1",strokeDasharray:"2,2",style:{opacity:.5}}),a.map((e,t)=>(0,ut.jsx)("path",{d:e.path,fill:"none",stroke:"currentColor",strokeWidth:e.isInactive?"1":"1.5",strokeDasharray:e.isInactive?"2,2":"none",className:e.color,style:{opacity:e.isInactive?.3:1}},t)),e.map((n,a)=>{const s=2+a/(e.length-1)*56,i=18-(n-t)/r*16,o=x===a,l=parseInt(u[a].daily_mixpanel_purchases)||0,c=u[a].is_inactive||!1,d=c?"text-gray-300 dark:text-gray-600":j(n,l);return(0,ut.jsx)("circle",{cx:s,cy:i,r:o?"2.5":c?"0.5":"1",fill:"currentColor",className:d,style:{filter:o?"drop-shadow(0 0 3px rgba(0,0,0,0.3))":"none",opacity:c?.3:1}},a)})]}),null!==x&&(0,ut.jsxs)("div",{className:"fixed z-50 bg-gray-900 text-white text-xs rounded px-2 py-1 pointer-events-none shadow-lg border border-gray-700",style:{left:y.x,top:y.y-10,transform:"none",maxWidth:"200px"},children:[(()=>{const e=u[x],t=(parseFloat(e.daily_spend),parseFloat(e.daily_estimated_revenue),parseFloat(e.rolling_3d_roas)||0);return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("div",{className:"font-medium text-white",children:(r=e.date,new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}))}),(0,ut.jsxs)("div",{className:j(t,e.rolling_3d_conversions||0).replace("text-","text-").replace("600","400"),children:["Rolling ROAS: ",S(t)]}),(0,ut.jsxs)("div",{className:"text-gray-400 text-xs",children:["3-day window (",e.rolling_window_days," days)"]})]});var r})(),(0,ut.jsxs)("div",{className:"text-gray-300 text-xs",children:["Rolling Spend: $",(parseFloat(u[x].rolling_3d_spend)||0).toFixed(2)]}),(0,ut.jsxs)("div",{className:"text-gray-300 text-xs",children:["Rolling Revenue: $",(parseFloat(u[x].rolling_3d_revenue)||0).toFixed(2)]}),u[x].period_accuracy_ratio&&1!==u[x].period_accuracy_ratio&&(0,ut.jsx)("div",{className:"text-gray-400 text-xs",children:(()=>{const e="purchases"===(u[x].event_priority||"trials")?"Purchase Accuracy":"Trial Accuracy",t=(100*parseFloat(u[x].period_accuracy_ratio)).toFixed(1);return"".concat(e,": ").concat(t,"% (MP/Meta)")})()}),(0,ut.jsxs)("div",{className:"text-green-300 text-xs",children:["Rolling Conversions: ",u[x].rolling_3d_conversions||0]}),(0,ut.jsxs)("div",{className:"text-blue-300 text-xs",children:["Rolling Trials: ",u[x].rolling_3d_trials||0]}),u[x].rolling_3d_meta_trials&&(0,ut.jsxs)("div",{className:"text-gray-400 text-xs",children:["Rolling Meta Trials: ",u[x].rolling_3d_meta_trials]})]})]})})():(0,ut.jsx)("div",{className:"w-[60px] h-[20px] flex items-center justify-center",children:(0,ut.jsx)("svg",{width:"60",height:"20",className:"overflow-visible",children:(0,ut.jsx)("line",{x1:"2",y1:"10",x2:"58",y2:"10",stroke:"currentColor",strokeWidth:"1",strokeDasharray:"2,2",className:"text-gray-300 dark:text-gray-600"})})})})]})}),mt=pt,ft=e=>{let{average:t,breakdown:r,colorClass:n,pipelineUpdatedClass:a}=e;const[i,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)({x:0,y:0}),d=(0,s.useRef)(null),u=e=>{switch(e.toLowerCase()){case"very_high":return"text-green-700";case"high":return"text-green-600";case"medium":return"text-yellow-600";case"low":return"text-orange-600";case"very_low":return"text-red-600";default:return"text-gray-600"}},h=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("span",{ref:d,className:"".concat(n," ").concat(a," cursor-pointer hover:underline"),onMouseEnter:e=>{o(!0);const t=e.currentTarget.getBoundingClientRect();c({x:t.left+t.width/2,y:t.top-10})},onMouseLeave:()=>{o(!1)},children:t}),i&&(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg p-3 min-w-48",style:{left:l.x-96,top:l.y-10,transform:"translateY(-100%)"},children:[(0,ut.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Accuracy Breakdown"}),(0,ut.jsx)("div",{className:"space-y-1",children:Object.entries(r).sort((e,t)=>{let[,r]=e,[,n]=t;return n.percentage-r.percentage}).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,ut.jsxs)("span",{className:"".concat(u(t)," font-medium"),children:[h(t),":"]}),(0,ut.jsxs)("span",{className:"text-gray-700 dark:text-gray-300",children:[r.count," (",r.percentage,"%)"]})]},t)})}),(0,ut.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-600 mt-2 pt-2 text-xs text-gray-600 dark:text-gray-400",children:["Total Users: ",Object.values(r).reduce((e,t)=>e+t.count,0)]})]})]})},gt=e=>{let{value:t,type:r,colorClass:n,pipelineUpdatedClass:a}=e;const[i,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)({x:0,y:0}),d="trial"===r?"5%":"15%";if(!("trial"===r?Math.abs(t-5)<.01:Math.abs(t-15)<.01))return null;return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("span",{className:"".concat(n," ").concat(a," cursor-help"),onMouseEnter:e=>{const t=e.currentTarget.getBoundingClientRect();c({x:t.left+t.width/2,y:t.top-10}),o(!0)},onMouseLeave:()=>{o(!1)},children:"*"}),i&&(0,ut.jsx)("div",{className:"fixed z-50 bg-gray-900 text-white text-xs rounded px-2 py-1 max-w-xs",style:{left:l.x,top:l.y,transform:"translateX(-50%) translateY(-100%)"},children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"font-medium",children:"Default Minimum Applied"}),(0,ut.jsxs)("div",{className:"mt-1",children:["This rate defaulted to ",d," because either there weren't enough users or the calculated rate was lower. We use this minimum to ensure reliable estimates."]})]})})]})},xt=e=>{var t;let{row:r,columnKey:n,value:a,colorClass:i,dashboardParams:o}=e;const[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)({x:0,y:0}),[h,p]=(0,s.useState)(null),[m,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[b,y]=(0,s.useState)(!1),[v,_]=(0,s.useState)([]),[k,j]=(0,s.useState)(null),[w,N]=(0,s.useState)({country:"",region:"",device_category:"",economic_tier:"",product_id:""}),S=e=>{const t=v.map(t=>t[e]).filter(e=>e&&"N/A"!==e);return[...new Set(t)].sort()},O=()=>v.filter(e=>Object.entries(w).every(t=>{let[r,n]=t;return!n||e[r]===n})),C=()=>{N({country:"",region:"",device_category:"",economic_tier:"",product_id:""})},E=e=>{switch(n){case"trial_conversion_rate":return e.trial_conversion_rate;case"avg_trial_refund_rate":return e.trial_refund_rate;case"purchase_refund_rate":return e.purchase_refund_rate;default:return 0}},P=()=>{switch(n){case"trial_conversion_rate":return"Trial Conversion Rate";case"avg_trial_refund_rate":return"Trial Refund Rate";case"purchase_refund_rate":return"Purchase Refund Rate";default:return"Rate"}};return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("span",{className:"".concat(i," cursor-pointer hover:underline"),onMouseEnter:async e=>{const t=e.currentTarget.getBoundingClientRect(),n=window.innerWidth;window.innerHeight;let a=t.left+t.width/2,s=t.top-10;a<100?a=100:a>n-100&&(a=n-100),s<300&&(s=t.bottom+10),u({x:a,y:s}),c(!0),f(!0),x(null);try{let e=r.type;const t=r.id;!t||!t.includes("_")||t.startsWith("campaign_")||t.startsWith("adset_")||t.startsWith("ad_")||(e=r.entity_type||"campaign");let n=t,a=null;if(t&&t.includes("_")&&!t.startsWith("campaign_")&&!t.startsWith("adset_")&&!t.startsWith("ad_")){const e=t.split("_");a=e[0],n=e.slice(1).join("_")}const s=new URLSearchParams({entity_type:e,entity_id:n,start_date:(null===o||void 0===o?void 0:o.start_date)||"2025-01-01",end_date:(null===o||void 0===o?void 0:o.end_date)||"2025-12-31",breakdown:(null===o||void 0===o?void 0:o.breakdown)||"all"});a&&s.append("breakdown_value",a);const i=await fetch("/api/dashboard/analytics/user-details?".concat(s.toString())),l=await i.json();l.success?(p(l),_(l.users||[])):x(l.error||"Failed to load user details")}catch(i){x("Network error loading user details"),console.error("Error fetching user details:",i)}finally{f(!1)}},onMouseLeave:()=>{c(!1),p(null),x(null)},onClick:()=>{h&&v.length>0&&(y(!0),c(!1),C())},title:"Click to see all users",children:void 0!==a&&null!==a?"".concat(bt(a,2),"%"):"N/A"}),l&&(0,ut.jsx)("div",{className:"fixed z-50 bg-gray-900 text-white text-xs rounded-lg shadow-lg border border-gray-700 max-w-lg",style:{left:d.x,top:d.y,transform:d.y>300?"translateX(-50%) translateY(-100%)":"translateX(-50%)"},children:(0,ut.jsxs)("div",{className:"p-3",children:[(0,ut.jsx)("div",{className:"font-semibold text-blue-300 mb-2",children:P()}),m&&(0,ut.jsx)("div",{className:"text-center py-2",children:(0,ut.jsx)("div",{className:"text-gray-300",children:"Loading user details..."})}),g&&(0,ut.jsx)("div",{className:"text-center py-2",children:(0,ut.jsxs)("div",{className:"text-red-300",children:["Error: ",g]})}),h&&!m&&(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{className:"bg-gradient-to-r from-blue-900/50 to-purple-900/50 p-3 rounded-lg border border-blue-700/50",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),(0,ut.jsx)("span",{className:"font-semibold text-blue-300",children:P()})]}),(0,ut.jsxs)("div",{className:"text-xs text-gray-400",children:[h.users.length," users"]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-white",children:h.summary.total_users}),(0,ut.jsx)("div",{className:"text-xs text-gray-300",children:"Total Users"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsxs)("div",{className:"text-2xl font-bold text-green-400",children:[bt("trial_conversion_rate"===n?h.summary.avg_trial_conversion_rate:"avg_trial_refund_rate"===n?h.summary.avg_trial_refund_rate:h.summary.avg_purchase_refund_rate,1),"%"]}),(0,ut.jsx)("div",{className:"text-xs text-gray-300",children:"Average Rate"})]})]})]}),h.users.length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),(0,ut.jsx)("span",{className:"font-medium text-yellow-300",children:"Top Performers"})]}),(0,ut.jsx)("div",{className:"text-xs text-gray-400",children:"Click to see all"})]}),(0,ut.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2 pr-2",children:h.users.slice(0,10).map((e,t)=>(0,ut.jsx)("div",{className:"bg-gray-800/50 p-3 rounded-lg border border-gray-700/50 hover:border-gray-600/50 transition-all",children:(0,ut.jsxs)("div",{className:"flex items-start justify-between",children:[(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,ut.jsx)("div",{className:"w-6 h-6 bg-blue-600 text-white text-xs font-bold rounded-full flex items-center justify-center",children:t+1}),(0,ut.jsxs)("div",{className:"text-sm font-medium text-white truncate",children:["U",t+1," \u2022 ",e.product_id]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-300",children:[(0,ut.jsxs)("div",{children:["\ud83d\udccd ",e.country,", ",e.region]}),(0,ut.jsxs)("div",{children:["\ud83d\udcb0 ",e.price_bucket]}),(0,ut.jsxs)("div",{children:["\ud83d\udcf1 ",e.device_category]}),(0,ut.jsxs)("div",{children:["\ud83c\udfaf ",e.economic_tier]})]})]}),(0,ut.jsxs)("div",{className:"text-right ml-3 flex-shrink-0",children:[(0,ut.jsxs)("div",{className:"text-lg font-bold text-green-400",children:[bt(E(e),1),"%"]}),(0,ut.jsx)("div",{className:"text-xs text-gray-400 bg-gray-700/50 px-2 py-1 rounded mt-1",children:e.accuracy_score})]})]})},t))}),h.users.length>10&&(0,ut.jsx)("div",{className:"mt-3 text-center",children:(0,ut.jsxs)("div",{className:"text-xs text-blue-300 bg-blue-900/30 px-3 py-2 rounded-lg border border-blue-700/50",children:["Showing top 10 of ",h.users.length," users \u2022 Click anywhere to see all"]})})]}),0===h.users.length&&(0,ut.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,ut.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcca"}),(0,ut.jsx)("div",{className:"font-medium",children:"No users found"}),(0,ut.jsx)("div",{className:"text-xs mt-1",children:"Try adjusting your filters"})]})]})]})}),b&&(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>y(!1),children:(0,ut.jsxs)("div",{className:"bg-gray-900 text-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,ut.jsx)("div",{className:"p-6 border-b border-gray-700 bg-gradient-to-r from-gray-800 to-gray-700",children:(0,ut.jsxs)("div",{className:"flex justify-between items-start",children:[(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsxs)("h2",{className:"text-2xl font-bold text-white mb-3",children:[P()," - All Users"]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-8 text-sm mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,ut.jsxs)("span",{className:"text-gray-300",children:["Total Users: ",(0,ut.jsx)("span",{className:"font-bold text-white text-lg",children:(null===h||void 0===h||null===(t=h.summary)||void 0===t?void 0:t.total_users)||v.length})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,ut.jsxs)("span",{className:"text-gray-300",children:["Average Rate: ",(0,ut.jsxs)("span",{className:"font-bold text-green-400 text-lg",children:[((e,t,r)=>{const a="trial_conversion_rate"===n?null===h||void 0===h||null===(e=h.summary)||void 0===e?void 0:e.avg_trial_conversion_rate:"avg_trial_refund_rate"===n?null===h||void 0===h||null===(t=h.summary)||void 0===t?void 0:t.avg_trial_refund_rate:null===h||void 0===h||null===(r=h.summary)||void 0===r?void 0:r.avg_purchase_refund_rate;return bt(a,2)})(),"%"]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),(0,ut.jsxs)("span",{className:"text-gray-300",children:["Filtered: ",(0,ut.jsx)("span",{className:"font-bold text-purple-400 text-lg",children:O().length})]})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-5 gap-3 mb-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Country"}),(0,ut.jsxs)("select",{value:w.country,onChange:e=>N(Ie(Ie({},w),{},{country:e.target.value})),className:"w-full bg-gray-700 text-white text-xs rounded px-2 py-1 border border-gray-600 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"",children:"All Countries"}),S("country").map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Region"}),(0,ut.jsxs)("select",{value:w.region,onChange:e=>N(Ie(Ie({},w),{},{region:e.target.value})),className:"w-full bg-gray-700 text-white text-xs rounded px-2 py-1 border border-gray-600 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"",children:"All Regions"}),S("region").map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Device"}),(0,ut.jsxs)("select",{value:w.device_category,onChange:e=>N(Ie(Ie({},w),{},{device_category:e.target.value})),className:"w-full bg-gray-700 text-white text-xs rounded px-2 py-1 border border-gray-600 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"",children:"All Devices"}),S("device_category").map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Tier"}),(0,ut.jsxs)("select",{value:w.economic_tier,onChange:e=>N(Ie(Ie({},w),{},{economic_tier:e.target.value})),className:"w-full bg-gray-700 text-white text-xs rounded px-2 py-1 border border-gray-600 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"",children:"All Tiers"}),S("economic_tier").map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Product"}),(0,ut.jsxs)("select",{value:w.product_id,onChange:e=>N(Ie(Ie({},w),{},{product_id:e.target.value})),className:"w-full bg-gray-700 text-white text-xs rounded px-2 py-1 border border-gray-600 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"",children:"All Products"}),S("product_id").map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]})]}),(0,ut.jsx)("div",{className:"flex justify-end",children:(0,ut.jsx)("button",{onClick:C,className:"text-xs bg-gray-600 hover:bg-gray-500 text-white px-3 py-1 rounded transition-colors",children:"Reset Filters"})})]}),(0,ut.jsx)("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-white p-2 hover:bg-gray-600 rounded-full transition-colors ml-4",children:(0,ut.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,ut.jsx)("div",{className:"p-6 overflow-y-auto max-h-[65vh]",children:O().length>0?(0,ut.jsx)("div",{className:"space-y-3",children:O().sort((e,t)=>E(t)-E(e)).map((e,t)=>{const r=(e=>({trial_conversion_rate:e.trial_conversion_rate||0,trial_refund_rate:e.trial_refund_rate||0,purchase_refund_rate:e.purchase_refund_rate||0}))(e);E(e);return(0,ut.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors border border-gray-700 hover:border-gray-600",children:[(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,ut.jsx)("div",{className:"text-white font-bold text-lg bg-blue-600 rounded-full w-8 h-8 flex items-center justify-center",children:t+1}),(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsxs)("div",{className:"text-white font-semibold",children:["U",t+1]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,ut.jsx)("div",{className:"text-xs text-gray-400 font-mono bg-gray-700 px-2 py-1 rounded",children:e.distinct_id}),(0,ut.jsx)("button",{onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),j(t),setTimeout(()=>j(null),2e3)}catch(r){console.error("Failed to copy user ID:",r)}})(e.distinct_id,t),className:"text-xs bg-blue-600 hover:bg-blue-500 text-white px-2 py-1 rounded transition-colors",title:"Copy User ID",children:k===t?"\u2713 Copied":"Copy ID"})]})]})]}),(0,ut.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,ut.jsxs)("div",{className:"text-gray-300",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Location:"})," ",e.country," \u2022 ",e.region]}),(0,ut.jsxs)("div",{className:"text-gray-300",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Store:"})," ",e.device_category]}),(0,ut.jsxs)("div",{className:"text-gray-300",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Price:"})," ",e.price_bucket]}),(0,ut.jsxs)("div",{className:"text-gray-300",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Tier:"})," ",e.economic_tier]}),(0,ut.jsxs)("div",{className:"text-gray-300",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Product:"})," ",e.product_id]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-3 text-xs text-gray-500",children:[(0,ut.jsxs)("span",{children:["Status: ",(0,ut.jsx)("span",{className:"text-gray-400",children:e.status})]}),(0,ut.jsxs)("span",{children:["Credited: ",(0,ut.jsx)("span",{className:"text-gray-400",children:e.credited_date})]}),(0,ut.jsxs)("span",{children:["Value: ",(0,ut.jsxs)("span",{className:"text-gray-400",children:["$",e.estimated_value]})]})]})]}),(0,ut.jsxs)("div",{className:"text-right ml-6",children:[(0,ut.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,ut.jsxs)("div",{className:"text-sm ".concat("trial_conversion_rate"===n?"font-bold text-blue-400 bg-blue-900/30 px-2 py-1 rounded":"text-gray-300"),children:["Trial Conv: ",bt(r.trial_conversion_rate,1),"%"]}),(0,ut.jsxs)("div",{className:"text-sm ".concat("avg_trial_refund_rate"===n?"font-bold text-blue-400 bg-blue-900/30 px-2 py-1 rounded":"text-gray-300"),children:["Trial Refund: ",bt(r.trial_refund_rate,1),"%"]}),(0,ut.jsxs)("div",{className:"text-sm ".concat("purchase_refund_rate"===n?"font-bold text-blue-400 bg-blue-900/30 px-2 py-1 rounded":"text-gray-300"),children:["Purchase Refund: ",bt(r.purchase_refund_rate,1),"%"]})]}),(0,ut.jsxs)("div",{className:"text-xs text-gray-400 bg-gray-700 px-2 py-1 rounded",children:["Accuracy: ",e.accuracy_score]})]})]},t)})}):(0,ut.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,ut.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcca"}),(0,ut.jsx)("div",{className:"text-lg font-medium",children:v.length>0?"No users match your filters":"No users found for this metric"}),(0,ut.jsx)("div",{className:"text-sm mt-2",children:v.length>0?"Try adjusting your filters above":"Try adjusting your date range"}),v.length>0&&(0,ut.jsx)("button",{onClick:C,className:"mt-4 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded transition-colors",children:"Reset Filters"})]})})]})})]})},bt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return void 0===e||null===e?"N/A":e.toLocaleString(void 0,{minimumFractionDigits:t,maximumFractionDigits:t})},yt=e=>void 0===e||null===e?"N/A":e.toLocaleString(void 0,{style:"currency",currency:"USD"}),vt=["mixpanel_trials_started","meta_trials_started","mixpanel_trials_ended","mixpanel_trials_in_progress","click_to_trial_rate","mixpanel_cost_per_trial","meta_cost_per_trial","trial_conversion_rate","avg_trial_refund_rate","trial_accuracy_ratio"],_t=["mixpanel_purchases","meta_purchases","mixpanel_cost_per_purchase","meta_cost_per_purchase","purchase_refund_rate","purchase_accuracy_ratio","mixpanel_conversions_net_refunds","mixpanel_revenue_usd","mixpanel_refunds_usd"],kt=e=>{const t=e.mixpanel_trials_started||0,r=e.mixpanel_purchases||0;return 0===t&&0===r||t>r?"trials":r>t?"purchases":"equal"},jt=(e,t)=>"equal"!==t&&(!("trials"!==t||!_t.includes(e))||!("purchases"!==t||!vt.includes(e))),wt=e=>vt.includes(e)?"trial":_t.includes(e)?"purchase":"neutral",Nt=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=wt(e);if(t)switch(r){case"trial":return"bg-blue-50 dark:bg-blue-900/20";case"purchase":return"bg-green-50 dark:bg-green-900/20";default:return""}else switch(r){case"trial":return"bg-blue-25 dark:bg-blue-900/10";case"purchase":return"bg-green-25 dark:bg-green-900/10";default:return""}},St=e=>Ie({},e),Ot=(e,t)=>{if("average_accuracy"===e&&t)switch(t.toLowerCase()){case"very high":return"text-green-700 dark:text-green-400";case"high":return"text-green-600 dark:text-green-400";case"medium":return"text-yellow-600 dark:text-yellow-400";case"low":return"text-orange-600 dark:text-orange-400";case"very low":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}return"text-gray-900 dark:text-gray-100"},Ct=e=>e>=3?"text-green-600 dark:text-green-400":e>=2?"text-yellow-600 dark:text-yellow-400":e>=1?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400",Et=e=>{let{column:t,sortConfig:r}=e;return r.column!==t?(0,ut.jsx)(tt,{size:12,className:"ml-1 text-gray-400 dark:text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"}):"asc"===r.direction?(0,ut.jsx)(Ke,{size:12,className:"ml-1 text-gray-600 dark:text-gray-300"}):(0,ut.jsx)(He,{size:12,className:"ml-1 text-gray-600 dark:text-gray-300"})},Pt=e=>{let{row:t,roas:r,children:n}=e;const[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)({x:0,y:0}),c=St(t),d=c.spend||0,u=c.estimated_revenue_usd||0,h=c.estimated_revenue_adjusted||0,p=c.mixpanel_trials_started||0,m=c.meta_trials_started||0,f=c.mixpanel_purchases||0,g=c.meta_purchases||0,x=0===p&&0===f||p>f?"trials":f>p?"purchases":"equal",b="purchases"===x?g>0?f/g*100:0:m>0?p/m*100:0,y="purchases"===x?"Purchase":"Trial",v=b>0&&100!==b?b/100:1;return(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{onMouseEnter:e=>{i(!0);const t=e.currentTarget.getBoundingClientRect();l({x:t.left+t.width/2,y:t.top-10})},onMouseLeave:()=>{i(!1)},children:n}),a&&(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl p-4 min-w-80",style:{left:o.x-160,top:o.y-10,transform:"translateY(-100%)"},children:[(0,ut.jsx)("div",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 mb-3 border-b border-gray-200 dark:border-gray-600 pb-2",children:"\ud83c\udfaf ROAS Calculation"}),(0,ut.jsxs)("div",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,ut.jsxs)("div",{children:["1. Base Estimated Revenue: ",(0,ut.jsx)("span",{className:"font-mono",children:yt(u)})]}),(0,ut.jsxs)("div",{children:["2. Active Accuracy Ratio (",y,"): ",(0,ut.jsxs)("span",{className:"font-mono",children:[bt(b,2),"%"]})]}),(0,ut.jsxs)("div",{children:["3. Adjustment Factor: ",(0,ut.jsx)("span",{className:"font-mono",children:bt(v,3)})]}),(0,ut.jsxs)("div",{children:["4. Adjusted Revenue: ",(0,ut.jsx)("span",{className:"font-mono",children:yt(h)})]}),(0,ut.jsxs)("div",{children:["5. Spend: ",(0,ut.jsx)("span",{className:"font-mono",children:yt(d)})]}),(0,ut.jsx)("div",{className:"border-t border-gray-300 dark:border-gray-500 pt-2 mt-3 font-medium text-blue-600 dark:text-blue-400",children:(0,ut.jsxs)("div",{className:"text-base",children:["\ud83c\udfaf ROAS: ",yt(h)," \xf7 ",yt(d)," = ",bt(r,2),"x"]})})]})]})]})},At=e=>{let{data:t=[],rowOrder:r=[],onRowOrderChange:n=null,columnVisibility:a={},columnOrder:i=[],onColumnOrderChange:o=null,dashboardParams:l=null,sortConfig:c={column:null,direction:"asc"},onSort:d=()=>{}}=e;const[u,h]=(0,s.useState)({}),[p,m]=(0,s.useState)({}),[f,g]=(0,s.useState)(null),[x,b]=(0,s.useState)(null),[y,v]=(0,s.useState)(null),[_,k]=(0,s.useState)(!1),j=e=>{!_&&d&&d(e)},[w,N]=(0,s.useState)(null),[S,O]=(0,s.useState)(null),C=(()=>{const e=(i.length>0?i:it.map(e=>e.key)).map(e=>it.find(t=>t.key===e)).filter(e=>e);return 0===Object.keys(a).length?e.filter(e=>e.defaultVisible):e.filter(e=>!0===a[e.key])})();console.log("Column Visibility Status:",{visible_columns:C.length,estimated_revenue_adjusted_visible:C.some(e=>"estimated_revenue_adjusted"===e.key),mixpanel_revenue_net_visible:C.some(e=>"mixpanel_revenue_net"===e.key)});const E=e=>({AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"\xc5land Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barth\xe9lemy",BM:"Bermuda",BN:"Brunei",BO:"Bolivia",BQ:"Caribbean Netherlands",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos Islands",CD:"Democratic Republic of the Congo",CF:"Central African Republic",CG:"Republic of the Congo",CH:"Switzerland",CI:"C\xf4te d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands",FM:"Micronesia",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MF:"Saint Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"North Macedonia",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestine",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"S\xe3o Tom\xe9 and Pr\xedncipe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"East Timor",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Vatican City",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"British Virgin Islands",VI:"U.S. Virgin Islands",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"}[null===e||void 0===e?void 0:e.toUpperCase()]||e),P=function(e,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const a=St(e);let s=a[t],i="N/A";switch(t){case"spend":case"mixpanel_revenue_usd":case"estimated_revenue_usd":case"estimated_revenue_adjusted":case"mixpanel_revenue_net":case"mixpanel_refunds_usd":case"profit":case"mixpanel_cost_per_trial":case"mixpanel_cost_per_purchase":case"meta_cost_per_trial":case"meta_cost_per_purchase":i=yt(s);break;case"impressions":case"clicks":case"mixpanel_trials_started":case"meta_trials_started":case"mixpanel_trials_ended":case"mixpanel_trials_in_progress":case"mixpanel_purchases":case"meta_purchases":case"mixpanel_converted_amount":case"mixpanel_conversions_net_refunds":case"total_attributed_users":i=bt(s);break;case"click_to_trial_rate":case"trial_accuracy_ratio":case"purchase_accuracy_ratio":i=void 0!==s&&null!==s?"".concat(bt(100*s,2),"%"):"N/A";break;case"trial_conversion_rate":i=void 0!==s&&null!==s?(0,ut.jsx)(xt,{row:e,columnKey:t,value:s,colorClass:"",dashboardParams:n}):"N/A";break;case"avg_trial_refund_rate":if(void 0!==s&&null!==s){const r=Math.abs(s-5)<.01;i=(0,ut.jsxs)("span",{children:[(0,ut.jsx)(xt,{row:e,columnKey:t,value:s,colorClass:"",dashboardParams:n}),r&&(0,ut.jsx)(gt,{value:s,type:"trial",colorClass:"text-blue-500",pipelineUpdatedClass:""})]})}else i="N/A";break;case"purchase_refund_rate":if(void 0!==s&&null!==s){const r=Math.abs(s-15)<.01;i=(0,ut.jsxs)("span",{children:[(0,ut.jsx)(xt,{row:e,columnKey:t,value:s,colorClass:"",dashboardParams:n}),r&&(0,ut.jsx)(gt,{value:s,type:"purchase",colorClass:"text-orange-500",pipelineUpdatedClass:""})]})}else i="N/A";break;case"estimated_roas":i=bt(s,2);break;case"performance_impact_score":i=void 0!==s&&null!==s&&s>0?bt(s,0):"0";break;default:i=s||"N/A"}let o=Ot(t,s);if("estimated_roas"===t?o=Ct(s):"performance_impact_score"===t&&(o=s>=7500?"text-purple-600 dark:text-purple-400 font-bold":s>=2500?"text-blue-600 dark:text-blue-400 font-semibold":s>=1e3?"text-green-600 dark:text-green-400 font-semibold":s>=500?"text-yellow-600 dark:text-yellow-400":s>=200?"text-orange-600 dark:text-orange-400":s>=50?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"),("trial_accuracy_ratio"===t||"purchase_accuracy_ratio"===t)&&void 0!==s&&null!==s){if(!(r&&jt(t,r))){if(("trial_accuracy_ratio"===t?a.meta_trials_started||0:a.meta_purchases||0)>5){const e=100*s;e<10?o="text-red-600 dark:text-red-400 font-semibold":e<20?o="text-orange-600 dark:text-orange-400 font-semibold":e<=30&&(o="text-yellow-600 dark:text-yellow-400 font-semibold")}}}if(r&&jt(t,r)&&(o="text-gray-500 dark:text-gray-500"),"segment_accuracy_average"===t&&e.accuracy_breakdown)return(0,ut.jsx)(ft,{average:i,breakdown:e.accuracy_breakdown,colorClass:o,pipelineUpdatedClass:""});if("estimated_roas"===t){const t=e.id?e.id.split("_")[1]:null;if(e.id&&e.id.includes("_")&&!e.id.startsWith("campaign_")&&!e.id.startsWith("adset_")&&!e.id.startsWith("ad_")){console.log("\ud83d\udd25 SPARKLINE CELL DEBUG (BREAKDOWN):",{rowId:e.id,entityType:e.entity_type,currentROAS:s,isBreakdownDetected:!0,breakdown:null===n||void 0===n?void 0:n.breakdown});const[t,r]=e.id.split("_",2);return(0,ut.jsx)(mt,{entityType:e.entity_type||"campaign",entityId:e.id,currentROAS:s,conversionCount:a.mixpanel_purchases||0,breakdown:(null===n||void 0===n?void 0:n.breakdown)||"all",startDate:(null===n||void 0===n?void 0:n.start_date)||"2025-04-01",endDate:(null===n||void 0===n?void 0:n.end_date)||"2025-04-10",isBreakdownEntity:!0,calculationTooltip:(0,ut.jsx)(Pt,{row:e,roas:s})})}return console.log("\ud83d\udd25 SPARKLINE CELL DEBUG (REGULAR):",{rowId:e.id,rowType:e.type,entityId:t,hasSpend:!!e.spend,hasRevenue:!!a.estimated_revenue_usd,isBreakdownDetected:!1}),(0,ut.jsx)(mt,{entityType:e.type,entityId:t,currentROAS:s,conversionCount:a.mixpanel_purchases||0,breakdown:(null===n||void 0===n?void 0:n.breakdown)||"all",startDate:(null===n||void 0===n?void 0:n.start_date)||"2025-04-01",endDate:(null===n||void 0===n?void 0:n.end_date)||"2025-04-10",calculationTooltip:(0,ut.jsx)(Pt,{row:e,roas:s})})}return(0,ut.jsxs)("span",{className:o,children:[i,!1]})},A=e=>{e.preventDefault()},T=e=>{e.currentTarget.contains(e.relatedTarget)||b(null)},M=e=>{g(null),b(null),setTimeout(()=>k(!1),100)},R=D;function D(){N(null),O(null)}const I=(e,t)=>{const a=!!u[e.id],s=!!p[e.id],i=[],o=St(e),c=kt(e);return i.push((0,ut.jsxs)("tr",{draggable:0===t,onDragStart:t=>((e,t)=>{N(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage(new Image,0,0)})(t,e.id),onDragEnter:t=>((e,t)=>{e.preventDefault(),t!==S&&O(t)})(t,e.id),onDragOver:e=>e.preventDefault(),onDrop:t=>((e,t)=>{if(e.preventDefault(),!w||w===t)return;const a=[...r],s=a.indexOf(w),i=a.indexOf(t);a.splice(i,0,a.splice(s,1)[0]),null===n||void 0===n||n(a),D()})(t,e.id),onDragEnd:R,className:"border-b border-gray-200 dark:border-gray-700 ".concat(0===t?"bg-gray-50 dark:bg-gray-800 font-semibold":1===t?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200":"bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200"," ").concat(w===e.id?"opacity-50":""," ").concat(S===e.id&&w!==e.id?"ring-2 ring-blue-400":""),children:[(0,ut.jsx)("td",{className:"sticky left-0 px-3 py-2 whitespace-nowrap z-10 ".concat(0===t?"bg-gray-50 dark:bg-gray-800":1===t?"bg-white dark:bg-gray-700":"bg-gray-100 dark:bg-gray-600"),children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{style:{paddingLeft:"".concat(20*t,"px")},children:e.children&&e.children.length>0?(0,ut.jsx)("button",{onClick:()=>{return t=e.id,void h(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"mr-1 p-1",children:a?(0,ut.jsx)(He,{size:16}):(0,ut.jsx)(rt,{size:16})}):(0,ut.jsx)("span",{className:"inline-block w-8"})}),e.breakdowns&&e.breakdowns.length>0&&(0,ut.jsx)("button",{onClick:()=>{return t=e.id,void m(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"mr-2 p-1 rounded ".concat(s?"text-blue-500 bg-blue-100 dark:bg-blue-900/30":"text-gray-400 hover:text-blue-400"),title:"Toggle breakdowns",children:(0,ut.jsx)(Ye,{size:14})}),(0,ut.jsx)("span",{className:"".concat(0===t?"text-gray-900 dark:text-gray-100":1===t?"text-gray-800 dark:text-gray-200":"text-gray-700 dark:text-gray-100"),children:0===t?e.name||e.campaign_name:1===t?e.name||e.adset_name:e.name||e.ad_name})]})}),C.slice(1).map(r=>{if("campaign_name"===r.key)return t>0?(0,ut.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:e.campaign_name},r.key):(0,ut.jsx)("td",{className:"px-3 py-2"},r.key);if("adset_name"===r.key)return t>1?(0,ut.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:e.adset_name},r.key):(0,ut.jsx)("td",{className:"px-3 py-2"},r.key);const n=Ot(r.key,o[r.key]),a="roas"===r.key||"estimated_roas"===r.key,s=a?Ct(o[r.key]):"",i=a?s:n,d=jt(r.key,c)?"text-gray-500 dark:text-gray-500":i,u=Nt(r.key);return(0,ut.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-right ".concat(d," ").concat(a?"font-medium":""," ").concat(u),children:P(o,r.key,!1,c,l)},r.key)})]},e.id)),s&&e.breakdowns&&i.push(...((e,t)=>{const r=[];return e.breakdowns?(e.breakdowns.forEach(n=>{n.values.forEach((a,s)=>{const i=St(a),o=a.meta_value&&a.mixpanel_value&&a.meta_value!==a.mixpanel_value,c=o?"".concat(a.meta_value," \u2192 ").concat(a.mixpanel_value):a.name;var d;r.push((0,ut.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700 bg-gray-50/30 dark:bg-gray-900/30 text-xs hover:bg-blue-50/20 dark:hover:bg-blue-900/20",children:[(0,ut.jsx)("td",{className:"sticky left-0 px-3 py-1 whitespace-nowrap bg-gray-50/30 dark:bg-gray-900/30 z-10",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"opacity-0 w-8"})," ",(0,ut.jsxs)("div",{style:{paddingLeft:"".concat(20*(t+1)+12,"px")},className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-gray-700 dark:text-gray-300 flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-lg",children:(d=a.name,{AD:"\ud83c\udde6\ud83c\udde9",AE:"\ud83c\udde6\ud83c\uddea",AF:"\ud83c\udde6\ud83c\uddeb",AG:"\ud83c\udde6\ud83c\uddec",AI:"\ud83c\udde6\ud83c\uddee",AL:"\ud83c\udde6\ud83c\uddf1",AM:"\ud83c\udde6\ud83c\uddf2",AO:"\ud83c\udde6\ud83c\uddf4",AQ:"\ud83c\udde6\ud83c\uddf6",AR:"\ud83c\udde6\ud83c\uddf7",AS:"\ud83c\udde6\ud83c\uddf8",AT:"\ud83c\udde6\ud83c\uddf9",AU:"\ud83c\udde6\ud83c\uddfa",AW:"\ud83c\udde6\ud83c\uddfc",AX:"\ud83c\udde6\ud83c\uddfd",AZ:"\ud83c\udde6\ud83c\uddff",BA:"\ud83c\udde7\ud83c\udde6",BB:"\ud83c\udde7\ud83c\udde7",BD:"\ud83c\udde7\ud83c\udde9",BE:"\ud83c\udde7\ud83c\uddea",BF:"\ud83c\udde7\ud83c\uddeb",BG:"\ud83c\udde7\ud83c\uddec",BH:"\ud83c\udde7\ud83c\udded",BI:"\ud83c\udde7\ud83c\uddee",BJ:"\ud83c\udde7\ud83c\uddef",BL:"\ud83c\udde7\ud83c\uddf1",BM:"\ud83c\udde7\ud83c\uddf2",BN:"\ud83c\udde7\ud83c\uddf3",BO:"\ud83c\udde7\ud83c\uddf4",BQ:"\ud83c\udde7\ud83c\uddf6",BR:"\ud83c\udde7\ud83c\uddf7",BS:"\ud83c\udde7\ud83c\uddf8",BT:"\ud83c\udde7\ud83c\uddf9",BV:"\ud83c\udde7\ud83c\uddfb",BW:"\ud83c\udde7\ud83c\uddfc",BY:"\ud83c\udde7\ud83c\uddfe",BZ:"\ud83c\udde7\ud83c\uddff",CA:"\ud83c\udde8\ud83c\udde6",CC:"\ud83c\udde8\ud83c\udde8",CD:"\ud83c\udde8\ud83c\udde9",CF:"\ud83c\udde8\ud83c\uddeb",CG:"\ud83c\udde8\ud83c\uddec",CH:"\ud83c\udde8\ud83c\udded",CI:"\ud83c\udde8\ud83c\uddee",CK:"\ud83c\udde8\ud83c\uddf0",CL:"\ud83c\udde8\ud83c\uddf1",CM:"\ud83c\udde8\ud83c\uddf2",CN:"\ud83c\udde8\ud83c\uddf3",CO:"\ud83c\udde8\ud83c\uddf4",CR:"\ud83c\udde8\ud83c\uddf7",CU:"\ud83c\udde8\ud83c\uddfa",CV:"\ud83c\udde8\ud83c\uddfb",CW:"\ud83c\udde8\ud83c\uddfc",CX:"\ud83c\udde8\ud83c\uddfd",CY:"\ud83c\udde8\ud83c\uddfe",CZ:"\ud83c\udde8\ud83c\uddff",DE:"\ud83c\udde9\ud83c\uddea",DJ:"\ud83c\udde9\ud83c\uddef",DK:"\ud83c\udde9\ud83c\uddf0",DM:"\ud83c\udde9\ud83c\uddf2",DO:"\ud83c\udde9\ud83c\uddf4",DZ:"\ud83c\udde9\ud83c\uddff",EC:"\ud83c\uddea\ud83c\udde8",EE:"\ud83c\uddea\ud83c\uddea",EG:"\ud83c\uddea\ud83c\uddec",EH:"\ud83c\uddea\ud83c\udded",ER:"\ud83c\uddea\ud83c\uddf7",ES:"\ud83c\uddea\ud83c\uddf8",ET:"\ud83c\uddea\ud83c\uddf9",FI:"\ud83c\uddeb\ud83c\uddee",FJ:"\ud83c\uddeb\ud83c\uddef",FK:"\ud83c\uddeb\ud83c\uddf0",FM:"\ud83c\uddeb\ud83c\uddf2",FO:"\ud83c\uddeb\ud83c\uddf4",FR:"\ud83c\uddeb\ud83c\uddf7",GA:"\ud83c\uddec\ud83c\udde6",GB:"\ud83c\uddec\ud83c\udde7",GD:"\ud83c\uddec\ud83c\udde9",GE:"\ud83c\uddec\ud83c\uddea",GF:"\ud83c\uddec\ud83c\uddeb",GG:"\ud83c\uddec\ud83c\uddec",GH:"\ud83c\uddec\ud83c\udded",GI:"\ud83c\uddec\ud83c\uddee",GL:"\ud83c\uddec\ud83c\uddf1",GM:"\ud83c\uddec\ud83c\uddf2",GN:"\ud83c\uddec\ud83c\uddf3",GP:"\ud83c\uddec\ud83c\uddf5",GQ:"\ud83c\uddec\ud83c\uddf6",GR:"\ud83c\uddec\ud83c\uddf7",GS:"\ud83c\uddec\ud83c\uddf8",GT:"\ud83c\uddec\ud83c\uddf9",GU:"\ud83c\uddec\ud83c\uddfa",GW:"\ud83c\uddec\ud83c\uddfc",GY:"\ud83c\uddec\ud83c\uddfe",HK:"\ud83c\udded\ud83c\uddf0",HM:"\ud83c\udded\ud83c\uddf2",HN:"\ud83c\udded\ud83c\uddf3",HR:"\ud83c\udded\ud83c\uddf7",HT:"\ud83c\udded\ud83c\uddf9",HU:"\ud83c\udded\ud83c\uddfa",ID:"\ud83c\uddee\ud83c\udde9",IE:"\ud83c\uddee\ud83c\uddea",IL:"\ud83c\uddee\ud83c\uddf1",IM:"\ud83c\uddee\ud83c\uddf2",IN:"\ud83c\uddee\ud83c\uddf3",IO:"\ud83c\uddee\ud83c\uddf4",IQ:"\ud83c\uddee\ud83c\uddf6",IR:"\ud83c\uddee\ud83c\uddf7",IS:"\ud83c\uddee\ud83c\uddf8",IT:"\ud83c\uddee\ud83c\uddf9",JE:"\ud83c\uddef\ud83c\uddea",JM:"\ud83c\uddef\ud83c\uddf2",JO:"\ud83c\uddef\ud83c\uddf4",JP:"\ud83c\uddef\ud83c\uddf5",KE:"\ud83c\uddf0\ud83c\uddea",KG:"\ud83c\uddf0\ud83c\uddec",KH:"\ud83c\uddf0\ud83c\udded",KI:"\ud83c\uddf0\ud83c\uddee",KM:"\ud83c\uddf0\ud83c\uddf2",KN:"\ud83c\uddf0\ud83c\uddf3",KP:"\ud83c\uddf0\ud83c\uddf5",KR:"\ud83c\uddf0\ud83c\uddf7",KW:"\ud83c\uddf0\ud83c\uddfc",KY:"\ud83c\uddf0\ud83c\uddfe",KZ:"\ud83c\uddf0\ud83c\uddff",LA:"\ud83c\uddf1\ud83c\udde6",LB:"\ud83c\uddf1\ud83c\udde7",LC:"\ud83c\uddf1\ud83c\udde8",LI:"\ud83c\uddf1\ud83c\uddee",LK:"\ud83c\uddf1\ud83c\uddf0",LR:"\ud83c\uddf1\ud83c\uddf7",LS:"\ud83c\uddf1\ud83c\uddf8",LT:"\ud83c\uddf1\ud83c\uddf9",LU:"\ud83c\uddf1\ud83c\uddfa",LV:"\ud83c\uddf1\ud83c\uddfb",LY:"\ud83c\uddf1\ud83c\uddfe",MA:"\ud83c\uddf2\ud83c\udde6",MC:"\ud83c\uddf2\ud83c\udde8",MD:"\ud83c\uddf2\ud83c\udde9",ME:"\ud83c\uddf2\ud83c\uddea",MF:"\ud83c\uddf2\ud83c\uddeb",MG:"\ud83c\uddf2\ud83c\uddec",MH:"\ud83c\uddf2\ud83c\udded",MK:"\ud83c\uddf2\ud83c\uddf0",ML:"\ud83c\uddf2\ud83c\uddf1",MM:"\ud83c\uddf2\ud83c\uddf2",MN:"\ud83c\uddf2\ud83c\uddf3",MO:"\ud83c\uddf2\ud83c\uddf4",MP:"\ud83c\uddf2\ud83c\uddf5",MQ:"\ud83c\uddf2\ud83c\uddf6",MR:"\ud83c\uddf2\ud83c\uddf7",MS:"\ud83c\uddf2\ud83c\uddf8",MT:"\ud83c\uddf2\ud83c\uddf9",MU:"\ud83c\uddf2\ud83c\uddfa",MV:"\ud83c\uddf2\ud83c\uddfb",MW:"\ud83c\uddf2\ud83c\uddfc",MX:"\ud83c\uddf2\ud83c\uddfd",MY:"\ud83c\uddf2\ud83c\uddfe",MZ:"\ud83c\uddf2\ud83c\uddff",NA:"\ud83c\uddf3\ud83c\udde6",NC:"\ud83c\uddf3\ud83c\udde8",NE:"\ud83c\uddf3\ud83c\uddea",NF:"\ud83c\uddf3\ud83c\uddeb",NG:"\ud83c\uddf3\ud83c\uddec",NI:"\ud83c\uddf3\ud83c\uddee",NL:"\ud83c\uddf3\ud83c\uddf1",NO:"\ud83c\uddf3\ud83c\uddf4",NP:"\ud83c\uddf3\ud83c\uddf5",NR:"\ud83c\uddf3\ud83c\uddf7",NU:"\ud83c\uddf3\ud83c\uddfa",NZ:"\ud83c\uddf3\ud83c\uddff",OM:"\ud83c\uddf4\ud83c\uddf2",PA:"\ud83c\uddf5\ud83c\udde6",PE:"\ud83c\uddf5\ud83c\uddea",PF:"\ud83c\uddf5\ud83c\uddeb",PG:"\ud83c\uddf5\ud83c\uddec",PH:"\ud83c\uddf5\ud83c\udded",PK:"\ud83c\uddf5\ud83c\uddf0",PL:"\ud83c\uddf5\ud83c\uddf1",PM:"\ud83c\uddf5\ud83c\uddf2",PN:"\ud83c\uddf5\ud83c\uddf3",PR:"\ud83c\uddf5\ud83c\uddf7",PS:"\ud83c\uddf5\ud83c\uddf8",PT:"\ud83c\uddf5\ud83c\uddf9",PW:"\ud83c\uddf5\ud83c\uddfc",PY:"\ud83c\uddf5\ud83c\uddfe",QA:"\ud83c\uddf6\ud83c\udde6",RE:"\ud83c\uddf7\ud83c\uddea",RO:"\ud83c\uddf7\ud83c\uddf4",RS:"\ud83c\uddf7\ud83c\uddf8",RU:"\ud83c\uddf7\ud83c\uddfa",RW:"\ud83c\uddf7\ud83c\uddfc",SA:"\ud83c\uddf8\ud83c\udde6",SB:"\ud83c\uddf8\ud83c\udde7",SC:"\ud83c\uddf8\ud83c\udde8",SD:"\ud83c\uddf8\ud83c\udde9",SE:"\ud83c\uddf8\ud83c\uddea",SG:"\ud83c\uddf8\ud83c\uddec",SH:"\ud83c\uddf8\ud83c\udded",SI:"\ud83c\uddf8\ud83c\uddee",SJ:"\ud83c\uddf8\ud83c\uddef",SK:"\ud83c\uddf8\ud83c\uddf0",SL:"\ud83c\uddf8\ud83c\uddf1",SM:"\ud83c\uddf8\ud83c\uddf2",SN:"\ud83c\uddf8\ud83c\uddf3",SO:"\ud83c\uddf8\ud83c\uddf4",SR:"\ud83c\uddf8\ud83c\uddf7",SS:"\ud83c\uddf8\ud83c\uddf8",ST:"\ud83c\uddf8\ud83c\uddf9",SV:"\ud83c\uddf8\ud83c\uddfb",SX:"\ud83c\uddf8\ud83c\uddfd",SY:"\ud83c\uddf8\ud83c\uddfe",SZ:"\ud83c\uddf8\ud83c\uddff",TC:"\ud83c\uddf9\ud83c\udde8",TD:"\ud83c\uddf9\ud83c\udde9",TF:"\ud83c\uddf9\ud83c\uddeb",TG:"\ud83c\uddf9\ud83c\uddec",TH:"\ud83c\uddf9\ud83c\udded",TJ:"\ud83c\uddf9\ud83c\uddef",TK:"\ud83c\uddf9\ud83c\uddf0",TL:"\ud83c\uddf9\ud83c\uddf1",TM:"\ud83c\uddf9\ud83c\uddf2",TN:"\ud83c\uddf9\ud83c\uddf3",TO:"\ud83c\uddf9\ud83c\uddf4",TR:"\ud83c\uddf9\ud83c\uddf7",TT:"\ud83c\uddf9\ud83c\uddf9",TV:"\ud83c\uddf9\ud83c\uddfb",TW:"\ud83c\uddf9\ud83c\uddfc",TZ:"\ud83c\uddf9\ud83c\uddff",UA:"\ud83c\uddfa\ud83c\udde6",UG:"\ud83c\uddfa\ud83c\uddec",UM:"\ud83c\uddfa\ud83c\uddf2",US:"\ud83c\uddfa\ud83c\uddf8",UY:"\ud83c\uddfa\ud83c\uddfe",UZ:"\ud83c\uddfa\ud83c\uddff",VA:"\ud83c\uddfb\ud83c\udde6",VC:"\ud83c\uddfb\ud83c\udde8",VE:"\ud83c\uddfb\ud83c\uddea",VG:"\ud83c\uddfb\ud83c\uddec",VI:"\ud83c\uddfb\ud83c\uddee",VN:"\ud83c\uddfb\ud83c\uddf3",VU:"\ud83c\uddfb\ud83c\uddfa",WF:"\ud83c\uddfc\ud83c\uddeb",WS:"\ud83c\uddfc\ud83c\uddf8",XK:"\ud83c\uddfd\ud83c\uddf0",YE:"\ud83c\uddfe\ud83c\uddea",YT:"\ud83c\uddfe\ud83c\uddf9",ZA:"\ud83c\uddff\ud83c\udde6",ZM:"\ud83c\uddff\ud83c\uddf2",ZW:"\ud83c\uddff\ud83c\uddfc"}[null===d||void 0===d?void 0:d.toUpperCase()]||"")}),(0,ut.jsxs)("span",{className:"font-medium",children:[a.name," \u2022 ",E(a.name)]}),o&&(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",c,")"]})]}),a.total_users&&(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",a.total_users.toLocaleString()," users)"]})]})]})}),C.slice(1).map(e=>"campaign_name"===e.key||"adset_name"===e.key?(0,ut.jsx)("td",{className:"px-3 py-1"},e.key):(0,ut.jsx)("td",{className:"px-3 py-1 whitespace-nowrap text-right",children:(0,ut.jsx)("span",{className:"".concat(Ot(e.key,i[e.key])),children:P(i,e.key,!1,kt(i),l)})},e.key))]},"".concat(e.id,"-").concat(n.type,"-").concat(s)))})}),r):r})(e,t)),a&&e.children&&e.children.forEach(e=>{i.push(...I(e,t+1))}),i};if(!t||0===t.length)return(0,ut.jsx)("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No data available."});const L=c.column&&null!==c.column?t:r.length?r.map(e=>t.find(t=>t.id===e)).filter(Boolean):t,F=L.reduce((e,t)=>e.concat(I(t,0)),[]);return(0,ut.jsxs)("div",{className:"shadow-soft rounded-2xl",children:[(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 px-4 py-2 flex space-x-4 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"inline-flex rounded-md shadow-sm",children:[(0,ut.jsxs)("button",{onClick:()=>{const e={},r=t=>{t.forEach(t=>{e[t.id]=!0,t.children&&r(t.children)})};r(t),h(e)},className:"px-3 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-l-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center",children:[(0,ut.jsx)(nt,{size:14,className:"mr-1"})," Expand All"]}),(0,ut.jsxs)("button",{onClick:()=>{h({})},className:"px-3 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-r-lg border border-l-0 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center",children:[(0,ut.jsx)(at,{size:14,className:"mr-1"})," Collapse All"]})]}),(0,ut.jsxs)("div",{className:"inline-flex rounded-md shadow-sm",children:[(0,ut.jsxs)("button",{onClick:()=>{const e={},r=t=>{t.forEach(t=>{t.breakdowns&&t.breakdowns.length>0&&(e[t.id]=!0),t.children&&r(t.children)})};r(t),m(e)},className:"px-3 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-l-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center",children:[(0,ut.jsx)(Ye,{size:14,className:"mr-1"})," Show Breakdowns"]}),(0,ut.jsxs)("button",{onClick:()=>{m({})},className:"px-3 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-r-lg border border-l-0 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center",children:[(0,ut.jsx)(st,{size:14,className:"mr-1"})," Hide Breakdowns"]})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 text-sm",children:[(0,ut.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{scope:"col",className:"sticky left-0 px-3 py-3 text-left text-xs font-medium uppercase tracking-wider bg-gray-100 dark:bg-gray-800 z-20 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors group\n                  ".concat("name"===c.column?"border-b-2 border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":""),onClick:()=>j("name"),children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{children:"Name"}),(0,ut.jsx)(Et,{column:"name",sortConfig:c})]})}),C.slice(1).map(e=>{const t=wt(e.key),r=Nt(e.key,x===e.key);return(0,ut.jsx)("th",{scope:"col",draggable:!e.alwaysVisible,onDragStart:t=>((e,t)=>{g(t),k(!0),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t)})(t,e.key),onDragOver:A,onDragEnter:t=>{return r=e.key,void(f&&f!==r&&b(r));var r},onDragLeave:T,onDrop:t=>((e,t)=>{if(e.preventDefault(),f&&f!==t&&o){const e=[...i],r=e.indexOf(f),n=e.indexOf(t);if(-1!==r&&-1!==n){const[t]=e.splice(r,1),a=r<n?n:n+1;e.splice(a,0,t),console.log("\ud83d\udd04 Column reordered: '".concat(f,"' moved from position ").concat(r," to ").concat(a)),o(e)}}g(null),b(null),setTimeout(()=>k(!1),100)})(t,e.key),onDragEnd:M,onClick:()=>j(e.key),className:"px-3 py-3 text-".concat("campaign_name"===e.key||"adset_name"===e.key?"left":"right"," text-xs font-medium uppercase tracking-wider ").concat((e.key,"text-gray-700 dark:text-gray-300")," ").concat(r,"\n                      cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-150 group\n                      ").concat(c.column===e.key?"bg-blue-50 dark:bg-blue-900/20 border-b-2 border-blue-500 dark:border-blue-400":"","\n                      ").concat(x===e.key&&f!==e.key?"bg-blue-100 dark:bg-blue-900 border-2 border-blue-300 dark:border-blue-600":"","\n                      ").concat("trial"===t?"border-l-2 border-blue-200 dark:border-blue-800":"","\n                      ").concat("purchase"===t?"border-l-2 border-green-200 dark:border-green-800":""),title:'Click to sort by "'.concat(e.label,'"').concat(e.alwaysVisible?"":". Drag to reorder column."),children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{children:e.label}),(0,ut.jsx)(Et,{column:e.key,sortConfig:c})]}),!e.alwaysVisible&&(0,ut.jsx)("span",{className:"ml-1 text-gray-400 dark:text-gray-500 text-lg leading-none hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-150",style:{transform:"rotate(90deg)"},children:"\u22ee\u22ee"})]})},e.key)})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:F.map(e=>(0,ut.jsx)(s.Fragment,{children:e},e.key))})]})})]})},Tt=ze("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Mt=ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Rt=ze("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Dt=ze("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),It=ze("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Lt=ze("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ft=ze("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Bt=ze("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Ut=e=>{let{status:t="idle",message:r,size:n="sm"}=e;const a={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"},s=(()=>{switch(t){case"loading":return{icon:qe,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30",borderColor:"border-blue-200 dark:border-blue-800",animate:"animate-spin"};case"success":return{icon:Bt,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30",borderColor:"border-green-200 dark:border-green-800",animate:""};case"error":return{icon:We,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30",borderColor:"border-red-200 dark:border-red-800",animate:""};case"info":return{icon:Ft,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30",borderColor:"border-blue-200 dark:border-blue-800",animate:""};default:return{icon:null,color:"text-gray-400 dark:text-gray-500",bgColor:"bg-gray-100 dark:bg-gray-700",borderColor:"border-gray-200 dark:border-gray-600",animate:""}}})(),i=s.icon;return(0,ut.jsxs)("div",{className:"inline-flex items-center space-x-2 px-3 py-1.5 rounded-lg text-sm border ".concat(s.bgColor," ").concat(s.borderColor," ").concat(s.color),children:[i&&(0,ut.jsx)(i,{className:"".concat(a[n]," ").concat(s.animate)}),"idle"===t&&(0,ut.jsx)("div",{className:"".concat(a[n]," rounded-full bg-gray-300 dark:bg-gray-600")}),r&&(0,ut.jsx)("span",{className:"font-medium",children:r})]})},zt=e=>{let{dateRange:t,breakdown:r,hierarchy:n,breakdownFilters:a,onDateRangeChange:i,onBreakdownChange:o,onHierarchyChange:l,onBreakdownFiltersChange:c,onRefresh:d,loading:u=!1,backgroundLoading:h=!1}=e;const[p,m]=(0,s.useState)("7days"),[f,g]=(0,s.useState)(!1),[x,b]=(0,s.useState)(!1),[y,v]=(0,s.useState)({dateRange:t,breakdown:r,hierarchy:n,breakdownFilters:a}),_=(()=>{const e=new Date;e.setDate(e.getDate()-1);const t=e=>e.toISOString().split("T")[0];return[{id:"yesterday",label:"Yesterday",start_date:t(e),end_date:t(e)},{id:"7days",label:"7 Days",start_date:t(new Date(e.getTime()-5184e5)),end_date:t(e)},{id:"14days",label:"14 Days",start_date:t(new Date(e.getTime()-11232e5)),end_date:t(e)},{id:"30days",label:"30 Days",start_date:t(new Date(e.getTime()-25056e5)),end_date:t(e)}]})();(0,s.useEffect)(()=>{const e=_.find(e=>e.start_date===t.start_date&&e.end_date===t.end_date);m(e?e.id:"custom")},[t]),(0,s.useEffect)(()=>{const e={dateRange:t,breakdown:r,hierarchy:n,breakdownFilters:a},s=JSON.stringify(e)!==JSON.stringify(y);b(s)},[t,r,n,a,y]);const k=(e,r)=>{m("custom"),i(Ie(Ie({},t),{},{[e]:r}))},j=e=>{c(Ie(Ie({},a),{},{type:e}))};return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,ut.jsx)(Je,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Analytics Controls"}),(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure your dashboard view and data filters"})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)(Ut,{status:h?"loading":x?"info":"success",message:h?"Updating...":x?"Settings changed - refresh needed":"Data up to date",size:"md"}),(0,ut.jsx)("button",{onClick:()=>{v({dateRange:t,breakdown:r,hierarchy:n,breakdownFilters:a}),b(!1),d()},disabled:u||h,className:"inline-flex items-center px-4 py-2 ".concat(x?"bg-orange-600 hover:bg-orange-700 ring-2 ring-orange-300 dark:ring-orange-700":"bg-blue-600 hover:bg-blue-700"," disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"),children:u?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4"}),x?"Apply Changes":"Refresh"]})})]})]})}),(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6",children:[(0,ut.jsx)("div",{className:"xl:col-span-2",children:(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,ut.jsx)(Tt,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Time Range"})]}),(0,ut.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4",children:_.map(e=>(0,ut.jsx)("button",{onClick:()=>(e=>{if(m(e),"custom"!==e){const t=_.find(t=>t.id===e);t&&i({start_date:t.start_date,end_date:t.end_date})}})(e.id),className:"px-3 py-2 text-xs font-medium rounded-md transition-all ".concat(p===e.id?"bg-blue-600 text-white shadow-sm ring-1 ring-blue-600":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"),children:e.label},e.id))}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"From"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("input",{type:"date",value:t.start_date,onChange:e=>k("start_date",e.target.value),className:"w-full pl-10 pr-3 py-2.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-200 cursor-pointer hover:border-gray-400 dark:hover:border-gray-500",style:{colorScheme:"light"}}),(0,ut.jsx)(Tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"To"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("input",{type:"date",value:t.end_date,onChange:e=>k("end_date",e.target.value),className:"w-full pl-10 pr-3 py-2.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-200 cursor-pointer hover:border-gray-400 dark:hover:border-gray-500",style:{colorScheme:"light"}}),(0,ut.jsx)(Tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]})]})]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,ut.jsx)(nt,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Structure"})]}),(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hierarchy"}),(0,ut.jsxs)("select",{value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,ut.jsx)("option",{value:"campaign",children:"Campaign \u2192 Ad Set \u2192 Ad"}),(0,ut.jsx)("option",{value:"adset",children:"Ad Set \u2192 Ad"}),(0,ut.jsx)("option",{value:"ad",children:"Ad Only"})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Breakdown"}),(0,ut.jsxs)("select",{value:r,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,ut.jsx)("option",{value:"all",children:"No Breakdown"}),(0,ut.jsx)("option",{value:"country",children:"By Country"})]})]})]})]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)(Mt,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Filters"})]}),"all"!==r&&(0,ut.jsx)("button",{onClick:()=>{c(Ie(Ie({},a),{},{enabled:!a.enabled}))},className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-md transition-colors ".concat(a.enabled?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"),children:a.enabled?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Rt,{className:"mr-1 h-3 w-3"}),"Active"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Dt,{className:"mr-1 h-3 w-3"}),"Inactive"]})})]}),"all"===r?(0,ut.jsx)("div",{className:"text-center py-6",children:(0,ut.jsx)("div",{className:"text-gray-400 dark:text-gray-500 text-sm",children:"Enable breakdown to use filters"})}):a.enabled?(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-1 p-1 bg-gray-200 dark:bg-gray-700 rounded-md",children:[(0,ut.jsxs)("button",{onClick:()=>j("limit"),className:"px-2 py-1.5 text-xs font-medium rounded transition-colors ".concat("limit"===a.type?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"),children:[(0,ut.jsx)(It,{className:"inline mr-1 h-3 w-3"}),"Top N"]}),(0,ut.jsxs)("button",{onClick:()=>j("spend"),className:"px-2 py-1.5 text-xs font-medium rounded transition-colors ".concat("spend"===a.type?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"),children:[(0,ut.jsx)(Lt,{className:"inline mr-1 h-3 w-3"}),"Min Spend"]})]}),(0,ut.jsx)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-600",children:"limit"===a.type?(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Show top items"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("input",{type:"range",min:"5",max:"50",step:"5",value:a.limitCount,onChange:e=>(e=>{c(Ie(Ie({},a),{},{limitCount:parseInt(e)}))})(e.target.value),className:"flex-1 h-2 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer"}),(0,ut.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 min-w-[2rem] text-center",children:a.limitCount})]})]}):(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Minimum spend ($)"}),(0,ut.jsx)("input",{type:"number",min:"0",step:"10",value:a.minSpend,onChange:e=>(e=>{c(Ie(Ie({},a),{},{minSpend:parseFloat(e)}))})(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})]}):(0,ut.jsxs)("div",{className:"text-center py-6",children:[(0,ut.jsx)("div",{className:"text-gray-400 dark:text-gray-500 text-sm mb-2",children:"Filters are disabled"}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Click "Active" above to enable filtering options'})]})]})})]}),(0,ut.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[(0,ut.jsx)("div",{className:"flex items-center space-x-4",children:"all"!==r&&(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)(Ft,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:["Breakdown: ",r.charAt(0).toUpperCase()+r.slice(1),a.enabled&&(0,ut.jsx)("span",{className:"ml-1 text-blue-600 dark:text-blue-400",children:"(filtered)"})]})]})}),(0,ut.jsxs)("div",{className:"text-xs",children:[t.start_date," to ",t.end_date]})]})})]})]})},Vt=()=>{const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_data");if(e)try{return JSON.parse(e)}catch(dU){console.warn("Failed to parse saved dashboard data:",dU)}return[]}),[c,d]=(0,s.useState)(()=>localStorage.getItem("dashboard_last_updated")||null),[u,h]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_date_range");if(e)try{return JSON.parse(e)}catch(dU){console.warn("Failed to parse saved date range:",dU)}return{start_date:"2024-01-01",end_date:(new Date).toISOString().split("T")[0]}}),[p,m]=(0,s.useState)(()=>localStorage.getItem("dashboard_breakdown")||"all"),[f,g]=(0,s.useState)(()=>localStorage.getItem("dashboard_hierarchy")||"campaign"),[x,b]=(0,s.useState)(()=>localStorage.getItem("dashboard_text_filter")||""),[y,v]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_breakdown_filters");if(e)try{return JSON.parse(e)}catch(dU){console.warn("Failed to parse saved breakdown filters:",dU)}return{enabled:!1,type:"limit",limitCount:10,minSpend:100}}),[_,k]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_column_visibility");let t={};if(e)try{t=JSON.parse(e)}catch(dU){console.warn("Failed to parse saved column visibility:",dU),t={}}return(e=>{const t={};return it.forEach(r=>{e&&e.hasOwnProperty(r.key)?t[r.key]=e[r.key]:t[r.key]=r.defaultVisible||!1}),t})(t)}),[j,w]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_column_order");let t=[];if(e)try{t=JSON.parse(e)}catch(dU){console.warn("Failed to parse saved column order:",dU),t=[]}return(e=>{const t=ot(),r=[...e||[]];return t.forEach(e=>{r.includes(e)||r.push(e)}),r.filter(e=>t.includes(e))})(t)}),[N,S]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_row_order");if(e)try{return JSON.parse(e)}catch(dU){console.warn("Failed to parse saved row order:",dU)}return[]}),[O,C]=(0,s.useState)(()=>{const e=localStorage.getItem("dashboard_sort_config");if(e)try{return JSON.parse(e)}catch(dU){console.warn("Failed to parse saved sort config:",dU)}return{column:"spend",direction:"desc"}}),[E,P]=(0,s.useState)(!1),A=((e,t)=>{(0,s.useEffect)(()=>{const r=lt(e);r.isValid||console.warn("\ud83d\udea8 Column Order Validation Failed:",{validation:r,missing_columns:r.missing,extra_columns:r.extra});const n=it.map(e=>e.key),a=Object.keys(t),s=n.filter(e=>!a.includes(e)),i=a.filter(e=>!n.includes(e));(s.length>0||i.length>0)&&console.warn("\ud83d\udea8 Column Visibility Validation Failed:",{missing_in_visibility:s,extra_in_visibility:i,expected_count:n.length,actual_count:a.length})},[e,t]);const r=lt(e),n=it.map(e=>e.key),a=Object.keys(t),i=n.every(e=>a.includes(e));return{isValid:r.isValid&&i,orderValidation:r,visibilityValid:i}})(j,_);(0,s.useEffect)(()=>{console.log("Column Status:",{estimated_revenue_adjusted:_.estimated_revenue_adjusted,visible_columns_count:Object.keys(_).filter(e=>_[e]).length,validation_passed:A.isValid})},[_,A]);const T=(0,s.useRef)(!1),M=(0,s.useRef)({dateRange:u,breakdown:p,hierarchy:f});(0,s.useEffect)(()=>{M.current={dateRange:u,breakdown:p,hierarchy:f}},[u,p,f]),(0,s.useEffect)(()=>{const e=e=>{E&&!e.target.closest(".column-selector-container")&&P(!1)};if(E)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[E]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_date_range",JSON.stringify(u))},[u]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_breakdown",p)},[p]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_hierarchy",f)},[f]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_column_visibility",JSON.stringify(_)),console.log("\ud83d\udcbe Column visibility saved to localStorage:",Object.keys(_).filter(e=>_[e]).length,"visible columns")},[_]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_text_filter",x)},[x]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_breakdown_filters",JSON.stringify(y))},[y]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_column_order",JSON.stringify(j)),console.log("\ud83d\udcbe Column order saved to localStorage:",j.length,"columns in order")},[j]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_row_order",JSON.stringify(N))},[N]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_sort_config",JSON.stringify(O))},[O]),(0,s.useEffect)(()=>{localStorage.setItem("dashboard_data",JSON.stringify(o))},[o]),(0,s.useEffect)(()=>{c&&localStorage.setItem("dashboard_last_updated",c)},[c]);const R=(0,s.useCallback)(e=>{if(!x.trim())return e;const t=x.toLowerCase();return e.reduce((e,r)=>{const n=r.name&&r.name.toLowerCase().includes(t)||r.campaign_name&&r.campaign_name.toLowerCase().includes(t)||r.adset_name&&r.adset_name.toLowerCase().includes(t)||r.ad_name&&r.ad_name.toLowerCase().includes(t),a=r.children?R(r.children):[];return(n||a.length>0)&&e.push(Ie(Ie({},r),{},{children:a})),e},[])},[x]),D=(0,s.useCallback)(e=>y.enabled&&"all"!==p?e.map(e=>{if(!e.breakdowns||0===e.breakdowns.length)return e;const t=e.breakdowns.map(e=>{let t=e.values;if("spend"===y.type)t=t.filter(e=>(e.spend||0)>=y.minSpend);else if("limit"===y.type){const e=O.column||"spend",r=O.direction||"desc";t=[...t].sort((t,n)=>{const a=t[e]||0,s=n[e]||0;return"desc"===r?s-a:a-s}).slice(0,y.limitCount)}return Ie(Ie({},e),{},{values:t})});return Ie(Ie({},e),{},{breakdowns:t})}):e,[y,p,O]),I=(0,s.useMemo)(()=>{if(!o||0===o.length)return[];const e=x?o.filter(e=>R([e]).length>0):o,t=((e,t)=>{if(!t.column)return e;const r=e=>{const n=[...e].sort((e,r)=>{let n=e[t.column],a=r[t.column];if(null==n&&null==a)return 0;if(null==n)return"asc"===t.direction?-1:1;if(null==a)return"asc"===t.direction?1:-1;if("number"===typeof n&&"number"===typeof a)return"asc"===t.direction?n-a:a-n;const s=String(n).toLowerCase(),i=String(a).toLowerCase();return"asc"===t.direction?s.localeCompare(i):i.localeCompare(s)});return n.map(e=>{const n=Ie({},e);return e.children&&e.children.length>0&&(n.children=r(e.children)),e.breakdowns&&e.breakdowns.length>0&&(n.breakdowns=e.breakdowns.map(e=>Ie(Ie({},e),{},{values:[...e.values].sort((e,r)=>{let n=e[t.column],a=r[t.column];if(null==n&&null==a)return 0;if(null==n)return"asc"===t.direction?-1:1;if(null==a)return"asc"===t.direction?1:-1;if("number"===typeof n&&"number"===typeof a)return"asc"===t.direction?n-a:a-n;const s=String(n).toLowerCase(),i=String(a).toLowerCase();return"asc"===t.direction?s.localeCompare(i):i.localeCompare(s)})}))),n})};return r(e)})(D(e),O);return t},[o,x,O,R,D]),L=(0,s.useCallback)(async()=>{n(!0),i(null);try{const{dateRange:e,breakdown:t,hierarchy:r}=M.current;console.log("\ud83d\udd04 Background refresh - fetching fresh data:",{dateRange:e,breakdown:t,hierarchy:r});const n=await dt.getAnalyticsData({start_date:e.start_date,end_date:e.end_date,breakdown:t,group_by:r,enable_breakdown_mapping:!0});n.success?(l(n.data||[]),d((new Date).toISOString()),n.data&&n.data.length>0&&0===N.length&&!O.column&&S(n.data.map(e=>e.id)),console.log("\u2705 Background refresh completed successfully")):i(n.error||"Failed to fetch analytics data")}catch(a){console.error("Background refresh error:",a),i(a.message||"Failed to refresh dashboard data")}finally{n(!1)}},[N.length]),F=(0,s.useCallback)(async()=>{t(!0),i(null);try{const{dateRange:t,breakdown:r,hierarchy:n}=M.current;console.log("\ud83d\udd04 Fetching pre-computed analytics data:",{dateRange:t,breakdown:r,hierarchy:n});const a=await dt.getAnalyticsData({start_date:t.start_date,end_date:t.end_date,breakdown:r,group_by:n,enable_breakdown_mapping:!0});var e;if(a.success)l(a.data||[]),d((new Date).toISOString()),a.data&&a.data.length>0&&!O.column&&S(a.data.map(e=>e.id)),console.log("\u2705 Dashboard data loaded successfully"),console.log("\ud83d\udcca Data summary:",{totalRows:(null===(e=a.data)||void 0===e?void 0:e.length)||0,breakdown:r,hierarchy:n});else i(a.error||"Failed to fetch analytics data")}catch(a){console.error("Dashboard refresh error:",a),i(a.message||"Failed to refresh dashboard data")}finally{t(!1)}},[]);(0,s.useEffect)(()=>{if(T.current)return;o&&o.length>0?(console.log("\ud83d\udccb Loading cached data (no auto-refresh)"),o.length>0&&0===N.length&&!O.column&&S(o.map(e=>e.id))):console.log("\ud83d\udccb No cached data available - waiting for user action"),T.current=!0},[]);return a?(0,ut.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)(We,{className:"mx-auto h-12 w-12 text-red-500"}),(0,ut.jsx)("h1",{className:"mt-4 text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Dashboard Error"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:a}),(0,ut.jsxs)("button",{onClick:()=>{i(null),F()},className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4"}),"Retry"]})]})})}):(0,ut.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:[(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Campaign Dashboard"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Advanced analytics for Meta advertising performance"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)(Ge,{size:14}),(0,ut.jsx)("span",{children:"Sorted by:"}),(0,ut.jsx)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:(()=>{if(!O.column)return"None";const e=it.find(e=>e.key===O.column);return e?e.label:O.column})()}),(0,ut.jsxs)("span",{className:"text-gray-500",children:["(","asc"===O.direction?"Low to High":"High to Low",")"]})]}),(0,ut.jsxs)("div",{className:"relative column-selector-container",children:[(0,ut.jsxs)("button",{onClick:()=>P(!E),className:"flex items-center space-x-2 px-3 py-2 text-gray-600 dark:text-gray-300 hover:text-blue-500 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,ut.jsx)($e,{className:"h-4 w-4"}),(0,ut.jsx)("span",{className:"text-sm",children:"Columns"}),E?(0,ut.jsx)(Ke,{className:"h-3 w-3"}):(0,ut.jsx)(He,{className:"h-3 w-3"})]}),E&&(0,ut.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50 max-h-80 overflow-y-auto",children:[(0,ut.jsx)("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex space-x-2 mb-2",children:[(0,ut.jsx)("button",{onClick:()=>{const e={};it.forEach(t=>{e[t.key]=!0}),k(e)},className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800",children:"Show All"}),(0,ut.jsx)("button",{onClick:()=>{const e=Ie({},_);it.forEach(t=>{t.alwaysVisible||(e[t.key]=!1)}),k(e)},className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-500",children:"Hide All"})]})}),(0,ut.jsx)("div",{className:"p-3 space-y-2",children:it.map(e=>(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("input",{type:"checkbox",checked:_[e.key]||!1,onChange:()=>{return t=e.key,void k(e=>{const r=Ie(Ie({},e),{},{[t]:!e[t]});return console.log("\ud83d\udd04 Column '".concat(t,"' toggled to:"),r[t]),r});var t},disabled:e.alwaysVisible,className:"mr-3 h-4 w-4 text-blue-600 rounded border-gray-300 dark:border-gray-500 focus:ring-blue-500"}),(0,ut.jsxs)("span",{className:"text-sm ".concat(e.alwaysVisible?"text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"),children:[e.label,e.alwaysVisible&&(0,ut.jsx)("span",{className:"ml-1 text-xs",children:"(always visible)"})]})]},e.key))})]})]})]})]})}),(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsx)(zt,{dateRange:u,breakdown:p,hierarchy:f,breakdownFilters:y,onDateRangeChange:h,onBreakdownChange:m,onHierarchyChange:g,onBreakdownFiltersChange:v,onRefresh:()=>{o&&o.length>0?L():F()},loading:e,backgroundLoading:r})}),(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)(Ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,ut.jsx)("input",{type:"text",placeholder:"Search campaigns, ad sets, or ads...",value:x,onChange:e=>b(e.target.value),className:"pl-10 pr-4 py-3 w-full border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(()=>{const e=o&&0!==o.length?I.reduce((e,t)=>(e.totalSpend+=t.spend||0,e.totalImpressions+=t.impressions||0,e.totalClicks+=t.clicks||0,e.totalRevenue+=t.estimated_revenue_adjusted||t.estimated_revenue_usd||0,e.totalProfit+=t.profit||0,e),{totalSpend:0,totalImpressions:0,totalClicks:0,totalRevenue:0,totalProfit:0}):{};if(!e||0===Object.keys(e).length)return null;const t=e.totalSpend>0?e.totalRevenue/e.totalSpend:0;return(0,ut.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(Xe,{className:"h-8 w-8 text-blue-500"}),(0,ut.jsxs)("div",{className:"ml-4",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Spend"}),(0,ut.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",e.totalSpend.toLocaleString()]})]})]})}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(Ge,{className:"h-8 w-8 text-green-500"}),(0,ut.jsxs)("div",{className:"ml-4",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Estimated Revenue"}),(0,ut.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",e.totalRevenue.toLocaleString()]})]})]})}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(Je,{className:"h-8 w-8 ".concat(e.totalProfit>=0?"text-green-500":"text-red-500")}),(0,ut.jsxs)("div",{className:"ml-4",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Profit"}),(0,ut.jsxs)("p",{className:"text-2xl font-bold ".concat(e.totalProfit>=0?"text-green-600":"text-red-600"),children:["$",e.totalProfit.toLocaleString()]})]})]})}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(Qe,{className:"h-8 w-8 text-purple-500"}),(0,ut.jsxs)("div",{className:"ml-4",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"ROAS"}),(0,ut.jsxs)("p",{className:"text-2xl font-bold ".concat(t>=2?"text-green-600":t>=1?"text-yellow-600":"text-red-600"),children:[t.toFixed(2),"x"]})]})]})})]})})(),(c||r)&&(0,ut.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,ut.jsx)(Ze,{className:"mr-2 h-4 w-4"}),"Last updated: ",c?new Date(c).toLocaleString():"Loading..."]}),r&&(0,ut.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-full text-xs border border-blue-200 dark:border-blue-800",children:[(0,ut.jsx)(qe,{className:"h-3 w-3 animate-spin"}),(0,ut.jsx)("span",{children:"Refreshing data..."})]})]}),e?(0,ut.jsx)("div",{className:"flex items-center justify-center h-64 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)(qe,{className:"mx-auto h-8 w-8 text-blue-500 animate-spin"}),(0,ut.jsx)("p",{className:"mt-2 text-lg font-medium text-gray-900 dark:text-gray-100",children:"Loading dashboard data..."}),(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Fetching pre-computed analytics data"})]})}):I.length>0?(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:(0,ut.jsx)(At,{data:I,rowOrder:N,onRowOrderChange:S,columnVisibility:_,columnOrder:j,onColumnOrderChange:w,dashboardParams:{start_date:u.start_date,end_date:u.end_date,breakdown:p,hierarchy:f},sortConfig:O,onSort:e=>{C(t=>{if(t.column===e)return Ie(Ie({},t),{},{direction:"asc"===t.direction?"desc":"asc"});return{column:e,direction:["impressions","clicks","spend","meta_trials_started","mixpanel_trials_started","meta_purchases","mixpanel_purchases","trial_accuracy_ratio","mixpanel_trials_ended","mixpanel_trials_in_progress","mixpanel_refunds_usd","mixpanel_revenue_usd","mixpanel_revenue_net","mixpanel_conversions_net_refunds","mixpanel_cost_per_trial","mixpanel_cost_per_purchase","meta_cost_per_trial","meta_cost_per_purchase","click_to_trial_rate","trial_conversion_rate","avg_trial_refund_rate","purchase_accuracy_ratio","purchase_refund_rate","estimated_revenue_usd","estimated_revenue_adjusted","profit","estimated_roas","performance_impact_score"].includes(e)?"desc":"asc"}}),S([])}})}):(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8 text-center",children:[(0,ut.jsx)(et,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,ut.jsx)("h3",{className:"mt-4 text-lg font-semibold text-gray-900 dark:text-gray-100",children:"No Data Available"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:x?'No results found for "'.concat(x,'". Try adjusting your search terms.'):'Click "Refresh Data" to load campaign information for the selected date range and settings.'}),!x&&(0,ut.jsx)("button",{onClick:F,disabled:e||r,className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e||r?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4"}),"Refresh Data"]})})]})]})})};function Ht(e,t){return function(){return e.apply(t,arguments)}}const{toString:Wt}=Object.prototype,{getPrototypeOf:qt}=Object,{iterator:Gt,toStringTag:$t}=Symbol,Kt=(e=>t=>{const r=Wt.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Yt=e=>(e=e.toLowerCase(),t=>Kt(t)===e),Xt=e=>t=>typeof t===e,{isArray:Jt}=Array,Qt=Xt("undefined");const Zt=Yt("ArrayBuffer");const er=Xt("string"),tr=Xt("function"),rr=Xt("number"),nr=e=>null!==e&&"object"===typeof e,ar=e=>{if("object"!==Kt(e))return!1;const t=qt(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!($t in e)&&!(Gt in e)},sr=Yt("Date"),ir=Yt("File"),or=Yt("Blob"),lr=Yt("FileList"),cr=Yt("URLSearchParams"),[dr,ur,hr,pr]=["ReadableStream","Request","Response","Headers"].map(Yt);function mr(e,t){let r,n,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Jt(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{const n=a?Object.getOwnPropertyNames(e):Object.keys(e),s=n.length;let i;for(r=0;r<s;r++)i=n[r],t.call(null,e[i],i,e)}}function fr(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,a=r.length;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const gr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,xr=e=>!Qt(e)&&e!==gr;const br=(yr="undefined"!==typeof Uint8Array&&qt(Uint8Array),e=>yr&&e instanceof yr);var yr;const vr=Yt("HTMLFormElement"),_r=(e=>{let{hasOwnProperty:t}=e;return(e,r)=>t.call(e,r)})(Object.prototype),kr=Yt("RegExp"),jr=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};mr(r,(r,a)=>{let s;!1!==(s=t(r,a,e))&&(n[a]=s||r)}),Object.defineProperties(e,n)};const wr=Yt("AsyncFunction"),Nr=(Sr="function"===typeof setImmediate,Or=tr(gr.postMessage),Sr?setImmediate:Or?((e,t)=>(gr.addEventListener("message",r=>{let{source:n,data:a}=r;n===gr&&a===e&&t.length&&t.shift()()},!1),r=>{t.push(r),gr.postMessage(e,"*")}))("axios@".concat(Math.random()),[]):e=>setTimeout(e));var Sr,Or;const Cr="undefined"!==typeof queueMicrotask?queueMicrotask.bind(gr):"undefined"!==typeof process&&process.nextTick||Nr,Er={isArray:Jt,isArrayBuffer:Zt,isBuffer:function(e){return null!==e&&!Qt(e)&&null!==e.constructor&&!Qt(e.constructor)&&tr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||tr(e.append)&&("formdata"===(t=Kt(e))||"object"===t&&tr(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Zt(e.buffer),t},isString:er,isNumber:rr,isBoolean:e=>!0===e||!1===e,isObject:nr,isPlainObject:ar,isReadableStream:dr,isRequest:ur,isResponse:hr,isHeaders:pr,isUndefined:Qt,isDate:sr,isFile:ir,isBlob:or,isRegExp:kr,isFunction:tr,isStream:e=>nr(e)&&tr(e.pipe),isURLSearchParams:cr,isTypedArray:br,isFileList:lr,forEach:mr,merge:function e(){const{caseless:t}=xr(this)&&this||{},r={},n=(n,a)=>{const s=t&&fr(r,a)||a;ar(r[s])&&ar(n)?r[s]=e(r[s],n):ar(n)?r[s]=e({},n):Jt(n)?r[s]=n.slice():r[s]=n};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&mr(arguments[a],n);return r},extend:function(e,t,r){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return mr(t,(t,n)=>{r&&tr(t)?e[n]=Ht(t,r):e[n]=t},{allOwnKeys:n}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let a,s,i;const o={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],n&&!n(i,e,t)||o[i]||(t[i]=e[i],o[i]=!0);e=!1!==r&&qt(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:Kt,kindOfTest:Yt,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(Jt(e))return e;let t=e.length;if(!rr(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Gt]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:vr,hasOwnProperty:_r,hasOwnProp:_r,reduceDescriptors:jr,freezeMethods:e=>{jr(e,(t,r)=>{if(tr(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];tr(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach(e=>{r[e]=!0})};return Jt(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:fr,global:gr,isContextDefined:xr,isSpecCompliantForm:function(e){return!!(e&&tr(e.append)&&"FormData"===e[$t]&&e[Gt])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(nr(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const a=Jt(e)?[]:{};return mr(e,(e,t)=>{const s=r(e,n+1);!Qt(s)&&(a[t]=s)}),t[n]=void 0,a}}return e};return r(e,0)},isAsyncFn:wr,isThenable:e=>e&&(nr(e)||tr(e))&&tr(e.then)&&tr(e.catch),setImmediate:Nr,asap:Cr,isIterable:e=>null!=e&&tr(e[Gt])};function Pr(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Er.inherits(Pr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Er.toJSONObject(this.config),code:this.code,status:this.status}}});const Ar=Pr.prototype,Tr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Tr[e]={value:e}}),Object.defineProperties(Pr,Tr),Object.defineProperty(Ar,"isAxiosError",{value:!0}),Pr.from=(e,t,r,n,a,s)=>{const i=Object.create(Ar);return Er.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),Pr.call(i,e.message,t,r,n,a),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const Mr=Pr;function Rr(e){return Er.isPlainObject(e)||Er.isArray(e)}function Dr(e){return Er.endsWith(e,"[]")?e.slice(0,-2):e}function Ir(e,t,r){return e?e.concat(t).map(function(e,t){return e=Dr(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}const Lr=Er.toFlatObject(Er,{},null,function(e){return/^is[A-Z]/.test(e)});const Fr=function(e,t,r){if(!Er.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=Er.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Er.isUndefined(t[e])})).metaTokens,a=r.visitor||c,s=r.dots,i=r.indexes,o=(r.Blob||"undefined"!==typeof Blob&&Blob)&&Er.isSpecCompliantForm(t);if(!Er.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Er.isDate(e))return e.toISOString();if(Er.isBoolean(e))return e.toString();if(!o&&Er.isBlob(e))throw new Mr("Blob is not supported. Use a Buffer instead.");return Er.isArrayBuffer(e)||Er.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,r,a){let o=e;if(e&&!a&&"object"===typeof e)if(Er.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(Er.isArray(e)&&function(e){return Er.isArray(e)&&!e.some(Rr)}(e)||(Er.isFileList(e)||Er.endsWith(r,"[]"))&&(o=Er.toArray(e)))return r=Dr(r),o.forEach(function(e,n){!Er.isUndefined(e)&&null!==e&&t.append(!0===i?Ir([r],n,s):null===i?r:r+"[]",l(e))}),!1;return!!Rr(e)||(t.append(Ir(a,r,s),l(e)),!1)}const d=[],u=Object.assign(Lr,{defaultVisitor:c,convertValue:l,isVisitable:Rr});if(!Er.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!Er.isUndefined(r)){if(-1!==d.indexOf(r))throw Error("Circular reference detected in "+n.join("."));d.push(r),Er.forEach(r,function(r,s){!0===(!(Er.isUndefined(r)||null===r)&&a.call(t,r,Er.isString(s)?s.trim():s,n,u))&&e(r,n?n.concat(s):[s])}),d.pop()}}(e),t};function Br(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Ur(e,t){this._pairs=[],e&&Fr(e,this,t)}const zr=Ur.prototype;zr.append=function(e,t){this._pairs.push([e,t])},zr.toString=function(e){const t=e?function(t){return e.call(this,t,Br)}:Br;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Vr=Ur;function Hr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Wr(e,t,r){if(!t)return e;const n=r&&r.encode||Hr;Er.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(s=a?a(t,r):Er.isURLSearchParams(t)?t.toString():new Vr(t,r).toString(n),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const qr=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Er.forEach(this.handlers,function(t){null!==t&&e(t)})}},Gr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$r={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Vr,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Kr="undefined"!==typeof window&&"undefined"!==typeof document,Yr="object"===typeof navigator&&navigator||void 0,Xr=Kr&&(!Yr||["ReactNative","NativeScript","NS"].indexOf(Yr.product)<0),Jr="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Qr=Kr&&window.location.href||"http://localhost",Zr=Ie(Ie({},e),$r);const en=function(e){function t(e,r,n,a){let s=e[a++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),o=a>=e.length;if(s=!s&&Er.isArray(n)?n.length:s,o)return Er.hasOwnProp(n,s)?n[s]=[n[s],r]:n[s]=r,!i;n[s]&&Er.isObject(n[s])||(n[s]=[]);return t(e,r,n[s],a)&&Er.isArray(n[s])&&(n[s]=function(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}(n[s])),!i}if(Er.isFormData(e)&&Er.isFunction(e.entries)){const r={};return Er.forEachEntry(e,(e,n)=>{t(function(e){return Er.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),n,r,0)}),r}return null};const tn={transitional:Gr,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,a=Er.isObject(e);a&&Er.isHTMLForm(e)&&(e=new FormData(e));if(Er.isFormData(e))return n?JSON.stringify(en(e)):e;if(Er.isArrayBuffer(e)||Er.isBuffer(e)||Er.isStream(e)||Er.isFile(e)||Er.isBlob(e)||Er.isReadableStream(e))return e;if(Er.isArrayBufferView(e))return e.buffer;if(Er.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Fr(e,new Zr.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return Zr.isNode&&Er.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Er.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Fr(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||n?(t.setContentType("application/json",!1),function(e,t,r){if(Er.isString(e))try{return(t||JSON.parse)(e),Er.trim(e)}catch(dU){if("SyntaxError"!==dU.name)throw dU}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||tn.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(Er.isResponse(e)||Er.isReadableStream(e))return e;if(e&&Er.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(dU){if(r){if("SyntaxError"===dU.name)throw Mr.from(dU,Mr.ERR_BAD_RESPONSE,this,null,this.response);throw dU}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zr.classes.FormData,Blob:Zr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Er.forEach(["delete","get","head","post","put","patch"],e=>{tn.headers[e]={}});const rn=tn,nn=Er.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),an=Symbol("internals");function sn(e){return e&&String(e).trim().toLowerCase()}function on(e){return!1===e||null==e?e:Er.isArray(e)?e.map(on):String(e)}function ln(e,t,r,n,a){return Er.isFunction(n)?n.call(this,t,r):(a&&(t=r),Er.isString(t)?Er.isString(n)?-1!==t.indexOf(n):Er.isRegExp(n)?n.test(t):void 0:void 0)}class cn{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function a(e,t,r){const a=sn(t);if(!a)throw new Error("header name must be a non-empty string");const s=Er.findKey(n,a);(!s||void 0===n[s]||!0===r||void 0===r&&!1!==n[s])&&(n[s||t]=on(e))}const s=(e,t)=>Er.forEach(e,(e,r)=>a(e,r,t));if(Er.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Er.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let r,n,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),r=e.substring(0,a).trim().toLowerCase(),n=e.substring(a+1).trim(),!r||t[r]&&nn[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t})(e),t);else if(Er.isObject(e)&&Er.isIterable(e)){let r,n,a={};for(const t of e){if(!Er.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[n=t[0]]=(r=a[n])?Er.isArray(r)?[...r,t[1]]:[r,t[1]]:t[1]}s(a,t)}else null!=e&&a(t,e,r);return this}get(e,t){if(e=sn(e)){const r=Er.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(Er.isFunction(t))return t.call(this,e,r);if(Er.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=sn(e)){const r=Er.findKey(this,e);return!(!r||void 0===this[r]||t&&!ln(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function a(e){if(e=sn(e)){const a=Er.findKey(r,e);!a||t&&!ln(0,r[a],a,t)||(delete r[a],n=!0)}}return Er.isArray(e)?e.forEach(a):a(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const a=t[r];e&&!ln(0,this[a],a,e,!0)||(delete this[a],n=!0)}return n}normalize(e){const t=this,r={};return Er.forEach(this,(n,a)=>{const s=Er.findKey(r,a);if(s)return t[s]=on(n),void delete t[a];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}(a):String(a).trim();i!==a&&delete t[a],t[i]=on(n),r[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Er.forEach(this,(r,n)=>{null!=r&&!1!==r&&(t[n]=e&&Er.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,r]=e;return t+": "+r}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[an]=this[an]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=sn(e);t[n]||(!function(e,t){const r=Er.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(e,r,a){return this[n].call(this,t,e,r,a)},configurable:!0})})}(r,e),t[n]=!0)}return Er.isArray(e)?e.forEach(n):n(e),this}}cn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Er.reduceDescriptors(cn.prototype,(e,t)=>{let{value:r}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(e){this[n]=e}}}),Er.freezeMethods(cn);const dn=cn;function un(e,t){const r=this||rn,n=t||r,a=dn.from(n.headers);let s=n.data;return Er.forEach(e,function(e){s=e.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function hn(e){return!(!e||!e.__CANCEL__)}function pn(e,t,r){Mr.call(this,null==e?"canceled":e,Mr.ERR_CANCELED,t,r),this.name="CanceledError"}Er.inherits(pn,Mr,{__CANCEL__:!0});const mn=pn;function fn(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new Mr("Request failed with status code "+r.status,[Mr.ERR_BAD_REQUEST,Mr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}const gn=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a,s=0,i=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=n[i];a||(a=l),r[s]=o,n[s]=l;let d=i,u=0;for(;d!==s;)u+=r[d++],d%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}};const xn=function(e,t){let r,n,a=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=s,r=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-a;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t>=s?i(l,e):(r=l,n||(n=setTimeout(()=>{n=null,i(r)},s-t)))},()=>r&&i(r)]},bn=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=0;const a=gn(50,250);return xn(r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,o=s-n,l=a(o);n=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:o,rate:l||void 0,estimated:l&&i&&s<=i?(i-s)/l:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},yn=(e,t)=>{const r=null!=e;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},vn=e=>function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Er.asap(()=>e(...r))},_n=Zr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Zr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Zr.origin),Zr.navigator&&/(msie|trident)/i.test(Zr.navigator.userAgent)):()=>!0,kn=Zr.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const i=[e+"="+encodeURIComponent(t)];Er.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Er.isString(n)&&i.push("path="+n),Er.isString(a)&&i.push("domain="+a),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function jn(e,t,r){let n=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(n||0==r)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const wn=e=>e instanceof dn?Ie({},e):e;function Nn(e,t){t=t||{};const r={};function n(e,t,r,n){return Er.isPlainObject(e)&&Er.isPlainObject(t)?Er.merge.call({caseless:n},e,t):Er.isPlainObject(t)?Er.merge({},t):Er.isArray(t)?t.slice():t}function a(e,t,r,a){return Er.isUndefined(t)?Er.isUndefined(e)?void 0:n(void 0,e,0,a):n(e,t,0,a)}function s(e,t){if(!Er.isUndefined(t))return n(void 0,t)}function i(e,t){return Er.isUndefined(t)?Er.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function o(r,a,s){return s in t?n(r,a):s in e?n(void 0,r):void 0}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(e,t,r)=>a(wn(e),wn(t),0,!0)};return Er.forEach(Object.keys(Object.assign({},e,t)),function(n){const s=l[n]||a,i=s(e[n],t[n],n);Er.isUndefined(i)&&s!==o||(r[n]=i)}),r}const Sn=e=>{const t=Nn({},e);let r,{data:n,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=dn.from(o),t.url=Wr(jn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Er.isFormData(n))if(Zr.hasStandardBrowserEnv||Zr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(r=o.getContentType())){const[e,...t]=r?r.split(";").map(e=>e.trim()).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(Zr.hasStandardBrowserEnv&&(a&&Er.isFunction(a)&&(a=a(t)),a||!1!==a&&_n(t.url))){const e=s&&i&&kn.read(i);e&&o.set(s,e)}return t},On="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){const n=Sn(e);let a=n.data;const s=dn.from(n.headers).normalize();let i,o,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=n;function m(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(i),n.signal&&n.signal.removeEventListener("abort",i)}let f=new XMLHttpRequest;function g(){if(!f)return;const n=dn.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());fn(function(e){t(e),m()},function(e){r(e),m()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f}),f=null}f.open(n.method.toUpperCase(),n.url,!0),f.timeout=n.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(r(new Mr("Request aborted",Mr.ECONNABORTED,e,f)),f=null)},f.onerror=function(){r(new Mr("Network Error",Mr.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const a=n.transitional||Gr;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),r(new Mr(t,a.clarifyTimeoutError?Mr.ETIMEDOUT:Mr.ECONNABORTED,e,f)),f=null},void 0===a&&s.setContentType(null),"setRequestHeader"in f&&Er.forEach(s.toJSON(),function(e,t){f.setRequestHeader(t,e)}),Er.isUndefined(n.withCredentials)||(f.withCredentials=!!n.withCredentials),u&&"json"!==u&&(f.responseType=n.responseType),p&&([l,d]=bn(p,!0),f.addEventListener("progress",l)),h&&f.upload&&([o,c]=bn(h),f.upload.addEventListener("progress",o),f.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(i=t=>{f&&(r(!t||t.type?new mn(null,e,f):t),f.abort(),f=null)},n.cancelToken&&n.cancelToken.subscribe(i),n.signal&&(n.signal.aborted?i():n.signal.addEventListener("abort",i)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);x&&-1===Zr.protocols.indexOf(x)?r(new Mr("Unsupported protocol "+x+":",Mr.ERR_BAD_REQUEST,e)):f.send(a||null)})},Cn=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,n=new AbortController;const a=function(e){if(!r){r=!0,i();const t=e instanceof Error?e:this.reason;n.abort(t instanceof Mr?t:new mn(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,a(new Mr("timeout ".concat(t," of ms exceeded"),Mr.ETIMEDOUT))},t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:o}=n;return o.unsubscribe=()=>Er.asap(i),o}};function En(e,t){this.v=e,this.k=t}function Pn(e){return function(){return new An(e.apply(this,arguments))}}function An(e){var t,r;function n(t,r){try{var s=e[t](r),i=s.value,o=i instanceof En;Promise.resolve(o?i.v:i).then(function(r){if(o){var l="return"===t?"return":"next";if(!i.k||r.done)return n(l,r);r=e[l](r).value}a(s.done?"return":"normal",r)},function(e){n("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,a){return new Promise(function(s,i){var o={key:e,arg:a,resolve:s,reject:i,next:null};r?r=r.next=o:(t=r=o,n(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function Tn(e){return new En(e,0)}function Mn(e){var t={},r=!1;function n(t,n){return r=!0,n=new Promise(function(r){r(e[t](n))}),{done:!1,value:new En(n,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):n("return",e)}),t}function Rn(e){var t,r,n,a=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);a--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new Dn(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Dn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Dn=function(e){this.s=e,this.n=e.next},Dn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new Dn(e)}An.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},An.prototype.next=function(e){return this._invoke("next",e)},An.prototype.throw=function(e){return this._invoke("throw",e)},An.prototype.return=function(e){return this._invoke("return",e)};const In=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let n,a=0;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},Ln=function(){var e=Pn(function*(e,t){var r,n=!1,a=!1;try{for(var s,i=Rn(Fn(e));n=!(s=yield Tn(i.next())).done;n=!1){const e=s.value;yield*Mn(Rn(In(e,t)))}}catch(o){a=!0,r=o}finally{try{n&&null!=i.return&&(yield Tn(i.return()))}finally{if(a)throw r}}});return function(t,r){return e.apply(this,arguments)}}(),Fn=function(){var e=Pn(function*(e){if(e[Symbol.asyncIterator])return void(yield*Mn(Rn(e)));const t=e.getReader();try{for(;;){const{done:e,value:r}=yield Tn(t.read());if(e)break;yield r}}finally{yield Tn(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),Bn=(e,t,r,n)=>{const a=Ln(e,t);let s,i=0,o=e=>{s||(s=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await a.next();if(t)return o(),void e.close();let s=n.byteLength;if(r){let e=i+=s;r(e)}e.enqueue(new Uint8Array(n))}catch(t){throw o(t),t}},cancel:e=>(o(e),a.return())},{highWaterMark:2})},Un="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,zn=Un&&"function"===typeof ReadableStream,Vn=Un&&("function"===typeof TextEncoder?(Hn=new TextEncoder,e=>Hn.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Hn;const Wn=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return!!e(...r)}catch(dU){return!1}},qn=zn&&Wn(()=>{let e=!1;const t=new Request(Zr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Gn=zn&&Wn(()=>Er.isReadableStream(new Response("").body)),$n={stream:Gn&&(e=>e.body)};var Kn;Un&&(Kn=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!$n[e]&&($n[e]=Er.isFunction(Kn[e])?t=>t[e]():(t,r)=>{throw new Mr("Response type '".concat(e,"' is not supported"),Mr.ERR_NOT_SUPPORT,r)})}));const Yn=async(e,t)=>{const r=Er.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Er.isBlob(e))return e.size;if(Er.isSpecCompliantForm(e)){const t=new Request(Zr.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Er.isArrayBufferView(e)||Er.isArrayBuffer(e)?e.byteLength:(Er.isURLSearchParams(e)&&(e+=""),Er.isString(e)?(await Vn(e)).byteLength:void 0)})(t):r},Xn=Un&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:s,timeout:i,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=Sn(e);c=c?(c+"").toLowerCase():"text";let p,m=Cn([a,s&&s.toAbortSignal()],i);const f=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(l&&qn&&"get"!==r&&"head"!==r&&0!==(g=await Yn(d,n))){let e,r=new Request(t,{method:"POST",body:n,duplex:"half"});if(Er.isFormData(n)&&(e=r.headers.get("content-type"))&&d.setContentType(e),r.body){const[e,t]=yn(g,bn(vn(l)));n=Bn(r.body,65536,e,t)}}Er.isString(u)||(u=u?"include":"omit");const a="credentials"in Request.prototype;p=new Request(t,Ie(Ie({},h),{},{signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:a?u:void 0}));let s=await fetch(p,h);const i=Gn&&("stream"===c||"response"===c);if(Gn&&(o||i&&f)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=Er.toFiniteNumber(s.headers.get("content-length")),[r,n]=o&&yn(t,bn(vn(o),!0))||[];s=new Response(Bn(s.body,65536,r,()=>{n&&n(),f&&f()}),e)}c=c||"text";let x=await $n[Er.findKey($n,c)||"text"](s,e);return!i&&f&&f(),await new Promise((t,r)=>{fn(t,r,{data:x,headers:dn.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:p})})}catch(x){if(f&&f(),x&&"TypeError"===x.name&&/Load failed|fetch/i.test(x.message))throw Object.assign(new Mr("Network Error",Mr.ERR_NETWORK,e,p),{cause:x.cause||x});throw Mr.from(x,x&&x.code,e,p)}}),Jn={http:null,xhr:On,fetch:Xn};Er.forEach(Jn,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(dU){}Object.defineProperty(e,"adapterName",{value:t})}});const Qn=e=>"- ".concat(e),Zn=e=>Er.isFunction(e)||null===e||!1===e,ea=e=>{e=Er.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let s=0;s<t;s++){let t;if(r=e[s],n=r,!Zn(r)&&(n=Jn[(t=String(r)).toLowerCase()],void 0===n))throw new Mr("Unknown adapter '".concat(t,"'"));if(n)break;a[t||"#"+s]=n}if(!n){const e=Object.entries(a).map(e=>{let[t,r]=e;return"adapter ".concat(t," ")+(!1===r?"is not supported by the environment":"is not available in the build")});let r=t?e.length>1?"since :\n"+e.map(Qn).join("\n"):" "+Qn(e[0]):"as no adapter specified";throw new Mr("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return n};function ta(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new mn(null,e)}function ra(e){ta(e),e.headers=dn.from(e.headers),e.data=un.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ea(e.adapter||rn.adapter)(e).then(function(t){return ta(e),t.data=un.call(e,e.transformResponse,t),t.headers=dn.from(t.headers),t},function(t){return hn(t)||(ta(e),t&&t.response&&(t.response.data=un.call(e,e.transformResponse,t.response),t.response.headers=dn.from(t.response.headers))),Promise.reject(t)})}const na="1.10.0",aa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{aa[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const sa={};aa.transitional=function(e,t,r){function n(e,t){return"[Axios v"+na+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,a,s)=>{if(!1===e)throw new Mr(n(a," has been removed"+(t?" in "+t:"")),Mr.ERR_DEPRECATED);return t&&!sa[a]&&(sa[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,a,s)}},aa.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};const ia={assertOptions:function(e,t,r){if("object"!==typeof e)throw new Mr("options must be an object",Mr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=t[s];if(i){const t=e[s],r=void 0===t||i(t,s,e);if(!0!==r)throw new Mr("option "+s+" must be "+r,Mr.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new Mr("Unknown option "+s,Mr.ERR_BAD_OPTION)}},validators:aa},oa=ia.validators;class la{constructor(e){this.defaults=e||{},this.interceptors={request:new qr,response:new qr}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(dU){}}throw r}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Nn(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:a}=t;void 0!==r&&ia.assertOptions(r,{silentJSONParsing:oa.transitional(oa.boolean),forcedJSONParsing:oa.transitional(oa.boolean),clarifyTimeoutError:oa.transitional(oa.boolean)},!1),null!=n&&(Er.isFunction(n)?t.paramsSerializer={serialize:n}:ia.assertOptions(n,{encode:oa.function,serialize:oa.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ia.assertOptions(t,{baseUrl:oa.spelling("baseURL"),withXsrfToken:oa.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&Er.merge(a.common,a[t.method]);a&&Er.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=dn.concat(s,a);const i=[];let o=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!o){const e=[ra.bind(this),void 0];for(e.unshift.apply(e,i),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let h=t;for(u=0;u<d;){const e=i[u++],t=i[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{c=ra.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return Wr(jn((e=Nn(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Er.forEach(["delete","get","head","options"],function(e){la.prototype[e]=function(t,r){return this.request(Nn(r||{},{method:e,url:t,data:(r||{}).data}))}}),Er.forEach(["post","put","patch"],function(e){function t(t){return function(r,n,a){return this.request(Nn(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}la.prototype[e]=t(),la.prototype[e+"Form"]=t(!0)});const ca=la;class da{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;const n=new Promise(e=>{r.subscribe(e),t=e}).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e(function(e,n,a){r.reason||(r.reason=new mn(e,n,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new da(function(t){e=t});return{token:t,cancel:e}}}const ua=da;const ha={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ha).forEach(e=>{let[t,r]=e;ha[r]=t});const pa=ha;const ma=function e(t){const r=new ca(t),n=Ht(ca.prototype.request,r);return Er.extend(n,ca.prototype,r,{allOwnKeys:!0}),Er.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return e(Nn(t,r))},n}(rn);ma.Axios=ca,ma.CanceledError=mn,ma.CancelToken=ua,ma.isCancel=hn,ma.VERSION=na,ma.toFormData=Fr,ma.AxiosError=Mr,ma.Cancel=ma.CanceledError,ma.all=function(e){return Promise.all(e)},ma.spread=function(e){return function(t){return e.apply(null,t)}},ma.isAxiosError=function(e){return Er.isObject(e)&&!0===e.isAxiosError},ma.mergeConfig=Nn,ma.AxiosHeaders=dn,ma.formToJSON=e=>en(Er.isHTMLForm(e)?new FormData(e):e),ma.getAdapter=ea,ma.HttpStatusCode=pa,ma.default=ma;const fa={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5001",ga=ma.create({baseURL:fa,headers:{"Content-Type":"application/json"},timeout:6e5,maxContentLength:524288e3,maxBodyLength:524288e3});ga.interceptors.response.use(e=>{if(e.data){const t=JSON.stringify(e.data).length;t>10485760&&console.warn("Large API response: ".concat((t/1048576).toFixed(2)," MB"))}return e},e=>{var t,r;return("ERR_INSUFFICIENT_RESOURCES"===e.code||null!==(t=e.message)&&void 0!==t&&t.includes("out of memory")||null!==(r=e.message)&&void 0!==r&&r.includes("Maximum call stack"))&&(console.error("Response too large for browser to handle:",e),e.message="Response is too large for your browser to handle. Please use debug mode or reduce the date range."),Promise.reject(e)});const xa=async()=>{try{return(await ga.get("/api/mixpanel/debug/sync-ts")).data}catch(e){throw console.error("Error fetching Mixpanel sync timestamp:",e),e}},ba=async()=>{try{return(await ga.post("/api/mixpanel/debug/sync-ts/reset")).data}catch(e){throw console.error("Error resetting Mixpanel sync timestamp:",e),e}},ya=async()=>{try{return(await ga.get("/api/mixpanel/debug/latest-processed-date")).data}catch(e){throw console.error("Error fetching latest processed date:",e),e}},va=async()=>{try{return(await ga.post("/api/mixpanel/debug/database/reset")).data}catch(e){throw console.error("Error resetting Mixpanel database:",e),e}},_a=async()=>{try{return(await ga.post("/api/mixpanel/debug/data/refresh")).data}catch(e){throw console.error("Error refreshing Mixpanel data:",e),e}},ka=async e=>{try{return(await ga.post("/api/mixpanel/process/start",e)).data}catch(t){throw console.error("Error starting Mixpanel processing:",t),t}},ja=async()=>{try{return(await ga.get("/api/mixpanel/process/status")).data}catch(e){throw console.error("Error fetching process status:",e),e}},wa=async()=>{try{return(await ga.post("/api/mixpanel/process/cancel")).data}catch(e){throw console.error("Error canceling processing:",e),e}},Na=async e=>{try{return(await ga.get("/api/mixpanel/debug/test-db-events",{params:e?{distinct_id:e}:{}})).data}catch(t){throw console.error("Error fetching test DB events:",t),t}},Sa=async e=>{try{return(await ga.post("/api/meta/fetch",e)).data}catch(t){throw console.error("Error fetching Meta API data:",t),t}},Oa=async e=>{try{return(await ga.get("/api/meta/job/".concat(e,"/status"))).data}catch(t){throw console.error("Error checking Meta job status:",t),t}},Ca=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return(await ga.get("/api/meta/job/".concat(e,"/results"),{params:{use_file_url:t}})).data}catch(r){throw console.error("Error getting Meta job results:",r),r}},Ea=async e=>{try{return(await ga.post("/api/cohort-analysis",e)).data}catch(n){var t,r;throw console.error("Error analyzing cohort data:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message),(null===(r=n.response)||void 0===r?void 0:r.data)||n}},Pa=async e=>{try{console.log("[V3-Refactored] Sending cohort analysis request to V3 Refactored API:",e);const t=await ga.post("/api/v3/cohort/analyze-refactored",e);return console.log("[V3-Refactored] Received response from V3 Refactored API:",t.data),t.data}catch(n){var t,r;throw console.error("Error analyzing cohort data with V3 Refactored API:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message),(null===(r=n.response)||void 0===r?void 0:r.data)||n}},Aa=async(e,t)=>{try{console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80 [V3-REFACTORED API] CALLING runV3RefactoredStageAnalysis for stage: ".concat(t)),console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80 [V3-REFACTORED API] Will POST to: /api/v3/cohort/analyze-refactored"),console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80 [V3-REFACTORED API] Filters:",e);const r=Ie(Ie({},e),{},{debug_mode:!0,debug_stage:t,pipeline_version:"3.0.0_refactored"});console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80 [V3-REFACTORED API] Final payload:",r);const n=await ga.post("/api/v3/cohort/analyze-refactored",r);return console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80 [V3-REFACTORED API] SUCCESS! Received response:",n.data),n.data}catch(a){var r,n;throw console.error("\ud83d\udea8\ud83d\udea8\ud83d\udea8 [V3-REFACTORED API] ERROR in stage ".concat(t," analysis:"),(null===(r=a.response)||void 0===r?void 0:r.data)||a.message),(null===(n=a.response)||void 0===n?void 0:n.data)||a}},Ta=async e=>{try{console.log("[DEBUG] getCohortUserTimeline called with filters:",e);const t=e.optional_filters||[];let r={},n=[];if(t.length>0){const e=t.filter(e=>"user"===e.property_source),a=t.filter(e=>"event"===e.property_source);r=e.length>0?e[0]:{},n=a}else r=e.primary_user_filter||{},n=e.secondary_filters||[];const a={date_from:e.date_from_str,date_to:e.date_to_str,primary_user_filter:r,secondary_filters:n,config:{}};console.log("[DEBUG] getCohortUserTimeline sending payload:",a);const s=await ga.post("/api/cohort-pipeline/timeline",a);return console.log("[DEBUG] getCohortUserTimeline received response:",s.data),s.data}catch(n){var t,r;throw console.error("Error fetching cohort user timeline:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message),console.error("[DEBUG] getCohortUserTimeline full error:",n),(null===(r=n.response)||void 0===r?void 0:r.data)||n}},Ma=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var n;console.log("[DEBUG] getUserEventRevenueTimeline called with filters:",e,"distinctId:",t,"productId:",r);const a={date_from_str:e.date_from_str,date_to_str:e.date_to_str,user_filters:[]};e.optional_filters&&e.optional_filters.length>0?a.user_filters=e.optional_filters.filter(e=>"user"===e.property_source):e.primary_user_filter&&e.primary_user_filter.property_name&&(a.user_filters=[{property_name:e.primary_user_filter.property_name,property_values:e.primary_user_filter.property_values,property_source:"user"}]),t&&(a.distinct_id=t),r&&(a.product_id=r),console.log("[DEBUG] getUserEventRevenueTimeline sending V3 payload:",a);const s=await ga.post("/api/v3/cohort/analyze-refactored",a);console.log("[DEBUG] getUserEventRevenueTimeline received V3 response:",s.data);const i=s.data,o=null===i||void 0===i||null===(n=i.stage_results)||void 0===n?void 0:n.stage3;if(!o||!o.timeline_results)throw new Error("Invalid V3 response format");const l=o.timeline_results,c={dates:l.dates||[],event_rows:{},estimate_rows:{},arpc_per_product:l.arpc_per_product||{},available_users:Object.keys(l.user_daily_metrics||{}),available_products:l.available_products||[]};l.timeline_data&&c.dates.forEach(e=>{const t=l.timeline_data[e]||{};c.event_rows.trial_started||(c.event_rows.trial_started={}),c.event_rows.trial_pending||(c.event_rows.trial_pending={}),c.event_rows.trial_ended||(c.event_rows.trial_ended={}),c.event_rows.trial_converted||(c.event_rows.trial_converted={}),c.event_rows.trial_canceled||(c.event_rows.trial_canceled={}),c.event_rows.initial_purchase||(c.event_rows.initial_purchase={}),c.event_rows.subscription_active||(c.event_rows.subscription_active={}),c.event_rows.subscription_cancelled||(c.event_rows.subscription_cancelled={}),c.event_rows.refund||(c.event_rows.refund={}),c.event_rows.trial_started[e]=t.trial_started||0,c.event_rows.trial_pending[e]=t.trial_pending||0,c.event_rows.trial_ended[e]=t.trial_ended||0,c.event_rows.trial_converted[e]=t.trial_converted||0,c.event_rows.trial_canceled[e]=t.trial_cancelled||0,c.event_rows.initial_purchase[e]=t.initial_purchase||0,c.event_rows.subscription_active[e]=t.subscription_active||0,c.event_rows.subscription_cancelled[e]=t.subscription_cancelled||0,c.event_rows.refund[e]=t.refund_count||0,c.estimate_rows.current_revenue||(c.estimate_rows.current_revenue={}),c.estimate_rows.estimated_revenue||(c.estimate_rows.estimated_revenue={}),c.estimate_rows.estimated_net_revenue||(c.estimate_rows.estimated_net_revenue={}),c.estimate_rows.current_revenue[e]=t.revenue||0,c.estimate_rows.estimated_revenue[e]=t.estimated_revenue||0,c.estimate_rows.estimated_net_revenue[e]=t.estimated_revenue||0}),c.event_rows.cumulative_initial_purchase={};let d=0;return c.dates.forEach(e=>{d+=c.event_rows.initial_purchase[e]||0,c.event_rows.cumulative_initial_purchase[e]=d}),console.log("[DEBUG] getUserEventRevenueTimeline converted to legacy format:",c),c}catch(a){throw console.error("getUserEventRevenueTimeline error:",a),a}},Ra=async()=>{try{return(await ga.get("/api/cohort_analyzer/discoverable_properties")).data}catch(r){var e,t;throw console.error("Error fetching discoverable cohort properties:",(null===(e=r.response)||void 0===e?void 0:e.data)||r.message),(null===(t=r.response)||void 0===t?void 0:t.data)||r}},Da=async(e,t)=>{try{return(await ga.get("/api/cohort_analyzer/property_values",{params:{property_key:e,property_source:t}})).data}catch(a){var r,n;throw console.error("Error fetching values for ".concat(e," (").concat(t,"):"),(null===(r=a.response)||void 0===r?void 0:r.data)||a.message),(null===(n=a.response)||void 0===n?void 0:n.data)||a}},Ia=async()=>{try{return(await ga.post("/api/cohort_analyzer/trigger_discovery")).data}catch(r){var e,t;throw console.error("Error triggering cohort property discovery:",(null===(e=r.response)||void 0===e?void 0:e.data)||r.message),(null===(t=r.response)||void 0===t?void 0:t.data)||r}},La=async()=>{try{return(await ga.post("/api/cohort_analyzer/enable_properties")).data}catch(r){var e,t;throw console.error("Error enabling cohort properties:",(null===(e=r.response)||void 0===e?void 0:e.data)||r.message),(null===(t=r.response)||void 0===t?void 0:t.data)||r}},Fa=async()=>{try{return(await ga.get("/api/cohort_analyzer/discovery_status")).data}catch(r){var e,t;throw console.error("Error checking property discovery status:",(null===(e=r.response)||void 0===e?void 0:e.data)||r.message),(null===(t=r.response)||void 0===t?void 0:t.data)||r}},Ba=async()=>{try{return(await ga.get("/api/mixpanel/debug/database-stats")).data}catch(e){throw console.error("Error fetching Mixpanel database statistics:",e),e}},Ua=async e=>{try{return(await ga.get("/api/mixpanel/debug/user-events",{params:{user_id:e}})).data}catch(t){throw console.error("Error fetching user events:",t),t}},za=async e=>{try{return(await ga.post("/api/meta/historical/start",e)).data}catch(t){throw console.error("Error starting historical collection:",t),t}},Va=async e=>{try{return(await ga.get("/api/meta/historical/jobs/".concat(e,"/status"))).data}catch(t){throw console.error("Error getting job status:",t),t}},Ha=async e=>{try{return(await ga.post("/api/meta/historical/jobs/".concat(e,"/cancel"))).data}catch(t){throw console.error("Error cancelling job:",t),t}},Wa=async e=>{try{return(await ga.get("/api/meta/historical/coverage",{params:e})).data}catch(t){throw console.error("Error getting data coverage:",t),t}},qa=async e=>{try{return(await ga.get("/api/meta/historical/missing-dates",{params:e})).data}catch(t){throw console.error("Error getting missing dates:",t),t}},Ga=async e=>{try{return(await ga.delete("/api/meta/historical/configurations/".concat(e))).data}catch(t){throw console.error("Error deleting historical configuration:",t),t}},$a=async()=>{try{return(await ga.get("/api/meta/historical/configurations")).data}catch(e){throw console.error("Error getting configurations:",e),e}},Ka=async e=>{try{return(await ga.get("/api/meta/historical/export",{params:e})).data}catch(t){throw console.error("Error exporting data:",t),t}},Ya=async()=>{try{return(await ga.get("/api/meta/action-mappings")).data}catch(e){throw console.error("Error getting action mappings:",e),e}},Xa=async e=>{try{return(await ga.post("/api/meta/action-mappings",{mappings:e})).data}catch(t){throw console.error("Error saving action mappings:",t),t}},Ja=async()=>{try{return(await ga.get("/api/meta/historical/tables/overview")).data}catch(e){throw console.error("Error getting tables overview:",e),e}},Qa=async e=>{try{return(await ga.get("/api/meta/historical/tables/".concat(e,"/aggregated"))).data}catch(t){throw console.error("Error getting aggregated data for ".concat(e,":"),t),t}},Za=async e=>{try{return(await ga.post("/api/meta/update-table",e)).data}catch(t){throw console.error("Error updating Meta table:",t),t}},es=async(e,t)=>{try{return(await ga.delete("/api/meta/historical/tables/".concat(e,"/date/").concat(t))).data}catch(r){throw console.error("Error deleting date ".concat(t," from table ").concat(e,":"),r),r}},ts=e=>{try{return"undefined"!==typeof window&&window.localStorage?localStorage.getItem(e):null}catch(t){return console.error("Error accessing localStorage:",t),null}},rs=()=>{const[e,t]=(0,s.useState)(""),[r,n]=(0,s.useState)(null),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)({stage:null,percent:0,currentDate:null}),[p,m]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,b]=(0,s.useState)(null),[y,v]=(0,s.useState)([]),[_,k]=(0,s.useState)({totalEvents:0,totalUsers:0,eventBreakdown:[],monthlyBreakdown:[],dailyBreakdown:[],dateRange:{earliest:null,latest:null}}),[j,w]=(0,s.useState)(!1),[N,S]=(0,s.useState)(""),[O,C]=(0,s.useState)([]),[E,P]=(0,s.useState)(!1),[A,T]=(0,s.useState)(null),[M,R]=(0,s.useState)(!1),[D,I]=(0,s.useState)(null),[L,F]=(0,s.useState)(null),[B,U]=(0,s.useState)(!1),[z,V]=(0,s.useState)(null),[H,W]=(0,s.useState)(null),[q,G]=(0,s.useState)(null),[$,K]=(0,s.useState)(!1),[Y,X]=(0,s.useState)(null),J=(0,s.useCallback)(async()=>{try{const e=await xa();n(e.last_load_timestamp)}catch(e){console.error("Error fetching last load timestamp:",e)}},[]),Q=(0,s.useCallback)(async()=>{try{const e=await ja();h({stage:e.current_stage,percent:e.percent_complete,currentDate:e.current_date}),e.is_complete?(i(!1),l("Processing complete!"),J()):e.error&&(i(!1),d(e.error))}catch(e){console.error("Error checking process status:",e)}},[J]);(0,s.useEffect)(()=>{const e=ts("mixpanelRequestHistory");if(e)try{v(JSON.parse(e))}catch(dU){console.error("Error parsing request history:",dU),v([])}J();const t=setInterval(()=>{a&&Q()},3e3);return()=>clearInterval(t)},[a,Q,J]);const Z=e=>"number"===typeof e||e?new Date(e).toLocaleString():"Never";(0,s.useEffect)(()=>{ee()},[]);const ee=async()=>{w(!0);try{const e=await Ba();k(e)}catch(e){console.error("Error fetching database stats:",e)}finally{w(!1)}};return(0,ut.jsxs)("div",{className:"flex",children:[(0,ut.jsxs)("div",{className:"w-64 bg-gray-50 dark:bg-gray-800 p-4 border-r min-h-[calc(100vh-10rem)] overflow-y-auto",children:[(0,ut.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Processing History"}),0===y.length?(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No processing history"}):(0,ut.jsx)("ul",{className:"space-y-2",children:y.map(e=>(0,ut.jsxs)("li",{className:"p-2 border rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,ut.jsxs)("div",{className:"text-sm font-medium",children:[e.startDate," to ",e.endDate]}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Z(e.timestamp)})]},e.id))})]}),(0,ut.jsxs)("div",{className:"flex-1 p-6 max-w-5xl",children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Mixpanel Data Processor"}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Process Mixpanel Data"}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:["Last full load: ",r?Z(r):"Never"]}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",htmlFor:"start_date_input",children:["Start Date (YYYY-MM-DD)",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("input",{type:"text",id:"start_date_input",value:e,onChange:e=>t(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 2023-05-01",required:!0,disabled:a}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Data will be processed from this date until today"})]}),(0,ut.jsxs)("div",{className:"flex space-x-4",children:[(0,ut.jsx)("button",{type:"button",onClick:async()=>{if(e){i(!0),l(null),d(null),h({stage:"initializing",percent:0,currentDate:null});try{const t=await ka({start_date:e,wipe_folder:!0});if(!t.success)throw new Error(t.error||"Failed to start processing");l("Processing started successfully")}catch(t){d(t.message||"An unknown error occurred"),i(!1)}}else d("Start date is required")},disabled:a||!e,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:a?"Processing...":"Start Processing"}),(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsx)("button",{type:"button",onClick:async()=>{K(!0),X(null),d(null),l(null);try{const e=await ya();if(!e.has_processed_dates)return X('No processed dates found. Please use the regular "Start Processing" with a start date.'),void K(!1);if(!e.next_date_to_process)return X("Unable to determine next date to process."),void K(!1);G(e.latest_processed_date),i(!0),l(null),d(null),X(null),h({stage:"initializing",percent:0,currentDate:null});const t=await ka({start_date:e.next_date_to_process,wipe_folder:!0});if(!t.success)throw new Error(t.error||"Failed to start processing");l("Processing started from ".concat(e.next_date_to_process," (continuing after ").concat(e.latest_processed_date,")"))}catch(e){X(e.message||"An unknown error occurred"),i(!1)}finally{K(!1)}},disabled:a||$,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400",children:$?"Loading...":"Continue from Last Date"}),(0,ut.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Automatically continues processing from the day after the last successfully processed date"})]}),a&&(0,ut.jsx)("button",{type:"button",onClick:async()=>{try{await wa(),i(!1),l("Processing canceled")}catch(e){d(e.message||"Failed to cancel processing")}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Cancel Processing"}),(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsx)("button",{type:"button",onClick:async()=>{l(null),d(null);try{const e=await ba();l(e.message),n(null)}catch(e){d(e.message||"An unknown error occurred")}},disabled:a||!r,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:bg-gray-400",children:"Reset Last Sync Counter"}),(0,ut.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Resets the timestamp tracking when data was last processed, allowing re-processing of all dates"})]}),(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsx)("button",{type:"button",onClick:async()=>{if(window.confirm("Are you sure you want to refresh all data? This will delete all downloaded files in the data/events and data/users directories. You will need to re-download data after this action.")){U(!0),V(null),W(null),l(null),d(null);try{const e=await _a();V(e.message)}catch(e){W(e.message||"An unknown error occurred")}finally{U(!1)}}},disabled:a||B,className:"px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:bg-gray-400",children:B?"Refreshing...":"Refresh Data"}),(0,ut.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Deletes all downloaded files in data/events and data/users directories"})]}),(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsx)("button",{type:"button",onClick:async()=>{if(window.confirm("Are you sure you want to reset ALL Mixpanel data in the database? This action cannot be undone and will delete all events, users, and processing history.")){R(!0),I(null),F(null),l(null),d(null);try{const e=await va();I(e.message),n(null),ee()}catch(e){F(e.message||"An unknown error occurred")}finally{R(!1)}}},disabled:a||M,className:"px-4 py-2 bg-red-800 text-white rounded hover:bg-red-900 disabled:bg-gray-400",children:M?"Resetting...":"Reset All Data"}),(0,ut.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Completely wipes all data from the database including events, users, and processing history"})]})]})]}),a&&(0,ut.jsxs)("div",{className:"mt-6",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:(()=>{switch(u.stage){case"download":return"Downloading data";case"extract":return"Extracting data";case"filter":return"Filtering data";case"ingest":return"Ingesting data";case"initializing":return"Initializing";default:return"Processing"}})()}),(0,ut.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2",children:(0,ut.jsx)("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:"".concat(u.percent,"%")}})}),(0,ut.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,ut.jsxs)("span",{children:[u.percent,"% complete"]}),u.currentDate&&(0,ut.jsxs)("span",{children:["Current date: ",u.currentDate]})]})]}),o&&!c&&!a&&(0,ut.jsx)("div",{className:"mt-4 p-3 bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-100 rounded",children:o}),c&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",c]}),D&&(0,ut.jsx)("div",{className:"mt-4 p-3 bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-100 rounded",children:D}),L&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",L]}),z&&(0,ut.jsx)("div",{className:"mt-4 p-3 bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-100 rounded",children:z}),H&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",H]}),Y&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",Y]})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test Database"}),(0,ut.jsx)("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-300",children:'This will find 3 random users who did the "RC Trial started" event and have their abi_ad_id set.'}),(0,ut.jsx)("button",{type:"button",onClick:async()=>{m(!0),g(null),b(null);try{const e=await Na();g(e)}catch(e){b(e.message||"An unknown error occurred")}finally{m(!1)}},disabled:p,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:p?"Testing...":"Test DB"}),x&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",x]}),f&&(0,ut.jsxs)("div",{className:"mt-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Test Results"}),f.map((e,t)=>(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-900 p-4 rounded mb-4",children:[(0,ut.jsxs)("h4",{className:"font-bold text-lg mb-2",children:["User ",t+1]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,ut.jsx)("div",{className:"font-semibold",children:"Name:"}),(0,ut.jsx)("div",{children:e.name}),(0,ut.jsx)("div",{className:"font-semibold",children:"Distinct ID:"}),(0,ut.jsx)("div",{children:e.distinct_id}),(0,ut.jsx)("div",{className:"font-semibold",children:"Ad ID:"}),(0,ut.jsx)("div",{children:e.abi_ad_id}),(0,ut.jsx)("div",{className:"font-semibold",children:"Event:"}),(0,ut.jsx)("div",{children:e.event_name})]}),(0,ut.jsxs)("div",{className:"mt-2",children:[(0,ut.jsx)("div",{className:"font-semibold mb-1",children:"Event Properties:"}),(0,ut.jsx)("pre",{className:"bg-gray-200 dark:bg-gray-800 p-2 rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e.event_properties,null,2)})]})]},t))]})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"User Event History"}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",htmlFor:"user_id_input",children:["User ID",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsxs)("div",{className:"flex",children:[(0,ut.jsx)("input",{type:"text",id:"user_id_input",value:N,onChange:e=>S(e.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"Enter user ID or distinct ID",required:!0}),(0,ut.jsx)("button",{type:"button",onClick:async()=>{if(N.trim()){P(!0),C([]),T(null);try{const e=(await Ua(N.trim())).sort((e,t)=>e.time-t.time);C(e)}catch(e){T(e.message||"Failed to fetch user events")}finally{P(!1)}}else T("User ID is required")},disabled:E||!N.trim(),className:"ml-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:E?"Loading...":"Search"})]})]}),A&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",A]}),E&&(0,ut.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500",children:"Loading user events..."})}),!E&&O.length>0&&(0,ut.jsxs)("div",{className:"mt-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Event Timeline for User"}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Time"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Event Name"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Details"})]})}),(0,ut.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:O.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white dark:bg-gray-700":"bg-gray-50 dark:bg-gray-800",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:new Date(e.time).toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.name}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:(0,ut.jsx)("button",{className:"text-blue-500 hover:text-blue-700",onClick:()=>{alert(JSON.stringify(e.properties,null,2))},children:"View Properties"})})]},t))})]})})]}),!E&&0===O.length&&N&&!A&&(0,ut.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500",children:"No events found for this user"})})]}),(0,ut.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold",children:"Database Statistics"}),(0,ut.jsx)("button",{onClick:ee,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",disabled:j,children:j?"Loading...":"Refresh"})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded border border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:"Total Events"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:_.totalEvents.toLocaleString()})]}),(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded border border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:"Total Users"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:_.totalUsers.toLocaleString()})]})]}),_.dateRange&&(_.dateRange.earliest||_.dateRange.latest)&&(0,ut.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 rounded border border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2 text-blue-800 dark:text-blue-200",children:"Data Range"}),(0,ut.jsxs)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("p",{children:["Earliest Event: ",_.dateRange.earliest?new Date(_.dateRange.earliest).toLocaleString():"N/A"]}),(0,ut.jsxs)("p",{children:["Latest Event: ",_.dateRange.latest?new Date(_.dateRange.latest).toLocaleString():"N/A"]})]})]}),_.monthlyBreakdown&&_.monthlyBreakdown.length>0&&(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:"Monthly Breakdown"}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded overflow-hidden",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Month"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Events"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Users"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Event Types"})]})}),(0,ut.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:_.monthlyBreakdown.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white dark:bg-gray-700":"bg-gray-50 dark:bg-gray-800",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200 font-medium",children:e.month}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.events.toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.users.toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.uniqueEvents})]},t))})]})})]}),_.dailyBreakdown&&_.dailyBreakdown.length>0&&(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:"Daily Breakdown (Last 30 Days)"}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded overflow-hidden max-h-96 overflow-y-auto",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Events"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Users"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Event Types"})]})}),(0,ut.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:_.dailyBreakdown.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white dark:bg-gray-700":"bg-gray-50 dark:bg-gray-800",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200 font-medium",children:e.date}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.events.toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.users.toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.uniqueEvents})]},t))})]})})]}),_.eventBreakdown&&_.eventBreakdown.length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-md font-medium mb-2",children:"Event Breakdown"}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded overflow-hidden",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Event Name"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Count"}),(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Percentage"})]})}),(0,ut.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:_.eventBreakdown.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white dark:bg-gray-700":"bg-gray-50 dark:bg-gray-800",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.name}),(0,ut.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:e.count.toLocaleString()}),(0,ut.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-200",children:[(e.count/_.totalEvents*100).toFixed(2),"%"]})]},t))})]})})]})]})]})]})},ns={os_ios:{label:"iOS",filterValues:["iphone","ipad"]},os_and:{label:"Android",filterValues:["android_smartphone","android_tablet"]}},as=[{name:"Basic Ad Data",fields:[{id:"ad_id",label:"Ad ID"},{id:"ad_name",label:"Ad Name"},{id:"adset_id",label:"Adset ID"},{id:"adset_name",label:"Adset Name"},{id:"campaign_id",label:"Campaign ID"},{id:"campaign_name",label:"Campaign Name"},{id:"impressions",label:"Impressions"},{id:"clicks",label:"Clicks"},{id:"spend",label:"Spend"}]},{name:"Reach & Frequency",fields:[{id:"reach",label:"Reach"},{id:"frequency",label:"Frequency"},{id:"unique_clicks",label:"Unique Clicks"},{id:"unique_ctr",label:"Unique CTR"}]},{name:"Cost Efficiency",fields:[{id:"cpc",label:"CPC"},{id:"cpm",label:"CPM"},{id:"cpp",label:"Cost per 1 000 People Reached"},{id:"cost_per_conversion",label:"Cost Per Conversion",isActionMetric:!0},{id:"purchase_roas",label:"Purchase ROAS",isActionMetric:!0},{id:"mobile_app_purchase_roas",label:"Mobile App Purchase ROAS",isActionMetric:!0}]},{name:"Conversion Detail",fields:[{id:"actions",label:"Actions",isActionMetric:!0},{id:"action_values",label:"Action Values",isActionMetric:!0},{id:"conversions",label:"Conversions",isActionMetric:!0},{id:"conversion_values",label:"Conversion Values",isActionMetric:!0}]},{name:"Video Engagement",fields:[{id:"video_30_sec_watched_actions",label:"Video 30s Watched"},{id:"video_avg_percent_watched_actions",label:"Video Avg % Watched"},{id:"video_thruplay_watched_actions",label:"Video Thruplay Watched"}]},{name:"Click Nuance",fields:[{id:"inline_link_clicks",label:"Inline Link Clicks"},{id:"outbound_clicks",label:"Outbound Clicks"},{id:"website_ctr",label:"Website CTR"}]},{name:"Ad Recall & Quality",fields:[{id:"estimated_ad_recallers",label:"Est. Ad Recallers"},{id:"estimated_ad_recall_rate",label:"Est. Ad Recall Rate"},{id:"quality_ranking",label:"Quality Ranking"},{id:"engagement_rate_ranking",label:"Engagement Rate Ranking"},{id:"conversion_rate_ranking",label:"Conversion Rate Ranking"}]},{name:"Context & Meta",fields:[{id:"account_currency",label:"Account Currency"},{id:"buying_type",label:"Buying Type"},{id:"objective",label:"Objective"},{id:"labels",label:"Labels"}]}],ss=["country","region","dma"],is=["device_platform","impression_device","os_ios","os_and"],os=["publisher_platform","platform_position","placement"],ls=["hourly_stats_aggregated_by_advertiser_time_zone","hourly_stats_aggregated_by_audience_time_zone"],cs=["image_asset","video_asset","title_asset","body_asset","call_to_action_asset","link_url_asset"],ds=as.flatMap(e=>e.fields).filter(e=>e.isActionMetric).map(e=>e.id),us=["impressions","clicks","spend","reach"],hs=["conversion_destination","country","region"],ps=[["age","gender"],["country","publisher_platform"],["device_platform","publisher_platform"],["publisher_platform","platform_position"],["impression_device","country"]],ms=[{name:"Geography",group:ss,breakdowns:[{id:"country",label:"Country"},{id:"region",label:"Region"},{id:"dma",label:"DMA"}]},{name:"Demographics",breakdowns:[{id:"age",label:"Age"},{id:"gender",label:"Gender"}]},{name:"Time-of-day",group:ls,breakdowns:[{id:"hourly_stats_aggregated_by_advertiser_time_zone",label:"Advertiser Timezone"},{id:"hourly_stats_aggregated_by_audience_time_zone",label:"Audience Timezone"}]},{name:"Device / OS",group:is,breakdowns:[{id:"impression_device",label:"Impression Device"},{id:"device_platform",label:"Device Platform"},{id:"os_ios",label:"iOS"},{id:"os_and",label:"Android"}]},{name:"Placement",group:os,breakdowns:[{id:"publisher_platform",label:"Publisher Platform"},{id:"platform_position",label:"Platform Position"},{id:"placement",label:"Placement"}]},{name:"Creative Assets",group:cs,breakdowns:[{id:"image_asset",label:"Image Asset"},{id:"video_asset",label:"Video Asset"},{id:"title_asset",label:"Title Asset"},{id:"body_asset",label:"Body Asset"},{id:"call_to_action_asset",label:"CTA Asset"},{id:"link_url_asset",label:"Link URL Asset"}]},{name:"Commerce / SKAd",breakdowns:[{id:"product_id",label:"Product ID"},{id:"skan_conversion_id",label:"SKAN Conversion ID"}]},{name:"Others",breakdowns:[{id:"landing_destination",label:"Landing Destination"},{id:"conversion_destination",label:"Conversion Destination",isActionBreakdown:!0}]}],fs=e=>"os_ios"===e||"os_and"===e,gs=e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t,r]=e;return r})),xs=(e,t)=>{const r=Object.entries(e).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}),n=Object.entries(t).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}).sort(),a=r.some(e=>ds.includes(e)),s=[];let i=!0;if(n.length>2&&(s.push("Maximum of 2 breakdowns allowed"),i=!1),a&&(n.length>1&&(s.push("When using action metrics, you can select at most 1 breakdown because Meta adds 'action_type' as an implicit breakdown"),i=!1),1!==n.length||hs.includes(n[0])||(s.push("'".concat(n[0],"' is no longer valid. Use one of: ")+hs.join(", ")),i=!1)),2===n.length){const[e,t]=n,a=r.length>0&&r.every(e=>us.includes(e)),o=ps.some(r=>r[0]===e&&r[1]===t||r[1]===e&&r[0]===t);let l=!1;(ls.includes(e)||ls.includes(t))&&(s.push("Hourly breakdowns must stand alone"),i=!1,l=!0),l||o||((ss.includes(e)&&ss.includes(t)||is.includes(e)&&is.includes(t)||os.includes(e)&&os.includes(t)||!a&&cs.includes(e)&&cs.includes(t))&&(s.push("Cannot select multiple breakdowns from the same group (".concat(e,", ").concat(t,") unless explicitly allowed in VALID_PAIRS.")),i=!1,l=!0),l||(s.push("The combination of '".concat(e,"' and '").concat(t,"' is not supported by Meta.")),i=!1))}return{valid:i,errors:s}},bs=(e,t,r)=>{if(r[e])return!1;const n=Object.entries(t).some(e=>{let[t,r]=e;return r&&ds.includes(t)});if(n){if(!hs.includes(e))return!0;if(Object.values(r).filter(Boolean).length>=1)return!0}const a=Object.entries(r).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}).sort();if(a.some(fs)&&fs(e)&&!a.includes(e))return!0;if(a.length>=2)return!0;if(Object.entries(t).some(e=>{let[t,r]=e;return r&&ds.includes(t)})){if(!hs.includes(e))return!0;if(a.length>=1)return!0}if(0===a.length)return!1;const s=a[0];if(ss.includes(s)&&ss.includes(e)||is.includes(s)&&is.includes(e)||os.includes(s)&&os.includes(e)||ls.includes(s)&&ls.includes(e)||cs.includes(s)&&cs.includes(e))return!0;if(ls.includes(s)&&!ls.includes(e)||ls.includes(e)&&!ls.includes(s))return!0;return!ps.some(t=>t[0]===s&&t[1]===e||t[1]===s&&t[0]===e)},ys=(e,t,r)=>{const n=Ie({},r);n[e]=!0;const a=xs(t,n);return a.valid?"":a.errors[0]},vs=e=>Object.entries(e).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}).join(","),_s=e=>Object.entries(e).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}).join(","),ks=e=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const[t,r,n]=e.split("-").map(Number),a=new Date(t,r-1,n);return a.getFullYear()===t&&a.getMonth()===r-1&&a.getDate()===n},js=()=>{try{const e=localStorage.getItem("meta_action_mappings");return e?JSON.parse(e):{}}catch(e){return console.error("Error loading action mappings:",e),{}}},ws=(e,t)=>Array.isArray(e)&&Array.isArray(t)?e.filter(e=>t.includes(e.action_type)).map(e=>parseFloat(e.value)||0):[],Ns=(e,t)=>{if(!Array.isArray(e)||0===e.length)return 0;switch(t){case"sum":default:return e.reduce((e,t)=>e+t,0);case"count":return e.length;case"average":return e.reduce((e,t)=>e+t,0)/e.length}},Ss=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Array.isArray(e)?(t||(t=js()),e.map(e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=js());const r=Ie({},e);return Object.entries(t).forEach(t=>{let[n,a]=t;const{actionTypes:s,aggregationType:i}=a,o=ws(e.actions,s);r["".concat(n,"_count")]=Ns(o,i);const l=ws(e.action_values,s);r["".concat(n,"_value")]=Ns(l,i);const c=ws(e.conversions,s);r["".concat(n,"_conversions")]=Ns(c,i);const d=ws(e.conversion_values,s);r["".concat(n,"_conversion_value")]=Ns(d,i),r["".concat(n,"_breakdown")]={count:o,value:l,conversions:c,conversion_value:d}}),r}(e,t))):e},Os=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Array.isArray(e)||0===e.length)return{};t||(t=js());const r={};return Object.keys(t).forEach(t=>{const n=e.map(e=>e["".concat(t,"_count")]||0),a=e.map(e=>e["".concat(t,"_value")]||0),s=e.map(e=>e["".concat(t,"_conversions")]||0),i=e.map(e=>e["".concat(t,"_conversion_value")]||0);r[t]={total_count:n.reduce((e,t)=>e+t,0),total_value:a.reduce((e,t)=>e+t,0),total_conversions:s.reduce((e,t)=>e+t,0),total_conversion_value:i.reduce((e,t)=>e+t,0),avg_count:n.reduce((e,t)=>e+t,0)/n.length,avg_value:a.reduce((e,t)=>e+t,0)/a.length,records_with_data:e.filter(e=>(e["".concat(t,"_count")]||0)>0).length}}),r},Cs=e=>{var t,r,n,a,i,o,l,c;let{startDateInput:d,setStartDateInput:u,endDateInput:h,setEndDateInput:p,incrementInput:m,setIncrementInput:f,selectedFields:g,setSelectedFields:x,selectedBreakdowns:b,setSelectedBreakdowns:y,error:v,setError:_}=e;const[k,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)({stage:"",pagesLoaded:0,percentage:0}),[S,O]=(0,s.useState)(null),[C,E]=(0,s.useState)(null),[P,A]=(0,s.useState)(null),[T,M]=(0,s.useState)(!1),[R,D]=(0,s.useState)(!1),[I,L]=(0,s.useState)(!0),[F,B]=(0,s.useState)({});(0,s.useEffect)(()=>{const e=js();B(e)},[]);const U=e=>Array.isArray(e)?e.map(e=>{const t=Ie({},e);return["actions","action_values","conversions","conversion_values"].forEach(e=>{t[e]&&Array.isArray(t[e])&&(t[e+"_formatted"]=t[e].reduce((e,t)=>(e[t.action_type]=t.value,e),{}))}),t}):e;(0,s.useEffect)(()=>{const e=Object.entries(g).some(e=>{let[t,r]=e;return r&&ds.includes(t)});if(e){const e=Object.entries(b).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return t}).sort();if(e.length>1){const t=Ie({},b);let r=!1;e.forEach(e=>{hs.includes(e)&&!r?r=!0:t[e]=!1}),y(t),_("Some breakdowns were deselected because with action metrics, at most one breakdown is allowed"),setTimeout(()=>_(null),5e3)}else if(1===e.length&&!hs.includes(e[0])){const t=Ie({},b);t[e[0]]=!1,y(t),_("Selected breakdown '".concat(e[0],"' was deselected because it's incompatible with action metrics")),setTimeout(()=>_(null),5e3)}}},[g,b,y,_]);(0,s.useEffect)(()=>()=>{P&&clearInterval(P)},[P]);const z=async e=>{try{const t=await Oa(e);if(N(e=>Ie(Ie({},e),{},{stage:"Processing in Meta servers... (".concat(t.async_status,")"),percentage:t.async_percent_completion||0})),"Job Completed"===t.async_status){N(e=>Ie(Ie({},e),{},{stage:"Fetching results...",percentage:100}));const t=await Ca(e);if(t.data&&t.data.data){const e=Ss(t.data.data,F),r=Os(e,F);O(Ie(Ie({},t),{},{data:Ie(Ie({},t.data),{},{data:e,business_summary:r})}))}else O(t);P&&(clearInterval(P),A(null)),j(!1),E(null)}else"Job Failed"===t.async_status&&(_("Meta API job failed. Please try again."),P&&(clearInterval(P),A(null)),j(!1),E(null))}catch(t){if(console.error("Error polling job status:",t),S&&S.data)return console.log("Job status check failed but we already have results - stopping polling"),P&&(clearInterval(P),A(null)),j(!1),void E(null);_("Error checking job status: "+(t.message||"Unknown error")),P&&(clearInterval(P),A(null)),j(!1),E(null)}},V=async e=>{if(d&&h)if(ks(d)&&ks(h)){j(!0),_(null),O(null),E(null),N({stage:"Initializing predefined request...",pagesLoaded:0,percentage:0});try{let r;"country"===e?r={start_date:d,end_date:h,time_increment:parseInt(m,10)||1,fields:"ad_id,ad_name,adset_id,adset_name,campaign_id,campaign_name,impressions,clicks,spend,actions",breakdowns:"country"}:"device"===e?r={start_date:d,end_date:h,time_increment:parseInt(m,10)||1,fields:"ad_id,ad_name,adset_id,adset_name,campaign_id,campaign_name,impressions,clicks,spend,actions",breakdowns:"impression_device,placement"}:"region"===e?r={start_date:d,end_date:h,time_increment:parseInt(m,10)||1,fields:"ad_id,ad_name,adset_id,adset_name,campaign_id,campaign_name,impressions,clicks,spend,actions",breakdowns:"region"}:"country_device"===e&&(r={start_date:d,end_date:h,time_increment:parseInt(m,10)||1,fields:"ad_id,ad_name,adset_id,adset_name,campaign_id,campaign_name,impressions,clicks,spend,actions",breakdowns:"country",action_breakdowns:"action_device",limit:500}),N(e=>Ie(Ie({},e),{},{stage:"Sending request to Meta API..."}));const n=await Sa(r);if(n.async_job&&n.report_run_id){E({reportRunId:n.report_run_id,status:n.async_status}),N(e=>Ie(Ie({},e),{},{stage:"Started async job (".concat(n.async_status,")..."),percentage:0}));const e=setInterval(()=>{z(n.report_run_id)},3e3);A(e),z(n.report_run_id)}else{var t;if(n.data&&n.data.data){const e=Ss(n.data.data,F),t=Os(e,F);O(Ie(Ie({},n),{},{data:Ie(Ie({},n.data),{},{data:e,business_summary:t})}))}else O(n);(null===(t=n.meta)||void 0===t?void 0:t.pages_fetched)>0&&N({stage:"Processing results...",pagesLoaded:n.meta.pages_fetched,percentage:100}),setTimeout(()=>{j(!1)},500)}}catch(a){var r,n;_((null===(r=a.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.error)||a.message||"An unknown error occurred"),j(!1),E(null)}}else _("Start or end date is invalid. Use YYYY-MM-DD format.");else _("Start date and end date are required")};return(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900 rounded-lg shadow p-4 mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>{M(!T)},children:[(0,ut.jsx)("h2",{className:"text-lg font-semibold text-blue-800 dark:text-blue-200",children:"How to use this tool"}),(0,ut.jsxs)("button",{className:"text-blue-500",children:[T?"Hide":"Show"," instructions"]})]}),T&&(0,ut.jsxs)("div",{className:"mt-4 text-sm text-blue-800 dark:text-blue-200",children:[(0,ut.jsx)("p",{className:"mb-2",children:"This tool allows you to fetch data from the Meta Ads API for a specified date range."}),(0,ut.jsx)("h3",{className:"font-semibold mt-3 mb-1",children:"Parameters:"}),(0,ut.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Start Date and End Date:"})," Define the time period for data retrieval (YYYY-MM-DD format)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Time Increment:"})," Controls how data is grouped:",(0,ut.jsxs)("ul",{className:"list-disc pl-5 mt-1",children:[(0,ut.jsxs)("li",{children:["Set to ",(0,ut.jsx)("strong",{children:"0"})," to get aggregated data for the entire date range"]}),(0,ut.jsxs)("li",{children:["Set to ",(0,ut.jsx)("strong",{children:"1"})," for daily breakdowns"]}),(0,ut.jsxs)("li",{children:["Set to ",(0,ut.jsx)("strong",{children:"7"})," for weekly breakdowns"]}),(0,ut.jsxs)("li",{children:["Set to ",(0,ut.jsx)("strong",{children:"30"})," for monthly breakdowns (approximate)"]})]})]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Fields:"})," Click on the pills to select which data fields to retrieve"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Breakdowns:"})," Select dimension breakdowns to segment your data (optional)"]})]}),(0,ut.jsx)("p",{className:"mt-3",children:(0,ut.jsx)("strong",{children:"Breakdown Rules:"})}),(0,ut.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,ut.jsx)("li",{children:"Maximum of 2 breakdown dimensions allowed at once"}),(0,ut.jsx)("li",{children:"Certain breakdowns cannot be used together (disabled options will appear grayed out)"}),(0,ut.jsx)("li",{children:"Breakdowns in the same category (e.g., multiple geography options) cannot be combined"}),(0,ut.jsx)("li",{children:"Hourly stats breakdowns must be used alone"}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Action/Conversion Metrics Limitations:"}),(0,ut.jsxs)("ul",{className:"list-disc pl-5 mt-1 text-red-800 dark:text-red-300",children:[(0,ut.jsxs)("li",{children:["When selecting ",(0,ut.jsx)("strong",{children:"\u26a1 action metrics"})," Meta always adds an internal ",(0,ut.jsx)("code",{children:"action_type"})," breakdown"]}),(0,ut.jsxs)("li",{children:["With ",(0,ut.jsx)("strong",{children:"\u26a1 action metrics"})," you may add ",(0,ut.jsx)("strong",{children:"only one"})," other breakdown, and it must be ",(0,ut.jsx)("code",{children:"conversion_destination"})]}),(0,ut.jsxs)("li",{children:["Common breakdowns like country, age, gender, device_platform ",(0,ut.jsx)("strong",{children:"cannot"})," be used with action metrics"]}),(0,ut.jsx)("li",{children:"To get both action data and country/device breakdowns, you need to run separate reports and join them offline"})]})]}),(0,ut.jsx)("li",{children:"Your selected fields and parameters are saved automatically for future sessions"})]})]})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Fetch Meta API Data"}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",htmlFor:"start_date_input",children:["Start Date (YYYY-MM-DD)",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("input",{type:"text",id:"start_date_input",value:d,onChange:e=>u(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 2023-05-01",required:!0,disabled:k})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",htmlFor:"end_date_input",children:["End Date (YYYY-MM-DD)",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("input",{type:"text",id:"end_date_input",value:h,onChange:e=>p(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 2023-05-31",required:!0,disabled:k})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium mb-1",htmlFor:"increment_input",children:"Time Increment (days)"}),(0,ut.jsx)("input",{type:"number",id:"increment_input",value:m,onChange:e=>f(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"1",min:"0",disabled:k}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"0 = entire range, 1 = daily, 7 = weekly, 30 = monthly"})]})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium",children:["Select Fields",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("div",{className:"text-sm",children:(0,ut.jsxs)("span",{className:"text-gray-500",children:[Object.values(g).filter(Boolean).length," fields selected"]})})]}),as.map((e,t)=>(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.name}),(0,ut.jsxs)("div",{className:"space-x-2",children:[(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},g);e.forEach(e=>{t[e.id]=!0}),x(t)})(e.fields),className:"text-xs text-blue-600 hover:text-blue-800",disabled:k,children:"Select All"}),(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},g);e.forEach(e=>{t[e.id]=!1}),x(t)})(e.fields),className:"text-xs text-red-600 hover:text-red-800",disabled:k,children:"Clear"})]})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:e.fields.map(e=>{const t=e.isActionMetric;return(0,ut.jsxs)("button",{type:"button",onClick:()=>{return t=e.id,void x(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"px-3 py-1 rounded-full text-sm ".concat(g[e.id]?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),disabled:k,children:[e.label,(0,ut.jsx)("span",{className:"ml-1 text-xs",children:t&&"\u26a1"})]},e.id)})})]},t))]}),(0,ut.jsx)("div",{className:"mb-4",children:(0,ut.jsx)("button",{type:"button",onClick:()=>D(!R),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center",children:(0,ut.jsxs)("span",{children:[R?"- Hide":"+ Show"," Breakdowns (Advanced)"]})})}),R&&(0,ut.jsxs)("div",{className:"mb-6 pl-4 border-l-2 border-blue-200",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("label",{className:"block text-sm font-medium",children:"Select Breakdowns (Optional)"}),(0,ut.jsx)("div",{className:"text-sm",children:(0,ut.jsxs)("span",{className:"text-gray-500",children:[Object.values(b).filter(Boolean).length," breakdowns selected"]})})]}),(0,ut.jsxs)("div",{className:"text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded mb-3 text-gray-800 dark:text-gray-300",children:[(0,ut.jsx)("strong",{children:"Note:"})," The Meta API has strict rules about which breakdowns can be used together.",(0,ut.jsxs)("ul",{className:"mt-1 ml-2 list-disc pl-4",children:[(0,ut.jsx)("li",{children:"Maximum 2 breakdowns allowed"}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Important:"})," When using ",(0,ut.jsx)("strong",{children:"\u26a1 action metrics"})," Meta always adds an internal ",(0,ut.jsx)("code",{children:"action_type"})," breakdown"]}),(0,ut.jsxs)("li",{children:["With ",(0,ut.jsx)("strong",{children:"\u26a1 action metrics"})," you may add ",(0,ut.jsx)("strong",{children:"only one"})," other breakdown, and it must be ",(0,ut.jsx)("code",{children:"conversion_destination"})]}),(0,ut.jsx)("li",{children:"Disabled options are incompatible with your current selection"})]})]}),ms.map((e,t)=>(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.name}),(0,ut.jsxs)("div",{className:"space-x-2",children:[(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{if(!e.every(e=>!bs(e.id,g,b)))return;const t=Ie({},b);e.forEach(e=>{t[e.id]=!0}),y(t)})(e.breakdowns),className:"text-xs text-blue-600 hover:text-blue-800",disabled:k||e.breakdowns.some(e=>bs(e.id,g,b)),children:"Select All"}),(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},b);e.forEach(e=>{t[e.id]=!1}),y(t)})(e.breakdowns),className:"text-xs text-red-600 hover:text-red-800",disabled:k,children:"Clear"})]})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:e.breakdowns.map(e=>{const t=bs(e.id,g,b),r=t?ys(e.id,g,b):"",n=hs.includes(e.id);return(0,ut.jsxs)("button",{type:"button",onClick:()=>{return t=e.id,void(bs(t,g,b)||y(e=>Ie(Ie({},e),{},{[t]:!e[t]})));var t},className:"px-3 py-1 rounded-full text-sm ".concat(b[e.id]?"bg-green-500 text-white":t?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300"),disabled:k||t,title:r,children:[e.label,n&&(0,ut.jsx)("span",{className:"ml-1 text-xs",title:"Compatible with action metrics",children:"\u2605"})]},e.id)})}),"Others"===e.name&&(0,ut.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"\u2605 Breakdowns marked with a star are compatible with action metrics (actions, conversions, ROAS)"})]},t))]}),(0,ut.jsx)("div",{className:"flex space-x-4",children:(0,ut.jsx)("button",{type:"button",onClick:async()=>{if(!d||!h)return void _("Start date and end date are required");if(!ks(d)||!ks(h))return void _("Start or end date is invalid. Use YYYY-MM-DD format.");if(!vs(g))return void _("At least one field must be selected");const e=xs(g,b);if(e.valid){j(!0),_(null),O(null),E(null),N({stage:"Initializing request...",pagesLoaded:0,percentage:0});try{const e=function(e,t,r,n,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const i=Object.entries(n).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return t}).join(","),o=Object.entries(a).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return t}),l=o.includes("os_ios"),c=o.includes("os_and"),d=o.filter(e=>!fs(e));!l&&!c||d.includes("impression_device")||d.push("impression_device");const u={start_date:e,end_date:t,time_increment:parseInt(r,10)||1,fields:i};if(d.length&&(u.breakdowns=d.join(",")),s&&(u.action_breakdowns=s),l||c){const e=l?"os_ios":"os_and";u.filtering=JSON.stringify([{field:"impression_device",operator:"IN",value:ns[e].filterValues}])}return u}(d,h,m,g,b);N(e=>Ie(Ie({},e),{},{stage:"Sending request to Meta API..."}));const r=await Sa(e);if(r.async_job&&r.report_run_id){E({reportRunId:r.report_run_id,status:r.async_status}),N(e=>Ie(Ie({},e),{},{stage:"Started async job (".concat(r.async_status,")..."),percentage:0}));const e=setInterval(()=>{z(r.report_run_id)},3e3);A(e),z(r.report_run_id)}else{var t;if(r.data&&r.data.data){const e=Ss(r.data.data,F),t=Os(e,F);O(Ie(Ie({},r),{},{data:Ie(Ie({},r.data),{},{data:e,business_summary:t})}))}else O(r);(null===(t=r.meta)||void 0===t?void 0:t.pages_fetched)>0&&N({stage:"Processing results...",pagesLoaded:r.meta.pages_fetched,percentage:100}),setTimeout(()=>{j(!1)},500)}}catch(a){var r,n;_((null===(r=a.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.error)||a.message||"An unknown error occurred"),j(!1),E(null)}}else _(e.errors[0])},disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:k?"Loading...":"Fetch Data"})})]}),k&&(0,ut.jsxs)("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-3",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500 mr-3"}),(0,ut.jsx)("span",{className:"font-medium",children:w.stage}),C&&(0,ut.jsxs)("span",{className:"ml-2 px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full",children:["Job ID: ",C.reportRunId.substring(0,8),"..."]})]}),(0,ut.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-full h-3 w-full mb-2",children:(0,ut.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(C?"bg-gradient-to-r from-blue-500 to-purple-500":"bg-blue-600 animate-pulse"),style:{width:C?"".concat(w.percentage,"%"):"100%"}})}),(0,ut.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)("span",{children:C?"".concat(w.percentage,"% complete"):w.pagesLoaded>0?"".concat(w.pagesLoaded," pages loaded"):"Processing..."}),C&&(0,ut.jsx)("span",{className:"text-xs font-mono bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:"Async Mode"})]}),C&&(0,ut.jsx)("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-800",children:(0,ut.jsxs)("div",{className:"flex justify-between items-start",children:[(0,ut.jsxs)("div",{className:"text-sm flex-1",children:[(0,ut.jsx)("div",{className:"font-medium text-blue-800 dark:text-blue-200 mb-1",children:"\ud83d\udcca Meta is processing your request on their servers"}),(0,ut.jsx)("div",{className:"text-blue-600 dark:text-blue-300 text-xs",children:"Large requests are processed asynchronously for better performance. You'll see progress updates every few seconds."})]}),(0,ut.jsx)("button",{onClick:()=>{P&&(clearInterval(P),A(null)),j(!1),E(null),N({stage:"",pagesLoaded:0,percentage:0})},className:"ml-3 px-3 py-1 bg-red-100 hover:bg-red-200 dark:bg-red-900 dark:hover:bg-red-800  text-red-800 dark:text-red-200 text-xs rounded border border-red-300 dark:border-red-700  transition-colors duration-200",children:"Cancel"})]})})]})]}),(0,ut.jsxs)("div",{className:"relative overflow-hidden bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 rounded-3xl shadow-2xl border border-purple-500/20 mb-6",children:[(0,ut.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,ut.jsx)("div",{className:"absolute top-0 left-1/4 w-2 h-2 bg-cyan-400 rounded-full animate-pulse opacity-60"}),(0,ut.jsx)("div",{className:"absolute top-1/3 right-1/4 w-1 h-1 bg-purple-400 rounded-full animate-ping opacity-40"}),(0,ut.jsx)("div",{className:"absolute bottom-1/4 left-1/3 w-1.5 h-1.5 bg-emerald-400 rounded-full animate-pulse opacity-50"}),(0,ut.jsx)("div",{className:"absolute top-1/2 right-1/3 w-1 h-1 bg-pink-400 rounded-full animate-ping opacity-30"})]}),(0,ut.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-cyan-500/5 to-transparent animate-pulse"}),(0,ut.jsxs)("div",{className:"relative p-8",children:[(0,ut.jsxs)("div",{className:"text-center mb-8",children:[(0,ut.jsxs)("div",{className:"inline-flex items-center space-x-3 mb-4",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full animate-pulse"}),(0,ut.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-cyan-300 via-purple-300 to-pink-300 bg-clip-text text-transparent tracking-wide",children:"QUANTUM API COMMAND CENTER"}),(0,ut.jsx)("div",{className:"w-3 h-3 bg-gradient-to-r from-pink-400 to-purple-500 rounded-full animate-pulse"})]}),(0,ut.jsxs)("div",{className:"flex justify-center items-center space-x-2 mb-2",children:[(0,ut.jsx)("div",{className:"h-px bg-gradient-to-r from-transparent via-cyan-400 to-transparent w-20"}),(0,ut.jsx)("span",{className:"text-cyan-300 text-sm font-mono tracking-wider",children:"NEURAL INTERFACE v2100.1"}),(0,ut.jsx)("div",{className:"h-px bg-gradient-to-r from-transparent via-cyan-400 to-transparent w-20"})]}),(0,ut.jsx)("p",{className:"text-slate-300 text-sm max-w-2xl mx-auto leading-relaxed",children:"Advanced Meta API templates with quantum-enhanced data processing and holographic visualization"})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"group relative",children:[(0,ut.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-300"}),(0,ut.jsxs)("div",{className:"relative bg-gradient-to-br from-slate-800/80 to-slate-900/80 backdrop-blur-xl border border-emerald-500/30 rounded-2xl p-6 hover:border-emerald-400/60 transition-all duration-300",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ut.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-400 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/20",children:(0,ut.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83c\udf0d"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-xl font-bold text-emerald-300 tracking-wide",children:"GEO-MATRIX SCAN"}),(0,ut.jsx)("div",{className:"text-xs text-emerald-400/70 font-mono",children:"MODULE_001 \u2022 COUNTRY_ANALYTICS"})]})]}),(0,ut.jsx)("p",{className:"text-slate-300 text-sm mb-4 leading-relaxed",children:"Quantum-enhanced geographical performance analysis. Maps ad efficiency across global territories with neural pattern recognition."}),(0,ut.jsxs)("div",{className:"bg-slate-900/60 rounded-xl p-4 mb-6 border border-emerald-500/20",children:[(0,ut.jsx)("div",{className:"text-xs text-emerald-400 font-mono mb-2",children:"NEURAL PARAMETERS:"}),(0,ut.jsxs)("div",{className:"text-xs text-slate-300 font-mono space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"fields:"}),(0,ut.jsx)("span",{className:"text-yellow-300",children:"ad_id, ad_name, campaign_*, impressions, clicks, spend, actions"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"breakdowns:"}),(0,ut.jsx)("span",{className:"text-emerald-300",children:"country"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"output:"}),(0,ut.jsx)("span",{className:"text-pink-300",children:"ad-country matrix pairs"})]})]})]}),(0,ut.jsxs)("button",{type:"button",onClick:()=>V("country"),disabled:k||!d||!h,className:"w-full h-14 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white font-bold rounded-xl  hover:from-emerald-400 hover:to-cyan-400 disabled:from-gray-600 disabled:to-gray-700  transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]  shadow-lg shadow-emerald-500/25 hover:shadow-emerald-500/40  disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group/btn",children:[(0,ut.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-700"}),(0,ut.jsx)("span",{className:"relative flex items-center justify-center space-x-2",children:(0,ut.jsx)("span",{children:k?"\u26a1 PROCESSING...":"\ud83d\ude80 EXECUTE GEO-SCAN"})})]})]})]}),(0,ut.jsxs)("div",{className:"group relative",children:[(0,ut.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-300"}),(0,ut.jsxs)("div",{className:"relative bg-gradient-to-br from-slate-800/80 to-slate-900/80 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6 hover:border-purple-400/60 transition-all duration-300",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ut.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-500 rounded-xl flex items-center justify-center shadow-lg shadow-purple-500/20",children:(0,ut.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83d\udcf1"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-xl font-bold text-purple-300 tracking-wide",children:"DEVICE-NEXUS PROBE"}),(0,ut.jsx)("div",{className:"text-xs text-purple-400/70 font-mono",children:"MODULE_002 \u2022 DEVICE_ANALYTICS"})]})]}),(0,ut.jsx)("p",{className:"text-slate-300 text-sm mb-4 leading-relaxed",children:"Multi-dimensional device ecosystem analysis. Identifies user behavior patterns across all connected platforms with AI precision."}),(0,ut.jsxs)("div",{className:"bg-slate-900/60 rounded-xl p-4 mb-6 border border-purple-500/20",children:[(0,ut.jsx)("div",{className:"text-xs text-purple-400 font-mono mb-2",children:"NEURAL PARAMETERS:"}),(0,ut.jsxs)("div",{className:"text-xs text-slate-300 font-mono space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"fields:"}),(0,ut.jsx)("span",{className:"text-yellow-300",children:"ad_id, ad_name, campaign_*, impressions, clicks, spend, actions"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"breakdowns:"}),(0,ut.jsx)("span",{className:"text-purple-300",children:"impression_device"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"actions:"}),(0,ut.jsx)("span",{className:"text-pink-300",children:"action_device [optional_split]"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"output:"}),(0,ut.jsx)("span",{className:"text-pink-300",children:"ad-device matrix pairs"})]})]})]}),(0,ut.jsxs)("button",{type:"button",onClick:()=>V("device"),disabled:k||!d||!h,className:"w-full h-14 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold rounded-xl  hover:from-purple-400 hover:to-pink-400 disabled:from-gray-600 disabled:to-gray-700  transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]  shadow-lg shadow-purple-500/25 hover:shadow-purple-500/40  disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group/btn",children:[(0,ut.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-700"}),(0,ut.jsx)("span",{className:"relative flex items-center justify-center space-x-2",children:(0,ut.jsx)("span",{children:k?"\u26a1 PROCESSING...":"\ud83d\udd2c EXECUTE DEVICE-SCAN"})})]})]})]}),(0,ut.jsxs)("div",{className:"group relative",children:[(0,ut.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-300"}),(0,ut.jsxs)("div",{className:"relative bg-gradient-to-br from-slate-800/80 to-slate-900/80 backdrop-blur-xl border border-orange-500/30 rounded-2xl p-6 hover:border-orange-400/60 transition-all duration-300",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ut.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-400 to-red-500 rounded-xl flex items-center justify-center shadow-lg shadow-orange-500/20",children:(0,ut.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83d\uddfa\ufe0f"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-xl font-bold text-orange-300 tracking-wide",children:"REGIONAL-ZONE MAPPER"}),(0,ut.jsx)("div",{className:"text-xs text-orange-400/70 font-mono",children:"MODULE_003 \u2022 REGION_ANALYTICS"})]})]}),(0,ut.jsx)("p",{className:"text-slate-300 text-sm mb-4 leading-relaxed",children:"Continental-scale performance intelligence. Aggregates advertising metrics across major world regions with territorial AI clustering."}),(0,ut.jsxs)("div",{className:"bg-slate-900/60 rounded-xl p-4 mb-6 border border-orange-500/20",children:[(0,ut.jsx)("div",{className:"text-xs text-orange-400 font-mono mb-2",children:"NEURAL PARAMETERS:"}),(0,ut.jsxs)("div",{className:"text-xs text-slate-300 font-mono space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"fields:"}),(0,ut.jsx)("span",{className:"text-yellow-300",children:"ad_id, ad_name, campaign_*, impressions, clicks, spend, actions"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"breakdowns:"}),(0,ut.jsx)("span",{className:"text-orange-300",children:"region"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"output:"}),(0,ut.jsx)("span",{className:"text-pink-300",children:"ad-region matrix pairs"})]})]})]}),(0,ut.jsxs)("button",{type:"button",onClick:()=>V("region"),disabled:k||!d||!h,className:"w-full h-14 bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold rounded-xl  hover:from-orange-400 hover:to-red-400 disabled:from-gray-600 disabled:to-gray-700  transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]  shadow-lg shadow-orange-500/25 hover:shadow-orange-500/40  disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group/btn",children:[(0,ut.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-700"}),(0,ut.jsx)("span",{className:"relative flex items-center justify-center space-x-2",children:(0,ut.jsx)("span",{children:k?"\u26a1 PROCESSING...":"\ud83c\udf10 EXECUTE REGION-SCAN"})})]})]})]}),(0,ut.jsxs)("div",{className:"group relative",children:[(0,ut.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-300"}),(0,ut.jsxs)("div",{className:"relative bg-gradient-to-br from-slate-800/80 to-slate-900/80 backdrop-blur-xl border border-yellow-500/30 rounded-2xl p-6 hover:border-yellow-400/60 transition-all duration-300",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ut.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-yellow-400 to-amber-500 rounded-xl flex items-center justify-center shadow-lg shadow-yellow-500/20",children:(0,ut.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83c\udf0d\ud83d\udcf1"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-lg font-bold text-yellow-300 tracking-wide",children:"HYBRID GEO-DEVICE"}),(0,ut.jsx)("div",{className:"text-xs text-yellow-400/70 font-mono",children:"MODULE_004 \u2022 CROSS_DIMENSIONAL"})]})]}),(0,ut.jsx)("p",{className:"text-slate-300 text-xs mb-3 leading-relaxed",children:"TESTED RECIPE: Attempts to get country rows with device-attributed actions. Meta API has confirmed this combination is not supported."}),(0,ut.jsxs)("div",{className:"bg-slate-900/60 rounded-xl p-3 mb-4 border border-red-500/20",children:[(0,ut.jsx)("div",{className:"text-xs text-red-400 font-mono mb-2",children:"FAILED PARAMS:"}),(0,ut.jsxs)("div",{className:"text-xs text-slate-300 font-mono space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"fields:"}),(0,ut.jsx)("span",{className:"text-yellow-300",children:"campaign_*, impressions, actions"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"breakdowns:"}),(0,ut.jsx)("span",{className:"text-yellow-300",children:"country"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-cyan-400",children:"action_breakdowns:"}),(0,ut.jsx)("span",{className:"text-pink-300",children:"action_device"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-red-400",children:"error:"}),(0,ut.jsx)("span",{className:"text-red-300",children:"Invalid combination"})]})]})]}),(0,ut.jsx)("div",{className:"bg-red-900/40 border border-red-500/30 rounded-lg p-2 mb-4",children:(0,ut.jsxs)("div",{className:"text-xs text-red-200",children:["\u274c ",(0,ut.jsx)("strong",{children:"Meta API Error:"}),' "Current combination of data breakdown columns (action_device, country) is invalid"']})}),(0,ut.jsxs)("button",{type:"button",onClick:()=>V("country_device"),disabled:k||!d||!h,className:"w-full h-12 bg-gradient-to-r from-red-500 to-red-600 text-white font-bold rounded-xl  hover:from-red-400 hover:to-red-500 disabled:from-gray-600 disabled:to-gray-700  transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]  shadow-lg shadow-red-500/25 hover:shadow-red-500/40  disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group/btn text-sm",children:[(0,ut.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-700"}),(0,ut.jsx)("span",{className:"relative flex items-center justify-center space-x-2",children:(0,ut.jsx)("span",{children:k?"\u26a1 FAILING...":"\u274c DEMO ERROR"})})]})]})]})]}),d&&h?(0,ut.jsx)("div",{className:"mt-8 text-center",children:(0,ut.jsxs)("div",{className:"inline-flex items-center space-x-2 text-cyan-300 text-sm",children:[(0,ut.jsx)("div",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),(0,ut.jsx)("span",{className:"font-mono",children:"QUANTUM TEMPLATES \u2022 READY FOR EXECUTION"}),(0,ut.jsx)("div",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"})]})}):(0,ut.jsxs)("div",{className:"mt-8 relative",children:[(0,ut.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl blur opacity-20"}),(0,ut.jsx)("div",{className:"relative bg-slate-900/80 backdrop-blur-xl border border-orange-500/40 rounded-2xl p-4",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-400 to-red-500 rounded-lg flex items-center justify-center",children:(0,ut.jsx)("span",{className:"text-white font-bold",children:"\u26a0\ufe0f"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-orange-300 font-bold",children:"TEMPORAL PARAMETERS REQUIRED"}),(0,ut.jsx)("div",{className:"text-orange-200 text-sm",children:"Initialize start and end dates in the chronometer above to activate quantum templates"})]})]})})]}),(0,ut.jsxs)("div",{className:"mt-8 bg-slate-900/60 backdrop-blur-xl border border-blue-500/20 rounded-2xl p-6",children:[(0,ut.jsxs)("h3",{className:"text-lg font-bold text-blue-300 mb-4 flex items-center",children:[(0,ut.jsx)("span",{className:"mr-2",children:"\ud83e\udde0"}),"DIMENSIONAL ANALYSIS LIMITATIONS"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-slate-300",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold text-cyan-300 mb-2",children:"\u2705 Single Dimension (Supported)"}),(0,ut.jsxs)("ul",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-emerald-300",children:"Country only"})," - Shows performance by country"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-purple-300",children:"Device only"})," - Shows performance by device + placement"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-orange-300",children:"Region only"})," - Shows performance by region/state"]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold text-red-300 mb-2",children:"\u274c Hybrid Experiment Failed"}),(0,ut.jsxs)("div",{className:"text-xs",children:[(0,ut.jsxs)("p",{className:"mb-2",children:["The ",(0,ut.jsx)("span",{className:"text-red-300",children:"HYBRID GEO-DEVICE"})," tested Meta's ",(0,ut.jsx)("code",{children:"action_breakdowns"}),":"]}),(0,ut.jsxs)("ul",{className:"space-y-1",children:[(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-cyan-300",children:"Goal:"})," Country rows + device action splits"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-red-300",children:"Error:"}),' "Invalid combination of data breakdown columns"']}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("span",{className:"text-red-300",children:"Result:"})," Meta API rejects this combination"]})]})]})]})]}),(0,ut.jsxs)("div",{className:"mt-6 p-4 bg-red-900/30 border border-red-500/30 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-semibold text-red-300 mb-2",children:"\u26a0\ufe0f Attribution Problem"}),(0,ut.jsx)("p",{className:"text-xs text-red-200 leading-relaxed",children:'Separate API calls cannot be combined for full attribution. Example: You cannot determine "iOS users in USA vs Android users in USA" by making separate country and device calls, because there\'s no way to cross-reference the user data between calls.'})]}),(0,ut.jsxs)("div",{className:"mt-4 p-4 bg-blue-900/30 border border-blue-500/30 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-semibold text-blue-300 mb-2",children:"\ud83d\udca1 Confirmed Solution"}),(0,ut.jsxs)("p",{className:"text-xs text-blue-200 leading-relaxed",children:["The ",(0,ut.jsx)("span",{className:"text-red-300",children:"HYBRID GEO-DEVICE"})," test confirms Meta API doesn't support cross-dimensional attribution. For geo-device insights, you must make separate API calls (country-only and device-only) and analyze the data independently. Full cross-attribution is not possible."]})]})]})]})]}),S&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Results"}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Total Records:"})," ",(null===(t=S.meta)||void 0===t?void 0:t.total_records)||0]}),(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Pages Fetched:"})," ",(null===(r=S.meta)||void 0===r?void 0:r.pages_fetched)||0]}),(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Date Range:"})," ",null===(n=S.meta)||void 0===n?void 0:n.start_date," to ",null===(a=S.meta)||void 0===a?void 0:a.end_date]}),(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Time Increment:"})," ",(null===(i=S.meta)||void 0===i?void 0:i.time_increment)||1," day(s)"]})]}),(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded mb-4",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Fields:"})," ",null===(o=S.meta)||void 0===o?void 0:o.fields]}),(null===(l=S.meta)||void 0===l?void 0:l.breakdowns)&&(0,ut.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 p-3 rounded mb-4",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Breakdowns:"})," ",null===(c=S.meta)||void 0===c?void 0:c.breakdowns]})]}),S.data&&S.data.data&&S.data.data.length>0?(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium",children:["Data Sample (",S.data.data.length," records)"]}),(0,ut.jsx)("div",{className:"flex items-center space-x-4",children:(0,ut.jsxs)("label",{className:"flex items-center",children:[(0,ut.jsx)("input",{type:"checkbox",checked:I,onChange:e=>L(e.target.checked),className:"mr-2"}),"Show Business Concepts"]})})]}),I&&Object.keys(F).length>0&&S.data.business_summary&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h4",{className:"text-md font-medium mb-3",children:"Business Concepts Summary"}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:Object.entries(S.data.business_summary).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900 p-4 rounded-lg",children:[(0,ut.jsx)("h5",{className:"font-medium text-blue-800 dark:text-blue-200 capitalize",children:t}),(0,ut.jsxs)("div",{className:"text-sm text-blue-600 dark:text-blue-300 mt-2 space-y-1",children:[(0,ut.jsxs)("div",{children:["Count: ",r.total_count.toFixed(0)]}),(0,ut.jsxs)("div",{children:["Value: $",r.total_value.toFixed(2)]}),(0,ut.jsxs)("div",{children:["Conversions: ",r.total_conversions.toFixed(0)]}),(0,ut.jsxs)("div",{children:["Conv. Value: $",r.total_conversion_value.toFixed(2)]}),(0,ut.jsxs)("div",{className:"text-xs",children:["Records: ",r.records_with_data,"/",S.data.data.length]})]})]},t)})}),0===Object.keys(F).length&&(0,ut.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No action mappings configured. Go to the Action Mapping tab to set up business concepts."})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("h4",{className:"text-md font-medium",children:"Raw JSON Data"}),(0,ut.jsxs)("button",{onClick:e=>{const t=JSON.stringify(U(S.data.data),null,2);navigator.clipboard.writeText(t).then(()=>{const t=e.target,r=t.textContent;t.textContent="\u2705 Copied!",t.classList.add("bg-green-500","text-white"),setTimeout(()=>{t.textContent=r,t.classList.remove("bg-green-500","text-white")},2e3)}).catch(e=>{console.error("Failed to copy:",e),alert("Failed to copy to clipboard")})},className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded  transition-colors duration-200 flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"\ud83d\udccb"}),(0,ut.jsx)("span",{children:"Copy All JSON"})]})]}),(0,ut.jsx)("div",{className:"bg-gray-100 dark:bg-gray-900 p-4 rounded overflow-auto max-h-96",children:(0,ut.jsx)("pre",{className:"text-xs",children:JSON.stringify(U(S.data.data),null,2)})})]})]}):(0,ut.jsx)("p",{className:"text-gray-500",children:"No data returned from API"})]})]})},Es=e=>{let{dataCoverage:t,missingDates:r,configurations:n}=e;return t?(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Data Coverage Summary"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"bg-blue-100 dark:bg-blue-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:t.total_days}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Days Stored"})]}),(0,ut.jsxs)("div",{className:"bg-green-100 dark:bg-green-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:t.total_records}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Total Records"})]}),(0,ut.jsxs)("div",{className:"bg-orange-100 dark:bg-orange-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:r.length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Missing Days"})]}),(0,ut.jsxs)("div",{className:"bg-purple-100 dark:bg-purple-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:n.length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Configurations"})]})]}),t.earliest_date&&(0,ut.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Date Range: ",t.earliest_date," to ",t.latest_date]})]}):null},Ps=e=>{let{activeJobs:t,cancelJob:r}=e;if(0===t.length)return null;const n=e=>{switch(e){case"running":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"completed_with_errors":return"bg-yellow-100 text-yellow-800";case"completed_unknown":return"bg-purple-100 text-purple-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=e=>{switch(e){case"completed_unknown":return"Status Unknown";case"completed_with_errors":return"Completed (with errors)";default:return e}};return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Collection Jobs"}),(0,ut.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,ut.jsxs)("div",{className:"border rounded p-3",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium",children:[e.start_date," to ",e.end_date]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600",children:["Fields: ",e.fields,e.breakdowns&&" | Breakdowns: ".concat(e.breakdowns)]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(n(e.status)),children:a(e.status)}),"running"===e.status&&(0,ut.jsx)("button",{onClick:()=>r(e.job_id),className:"text-red-600 hover:text-red-800 text-xs",children:"Cancel"})]})]}),"running"===e.status&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,ut.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.progress_percentage,"%")}})}),(0,ut.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:[e.current_date&&"Processing: ".concat(e.current_date)," (".concat(Math.round(e.progress_percentage),"%)")]})]}),"completed_unknown"===e.status&&e.message&&(0,ut.jsxs)("div",{className:"mt-2 text-xs text-purple-600 bg-purple-50 p-2 rounded",children:[(0,ut.jsx)("strong",{children:"Note:"})," ",e.message]}),e.errors&&e.errors.length>0&&(0,ut.jsxs)("div",{className:"mt-2 text-xs text-red-600",children:[e.errors.length," error(s) occurred"]})]},e.job_id))})]})},As=()=>{const[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)({}),[a,i]=(0,s.useState)(!0),[o,l]=(0,s.useState)(new Set),[c,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{u()},[]);const u=async()=>{i(!0);try{const e=await $a(),r=Array.isArray(e)?e:e.data||[];t(r);const a=r.map(async e=>{if(e.day_count>0)try{const t=await Ka({start_date:e.earliest_date,end_date:e.latest_date,fields:e.fields,breakdowns:e.breakdowns});return{configHash:e.config_hash,data:t}}catch(t){return console.error("Error loading data for config ".concat(e.config_hash,":"),t),{configHash:e.config_hash,data:null}}return{configHash:e.config_hash,data:null}}),s=await Promise.all(a),i={};s.forEach(e=>{let{configHash:t,data:r}=e;i[t]=r}),n(i)}catch(e){console.error("Error loading configurations:",e)}finally{i(!1)}},h=(e,t,r)=>{if(!e)return{};if(!Array.isArray(e))return console.warn("processMetricsForDate: records is not an array:",typeof e,e),{};if(0===e.length)return{};const n={};return t.forEach(t=>{if(m(t)){const r=e.reduce((e,r)=>e+(parseFloat(r[t])||0),0);n[t]=r}else if(f(t)){const r=new Set;e.forEach(e=>{e[t]&&r.add(e[t])}),n[t]=r.size}else n[t]=e.length>0?"Data":"No Data"}),r&&(n._breakdownData=p(e,t)),n},p=(e,t)=>{const r={};return Array.isArray(e)?(e.forEach(e=>{const n=Object.keys(e).filter(e=>!t.includes(e)&&!["date_start","date_stop"].includes(e)).map(t=>"".concat(t,":").concat(e[t])).join(" | ");r[n]||(r[n]={}),t.forEach(t=>{if(m(t)){const a=parseFloat(e[t])||0;r[n][t]=(r[n][t]||0)+a}})}),r):(console.warn("processBreakdownData: records is not an array:",typeof e,e),r)},m=e=>["impressions","clicks","spend","reach","frequency","cpc","cpm","cpp","unique_clicks","unique_ctr","inline_link_clicks","outbound_clicks","estimated_ad_recallers","estimated_ad_recall_rate"].includes(e)||e.includes("action")||e.includes("conversion"),f=e=>["ad_name","campaign_name","adset_name","ad_id","campaign_id","adset_id"].includes(e),g=(e,t)=>"number"===typeof t?"spend"===e||e.includes("cost")?"$".concat(t.toFixed(2)):e.includes("rate")||e.includes("ctr")?"".concat((100*t).toFixed(2),"%"):Number.isInteger(t)?t.toLocaleString():t.toFixed(2):"number"===typeof t&&f(e)?"".concat(t," ").concat(e.includes("campaign")?"campaigns":e.includes("ad")?"ads":"items"):t,x=(e,t)=>{if(!t)return(0,ut.jsx)("div",{className:"text-gray-500 text-center py-4",children:"No data available for this configuration"});const{dates:r,dateData:n,fields:a,hasBreakdowns:s,businessMetrics:i}=t,o=e.config_hash;return(0,ut.jsxs)("div",{className:"space-y-6",children:[i&&Object.keys(i).length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-md font-medium mb-3 text-blue-800",children:"\ud83d\udcb0 Business Metrics Summary"}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full border border-gray-200 bg-blue-50",children:[(0,ut.jsx)("thead",{className:"bg-blue-100",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-blue-800 border-r",children:"Business Concept"}),r.map(e=>(0,ut.jsx)("th",{className:"px-3 py-2 text-center text-sm font-medium text-blue-800 border-r",children:e},"".concat(o,"-bm-header-").concat(e)))]})}),(0,ut.jsx)("tbody",{className:"bg-white",children:(()=>{const e=r.find(e=>i[e]&&Object.keys(i[e]).length>0);if(!e)return null;return Object.keys(i[e]).map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-blue-25":"bg-white",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-blue-900 border-r capitalize",children:"trial_started"===e?"Trial Started":"initial_purchase"===e?"Initial Purchase":e.replace(/_/g," ")}),r.map(t=>{var r;return(0,ut.jsx)("td",{className:"px-3 py-2 text-sm text-blue-800 text-center border-r font-medium",children:i[t]&&void 0!==(null===(r=i[t][e])||void 0===r?void 0:r.count)?i[t][e].count:"-"},"".concat(o,"-bm-").concat(e,"-").concat(t))})]},"".concat(o,"-bm-").concat(e)))})()})]})})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-md font-medium mb-3 text-gray-800",children:"\ud83d\udcca Raw Data Metrics"}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full border border-gray-200",children:[(0,ut.jsx)("thead",{className:"bg-gray-50",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700 border-r",children:"Metric"}),r.map(e=>(0,ut.jsx)("th",{className:"px-3 py-2 text-center text-sm font-medium text-gray-700 border-r",children:e},"".concat(o,"-rm-header-").concat(e)))]})}),(0,ut.jsx)("tbody",{className:"bg-white",children:a.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-gray-50":"bg-white",children:[(0,ut.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900 border-r",children:e}),r.map(t=>(0,ut.jsx)("td",{className:"px-3 py-2 text-sm text-gray-700 text-center border-r",children:n[t]&&void 0!==n[t][e]?g(e,n[t][e]):"-"},"".concat(o,"-rm-").concat(e,"-").concat(t)))]},"".concat(o,"-rm-").concat(e)))})]})})]}),s&&Object.keys(n).some(e=>n[e]._breakdownData)&&(0,ut.jsxs)("div",{className:"mt-6",children:[(0,ut.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"Breakdown Data"}),r.map(e=>{const t=n[e]._breakdownData;return t&&0!==Object.keys(t).length?(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsx)("h6",{className:"text-xs font-medium text-gray-600 mb-2",children:e}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full border border-gray-200 text-xs",children:[(0,ut.jsx)("thead",{className:"bg-gray-100",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-2 py-1 text-left text-gray-700 border-r",children:"Breakdown"}),a.filter(m).map(t=>(0,ut.jsx)("th",{className:"px-2 py-1 text-center text-gray-700 border-r",children:t},"".concat(o,"-bd-").concat(e,"-header-").concat(t)))]})}),(0,ut.jsx)("tbody",{children:Object.entries(t).map(t=>{let[r,n]=t;return(0,ut.jsxs)("tr",{className:"bg-white",children:[(0,ut.jsx)("td",{className:"px-2 py-1 text-gray-900 border-r",children:r}),a.filter(m).map(t=>(0,ut.jsx)("td",{className:"px-2 py-1 text-center text-gray-700 border-r",children:g(t,n[t]||0)},"".concat(o,"-bd-").concat(e,"-").concat(r,"-").concat(t)))]},"".concat(o,"-bd-").concat(e,"-").concat(r))})})]})})]},"".concat(o,"-bd-").concat(e)):null})]})]})};return a?(0,ut.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mr-3"}),(0,ut.jsx)("span",{children:"Loading historical data..."})]}):0===e.length?(0,ut.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,ut.jsx)("p",{children:"No historical data configurations found."}),(0,ut.jsx)("p",{className:"text-sm mt-2",children:"Start a historical collection job to see data here."})]}):(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium",children:"Historical Data Overview"}),(0,ut.jsx)("button",{onClick:u,className:"text-sm text-blue-600 hover:text-blue-800",children:"Refresh Data"})]}),e.map(e=>{const t=o.has(e.config_hash),n=r[e.config_hash],a=n?(e=>{if(!e||!e.data||0===e.data.length)return null;const t=e.config.fields.split(",").map(e=>e.trim()),r=e.config.breakdowns&&e.config.breakdowns.trim(),n=e.data.map(e=>e.date).sort(),a={},s={};return e.data.forEach(e=>{const n=e.date;e.business_metrics&&(s[n]=e.business_metrics);let i=[];e.data&&(e.data.data&&Array.isArray(e.data.data.data)?i=e.data.data.data:Array.isArray(e.data.data)?i=e.data.data:Array.isArray(e.data)?i=e.data:(console.warn("Unexpected data structure for date:",n,e.data),i=[])),a[n]=h(i,t,r)}),{dates:n,dateData:a,fields:t,hasBreakdowns:r,config:e.config,businessMetrics:s}})(n):null;return(0,ut.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[(0,ut.jsx)("div",{className:"p-4 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>(e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),l(t)})(e.config_hash),children:(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-gray-900",children:["Fields: ",e.fields]}),e.breakdowns&&(0,ut.jsxs)("div",{className:"text-sm text-gray-600",children:["Breakdowns: ",e.breakdowns]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[e.day_count," days \u2022 ",e.earliest_date," to ",e.latest_date]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this entire dataset? This action cannot be undone.")){d(e);try{await Ga(e),await u()}catch(t){console.error("Error deleting configuration:",t),alert("Failed to delete configuration. Please try again.")}finally{d(null)}}})(e.config_hash)},disabled:c===e.config_hash,className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-gray-400",title:"Delete this entire dataset",children:c===e.config_hash?"Deleting...":"Delete"}),(0,ut.jsx)("div",{className:"text-gray-400",children:t?"\u2212":"+"})]})]})}),t&&(0,ut.jsx)("div",{className:"p-4 border-t",children:x(e,a)})]},e.config_hash)})]})},Ts=e=>{let{startDateInput:t,setStartDateInput:r,endDateInput:n,setEndDateInput:a,selectedFields:i,setSelectedFields:o,selectedBreakdowns:l,setSelectedBreakdowns:c,error:d,setError:u}=e;const[h,p]=(0,s.useState)([]),[m,f]=(0,s.useState)([]),[g,x]=(0,s.useState)(null),[b,y]=(0,s.useState)([]),[v,_]=(0,s.useState)(!1),[k,j]=(0,s.useState)(null),[w,N]=(0,s.useState)(null),[S,O]=(0,s.useState)(!0),[C,E]=(0,s.useState)(!1),P=(0,s.useRef)(null);(0,s.useEffect)(()=>(h.some(e=>"running"===e.status||"starting"===e.status)?P.current=setInterval(()=>{M()},2e3):P.current&&clearInterval(P.current),()=>{P.current&&clearInterval(P.current)}),[h]),(0,s.useEffect)(()=>{A(),T()},[i,l]),(0,s.useEffect)(()=>{p([]);const e=setInterval(()=>{p(e=>e.filter(e=>{if("running"===e.status||"starting"===e.status)return!0;if(e.end_time){const t=new Date(e.end_time);return new Date-t<3e5}return!0}))},6e4);return()=>clearInterval(e)},[]);const A=async()=>{try{const e=await $a();f(e)}catch(d){console.error("Error loading configurations:",d)}},T=async()=>{const e=vs(i),r=_s(l);if(e)try{const a=await Wa({fields:e,breakdowns:r,start_date:t||void 0,end_date:n||void 0});if(x(a),t&&n){const a=await qa({start_date:t,end_date:n,fields:e,breakdowns:r});y(a.missing_dates||[])}}catch(d){console.error("Error updating data coverage:",d)}},M=async()=>{const e=h.filter(e=>"running"===e.status||"starting"===e.status);if(0===e.length)return;const t=await Promise.all(e.map(async e=>{try{const t=await Va(e.job_id);return Ie(Ie({},e),t)}catch(d){var t;return console.error("Error polling job ".concat(e.job_id,":"),d),404===(null===(t=d.response)||void 0===t?void 0:t.status)?(console.log("Job ".concat(e.job_id," not found in active tracking, checking if data was collected...")),T(),Ie(Ie({},e),{},{status:"completed_unknown",message:"Job completed but status unavailable. Check data coverage for results."})):e}}));p(r=>[...r.filter(t=>!e.find(e=>e.job_id===t.job_id)),...t]),t.some(e=>"completed"===e.status||"completed_with_errors"===e.status||"completed_unknown"===e.status)&&T()};return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsx)(As,{}),(0,ut.jsx)(Es,{dataCoverage:g,missingDates:b,configurations:m}),(0,ut.jsx)(Ps,{activeJobs:h,cancelJob:async e=>{try{await Ha(e),p(t=>t.map(t=>t.job_id===e?Ie(Ie({},t),{},{status:"cancelled"}):t))}catch(d){console.error("Error cancelling job:",d)}}}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Configure Historical Collection"}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Date Range"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["Start Date (YYYY-MM-DD)",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 2023-05-01"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["End Date (YYYY-MM-DD)",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsx)("input",{type:"text",value:n,onChange:e=>a(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., 2023-05-31"})]})]})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium",children:["Select Fields for Collection",(0,ut.jsx)("span",{className:"text-red-500",children:" *"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("span",{className:"text-sm text-gray-500",children:[Object.values(i).filter(Boolean).length," fields selected"]}),(0,ut.jsxs)("button",{type:"button",onClick:()=>O(!S),className:"text-blue-600 hover:text-blue-800 text-sm",children:[S?"Hide":"Show"," Fields"]})]})]}),S&&(0,ut.jsx)("div",{className:"border rounded p-4 bg-gray-50 dark:bg-gray-700",children:as.map((e,t)=>(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.name}),(0,ut.jsxs)("div",{className:"space-x-2",children:[(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},i);e.forEach(e=>{t[e.id]=!0}),o(t)})(e.fields),className:"text-xs text-blue-600 hover:text-blue-800",children:"Select All"}),(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},i);e.forEach(e=>{t[e.id]=!1}),o(t)})(e.fields),className:"text-xs text-red-600 hover:text-red-800",children:"Clear"})]})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:e.fields.map(e=>{const t=e.isActionMetric;return(0,ut.jsxs)("button",{type:"button",onClick:()=>{return t=e.id,void o(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"px-3 py-1 rounded-full text-sm ".concat(i[e.id]?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"),children:[e.label,(0,ut.jsx)("span",{className:"ml-1 text-xs",children:t&&"\u26a1"})]},e.id)})})]},t))})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium",children:"Select Breakdowns (Optional)"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("span",{className:"text-sm text-gray-500",children:[Object.values(l).filter(Boolean).length," breakdowns selected"]}),(0,ut.jsxs)("button",{type:"button",onClick:()=>E(!C),className:"text-blue-600 hover:text-blue-800 text-sm",children:[C?"Hide":"Show"," Breakdowns"]})]})]}),C&&(0,ut.jsxs)("div",{className:"border rounded p-4 bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsxs)("div",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 p-2 rounded mb-3 text-yellow-800 dark:text-yellow-300",children:[(0,ut.jsx)("strong",{children:"Historical Collection Rules:"}),(0,ut.jsxs)("ul",{className:"mt-1 ml-2 list-disc pl-4",children:[(0,ut.jsx)("li",{children:"Maximum 2 breakdowns allowed"}),(0,ut.jsxs)("li",{children:["With ",(0,ut.jsx)("strong",{children:"\u26a1 action metrics"}),", only ",(0,ut.jsx)("code",{children:"conversion_destination"})," breakdown is allowed"]}),(0,ut.jsx)("li",{children:"Historical jobs will collect data for ALL days in the date range with the selected configuration"})]})]}),ms.map((e,t)=>(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:e.name}),(0,ut.jsxs)("div",{className:"space-x-2",children:[(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{if(!e.every(e=>!bs(e.id,i,l)))return;const t=Ie({},l);e.forEach(e=>{t[e.id]=!0}),c(t)})(e.breakdowns),className:"text-xs text-blue-600 hover:text-blue-800",disabled:e.breakdowns.some(e=>bs(e.id,i,l)),children:"Select All"}),(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie({},l);e.forEach(e=>{t[e.id]=!1}),c(t)})(e.breakdowns),className:"text-xs text-red-600 hover:text-red-800",children:"Clear"})]})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:e.breakdowns.map(e=>{const t=bs(e.id,i,l),r=t?ys(e.id,i,l):"",n=hs.includes(e.id);return(0,ut.jsxs)("button",{type:"button",onClick:()=>{return t=e.id,void(bs(t,i,l)||c(e=>Ie(Ie({},e),{},{[t]:!e[t]})));var t},className:"px-3 py-1 rounded-full text-sm ".concat(l[e.id]?"bg-green-500 text-white":t?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300"),disabled:t,title:r,children:[e.label,n&&(0,ut.jsx)("span",{className:"ml-1 text-xs",title:"Compatible with action metrics",children:"\u2605"})]},e.id)})})]},t))]})]}),t&&n&&Object.values(i).some(Boolean)&&(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Collection Summary"}),(0,ut.jsxs)("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Date Range:"})," ",t," to ",n]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Fields:"})," ",vs(i)]}),_s(l)&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Breakdowns:"})," ",_s(l)]}),b.length>0&&(0,ut.jsxs)("div",{className:"text-orange-700 dark:text-orange-300",children:[(0,ut.jsxs)("strong",{children:[b.length," days"]})," need to be collected",b.length<=5&&" (".concat(b.join(", "),")")]})]})]}),(0,ut.jsx)("button",{onClick:async()=>{if(!t||!n)return void u("Start date and end date are required for historical collection");const e=vs(i);if(!e)return void u("At least one field must be selected");const r=xs(i,l);if(r.valid)try{const r={start_date:t,end_date:n,fields:e,breakdowns:_s(l)||void 0},a={job_id:(await za(r)).job_id,status:"running",start_date:t,end_date:n,fields:e,breakdowns:_s(l)||"",progress_percentage:0};p(e=>[...e,a]),u(null),T()}catch(d){var a,s;u((null===(a=d.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||d.message||"Failed to start historical collection")}else u(r.errors[0])},disabled:!t||!n||!Object.values(i).some(Boolean),className:"px-6 py-3 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400",children:"Start Historical Collection Job"})]}),w&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Exported Data"}),(0,ut.jsx)("div",{className:"bg-gray-100 dark:bg-gray-900 p-4 rounded overflow-auto max-h-96",children:(0,ut.jsx)("pre",{className:"text-xs",children:JSON.stringify(w,null,2)})})]})]})},Ms={PURCHASE:["purchase","onsite_web_purchase","onsite_web_app_purchase","omni_purchase","web_in_store_purchase","web_app_in_store_purchase","offsite_conversion.fb_pixel_purchase","add_payment_info","offsite_conversion.fb_pixel_add_payment_info","initiate_checkout","onsite_web_initiate_checkout","omni_initiated_checkout","offsite_conversion.fb_pixel_initiate_checkout","offsite_conversion.fb_pixel_custom.server_purchase"],LEADS_CONVERSIONS:["lead","onsite_web_lead","offsite_conversion.fb_pixel_lead","complete_registration","offsite_conversion.fb_pixel_complete_registration","omni_complete_registration","offsite_conversion.custom.532547799297472","offsite_conversion.fb_pixel_custom"],TRIAL_SUBSCRIPTION:["start_trial_mobile_app","start_trial_total","offsite_conversion.fb_pixel_custom.TrialStartedRoasEvent"],ENGAGEMENT:["page_engagement","post_engagement","video_view","link_click","post_reaction","like","comment","post"],CONTENT_VIEWING:["view_content","onsite_web_view_content","onsite_web_app_view_content","omni_view_content","offsite_conversion.fb_pixel_view_content","landing_page_view","omni_landing_page_view","onsite_conversion.post_save"],APP_EVENTS:["mobile_app_install","omni_app_install","omni_activate_app","app_custom_event.fb_mobile_activate_app","offsite_conversion.fb_pixel_custom.web2app-checkout-stripe-success"],MESSAGING:["onsite_conversion.messaging_first_reply","onsite_conversion.messaging_conversation_started_7d","onsite_conversion.messaging_block"]},Rs=Object.values(Ms).flat(),Ds={conversions:{description:"All purchase and conversion-related actions",suggestedActions:["purchase","onsite_web_purchase","omni_purchase","offsite_conversion.fb_pixel_purchase","lead","complete_registration"]},revenue_actions:{description:"Purchase actions that generate revenue",suggestedActions:["purchase","onsite_web_purchase","onsite_web_app_purchase","omni_purchase","web_in_store_purchase","offsite_conversion.fb_pixel_purchase"]},trial_starts:{description:"Trial initiation events",suggestedActions:["start_trial_mobile_app","start_trial_total","offsite_conversion.fb_pixel_custom.TrialStartedRoasEvent"]},lead_generation:{description:"Lead capture and registration events",suggestedActions:["lead","onsite_web_lead","offsite_conversion.fb_pixel_lead","complete_registration","offsite_conversion.fb_pixel_complete_registration"]},engagement:{description:"User engagement and interaction events",suggestedActions:["page_engagement","post_engagement","video_view","link_click","post_reaction","like","comment"]},app_installs:{description:"Mobile app installation events",suggestedActions:["mobile_app_install","omni_app_install","omni_activate_app"]},content_views:{description:"Content viewing and page visit events",suggestedActions:["view_content","onsite_web_view_content","omni_view_content","landing_page_view","offsite_conversion.fb_pixel_view_content"]},checkout_funnel:{description:"Checkout process events",suggestedActions:["initiate_checkout","onsite_web_initiate_checkout","omni_initiated_checkout","add_payment_info","offsite_conversion.fb_pixel_add_payment_info"]}},Is=()=>{const[e,t]=(0,s.useState)({}),[r,n]=(0,s.useState)([]),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)({conceptName:"",actionTypes:[],aggregationType:"sum"}),[c,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)(!1),p=Object.keys(Ds);(0,s.useEffect)(()=>{f(),m()},[]);const m=()=>{n(Rs),x()},f=async()=>{try{const e=await Ya();if(e.mappings&&Object.keys(e.mappings).length>0)return t(e.mappings),void localStorage.setItem("meta_action_mappings",JSON.stringify(e.mappings));const r=localStorage.getItem("meta_action_mappings");if(r){const e=JSON.parse(r);t(e),Object.keys(e).length>0&&await Xa(e)}}catch(e){console.error("Error loading mappings:",e);try{const e=localStorage.getItem("meta_action_mappings");e&&t(JSON.parse(e))}catch(r){console.error("Error loading from localStorage:",r)}}},g=async e=>{try{await Xa(e),t(e),localStorage.setItem("meta_action_mappings",JSON.stringify(e)),console.log("Action mappings saved successfully")}catch(r){console.error("Error saving mappings to backend:",r),t(e),localStorage.setItem("meta_action_mappings",JSON.stringify(e)),alert("Mappings saved locally, but failed to sync to server. They will be synced next time the page loads.")}},x=async()=>{i(!0);try{const t=await $a(),r=new Set;for(const n of t.slice(0,3))if(n.day_count>0)try{(await Ka({start_date:n.latest_date,end_date:n.latest_date,fields:n.fields,breakdowns:n.breakdowns})).data.forEach(e=>{let t=[];if(e.data&&e.data.data&&Array.isArray(e.data.data))t=e.data.data;else{if(!e.data||!Array.isArray(e.data))return void console.warn("Unexpected data structure in ActionMapper:",e);t=e.data}Array.isArray(t)?t.forEach(e=>{e&&"object"===typeof e?(e.actions&&Array.isArray(e.actions)&&e.actions.forEach(e=>{e&&e.action_type&&r.add(e.action_type)}),e.action_values&&Array.isArray(e.action_values)&&e.action_values.forEach(e=>{e&&e.action_type&&r.add(e.action_type)}),e.conversions&&Array.isArray(e.conversions)&&e.conversions.forEach(e=>{e&&e.action_type&&r.add(e.action_type)}),e.conversion_values&&Array.isArray(e.conversion_values)&&e.conversion_values.forEach(e=>{e&&e.action_type&&r.add(e.action_type)})):console.warn("Invalid record in ActionMapper:",e)}):console.warn("Records is not an array in ActionMapper:",typeof t,t)})}catch(e){console.error("Error loading data for config ".concat(n.config_hash,":"),e)}const a=new Set([...Rs,...Array.from(r)]);n(Array.from(a).sort())}catch(e){console.error("Error discovering actions:",e),n(Rs)}finally{i(!1)}},b=()=>0===o.actionTypes.length?[]:(e=>{const t=[];return Object.entries(Ds).forEach(r=>{let[n,a]=r;const s=e.filter(e=>a.suggestedActions.includes(e));s.length>0&&t.push({concept:n,description:a.description,matchingActions:s,confidence:s.length/a.suggestedActions.length})}),t.sort((e,t)=>t.confidence-e.confidence)})(o.actionTypes),y={totalMappings:Object.keys(e).length,totalActionsMapped:Object.values(e).reduce((e,t)=>e+t.actionTypes.length,0),unmappedActions:r.filter(t=>!Object.values(e).some(e=>e.actionTypes.includes(t)))};return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold",children:"Meta Action Mapping"}),(0,ut.jsx)("button",{onClick:()=>d(!c),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:c?"Cancel":"Add New Mapping"})]}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Map Meta action types to business concepts for better reporting and analysis. This helps aggregate related actions into meaningful metrics."}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Total Mappings"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-blue-800 dark:text-blue-100",children:y.totalMappings})]}),(0,ut.jsxs)("div",{className:"bg-green-50 dark:bg-green-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-sm text-green-600 dark:text-green-300",children:"Actions Mapped"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-green-800 dark:text-green-100",children:y.totalActionsMapped})]}),(0,ut.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900 p-3 rounded",children:[(0,ut.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-300",children:"Unmapped Actions"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-orange-800 dark:text-orange-100",children:y.unmappedActions.length})]})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("span",{className:"text-sm text-gray-500",children:[r.length," unique action types available (including ",Rs.length," known from comprehensive analysis)"]}),(0,ut.jsx)("button",{onClick:x,disabled:a,className:"text-sm text-blue-600 hover:text-blue-800 disabled:text-gray-400",children:a?"Discovering...":"Refresh Action Types"})]})]}),c&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Create New Mapping"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Concept Name"}),(0,ut.jsx)("input",{type:"text",value:o.conceptName,onChange:e=>l(Ie(Ie({},o),{},{conceptName:e.target.value})),placeholder:"e.g., conversions, leads, purchases",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"}),(0,ut.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Suggested: ",p.join(", ")]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Aggregation Type"}),(0,ut.jsxs)("select",{value:o.aggregationType,onChange:e=>l(Ie(Ie({},o),{},{aggregationType:e.target.value})),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[(0,ut.jsx)("option",{value:"sum",children:"Sum (total count/value)"}),(0,ut.jsx)("option",{value:"count",children:"Count (number of action types)"}),(0,ut.jsx)("option",{value:"average",children:"Average (mean value)"})]})]})]}),o.actionTypes.length>0&&(0,ut.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900 rounded-lg",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"\ud83d\udca1 Smart Suggestions"}),(0,ut.jsxs)("button",{onClick:()=>h(!u),className:"text-xs text-blue-600 hover:text-blue-800",children:[u?"Hide":"Show"," Suggestions"]})]}),u&&(0,ut.jsxs)("div",{className:"space-y-2",children:[b().map((e,t)=>(0,ut.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-700 rounded text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium text-blue-600",children:e.concept}),(0,ut.jsxs)("span",{className:"text-gray-500 ml-2",children:["(",Math.round(100*e.confidence),"% match)"]}),(0,ut.jsx)("div",{className:"text-gray-400 mt-1",children:e.description})]}),(0,ut.jsx)("button",{onClick:()=>(e=>{l(Ie(Ie({},o),{},{conceptName:e.concept,actionTypes:[...new Set([...o.actionTypes,...e.matchingActions])]}))})(e),className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Apply"})]},t)),0===b().length&&(0,ut.jsx)("div",{className:"text-xs text-gray-500 italic",children:"No business concept suggestions for your current selection."})]})]}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Select Action Types (",o.actionTypes.length," selected)"]}),Object.entries((e=>{const t={};return Object.keys(Ms).forEach(e=>{const r=e.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase());t[r]=[]}),t.Other=[],e.forEach(e=>{const r=(e=>{for(const[t,r]of Object.entries(Ms))if(r.includes(e))return t;return"OTHER"})(e);if("OTHER"===r)t.Other.push(e);else{const n=r.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase());t[n]?t[n].push(e):t.Other.push(e)}}),t})(r)).map(e=>{let[t,r]=e;return r.length>0&&(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(e=>(0,ut.jsx)("button",{onClick:()=>(e=>{const t=o.actionTypes,r=t.includes(e)?t.filter(t=>t!==e):[...t,e];l(Ie(Ie({},o),{},{actionTypes:r}))})(e),className:"px-3 py-1 rounded-full text-xs ".concat(o.actionTypes.includes(e)?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300"),children:e},e))})]},t)})]}),(0,ut.jsxs)("div",{className:"flex space-x-2",children:[(0,ut.jsx)("button",{onClick:()=>{if(!o.conceptName||0===o.actionTypes.length)return void alert("Please enter a concept name and select at least one action type");const t=Ie(Ie({},e),{},{[o.conceptName]:{actionTypes:o.actionTypes,aggregationType:o.aggregationType,createdAt:(new Date).toISOString()}});g(t),l({conceptName:"",actionTypes:[],aggregationType:"sum"}),d(!1)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Create Mapping"}),(0,ut.jsx)("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"})]})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium mb-4",children:["Current Mappings (",Object.keys(e).length,")"]}),0===Object.keys(e).length?(0,ut.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,ut.jsx)("p",{children:"No mappings created yet."}),(0,ut.jsx)("p",{className:"text-sm mt-2",children:"Create your first mapping to start organizing action types into business concepts."})]}):(0,ut.jsx)("div",{className:"space-y-4",children:Object.entries(e).map(t=>{let[r,n]=t;return(0,ut.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-lg font-medium text-blue-800 dark:text-blue-200",children:r}),(0,ut.jsxs)("div",{className:"text-sm text-gray-500",children:["Aggregation: ",n.aggregationType," \u2022 ",n.actionTypes.length," action types"]})]}),(0,ut.jsx)("button",{onClick:()=>(t=>{if(window.confirm('Are you sure you want to delete the mapping for "'.concat(t,'"?'))){const r=Ie({},e);delete r[t],g(r)}})(r),className:"text-red-500 hover:text-red-700 text-sm",children:"Delete"})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:n.actionTypes.map(e=>(0,ut.jsx)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded text-xs",children:e},e))})]},r)})})]}),y.unmappedActions.length>0&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium mb-4",children:["Unmapped Action Types (",y.unmappedActions.length,")"]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:y.unmappedActions.map(e=>(0,ut.jsx)("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 rounded text-xs",children:e},e))})]})]})},Ls=()=>{const[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)("ad_performance_daily"),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(!1),[p,m]=(0,s.useState)("2025-04-01"),[f,g]=(0,s.useState)(()=>{const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]}),[x,b]=(0,s.useState)(!1),[y,v]=(0,s.useState)(null),[_,k]=(0,s.useState)(null),[j,w]=(0,s.useState)(null),[N,S]=(0,s.useState)(null),[O,C]=(0,s.useState)(new Set),[E,P]=(0,s.useState)(!1);(0,s.useEffect)(()=>{A(),T("ad_performance_daily")},[]);const A=async()=>{try{const e=await Ja();t(e)}catch(c){console.error("Error loading tables overview:",c),d("Failed to load tables overview: ".concat(c.message))}},T=async e=>{l(!0),d(null),C(new Set);try{const t=await Qa(e);i(t),n(e)}catch(c){console.error("Error loading aggregated data for ".concat(e,":"),c),d("Failed to load data: ".concat(c.message)),i(null)}finally{l(!1)}},M=e=>"unique_countries"===e?"Countries":"unique_devices"===e?"Devices":"unique_regions"===e?"Regions":e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()).replace("Unique ","").replace("Total ",""),R=(e,t)=>null===e||void 0===e?"\u2014":t.includes("spend")?"$".concat(e.toLocaleString()):(t.includes("unique")||t.includes("total"),e.toLocaleString());if(c)return(0,ut.jsxs)("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[(0,ut.jsx)("h3",{className:"text-red-800 font-medium text-lg",children:"Error"}),(0,ut.jsx)("p",{className:"text-red-600 mt-2",children:c}),(0,ut.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Reload Page"})]});const D=e?Object.entries(e).filter(e=>{let[t,r]=e;return t.startsWith("ad_performance_")}).sort((e,t)=>{let[r]=e,[n]=t;return r.localeCompare(n)}):[],I=e?Object.entries(e).filter(e=>{let[t,r]=e;return!t.startsWith("ad_performance_")&&0===r.row_count}).sort((e,t)=>{let[r]=e,[n]=t;return r.localeCompare(n)}):[];return(0,ut.jsxs)("div",{className:"space-y-8",children:[(0,ut.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,ut.jsx)("div",{className:"px-8 py-6 border-b border-gray-200 bg-gray-50",children:(0,ut.jsx)("div",{className:"flex justify-between items-center",children:(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:r.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,ut.jsxs)("p",{className:"text-gray-600 mt-1",children:["Complete daily performance metrics",(null===a||void 0===a?void 0:a.breakdown_dimension)&&" (aggregated across ".concat(a.breakdown_dimension,")")]})]})})}),(0,ut.jsxs)("div",{className:"p-8",children:["composite_validation"!==r&&(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Fill Missing Data"}),(0,ut.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:[(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsx)("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,ut.jsx)("input",{id:"start-date",type:"date",value:p,onChange:e=>m(e.target.value),disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsx)("label",{htmlFor:"end-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,ut.jsx)("input",{id:"end-date",type:"date",value:f,onChange:e=>g(e.target.value),disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),(0,ut.jsx)("button",{onClick:async()=>{if(!r||"composite_validation"===r)return;if(!p||!f)return void v("Both start date and end date are required");if(p>f)return void v("Start date must be before or equal to end date");const e=(new Date).toISOString().split("T")[0];if(f>e)v("End date cannot be in the future");else{b(!0),v(null),k(null);try{const e={ad_performance_daily:null,ad_performance_daily_country:"country",ad_performance_daily_region:"region",ad_performance_daily_device:"device"}[r]||null;await Za({table_name:r,breakdown_type:e,start_date:p,end_date:f,skip_existing:!0}),k("Successfully filled gaps in ".concat(r," from ").concat(p," to ").concat(f)),setTimeout(()=>{T(r),k(null)},3e3)}catch(c){console.error("Error updating table:",c),v("Failed to update table: ".concat(c.message))}finally{b(!1)}}},disabled:x||!p||!f||p>f,className:"px-6 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:x?(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),(0,ut.jsx)("span",{children:"Updating..."})]}):"Fill Gaps"})]}),_&&(0,ut.jsx)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-green-500",children:"\u2705"}),(0,ut.jsx)("span",{className:"text-sm text-green-800",children:_})]})}),y&&(0,ut.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-red-500",children:"\u274c"}),(0,ut.jsx)("span",{className:"text-sm text-red-800",children:y})]})})]}),N&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-green-500",children:"\u2705"}),(0,ut.jsx)("span",{className:"text-sm text-green-800",children:N})]})}),j&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-red-500",children:"\u274c"}),(0,ut.jsx)("span",{className:"text-sm text-red-800",children:j})]})}),O.size>0&&"composite_validation"!==r&&(0,ut.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("div",{className:"text-sm font-medium text-blue-900",children:[O.size," date",1!==O.size?"s":""," selected"]}),(0,ut.jsx)("button",{onClick:()=>C(new Set),className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Clear selection"})]}),(0,ut.jsx)("button",{onClick:async()=>{if("composite_validation"===r||0===O.size)return;const e=Array.from(O).sort();if(!window.confirm("Are you sure you want to delete all data for ".concat(O.size," selected dates from ").concat(r,"?\n\nDates: ").concat(e.join(", "),"\n\nThis action cannot be undone.")))return;P(!0),w(null),S(null);let t=0,n=0,a=0;const s=[];try{for(const l of e)try{const e=await es(r,l);t++,a+=e.rows_deleted}catch(c){var i,o;n++;const t=(null===(i=c.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.error)||c.message||"Unknown error";s.push("".concat(l,": ").concat(t))}0===n?S("Successfully deleted ".concat(a," rows across ").concat(t," dates from ").concat(r)):0===t?w("Failed to delete all ".concat(O.size," dates:\n").concat(s.join("\n"))):(S("Partially successful: ".concat(t," dates deleted (").concat(a," rows), ").concat(n," failed")),s.length>0&&console.error("Bulk delete errors:",s)),C(new Set),setTimeout(()=>{T(r),S(null)},3e3)}catch(c){console.error("Error in bulk delete:",c),w("Bulk delete failed: ".concat(c.message))}finally{P(!1)}},disabled:E,className:"px-4 py-2 bg-red-600 text-white rounded-md text-sm font-medium hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:E?(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),(0,ut.jsx)("span",{children:"Deleting..."})]}):"Delete ".concat(O.size," date").concat(1!==O.size?"s":"")})]})}),a&&(()=>{if(null===a||void 0===a||!a.date_analysis)return null;const e=a.date_analysis;return(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Data Overview"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.available_days}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Available Days"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:e.date_range?e.date_range.start:"N/A"}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"First Date"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:e.date_range?e.date_range.end:"N/A"}),(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:"Last Date"})]})]}),e.warnings&&e.warnings.length>0&&(0,ut.jsxs)("div",{className:"space-y-2",children:[e.warnings.map((e,t)=>(0,ut.jsxs)("div",{className:"flex items-center space-x-2 text-amber-700 bg-amber-50 px-3 py-2 rounded",children:[(0,ut.jsx)("span",{className:"text-amber-500",children:"\u26a0\ufe0f"}),(0,ut.jsx)("span",{className:"text-sm font-medium",children:e})]},t)),e.missing_dates&&e.missing_dates.length>0&&(0,ut.jsxs)("details",{className:"mt-2",children:[(0,ut.jsxs)("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:["View missing dates (",e.missing_dates.length,")"]}),(0,ut.jsx)("div",{className:"mt-2 text-xs text-gray-600 max-h-32 overflow-y-auto",children:e.missing_dates.join(", ")})]}),e.empty_days&&e.empty_days.length>0&&(0,ut.jsxs)("details",{className:"mt-2",children:[(0,ut.jsxs)("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:["View empty days (",e.empty_days.length,")"]}),(0,ut.jsx)("div",{className:"mt-2 text-xs text-gray-600 max-h-32 overflow-y-auto",children:e.empty_days.join(", ")})]})]})]})})(),o?(0,ut.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mr-3"}),(0,ut.jsxs)("span",{className:"text-gray-600",children:["Loading ","composite_validation"===r?"all":"table"," metrics..."]})]}):a&&a.dates&&a.dates.length>0?(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full",children:[(0,ut.jsx)("thead",{className:"bg-gray-50",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 border-r border-gray-200 sticky left-0 bg-gray-50 z-10",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{children:"Metric"}),"composite_validation"!==r&&(null===a||void 0===a?void 0:a.dates)&&(0,ut.jsx)("input",{type:"checkbox",checked:O.size===a.dates.length&&a.dates.length>0,onChange:e=>{return t=e.target.checked,void C(t?new Set((null===a||void 0===a?void 0:a.dates)||[]):new Set);var t},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",title:"Select all dates"})]})}),a.dates.map(e=>{var t,n;const s=a.date_analysis,i=null===s||void 0===s||null===(t=s.missing_dates)||void 0===t?void 0:t.includes(e),o=null===s||void 0===s||null===(n=s.empty_days)||void 0===n?void 0:n.includes(e),l="composite_validation"!==r,c=O.has(e);return(0,ut.jsx)("th",{className:"px-3 py-3 text-center text-sm font-semibold border-r border-gray-200 min-w-[100px] relative group ".concat(c?"bg-blue-100 text-blue-900 ring-2 ring-blue-300":i?"bg-red-100 text-red-800":o?"bg-yellow-100 text-yellow-800":"text-gray-900"),children:(0,ut.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ut.jsx)("div",{children:(d=e,new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric"}))}),(0,ut.jsx)("div",{className:"text-xs font-normal mt-1 opacity-75",children:e}),(i||o)&&(0,ut.jsx)("div",{className:"text-xs mt-1",children:i?"\u274c":o?"\u26a0\ufe0f":""}),l&&(0,ut.jsx)("div",{className:"mt-1 transition-opacity duration-200 ".concat(c?"opacity-100":"opacity-0 group-hover:opacity-100"),children:(0,ut.jsx)("input",{type:"checkbox",checked:c,onChange:t=>((e,t)=>{const r=new Set(O);t?r.add(e):r.delete(e),C(r)})(e,t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Select ".concat(e," for bulk deletion")})})]})},e);var d})]})}),(0,ut.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:a.metric_names.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white":"bg-gray-50",children:[(0,ut.jsx)("td",{className:"px-6 py-2 text-sm font-medium text-gray-900 border-r border-gray-200 sticky left-0 bg-inherit z-10",children:M(e)}),a.dates.map(t=>{var r,n,s,i;const o=null===(r=a.metrics_data[t])||void 0===r?void 0:r[e],l=a.date_analysis,c=null===l||void 0===l||null===(n=l.empty_days)||void 0===n?void 0:n.includes(t),d="composite_validation"===a.table_name?null===(s=a.validation_errors)||void 0===s||null===(i=s[t])||void 0===i?void 0:i[e]:null,u="MISSING_BASE"===o||"MISSING_TABLE"===o||"MISSING_DATE"===o||("unique_countries"===e||"unique_devices"===e||"unique_regions"===e)&&0===o,h=d&&"missing"===d.type,p=d&&("discrepancy"===d.type||"mixed"===d.type);let m="text-red-600",f="bg-red-50";if(p){const e=d.max_percentage;e<5?(m="text-yellow-600",f="bg-yellow-50"):e<10?(m="text-orange-600",f="bg-orange-50"):(m="text-red-600",f="bg-red-50")}return(0,ut.jsx)("td",{className:"px-3 py-2 text-center text-sm border-r border-gray-200 font-mono ".concat(u||h?"bg-red-50":p?f:c?"bg-yellow-50 text-yellow-800":"text-gray-700"),children:u?(0,ut.jsx)("div",{className:"text-red-600 font-bold text-lg",title:"Base table missing data",children:"\u2717"}):h?(0,ut.jsx)("div",{className:"text-red-600 font-bold text-lg",title:"All tables missing: ".concat(d.missing_tables.join(", ")),children:"\u2717"}):p?(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"".concat(m," font-bold"),children:R(o,e)}),(0,ut.jsxs)("div",{className:"text-xs ".concat(m," mt-1"),children:[d.discrepancies.map((e,t)=>(0,ut.jsxs)("div",{children:[e.table,": ",e.value]},t)),"mixed"===d.type&&d.missing_tables&&(0,ut.jsxs)("div",{className:"text-red-600 mt-1",children:["Missing: ",d.missing_tables.join(", ")]})]})]}):R(o,e)},"".concat(e,"-").concat(t))})]},e))})]})}):a?(0,ut.jsx)("div",{className:"flex items-center justify-center py-12 text-gray-500",children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg mb-2",children:"\ud83d\udced"}),(0,ut.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Empty Table"}),(0,ut.jsx)("div",{className:"text-sm",children:'This table contains no data yet. Use the "Fill Gaps" feature above to populate it with Meta advertising data.'})]})}):(0,ut.jsx)("div",{className:"flex items-center justify-center py-12 text-gray-500",children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg mb-2",children:"\ud83d\udcca"}),(0,ut.jsx)("div",{children:"Select a table to view metrics"})]})})]})]}),(0,ut.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,ut.jsx)("div",{className:"px-8 py-6 border-b border-gray-200",children:(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Available Performance Tables"}),(0,ut.jsx)("p",{className:"text-gray-600 mt-1",children:"Select a table to view complete aggregated daily metrics"})]}),(0,ut.jsx)("button",{onClick:()=>T("composite_validation"),className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat("composite_validation"===r?"bg-purple-600 text-white":"bg-purple-100 text-purple-700 hover:bg-purple-200"),children:"All"})]})}),(0,ut.jsxs)("div",{className:"p-8",children:[(0,ut.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:D.map(e=>{let[t,n]=e;const a=0===n.row_count;return(0,ut.jsxs)("div",{className:"p-6 border-2 rounded-lg cursor-pointer transition-all duration-200 ".concat(r===t?"border-blue-500 bg-blue-50 shadow-md":a?"border-orange-200 hover:border-orange-300 hover:bg-orange-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),onClick:()=>T(t),children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:t.replace("ad_performance_daily_","").replace("ad_performance_daily","Base")||"Base"}),(0,ut.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded ".concat(a?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"),children:a?"Empty":"".concat(n.row_count.toLocaleString()," rows")})]}),(0,ut.jsxs)("div",{className:"text-xs text-gray-600 mb-2",children:[n.columns.length," columns"]}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"ad_performance_daily"===t?"No breakdown dimension":"Breakdown by ".concat(t.replace("ad_performance_daily_",""))}),a?(0,ut.jsxs)("div",{className:"text-xs text-orange-600 bg-orange-50 px-2 py-1 rounded",children:[(0,ut.jsx)("div",{className:"font-medium",children:"No data available"}),(0,ut.jsx)("div",{className:"opacity-75",children:'Use "Fill Gaps" to populate'})]}):n.date_range?(0,ut.jsxs)("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[(0,ut.jsxs)("div",{className:"font-medium",children:[n.available_days," days available"]}),(0,ut.jsx)("div",{className:"opacity-75",children:(()=>{const e=new Date(n.date_range.start),t=new Date(n.date_range.end);return e.getFullYear()===t.getFullYear()?"".concat(e.toLocaleDateString("en-US",{month:"short",day:"numeric"})," to ").concat(t.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})):"".concat(e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," to ").concat(t.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}))})()})]}):null]},t)})}),I.length>0&&(0,ut.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,ut.jsxs)("button",{onClick:()=>h(!u),className:"flex items-center space-x-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:[(0,ut.jsxs)("span",{children:[u?"Hide":"Show"," other empty tables (",I.length,")"]}),(0,ut.jsx)("span",{className:"transform transition-transform duration-200",style:{transform:u?"rotate(180deg)":"rotate(0deg)"},children:"\u25bc"})]}),u&&(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4",children:I.map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,ut.jsx)("h4",{className:"font-medium text-gray-700 text-sm",children:t}),(0,ut.jsx)("span",{className:"px-2 py-1 text-xs rounded bg-gray-200 text-gray-600",children:"0 rows"})]}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500",children:[r.columns.length," columns"]})]},t)})})]})]})]})]})},Fs=()=>{const[e,t]=(0,s.useState)("table-view"),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)("1"),[u,h]=(0,s.useState)({}),[p,m]=(0,s.useState)({}),[f,g]=(0,s.useState)(null);return(0,s.useEffect)(()=>{const e=localStorage.getItem("metaDebugger_selectedFields"),t=localStorage.getItem("metaDebugger_selectedBreakdowns");if(e)h(JSON.parse(e));else{const e={};"ad_id,ad_name,adset_id,adset_name,campaign_id,campaign_name,impressions,clicks,spend".split(",").forEach(t=>{e[t]=!0}),h(e)}t&&m(JSON.parse(t))},[]),(0,s.useEffect)(()=>{const e=localStorage.getItem("metaDebugger_startDate"),t=localStorage.getItem("metaDebugger_endDate"),r=localStorage.getItem("metaDebugger_increment");e&&i(e),t&&l(t),r&&d(r)},[]),(0,s.useEffect)(()=>{localStorage.setItem("metaDebugger_startDate",a),localStorage.setItem("metaDebugger_endDate",o),localStorage.setItem("metaDebugger_increment",c),localStorage.setItem("metaDebugger_selectedFields",JSON.stringify(gs(u))),localStorage.setItem("metaDebugger_selectedBreakdowns",JSON.stringify(gs(p)))},[a,o,c,u,p]),(0,s.useEffect)(()=>{const e=e=>{r&&!e.target.closest(".relative")&&n(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[r]),(0,ut.jsx)("div",{className:"flex",children:(0,ut.jsxs)("div",{className:"flex-1 p-6 max-w-5xl",children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Meta API Debugger"}),(0,ut.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 mb-6",children:(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("div",{className:"flex space-x-4",children:[(0,ut.jsx)("button",{onClick:()=>t("table-view"),className:"px-4 py-2 rounded ".concat("table-view"===e?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700"),children:"Table View"}),(0,ut.jsx)("button",{onClick:()=>t("live"),className:"px-4 py-2 rounded ".concat("live"===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:"Live API Testing"})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("button",{onClick:()=>n(!r),className:"px-3 py-2 rounded flex items-center space-x-1 ".concat(["historical","mapping"].includes(e)?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,ut.jsx)("span",{children:"\u2699\ufe0f"}),(0,ut.jsx)("span",{className:"text-sm",children:"More"}),(0,ut.jsx)("span",{className:"transform transition-transform duration-200 ".concat(r?"rotate-180":""),children:"\u25bc"})]}),r&&(0,ut.jsxs)("div",{className:"absolute right-0 top-full mt-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-10 min-w-[200px]",children:[(0,ut.jsx)("button",{onClick:()=>{t("historical"),n(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 first:rounded-t-lg ".concat("historical"===e?"bg-green-50 text-green-700 dark:bg-green-900 dark:text-green-200":"text-gray-700 dark:text-gray-300"),children:"Historical Data Collection"}),(0,ut.jsx)("button",{onClick:()=>{t("mapping"),n(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 last:rounded-b-lg ".concat("mapping"===e?"bg-purple-50 text-purple-700 dark:bg-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"),children:"Action Mapping"})]})]})]})}),"table-view"===e&&(0,ut.jsx)(Ls,{}),"live"===e&&(0,ut.jsx)(Cs,{startDateInput:a,setStartDateInput:i,endDateInput:o,setEndDateInput:l,incrementInput:c,setIncrementInput:d,selectedFields:u,setSelectedFields:h,selectedBreakdowns:p,setSelectedBreakdowns:m,error:f,setError:g}),"historical"===e&&(0,ut.jsx)(Ts,{startDateInput:a,setStartDateInput:i,endDateInput:o,setEndDateInput:l,selectedFields:u,setSelectedFields:h,selectedBreakdowns:p,setSelectedBreakdowns:m,error:f,setError:g}),"mapping"===e&&(0,ut.jsx)(Is,{selectedFields:u,setSelectedFields:h,selectedBreakdowns:p,setSelectedBreakdowns:m,error:f,setError:g}),f&&(0,ut.jsxs)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-100 rounded",children:["Error: ",f]})]})})};function Bs(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Bs(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}const Us=function(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Bs(e))&&(n&&(n+=" "),n+=t);return n};var zs=r(9889),Vs=r.n(zs),Hs=r(620),Ws=r.n(Hs),qs=r(5268),Gs=r.n(qs),$s=r(3097),Ks=r.n($s),Ys=r(9160),Xs=r.n(Ys),Js=function(e){return 0===e?0:e>0?1:-1},Qs=function(e){return Ws()(e)&&e.indexOf("%")===e.length-1},Zs=function(e){return Xs()(e)&&!Gs()(e)},ei=function(e){return Zs(e)||Ws()(e)},ti=0,ri=function(e){var t=++ti;return"".concat(e||"").concat(t)},ni=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Zs(e)&&!Ws()(e))return n;if(Qs(e)){var s=e.indexOf("%");r=t*parseFloat(e.slice(0,s))/100}else r=+e;return Gs()(r)&&(r=n),a&&r>t&&(r=t),r},ai=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},si=function(e,t){return Zs(e)&&Zs(t)?function(r){return e+r*(t-e)}:function(){return t}};function ii(e,t,r){return e&&e.length?e.find(function(e){return e&&("function"===typeof t?t(e):Ks()(e,t))===r}):null}var oi=function(e,t){return Zs(e)&&Zs(t)?e-t:Ws()(e)&&Ws()(t)?e.localeCompare(t):e instanceof Date&&t instanceof Date?e.getTime()-t.getTime():String(e).localeCompare(String(t))},li=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a]},ci=r(9686),di=r.n(ci),ui=r(1629),hi=r.n(ui),pi=r(6686),mi=r.n(pi),fi=r(9062);function gi(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function xi(e){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}var bi=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],yi=["points","pathLength"],vi={svg:["viewBox","children"],polygon:yi,polyline:yi},_i=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ki=function(e,t){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,s.isValidElement)(e)&&(r=e.props),!mi()(r))return null;var n={};return Object.keys(r).forEach(function(e){_i.includes(e)&&(n[e]=t||function(t){return r[e](r,t)})}),n},ji=function(e,t,r){if(!mi()(e)||"object"!==xi(e))return null;var n=null;return Object.keys(e).forEach(function(a){var s=e[a];_i.includes(a)&&"function"===typeof s&&(n||(n={}),n[a]=function(e,t,r){return function(n){return e(t,r,n),null}}(s,t,r))}),n},wi=["children"],Ni=["children"];function Si(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Oi(e){return Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(e)}var Ci={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Ei=function(e){return"string"===typeof e?e:e?e.displayName||e.name||"Component":""},Pi=null,Ai=null,Ti=function e(t){if(t===Pi&&Array.isArray(Ai))return Ai;var r=[];return s.Children.forEach(t,function(t){di()(t)||((0,fi.isFragment)(t)?r=r.concat(e(t.props.children)):r.push(t))}),Ai=r,Pi=t,r};function Mi(e,t){var r=[],n=[];return n=Array.isArray(t)?t.map(function(e){return Ei(e)}):[Ei(t)],Ti(e).forEach(function(e){var t=Ks()(e,"type.displayName")||Ks()(e,"type.name");-1!==n.indexOf(t)&&r.push(e)}),r}function Ri(e,t){var r=Mi(e,t);return r&&r[0]}var Di=function(e){if(!e||!e.props)return!1;var t=e.props,r=t.width,n=t.height;return!(!Zs(r)||r<=0||!Zs(n)||n<=0)},Ii=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Li=function(e){return e&&e.type&&Ws()(e.type)&&Ii.indexOf(e.type)>=0},Fi=function(e,t,r){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,s.isValidElement)(e)&&(n=e.props),!mi()(n))return null;var a={};return Object.keys(n).forEach(function(e){var s;(function(e,t,r,n){var a,s=null!==(a=null===vi||void 0===vi?void 0:vi[n])&&void 0!==a?a:[];return t.startsWith("data-")||!hi()(e)&&(n&&s.includes(t)||bi.includes(t))||r&&_i.includes(t)})(null===(s=n)||void 0===s?void 0:s[e],e,t,r)&&(a[e]=n[e])}),a},Bi=function e(t,r){if(t===r)return!0;var n=s.Children.count(t);if(n!==s.Children.count(r))return!1;if(0===n)return!0;if(1===n)return Ui(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!Ui(i,o))return!1}return!0},Ui=function(e,t){if(di()(e)&&di()(t))return!0;if(!di()(e)&&!di()(t)){var r=e.props||{},n=r.children,a=Si(r,wi),s=t.props||{},i=s.children,o=Si(s,Ni);return n&&i?gi(a,o)&&Bi(n,i):!n&&!i&&gi(a,o)}return!1},zi=function(e,t){var r=[],n={};return Ti(e).forEach(function(e,a){if(Li(e))r.push(e);else if(e){var s=Ei(e.type),i=t[s]||{},o=i.handler,l=i.once;if(o&&(!l||!n[s])){var c=o(e,s,a);r.push(c),n[s]=!0}}}),r};function Vi(e){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vi(e)}function Hi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Wi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hi(Object(r),!0).forEach(function(t){qi(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hi(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function qi(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Vi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Vi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Vi(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return $i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ki=(0,s.forwardRef)(function(e,t){var r=e.aspect,n=e.initialDimension,a=void 0===n?{width:-1,height:-1}:n,i=e.width,o=void 0===i?"100%":i,l=e.height,c=void 0===l?"100%":l,d=e.minWidth,u=void 0===d?0:d,h=e.minHeight,p=e.maxHeight,m=e.children,f=e.debounce,g=void 0===f?0:f,x=e.id,b=e.className,y=e.onResize,v=e.style,_=void 0===v?{}:v,k=(0,s.useRef)(null),j=(0,s.useRef)();j.current=y,(0,s.useImperativeHandle)(t,function(){return Object.defineProperty(k.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),k.current},configurable:!0})});var w=Gi((0,s.useState)({containerWidth:a.width,containerHeight:a.height}),2),N=w[0],S=w[1],O=(0,s.useCallback)(function(e,t){S(function(r){var n=Math.round(e),a=Math.round(t);return r.containerWidth===n&&r.containerHeight===a?r:{containerWidth:n,containerHeight:a}})},[]);(0,s.useEffect)(function(){var e=function(e){var t,r=e[0].contentRect,n=r.width,a=r.height;O(n,a),null===(t=j.current)||void 0===t||t.call(j,n,a)};g>0&&(e=Vs()(e,g,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),r=k.current.getBoundingClientRect(),n=r.width,a=r.height;return O(n,a),t.observe(k.current),function(){t.disconnect()}},[O,g]);var C=(0,s.useMemo)(function(){var e=N.containerWidth,t=N.containerHeight;if(e<0||t<0)return null;li(Qs(o)||Qs(c),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",o,c),li(!r||r>0,"The aspect(%s) must be greater than zero.",r);var n=Qs(o)?e:o,a=Qs(c)?t:c;r&&r>0&&(n?a=n/r:a&&(n=a*r),p&&a>p&&(a=p)),li(n>0||a>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",n,a,o,c,u,h,r);var i=!Array.isArray(m)&&Ei(m.type).endsWith("Chart");return s.Children.map(m,function(e){return s.isValidElement(e)?(0,s.cloneElement)(e,Wi({width:n,height:a},i?{style:Wi({height:"100%",width:"100%",maxHeight:a,maxWidth:n},e.props.style)}:{})):e})},[r,m,c,p,h,u,N,o]);return s.createElement("div",{id:x?"".concat(x):void 0,className:Us("recharts-responsive-container",b),style:Wi(Wi({},_),{},{width:o,height:c,minWidth:u,minHeight:h,maxHeight:p}),ref:k},C)}),Yi=r(6604),Xi=r.n(Yi),Ji=r(7424),Qi=r.n(Ji),Zi="Invariant failed";function eo(e,t){if(!e)throw new Error(Zi)}var to=["children","width","height","viewBox","className","style","title","desc"];function ro(){return ro=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ro.apply(this,arguments)}function no(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ao(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,d=no(e,to),u=a||{width:r,height:n,x:0,y:0},h=Us("recharts-surface",i);return s.createElement("svg",ro({},Fi(d,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),s.createElement("title",null,l),s.createElement("desc",null,c),t)}var so=["children","className"];function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},io.apply(this,arguments)}function oo(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var lo=s.forwardRef(function(e,t){var r=e.children,n=e.className,a=oo(e,so),i=Us("recharts-layer",n);return s.createElement("g",io({className:i},Fi(a,!0),{ref:t}),r)});function co(e){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(e)}function uo(){return uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uo.apply(this,arguments)}function ho(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return po(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return po(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function po(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function fo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(r),!0).forEach(function(t){go(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function go(e,t,r){return t=function(e){var t=function(e,t){if("object"!=co(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==co(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xo(e){return Array.isArray(e)&&ei(e[0])&&ei(e[1])?e.join(" ~ "):e}var bo=function(e){var t=e.separator,r=void 0===t?" : ":t,n=e.contentStyle,a=void 0===n?{}:n,i=e.itemStyle,o=void 0===i?{}:i,l=e.labelStyle,c=void 0===l?{}:l,d=e.payload,u=e.formatter,h=e.itemSorter,p=e.wrapperClassName,m=e.labelClassName,f=e.label,g=e.labelFormatter,x=e.accessibilityLayer,b=void 0!==x&&x,y=fo({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),v=fo({margin:0},c),_=!di()(f),k=_?f:"",j=Us("recharts-default-tooltip",p),w=Us("recharts-tooltip-label",m);_&&g&&void 0!==d&&null!==d&&(k=g(f,d));var N=b?{role:"status","aria-live":"assertive"}:{};return s.createElement("div",uo({className:j,style:y},N),s.createElement("p",{className:w,style:v},s.isValidElement(k)?k:"".concat(k)),function(){if(d&&d.length){var e=(h?Qi()(d,h):d).map(function(e,t){if("none"===e.type)return null;var n=fo({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},o),a=e.formatter||u||xo,i=e.value,l=e.name,c=i,h=l;if(a&&null!=c&&null!=h){var p=a(i,l,e,t,d);if(Array.isArray(p)){var m=ho(p,2);c=m[0],h=m[1]}else c=p}return s.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(t),style:n},ei(h)?s.createElement("span",{className:"recharts-tooltip-item-name"},h):null,ei(h)?s.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,s.createElement("span",{className:"recharts-tooltip-item-value"},c),s.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return s.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null}())};function yo(e){return yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yo(e)}function vo(e,t,r){return t=function(e){var t=function(e,t){if("object"!=yo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=yo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yo(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _o="recharts-tooltip-wrapper",ko={visibility:"hidden"};function jo(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Us(_o,vo(vo(vo(vo({},"".concat(_o,"-right"),Zs(r)&&t&&Zs(t.x)&&r>=t.x),"".concat(_o,"-left"),Zs(r)&&t&&Zs(t.x)&&r<t.x),"".concat(_o,"-bottom"),Zs(n)&&t&&Zs(t.y)&&n>=t.y),"".concat(_o,"-top"),Zs(n)&&t&&Zs(t.y)&&n<t.y))}function wo(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,s=e.position,i=e.reverseDirection,o=e.tooltipDimension,l=e.viewBox,c=e.viewBoxDimension;if(s&&Zs(s[n]))return s[n];var d=r[n]-o-a,u=r[n]+a;return t[n]?i[n]?d:u:i[n]?d<l[n]?Math.max(u,l[n]):Math.max(d,l[n]):u+o>l[n]+c?Math.max(d,l[n]):Math.max(u,l[n])}function No(e){return No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},No(e)}function So(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?So(Object(r),!0).forEach(function(t){Mo(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):So(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Co(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ro(n.key),n)}}function Eo(e,t,r){return t=Ao(t),function(e,t){if(t&&("object"===No(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Po()?Reflect.construct(t,r||[],Ao(e).constructor):t.apply(e,r))}function Po(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Po=function(){return!!e})()}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ao(e)}function To(e,t){return To=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},To(e,t)}function Mo(e,t,r){return(t=Ro(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ro(e){var t=function(e,t){if("object"!=No(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=No(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==No(t)?t:t+""}var Do=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return Mo(e=Eo(this,t,[].concat(n)),"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Mo(e,"handleKeyDown",function(t){var r,n,a,s;"Escape"===t.key&&e.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(r=null===(n=e.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==r?r:0,y:null!==(a=null===(s=e.props.coordinate)||void 0===s?void 0:s.y)&&void 0!==a?a:0}})}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&To(e,t)}(t,e),r=t,n=[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();(Math.abs(e.width-this.state.lastBoundingBox.width)>1||Math.abs(e.height-this.state.lastBoundingBox.height)>1)&&this.setState({lastBoundingBox:{width:e.width,height:e.height}})}else-1===this.state.lastBoundingBox.width&&-1===this.state.lastBoundingBox.height||this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var e,t;this.props.active&&this.updateBBox(),this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}},{key:"render",value:function(){var e=this,t=this.props,r=t.active,n=t.allowEscapeViewBox,a=t.animationDuration,i=t.animationEasing,o=t.children,l=t.coordinate,c=t.hasPayload,d=t.isAnimationActive,u=t.offset,h=t.position,p=t.reverseDirection,m=t.useTranslate3d,f=t.viewBox,g=t.wrapperStyle,x=function(e){var t,r,n=e.allowEscapeViewBox,a=e.coordinate,s=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipBox,c=e.useTranslate3d,d=e.viewBox;return{cssProperties:l.height>0&&l.width>0&&a?function(e){var t=e.translateX,r=e.translateY;return{transform:e.useTranslate3d?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}({translateX:t=wo({allowEscapeViewBox:n,coordinate:a,key:"x",offsetTopLeft:s,position:i,reverseDirection:o,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),translateY:r=wo({allowEscapeViewBox:n,coordinate:a,key:"y",offsetTopLeft:s,position:i,reverseDirection:o,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),useTranslate3d:c}):ko,cssClasses:jo({translateX:t,translateY:r,coordinate:a})}}({allowEscapeViewBox:n,coordinate:l,offsetTopLeft:u,position:h,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:f}),b=x.cssClasses,y=x.cssProperties,v=Oo(Oo({transition:d&&r?"transform ".concat(a,"ms ").concat(i):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&c?"visible":"hidden",position:"absolute",top:0,left:0},g);return s.createElement("div",{tabIndex:-1,className:b,style:v,ref:function(t){e.wrapperNode=t}},o)}}],n&&Co(r.prototype,n),a&&Co(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent),Io={isSsr:!("undefined"!==typeof window&&window.document&&window.document.createElement&&window.setTimeout),get:function(e){return Io[e]},set:function(e,t){if("string"===typeof e)Io[e]=t;else{var r=Object.keys(e);r&&r.length&&r.forEach(function(t){Io[t]=e[t]})}}},Lo=r(977),Fo=r.n(Lo);function Bo(e,t,r){return!0===t?Fo()(e,r):hi()(t)?Fo()(e,t):e}function Uo(e){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uo(e)}function zo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Vo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zo(Object(r),!0).forEach(function(t){Ko(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ho(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yo(n.key),n)}}function Wo(e,t,r){return t=Go(t),function(e,t){if(t&&("object"===Uo(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qo()?Reflect.construct(t,r||[],Go(e).constructor):t.apply(e,r))}function qo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(qo=function(){return!!e})()}function Go(e){return Go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Go(e)}function $o(e,t){return $o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$o(e,t)}function Ko(e,t,r){return(t=Yo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yo(e){var t=function(e,t){if("object"!=Uo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Uo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Uo(t)?t:t+""}function Xo(e){return e.dataKey}var Jo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wo(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$o(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this,t=this.props,r=t.active,n=t.allowEscapeViewBox,a=t.animationDuration,i=t.animationEasing,o=t.content,l=t.coordinate,c=t.filterNull,d=t.isAnimationActive,u=t.offset,h=t.payload,p=t.payloadUniqBy,m=t.position,f=t.reverseDirection,g=t.useTranslate3d,x=t.viewBox,b=t.wrapperStyle,y=null!==h&&void 0!==h?h:[];c&&y.length&&(y=Bo(h.filter(function(t){return null!=t.value&&(!0!==t.hide||e.props.includeHidden)}),p,Xo));var v=y.length>0;return s.createElement(Do,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:d,active:r,coordinate:l,hasPayload:v,offset:u,position:m,reverseDirection:f,useTranslate3d:g,viewBox:x,wrapperStyle:b},function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):"function"===typeof e?s.createElement(e,t):s.createElement(bo,t)}(o,Vo(Vo({},this.props),{},{payload:y})))}}],n&&Ho(r.prototype,n),a&&Ho(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);Ko(Jo,"displayName","Tooltip"),Ko(Jo,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Io.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Qo=r(643),Zo=r.n(Qo);Math.abs,Math.atan2;const el=Math.cos,tl=(Math.max,Math.min,Math.sin),rl=Math.sqrt,nl=Math.PI,al=2*nl;const sl={draw(e,t){const r=rl(t/nl);e.moveTo(r,0),e.arc(0,0,r,0,al)}},il={draw(e,t){const r=rl(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},ol=rl(1/3),ll=2*ol,cl={draw(e,t){const r=rl(t/ll),n=r*ol;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},dl={draw(e,t){const r=rl(t),n=-r/2;e.rect(n,n,r,r)}},ul=tl(nl/10)/tl(7*nl/10),hl=tl(al/10)*ul,pl=-el(al/10)*ul,ml={draw(e,t){const r=rl(.8908130915292852*t),n=hl*r,a=pl*r;e.moveTo(0,-r),e.lineTo(n,a);for(let s=1;s<5;++s){const t=al*s/5,i=el(t),o=tl(t);e.lineTo(o*r,-i*r),e.lineTo(i*n-o*a,o*n+i*a)}e.closePath()}},fl=rl(3),gl={draw(e,t){const r=-rl(t/(3*fl));e.moveTo(0,2*r),e.lineTo(-fl*r,-r),e.lineTo(fl*r,-r),e.closePath()}},xl=-.5,bl=rl(3)/2,yl=1/rl(12),vl=3*(yl/2+1),_l={draw(e,t){const r=rl(t/vl),n=r/2,a=r*yl,s=n,i=r*yl+r,o=-s,l=i;e.moveTo(n,a),e.lineTo(s,i),e.lineTo(o,l),e.lineTo(xl*n-bl*a,bl*n+xl*a),e.lineTo(xl*s-bl*i,bl*s+xl*i),e.lineTo(xl*o-bl*l,bl*o+xl*l),e.lineTo(xl*n+bl*a,xl*a-bl*n),e.lineTo(xl*s+bl*i,xl*i-bl*s),e.lineTo(xl*o+bl*l,xl*l-bl*o),e.closePath()}};function kl(e){return function(){return e}}function jl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var wl,Nl,Sl,Ol,Cl,El,Pl,Al,Tl,Ml,Rl,Dl,Il,Ll;const Fl=Math.PI,Bl=2*Fl,Ul=1e-6,zl=Bl-Ul;function Vl(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}class Hl{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Vl:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return Vl;const r=10**t;return function(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=Math.round(arguments[t]*r)/r+e[t]}}(e)}moveTo(e,t){this._append(wl||(wl=jl(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Nl||(Nl=jl(["Z"]))))}lineTo(e,t){this._append(Sl||(Sl=jl(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,r,n){this._append(Ol||(Ol=jl(["Q",",",",",",",""])),+e,+t,this._x1=+r,this._y1=+n)}bezierCurveTo(e,t,r,n,a,s){this._append(Cl||(Cl=jl(["C",",",",",",",",",",",""])),+e,+t,+r,+n,this._x1=+a,this._y1=+s)}arcTo(e,t,r,n,a){if(e=+e,t=+t,r=+r,n=+n,(a=+a)<0)throw new Error("negative radius: ".concat(a));let s=this._x1,i=this._y1,o=r-e,l=n-t,c=s-e,d=i-t,u=c*c+d*d;if(null===this._x1)this._append(El||(El=jl(["M",",",""])),this._x1=e,this._y1=t);else if(u>Ul)if(Math.abs(d*o-l*c)>Ul&&a){let h=r-s,p=n-i,m=o*o+l*l,f=h*h+p*p,g=Math.sqrt(m),x=Math.sqrt(u),b=a*Math.tan((Fl-Math.acos((m+u-f)/(2*g*x)))/2),y=b/x,v=b/g;Math.abs(y-1)>Ul&&this._append(Al||(Al=jl(["L",",",""])),e+y*c,t+y*d),this._append(Tl||(Tl=jl(["A",",",",0,0,",",",",",""])),a,a,+(d*h>c*p),this._x1=e+v*o,this._y1=t+v*l)}else this._append(Pl||(Pl=jl(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,r,n,a,s){if(e=+e,t=+t,s=!!s,(r=+r)<0)throw new Error("negative radius: ".concat(r));let i=r*Math.cos(n),o=r*Math.sin(n),l=e+i,c=t+o,d=1^s,u=s?n-a:a-n;null===this._x1?this._append(Ml||(Ml=jl(["M",",",""])),l,c):(Math.abs(this._x1-l)>Ul||Math.abs(this._y1-c)>Ul)&&this._append(Rl||(Rl=jl(["L",",",""])),l,c),r&&(u<0&&(u=u%Bl+Bl),u>zl?this._append(Dl||(Dl=jl(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),r,r,d,e-i,t-o,r,r,d,this._x1=l,this._y1=c):u>Ul&&this._append(Il||(Il=jl(["A",",",",0,",",",",",",",""])),r,r,+(u>=Fl),d,this._x1=e+r*Math.cos(a),this._y1=t+r*Math.sin(a)))}rect(e,t,r,n){this._append(Ll||(Ll=jl(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,r=+r,+n,-r)}toString(){return this._}}function Wl(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(null==r)t=null;else{const e=Math.floor(r);if(!(e>=0))throw new RangeError("invalid digits: ".concat(r));t=e}return e},()=>new Hl(t)}rl(3),rl(3);function ql(e){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ql(e)}var Gl=["type","size","sizeType"];function $l(){return $l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$l.apply(this,arguments)}function Kl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Yl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kl(Object(r),!0).forEach(function(t){Xl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Xl(e,t,r){return t=function(e){var t=function(e,t){if("object"!=ql(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ql(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ql(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jl(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Ql={symbolCircle:sl,symbolCross:il,symbolDiamond:cl,symbolSquare:dl,symbolStar:ml,symbolTriangle:gl,symbolWye:_l},Zl=Math.PI/180,ec=function(e){var t=e.type,r=void 0===t?"circle":t,n=e.size,a=void 0===n?64:n,i=e.sizeType,o=void 0===i?"area":i,l=Yl(Yl({},Jl(e,Gl)),{},{type:r,size:a,sizeType:o}),c=l.className,d=l.cx,u=l.cy,h=Fi(l,!0);return d===+d&&u===+u&&a===+a?s.createElement("path",$l({},h,{className:Us("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:function(){var e=function(e){var t="symbol".concat(Zo()(e));return Ql[t]||sl}(r),t=function(e,t){let r=null,n=Wl(a);function a(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return e="function"===typeof e?e:kl(e||sl),t="function"===typeof t?t:kl(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:kl(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:kl(+e),a):t},a.context=function(e){return arguments.length?(r=null==e?null:e,a):r},a}().type(e).size(function(e,t,r){if("area"===t)return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var n=18*Zl;return 1.25*e*e*(Math.tan(n)-Math.tan(2*n)*Math.pow(Math.tan(n),2));case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}}(a,o,r));return t()}()})):null};function tc(e){return tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tc(e)}function rc(){return rc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rc.apply(this,arguments)}function nc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ac(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dc(n.key),n)}}function sc(e,t,r){return t=oc(t),function(e,t){if(t&&("object"===tc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ic()?Reflect.construct(t,r||[],oc(e).constructor):t.apply(e,r))}function ic(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ic=function(){return!!e})()}function oc(e){return oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oc(e)}function lc(e,t){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lc(e,t)}function cc(e,t,r){return(t=dc(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dc(e){var t=function(e,t){if("object"!=tc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tc(t)?t:t+""}ec.registerSymbol=function(e,t){Ql["symbol".concat(Zo()(e))]=t};var uc=32,hc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sc(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lc(e,t)}(t,e),r=t,n=[{key:"renderIcon",value:function(e){var t=this.props.inactiveColor,r=16,n=uc/6,a=uc/3,i=e.inactive?t:e.color;if("plainline"===e.type)return s.createElement("line",{strokeWidth:4,fill:"none",stroke:i,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:r,x2:uc,y2:r,className:"recharts-legend-icon"});if("line"===e.type)return s.createElement("path",{strokeWidth:4,fill:"none",stroke:i,d:"M0,".concat(r,"h").concat(a,"\n            A").concat(n,",").concat(n,",0,1,1,").concat(2*a,",").concat(r,"\n            H").concat(uc,"M").concat(2*a,",").concat(r,"\n            A").concat(n,",").concat(n,",0,1,1,").concat(a,",").concat(r),className:"recharts-legend-icon"});if("rect"===e.type)return s.createElement("path",{stroke:"none",fill:i,d:"M0,".concat(4,"h").concat(uc,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(s.isValidElement(e.legendIcon)){var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nc(Object(r),!0).forEach(function(t){cc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e);return delete o.legendIcon,s.cloneElement(e.legendIcon,o)}return s.createElement(ec,{fill:i,cx:r,cy:r,size:uc,sizeType:"diameter",type:e.type})}},{key:"renderItems",value:function(){var e=this,t=this.props,r=t.payload,n=t.iconSize,a=t.layout,i=t.formatter,o=t.inactiveColor,l={x:0,y:0,width:uc,height:uc},c={display:"horizontal"===a?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map(function(t,r){var a=t.formatter||i,u=Us(cc(cc({"recharts-legend-item":!0},"legend-item-".concat(r),!0),"inactive",t.inactive));if("none"===t.type)return null;var h=hi()(t.value)?null:t.value;li(!hi()(t.value),'The name property is also required when using a function for the dataKey of a chart\'s cartesian components. Ex: <Bar name="Name of my Data"/>');var p=t.inactive?o:t.color;return s.createElement("li",rc({className:u,style:c,key:"legend-item-".concat(r)},ji(e.props,t,r)),s.createElement(ao,{width:n,height:n,viewBox:l,style:d},e.renderIcon(t)),s.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},a?a(h,t,r):h))})}},{key:"render",value:function(){var e=this.props,t=e.payload,r=e.layout,n=e.align;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:"horizontal"===r?n:"left"};return s.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}],n&&ac(r.prototype,n),a&&ac(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);function pc(e){return pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pc(e)}cc(hc,"displayName","Legend"),cc(hc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var mc=["ref"];function fc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function gc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fc(Object(r),!0).forEach(function(t){kc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jc(n.key),n)}}function bc(e,t,r){return t=vc(t),function(e,t){if(t&&("object"===pc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yc()?Reflect.construct(t,r||[],vc(e).constructor):t.apply(e,r))}function yc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(yc=function(){return!!e})()}function vc(e){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vc(e)}function _c(e,t){return _c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_c(e,t)}function kc(e,t,r){return(t=jc(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jc(e){var t=function(e,t){if("object"!=pc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pc(t)?t:t+""}function wc(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Nc(e){return e.value}var Sc=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return kc(e=bc(this,t,[].concat(n)),"lastBoundingBox",{width:-1,height:-1}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_c(e,t)}(t,e),r=t,n=[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();return e.height=this.wrapperNode.offsetHeight,e.width=this.wrapperNode.offsetWidth,e}return null}},{key:"updateBBox",value:function(){var e=this.props.onBBoxUpdate,t=this.getBBox();t?(Math.abs(t.width-this.lastBoundingBox.width)>1||Math.abs(t.height-this.lastBoundingBox.height)>1)&&(this.lastBoundingBox.width=t.width,this.lastBoundingBox.height=t.height,e&&e(t)):-1===this.lastBoundingBox.width&&-1===this.lastBoundingBox.height||(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,e&&e(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?gc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(e){var t,r,n=this.props,a=n.layout,s=n.align,i=n.verticalAlign,o=n.margin,l=n.chartWidth,c=n.chartHeight;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(t="center"===s&&"vertical"===a?{left:((l||0)-this.getBBoxSnapshot().width)/2}:"right"===s?{right:o&&o.right||0}:{left:o&&o.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(r="middle"===i?{top:((c||0)-this.getBBoxSnapshot().height)/2}:"bottom"===i?{bottom:o&&o.bottom||0}:{top:o&&o.top||0}),gc(gc({},t),r)}},{key:"render",value:function(){var e=this,t=this.props,r=t.content,n=t.width,a=t.height,i=t.wrapperStyle,o=t.payloadUniqBy,l=t.payload,c=gc(gc({position:"absolute",width:n||"auto",height:a||"auto"},this.getDefaultPosition(i)),i);return s.createElement("div",{className:"recharts-legend-wrapper",style:c,ref:function(t){e.wrapperNode=t}},function(e,t){if(s.isValidElement(e))return s.cloneElement(e,t);if("function"===typeof e)return s.createElement(e,t);t.ref;var r=wc(t,mc);return s.createElement(hc,r)}(r,gc(gc({},this.props),{},{payload:Bo(l,o,Nc)})))}}],a=[{key:"getWithHeight",value:function(e,t){var r=gc(gc({},this.defaultProps),e.props).layout;return"vertical"===r&&Zs(e.props.height)?{height:e.props.height}:"horizontal"===r?{width:e.props.width||t}:null}}],n&&xc(r.prototype,n),a&&xc(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);function Oc(){return Oc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oc.apply(this,arguments)}kc(Sc,"displayName","Legend"),kc(Sc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Cc=function(e){var t=e.cx,r=e.cy,n=e.r,a=e.className,i=Us("recharts-dot",a);return t===+t&&r===+r&&n===+n?s.createElement("circle",Oc({},Fi(e,!1),ki(e),{className:i,cx:t,cy:r,r:n})):null},Ec=r(5173),Pc=r.n(Ec),Ac=Object.getOwnPropertyNames,Tc=Object.getOwnPropertySymbols,Mc=Object.prototype.hasOwnProperty;function Rc(e,t){return function(r,n,a){return e(r,n,a)&&t(r,n,a)}}function Dc(e){return function(t,r,n){if(!t||!r||"object"!==typeof t||"object"!==typeof r)return e(t,r,n);var a=n.cache,s=a.get(t),i=a.get(r);if(s&&i)return s===r&&i===t;a.set(t,r),a.set(r,t);var o=e(t,r,n);return a.delete(t),a.delete(r),o}}function Ic(e){return Ac(e).concat(Tc(e))}var Lc=Object.hasOwn||function(e,t){return Mc.call(e,t)};function Fc(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Bc=Object.getOwnPropertyDescriptor,Uc=Object.keys;function zc(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Vc(e,t){return Fc(e.getTime(),t.getTime())}function Hc(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Wc(e,t){return e===t}function qc(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a,s,i=new Array(n),o=e.entries(),l=0;(a=o.next())&&!a.done;){for(var c=t.entries(),d=!1,u=0;(s=c.next())&&!s.done;)if(i[u])u++;else{var h=a.value,p=s.value;if(r.equals(h[0],p[0],l,u,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){d=i[u]=!0;break}u++}if(!d)return!1;l++}return!0}var Gc=Fc;function $c(e,t,r){var n=Uc(e),a=n.length;if(Uc(t).length!==a)return!1;for(;a-- >0;)if(!ed(e,t,r,n[a]))return!1;return!0}function Kc(e,t,r){var n,a,s,i=Ic(e),o=i.length;if(Ic(t).length!==o)return!1;for(;o-- >0;){if(!ed(e,t,r,n=i[o]))return!1;if(a=Bc(e,n),s=Bc(t,n),(a||s)&&(!a||!s||a.configurable!==s.configurable||a.enumerable!==s.enumerable||a.writable!==s.writable))return!1}return!0}function Yc(e,t){return Fc(e.valueOf(),t.valueOf())}function Xc(e,t){return e.source===t.source&&e.flags===t.flags}function Jc(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a,s,i=new Array(n),o=e.values();(a=o.next())&&!a.done;){for(var l=t.values(),c=!1,d=0;(s=l.next())&&!s.done;){if(!i[d]&&r.equals(a.value,s.value,a.value,s.value,e,t,r)){c=i[d]=!0;break}d++}if(!c)return!1}return!0}function Qc(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Zc(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function ed(e,t,r,n){return!("_owner"!==n&&"__o"!==n&&"__v"!==n||!e.$$typeof&&!t.$$typeof)||Lc(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var td=Array.isArray,rd="function"===typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,nd=Object.assign,ad=Object.prototype.toString.call.bind(Object.prototype.toString);var sd=id();id({strict:!0}),id({circular:!0}),id({circular:!0,strict:!0}),id({createInternalComparator:function(){return Fc}}),id({strict:!0,createInternalComparator:function(){return Fc}}),id({circular:!0,createInternalComparator:function(){return Fc}}),id({circular:!0,createInternalComparator:function(){return Fc},strict:!0});function id(e){void 0===e&&(e={});var t,r=e.circular,n=void 0!==r&&r,a=e.createInternalComparator,s=e.createState,i=e.strict,o=void 0!==i&&i,l=function(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Kc:zc,areDatesEqual:Vc,areErrorsEqual:Hc,areFunctionsEqual:Wc,areMapsEqual:n?Rc(qc,Kc):qc,areNumbersEqual:Gc,areObjectsEqual:n?Kc:$c,arePrimitiveWrappersEqual:Yc,areRegExpsEqual:Xc,areSetsEqual:n?Rc(Jc,Kc):Jc,areTypedArraysEqual:n?Kc:Qc,areUrlsEqual:Zc};if(r&&(a=nd({},a,r(a))),t){var s=Dc(a.areArraysEqual),i=Dc(a.areMapsEqual),o=Dc(a.areObjectsEqual),l=Dc(a.areSetsEqual);a=nd({},a,{areArraysEqual:s,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:l})}return a}(e),c=function(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,s=e.areMapsEqual,i=e.areNumbersEqual,o=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,d=e.areSetsEqual,u=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(e,p,m){if(e===p)return!0;if(null==e||null==p)return!1;var f=typeof e;if(f!==typeof p)return!1;if("object"!==f)return"number"===f?i(e,p,m):"function"===f&&a(e,p,m);var g=e.constructor;if(g!==p.constructor)return!1;if(g===Object)return o(e,p,m);if(td(e))return t(e,p,m);if(null!=rd&&rd(e))return u(e,p,m);if(g===Date)return r(e,p,m);if(g===RegExp)return c(e,p,m);if(g===Map)return s(e,p,m);if(g===Set)return d(e,p,m);var x=ad(e);return"[object Date]"===x?r(e,p,m):"[object RegExp]"===x?c(e,p,m):"[object Map]"===x?s(e,p,m):"[object Set]"===x?d(e,p,m):"[object Object]"===x?"function"!==typeof e.then&&"function"!==typeof p.then&&o(e,p,m):"[object URL]"===x?h(e,p,m):"[object Error]"===x?n(e,p,m):"[object Arguments]"===x?o(e,p,m):("[object Boolean]"===x||"[object Number]"===x||"[object String]"===x)&&l(e,p,m)}}(l),d=a?a(c):(t=c,function(e,r,n,a,s,i,o){return t(e,r,o)});return function(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,s=e.strict;if(n)return function(e,i){var o=n(),l=o.cache,c=void 0===l?t?new WeakMap:void 0:l,d=o.meta;return r(e,i,{cache:c,equals:a,meta:d,strict:s})};if(t)return function(e,t){return r(e,t,{cache:new WeakMap,equals:a,meta:void 0,strict:s})};var i={cache:void 0,equals:a,meta:void 0,strict:s};return function(e,t){return r(e,t,i)}}({circular:n,comparator:c,createState:s,equals:d,strict:o})}function od(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1;requestAnimationFrame(function n(a){r<0&&(r=a),a-r>t?(e(a),r=-1):function(e){"undefined"!==typeof requestAnimationFrame&&requestAnimationFrame(e)}(n)})}function ld(e){return ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(e)}function cd(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return dd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dd(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ud(){var e=function(){return null},t=!1,r=function r(n){if(!t){if(Array.isArray(n)){if(!n.length)return;var a=cd(n),s=a[0],i=a.slice(1);return"number"===typeof s?void od(r.bind(null,i),s):(r(s),void od(r.bind(null,i)))}"object"===ld(n)&&e(n),"function"===typeof n&&n()}};return{stop:function(){t=!0},start:function(e){t=!1,r(e)},subscribe:function(t){return e=t,function(){e=function(){return null}}}}}function hd(e){return hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(e)}function pd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function md(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pd(Object(r),!0).forEach(function(t){fd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function fd(e,t,r){return t=function(e){var t=function(e,t){if("object"!==hd(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==hd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===hd(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gd=function(e){return e},xd=function(e,t){return Object.keys(t).reduce(function(r,n){return md(md({},r),{},fd({},n,e(n,t[n])))},{})},bd=function(e,t,r){return e.map(function(e){return"".concat((n=e,n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}))," ").concat(t,"ms ").concat(r);var n}).join(",")};function yd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||_d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vd(e){return function(e){if(Array.isArray(e))return kd(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _d(e,t){if(e){if("string"===typeof e)return kd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kd(e,t):void 0}}function kd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jd=1e-4,wd=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},Nd=function(e,t){return e.map(function(e,r){return e*Math.pow(t,r)}).reduce(function(e,t){return e+t})},Sd=function(e,t){return function(r){var n=wd(e,t);return Nd(n,r)}},Od=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],a=t[1],s=t[2],i=t[3];if(1===t.length)switch(t[0]){case"linear":n=0,a=0,s=1,i=1;break;case"ease":n=.25,a=.1,s=.25,i=1;break;case"ease-in":n=.42,a=0,s=1,i=1;break;case"ease-out":n=.42,a=0,s=.58,i=1;break;case"ease-in-out":n=0,a=0,s=.58,i=1;break;default:var o=t[0].split("(");if("cubic-bezier"===o[0]&&4===o[1].split(")")[0].split(",").length){var l=yd(o[1].split(")")[0].split(",").map(function(e){return parseFloat(e)}),4);n=l[0],a=l[1],s=l[2],i=l[3]}}[n,s,a,i].every(function(e){return"number"===typeof e&&e>=0&&e<=1});var c,d,u=Sd(n,s),h=Sd(a,i),p=(c=n,d=s,function(e){var t=wd(c,d),r=[].concat(vd(t.map(function(e,t){return e*t}).slice(1)),[0]);return Nd(r,e)}),m=function(e){return e>1?1:e<0?0:e},f=function(e){for(var t=e>1?1:e,r=t,n=0;n<8;++n){var a=u(r)-t,s=p(r);if(Math.abs(a-t)<jd||s<jd)return h(r);r=m(r-a/s)}return h(r)};return f.isStepper=!1,f},Cd=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0];if("string"===typeof n)switch(n){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Od(n);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiff,r=void 0===t?100:t,n=e.damping,a=void 0===n?8:n,s=e.dt,i=void 0===s?17:s,o=function(e,t,n){var s=n+(-(e-t)*r-n*a)*i/1e3,o=n*i/1e3+e;return Math.abs(o-t)<jd&&Math.abs(s)<jd?[t,0]:[o,s]};return o.isStepper=!0,o.dt=i,o}();default:if("cubic-bezier"===n.split("(")[0])return Od(n)}return"function"===typeof n?n:null};function Ed(e){return Ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(e)}function Pd(e){return function(e){if(Array.isArray(e))return Id(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Dd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ad(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Td(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ad(Object(r),!0).forEach(function(t){Md(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ad(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Md(e,t,r){return t=function(e){var t=function(e,t){if("object"!==Ed(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ed(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ed(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||Dd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dd(e,t){if(e){if("string"===typeof e)return Id(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Id(e,t):void 0}}function Id(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ld=function(e,t,r){return e+(t-e)*r},Fd=function(e){return e.from!==e.to},Bd=function e(t,r,n){var a=xd(function(e,r){if(Fd(r)){var n=Rd(t(r.from,r.to,r.velocity),2),a=n[0],s=n[1];return Td(Td({},r),{},{from:a,velocity:s})}return r},r);return n<1?xd(function(e,t){return Fd(t)?Td(Td({},t),{},{velocity:Ld(t.velocity,a[e].velocity,n),from:Ld(t.from,a[e].from,n)}):t},r):e(t,a,n-1)};const Ud=function(e,t,r,n,a){var s,i,o,l,c=(s=e,i=t,[Object.keys(s),Object.keys(i)].reduce(function(e,t){return e.filter(function(e){return t.includes(e)})})),d=c.reduce(function(r,n){return Td(Td({},r),{},Md({},n,[e[n],t[n]]))},{}),u=c.reduce(function(r,n){return Td(Td({},r),{},Md({},n,{from:e[n],velocity:0,to:t[n]}))},{}),h=-1,p=function(){return null};return p=r.isStepper?function(n){o||(o=n);var s=(n-o)/r.dt;u=Bd(r,u,s),a(Td(Td(Td({},e),t),xd(function(e,t){return t.from},u))),o=n,Object.values(u).filter(Fd).length&&(h=requestAnimationFrame(p))}:function(s){l||(l=s);var i=(s-l)/n,o=xd(function(e,t){return Ld.apply(void 0,Pd(t).concat([r(i)]))},d);if(a(Td(Td(Td({},e),t),o)),i<1)h=requestAnimationFrame(p);else{var c=xd(function(e,t){return Ld.apply(void 0,Pd(t).concat([r(1)]))},d);a(Td(Td(Td({},e),t),c))}},function(){return requestAnimationFrame(p),function(){cancelAnimationFrame(h)}}};function zd(e){return zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zd(e)}var Vd=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Hd(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Wd(e){return function(e){if(Array.isArray(e))return qd(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return qd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qd(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gd(Object(r),!0).forEach(function(t){Kd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Kd(e,t,r){return(t=Xd(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xd(n.key),n)}}function Xd(e){var t=function(e,t){if("object"!==zd(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==zd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===zd(t)?t:String(t)}function Jd(e,t){return Jd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jd(e,t)}function Qd(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(dU){return!1}}();return function(){var r,n=tu(e);if(t){var a=tu(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Zd(this,r)}}function Zd(e,t){if(t&&("object"===zd(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eu(e)}function eu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tu(e){return tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tu(e)}var ru=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jd(e,t)}(i,e);var t,r,n,a=Qd(i);function i(e,t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=(r=a.call(this,e,t)).props,s=n.isActive,o=n.attributeName,l=n.from,c=n.to,d=n.steps,u=n.children,h=n.duration;if(r.handleStyleChange=r.handleStyleChange.bind(eu(r)),r.changeStyle=r.changeStyle.bind(eu(r)),!s||h<=0)return r.state={style:{}},"function"===typeof u&&(r.state={style:c}),Zd(r);if(d&&d.length)r.state={style:d[0].style};else if(l){if("function"===typeof u)return r.state={style:l},Zd(r);r.state={style:o?Kd({},o,l):l}}else r.state={style:{}};return r}return t=i,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isActive,r=e.canBegin;this.mounted=!0,t&&r&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.isActive,n=t.canBegin,a=t.attributeName,s=t.shouldReAnimate,i=t.to,o=t.from,l=this.state.style;if(n)if(r){if(!(sd(e.to,i)&&e.canBegin&&e.isActive)){var c=!e.canBegin||!e.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var d=c||s?o:e.to;if(this.state&&l){var u={style:a?Kd({},a,d):d};(a&&l[a]!==d||!a&&l!==d)&&this.setState(u)}this.runAnimation($d($d({},this.props),{},{from:d,begin:0}))}}else{var h={style:a?Kd({},a,i):i};this.state&&l&&(a&&l[a]!==i||!a&&l!==i)&&this.setState(h)}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var e=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}},{key:"handleStyleChange",value:function(e){this.changeStyle(e)}},{key:"changeStyle",value:function(e){this.mounted&&this.setState({style:e})}},{key:"runJSAnimation",value:function(e){var t=this,r=e.from,n=e.to,a=e.duration,s=e.easing,i=e.begin,o=e.onAnimationEnd,l=e.onAnimationStart,c=Ud(r,n,Cd(s),a,this.changeStyle);this.manager.start([l,i,function(){t.stopJSAnimation=c()},a,o])}},{key:"runStepAnimation",value:function(e){var t=this,r=e.steps,n=e.begin,a=e.onAnimationStart,s=r[0],i=s.style,o=s.duration,l=void 0===o?0:o;return this.manager.start([a].concat(Wd(r.reduce(function(e,n,a){if(0===a)return e;var s=n.duration,i=n.easing,o=void 0===i?"ease":i,l=n.style,c=n.properties,d=n.onAnimationEnd,u=a>0?r[a-1]:n,h=c||Object.keys(l);if("function"===typeof o||"spring"===o)return[].concat(Wd(e),[t.runJSAnimation.bind(t,{from:u.style,to:l,duration:s,easing:o}),s]);var p=bd(h,s,o),m=$d($d($d({},u.style),l),{},{transition:p});return[].concat(Wd(e),[m,s,d]).filter(gd)},[i,Math.max(l,n)])),[e.onAnimationEnd]))}},{key:"runAnimation",value:function(e){this.manager||(this.manager=ud());var t=e.begin,r=e.duration,n=e.attributeName,a=e.to,s=e.easing,i=e.onAnimationStart,o=e.onAnimationEnd,l=e.steps,c=e.children,d=this.manager;if(this.unSubscribe=d.subscribe(this.handleStyleChange),"function"!==typeof s&&"function"!==typeof c&&"spring"!==s)if(l.length>1)this.runStepAnimation(e);else{var u=n?Kd({},n,a):a,h=bd(Object.keys(u),r,s);d.start([i,t,$d($d({},u),{},{transition:h}),r,o])}else this.runJSAnimation(e)}},{key:"render",value:function(){var e=this.props,t=e.children,r=(e.begin,e.duration),n=(e.attributeName,e.easing,e.isActive),a=(e.steps,e.from,e.to,e.canBegin,e.onAnimationEnd,e.shouldReAnimate,e.onAnimationReStart,Hd(e,Vd)),i=s.Children.count(t),o=this.state.style;if("function"===typeof t)return t(o);if(!n||0===i||r<=0)return t;var l=function(e){var t=e.props,r=t.style,n=void 0===r?{}:r,i=t.className;return(0,s.cloneElement)(e,$d($d({},a),{},{style:$d($d({},n),o),className:i}))};return 1===i?l(s.Children.only(t)):s.createElement("div",null,s.Children.map(t,function(e){return l(e)}))}}],r&&Yd(t.prototype,r),n&&Yd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.PureComponent);ru.displayName="Animate",ru.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},ru.propTypes={from:Pc().oneOfType([Pc().object,Pc().string]),to:Pc().oneOfType([Pc().object,Pc().string]),attributeName:Pc().string,duration:Pc().number,begin:Pc().number,easing:Pc().oneOfType([Pc().string,Pc().func]),steps:Pc().arrayOf(Pc().shape({duration:Pc().number.isRequired,style:Pc().object.isRequired,easing:Pc().oneOfType([Pc().oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Pc().func]),properties:Pc().arrayOf("string"),onAnimationEnd:Pc().func})),children:Pc().oneOfType([Pc().node,Pc().func]),isActive:Pc().bool,canBegin:Pc().bool,onAnimationEnd:Pc().func,shouldReAnimate:Pc().bool,onAnimationStart:Pc().func,onAnimationReStart:Pc().func};const nu=ru;function au(e){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},au(e)}function su(){return su=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},su.apply(this,arguments)}function iu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ou(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ou(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ou(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function cu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lu(Object(r),!0).forEach(function(t){du(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function du(e,t,r){return t=function(e){var t=function(e,t){if("object"!=au(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=au(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==au(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var uu=function(e,t,r,n,a){var s,i=Math.min(Math.abs(r)/2,Math.abs(n)/2),o=n>=0?1:-1,l=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],u=0;u<4;u++)d[u]=a[u]>i?i:a[u];s="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(s+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),s+="L ".concat(e+r-l*d[1],",").concat(t),d[1]>0&&(s+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,",\n        ").concat(e+r,",").concat(t+o*d[1])),s+="L ".concat(e+r,",").concat(t+n-o*d[2]),d[2]>0&&(s+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,",\n        ").concat(e+r-l*d[2],",").concat(t+n)),s+="L ".concat(e+l*d[3],",").concat(t+n),d[3]>0&&(s+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+n-o*d[3])),s+="Z"}else if(i>0&&a===+a&&a>0){var h=Math.min(i,a);s="M ".concat(e,",").concat(t+o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,"\n            L ").concat(e+r-l*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,"\n            L ").concat(e+r,",").concat(t+n-o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+n,"\n            L ").concat(e+l*h,",").concat(t+n,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+n-o*h," Z")}else s="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return s},hu=function(e,t){if(!e||!t)return!1;var r=e.x,n=e.y,a=t.x,s=t.y,i=t.width,o=t.height;if(Math.abs(i)>0&&Math.abs(o)>0){var l=Math.min(a,a+i),c=Math.max(a,a+i),d=Math.min(s,s+o),u=Math.max(s,s+o);return r>=l&&r<=c&&n>=d&&n<=u}return!1},pu={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},mu=function(e){var t=cu(cu({},pu),e),r=(0,s.useRef)(),n=iu((0,s.useState)(-1),2),a=n[0],i=n[1];(0,s.useEffect)(function(){if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&i(e)}catch(t){}},[]);var o=t.x,l=t.y,c=t.width,d=t.height,u=t.radius,h=t.className,p=t.animationEasing,m=t.animationDuration,f=t.animationBegin,g=t.isAnimationActive,x=t.isUpdateAnimationActive;if(o!==+o||l!==+l||c!==+c||d!==+d||0===c||0===d)return null;var b=Us("recharts-rectangle",h);return x?s.createElement(nu,{canBegin:a>0,from:{width:c,height:d,x:o,y:l},to:{width:c,height:d,x:o,y:l},duration:m,animationEasing:p,isActive:x},function(e){var n=e.width,i=e.height,o=e.x,l=e.y;return s.createElement(nu,{canBegin:a>0,from:"0px ".concat(-1===a?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:m,isActive:g,easing:p},s.createElement("path",su({},Fi(t,!0),{className:b,d:uu(o,l,n,i,u),ref:r})))}):s.createElement("path",su({},Fi(t,!0),{className:b,d:uu(o,l,c,d,u)}))};function fu(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function gu(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class xu extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_u;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[r,n]of e)this.set(r,n)}get(e){return super.get(bu(this,e))}has(e){return super.has(bu(this,e))}set(e,t){return super.set(yu(this,e),t)}delete(e){return super.delete(vu(this,e))}}Set;function bu(e,t){let{_intern:r,_key:n}=e;const a=n(t);return r.has(a)?r.get(a):t}function yu(e,t){let{_intern:r,_key:n}=e;const a=n(t);return r.has(a)?r.get(a):(r.set(a,t),t)}function vu(e,t){let{_intern:r,_key:n}=e;const a=n(t);return r.has(a)&&(t=r.get(a),r.delete(a)),t}function _u(e){return null!==e&&"object"===typeof e?e.valueOf():e}const ku=Symbol("implicit");function ju(){var e=new xu,t=[],r=[],n=ku;function a(a){let s=e.get(a);if(void 0===s){if(n!==ku)return n;e.set(a,s=t.push(a)-1)}return r[s%r.length]}return a.domain=function(r){if(!arguments.length)return t.slice();t=[],e=new xu;for(const n of r)e.has(n)||e.set(n,t.push(n)-1);return a},a.range=function(e){return arguments.length?(r=Array.from(e),a):r.slice()},a.unknown=function(e){return arguments.length?(n=e,a):n},a.copy=function(){return ju(t,r).unknown(n)},fu.apply(a,arguments),a}function wu(){var e,t,r=ju().unknown(void 0),n=r.domain,a=r.range,s=0,i=1,o=!1,l=0,c=0,d=.5;function u(){var r=n().length,u=i<s,h=u?i:s,p=u?s:i;e=(p-h)/Math.max(1,r-l+2*c),o&&(e=Math.floor(e)),h+=(p-h-e*(r-l))*d,t=e*(1-l),o&&(h=Math.round(h),t=Math.round(t));var m=function(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),s=new Array(a);++n<a;)s[n]=e+n*r;return s}(r).map(function(t){return h+e*t});return a(u?m.reverse():m)}return delete r.unknown,r.domain=function(e){return arguments.length?(n(e),u()):n()},r.range=function(e){return arguments.length?([s,i]=e,s=+s,i=+i,u()):[s,i]},r.rangeRound=function(e){return[s,i]=e,s=+s,i=+i,o=!0,u()},r.bandwidth=function(){return t},r.step=function(){return e},r.round=function(e){return arguments.length?(o=!!e,u()):o},r.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},r.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},r.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},r.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),u()):d},r.copy=function(){return wu(n(),[s,i]).round(o).paddingInner(l).paddingOuter(c).align(d)},fu.apply(u(),arguments)}function Nu(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Nu(t())},e}function Su(){return Nu(wu.apply(null,arguments).paddingInner(1))}function Ou(e){return Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(e)}function Cu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Eu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(r),!0).forEach(function(t){Pu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Pu(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Ou(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ou(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ou(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Au={widthCache:{},cacheCount:0},Tu={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Mu="recharts_measurement_span";var Ru=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||Io.isSsr)return{width:0,height:0};var r=function(e){var t=Eu({},e);return Object.keys(t).forEach(function(e){t[e]||delete t[e]}),t}(t),n=JSON.stringify({text:e,copyStyle:r});if(Au.widthCache[n])return Au.widthCache[n];try{var a=document.getElementById(Mu);a||((a=document.createElement("span")).setAttribute("id",Mu),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=Eu(Eu({},Tu),r);Object.assign(a.style,s),a.textContent="".concat(e);var i=a.getBoundingClientRect(),o={width:i.width,height:i.height};return Au.widthCache[n]=o,++Au.cacheCount>2e3&&(Au.cacheCount=0,Au.widthCache={}),o}catch(dU){return{width:0,height:0}}};function Du(e){return Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Du(e)}function Iu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Lu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bu(n.key),n)}}function Bu(e){var t=function(e,t){if("object"!=Du(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Du(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Du(t)?t:t+""}var Uu=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,zu=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Vu=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Hu=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Wu={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},qu=Object.keys(Wu),Gu="NaN";var $u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),""===r||Vu.test(r)||(this.num=NaN,this.unit=""),qu.includes(r)&&(this.num=function(e,t){return e*Wu[t]}(t,r),this.unit="px")}return t=e,n=[{key:"parse",value:function(t){var r,n=Iu(null!==(r=Hu.exec(t))&&void 0!==r?r:[],3),a=n[1],s=n[2];return new e(parseFloat(a),null!==s&&void 0!==s?s:"")}}],(r=[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}])&&Fu(t.prototype,r),n&&Fu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function Ku(e){if(e.includes(Gu))return Gu;for(var t=e;t.includes("*")||t.includes("/");){var r,n=Iu(null!==(r=Uu.exec(t))&&void 0!==r?r:[],4),a=n[1],s=n[2],i=n[3],o=$u.parse(null!==a&&void 0!==a?a:""),l=$u.parse(null!==i&&void 0!==i?i:""),c="*"===s?o.multiply(l):o.divide(l);if(c.isNaN())return Gu;t=t.replace(Uu,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,u=Iu(null!==(d=zu.exec(t))&&void 0!==d?d:[],4),h=u[1],p=u[2],m=u[3],f=$u.parse(null!==h&&void 0!==h?h:""),g=$u.parse(null!==m&&void 0!==m?m:""),x="+"===p?f.add(g):f.subtract(g);if(x.isNaN())return Gu;t=t.replace(zu,x.toString())}return t}var Yu=/\(([^()]*)\)/;function Xu(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t=e;t.includes("(");){var r=Iu(Yu.exec(t),2)[1];t=t.replace(Yu,Ku(r))}return t}(t),t=Ku(t)}function Ju(e){var t=function(e){try{return Xu(e)}catch(dU){return Gu}}(e.slice(5,-1));return t===Gu?"":t}var Qu=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Zu=["dx","dy","angle","className","breakAll"];function eh(){return eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eh.apply(this,arguments)}function th(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return nh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ah=/[ \f\n\r\t\v\u2028\u2029]+/,sh=function(e){var t=e.children,r=e.breakAll,n=e.style;try{var a=[];return di()(t)||(a=r?t.toString().split(""):t.toString().split(ah)),{wordsWithComputedWidth:a.map(function(e){return{word:e,width:Ru(e,n).width}}),spaceWidth:r?0:Ru("\xa0",n).width}}catch(dU){return null}},ih=function(e){return[{words:di()(e)?[]:e.toString().split(ah)}]},oh=function(e){var t=e.width,r=e.scaleToFit,n=e.children,a=e.style,s=e.breakAll,i=e.maxLines;if((t||r)&&!Io.isSsr){var o=sh({breakAll:s,children:n,style:a});return o?function(e,t,r,n,a){var s=e.maxLines,i=e.children,o=e.style,l=e.breakAll,c=Zs(s),d=i,u=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){var s=t.word,i=t.width,o=e[e.length-1];if(o&&(null==n||a||o.width+i+r<Number(n)))o.words.push(s),o.width+=i+r;else{var l={words:[s],width:i};e.push(l)}return e},[])},h=u(t);if(!c)return h;for(var p,m=function(e){var t=d.slice(0,e),r=sh({breakAll:l,style:o,children:t+"\u2026"}).wordsWithComputedWidth,a=u(r),i=a.length>s||function(e){return e.reduce(function(e,t){return e.width>t.width?e:t})}(a).width>Number(n);return[i,a]},f=0,g=d.length-1,x=0;f<=g&&x<=d.length-1;){var b=Math.floor((f+g)/2),y=rh(m(b-1),2),v=y[0],_=y[1],k=rh(m(b),1)[0];if(v||k||(f=b+1),v&&k&&(g=b-1),!v&&k){p=_;break}x++}return p||h}({breakAll:s,children:n,maxLines:i,style:a},o.wordsWithComputedWidth,o.spaceWidth,t,r):ih(n)}return ih(n)},lh="#808080",ch=function(e){var t=e.x,r=void 0===t?0:t,n=e.y,a=void 0===n?0:n,i=e.lineHeight,o=void 0===i?"1em":i,l=e.capHeight,c=void 0===l?"0.71em":l,d=e.scaleToFit,u=void 0!==d&&d,h=e.textAnchor,p=void 0===h?"start":h,m=e.verticalAnchor,f=void 0===m?"end":m,g=e.fill,x=void 0===g?lh:g,b=th(e,Qu),y=(0,s.useMemo)(function(){return oh({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),v=b.dx,_=b.dy,k=b.angle,j=b.className,w=b.breakAll,N=th(b,Zu);if(!ei(r)||!ei(a))return null;var S,O=r+(Zs(v)?v:0),C=a+(Zs(_)?_:0);switch(f){case"start":S=Ju("calc(".concat(c,")"));break;case"middle":S=Ju("calc(".concat((y.length-1)/2," * -").concat(o," + (").concat(c," / 2))"));break;default:S=Ju("calc(".concat(y.length-1," * -").concat(o,")"))}var E=[];if(u){var P=y[0].width,A=b.width;E.push("scale(".concat((Zs(A)?A/P:1)/P,")"))}return k&&E.push("rotate(".concat(k,", ").concat(O,", ").concat(C,")")),E.length&&(N.transform=E.join(" ")),s.createElement("text",eh({},Fi(N,!0),{x:O,y:C,className:Us("recharts-text",j),textAnchor:p,fill:x.includes("url")?lh:x}),y.map(function(e,t){var r=e.words.join(w?"":" ");return s.createElement("tspan",{x:O,dy:0===t?S:o,key:"".concat(r,"-").concat(t)},r)}))};const dh=Math.sqrt(50),uh=Math.sqrt(10),hh=Math.sqrt(2);function ph(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),i=s>=dh?10:s>=uh?5:s>=hh?2:1;let o,l,c;return a<0?(c=Math.pow(10,-a)/i,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*i,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?ph(e,t,2*r):[o,l,c]}function mh(e,t,r){if(!((r=+r)>0))return[];if((e=+e)===(t=+t))return[e];const n=t<e,[a,s,i]=n?ph(t,e,r):ph(e,t,r);if(!(s>=a))return[];const o=s-a+1,l=new Array(o);if(n)if(i<0)for(let c=0;c<o;++c)l[c]=(s-c)/-i;else for(let c=0;c<o;++c)l[c]=(s-c)*i;else if(i<0)for(let c=0;c<o;++c)l[c]=(a+c)/-i;else for(let c=0;c<o;++c)l[c]=(a+c)*i;return l}function fh(e,t,r){return ph(e=+e,t=+t,r=+r)[2]}function gh(e,t,r){r=+r;const n=(t=+t)<(e=+e),a=n?fh(t,e,r):fh(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function xh(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bh(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yh(e){let t,r,n;function a(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(n,n))return s;do{const t=a+s>>>1;r(e[t],n)<0?a=t+1:s=t}while(a<s)}return a}return 2!==e.length?(t=xh,r=(t,r)=>xh(e(t),r),n=(t,r)=>e(t)-r):(t=e===xh||e===bh?e:vh,r=e,n=e),{left:a,center:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=a(e,t,r,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return s>r&&n(e[s-1],t)>-n(e[s],t)?s-1:s},right:function(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(n,n))return s;do{const t=a+s>>>1;r(e[t],n)<=0?a=t+1:s=t}while(a<s)}return a}}}function vh(){return 0}function _h(e){return null===e?NaN:+e}const kh=yh(xh),jh=kh.right,wh=(kh.left,yh(_h).center,jh);function Nh(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Sh(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Oh(){}var Ch=.7,Eh=1/Ch,Ph="\\s*([+-]?\\d+)\\s*",Ah="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Th="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mh=/^#([0-9a-f]{3,8})$/,Rh=new RegExp("^rgb\\(".concat(Ph,",").concat(Ph,",").concat(Ph,"\\)$")),Dh=new RegExp("^rgb\\(".concat(Th,",").concat(Th,",").concat(Th,"\\)$")),Ih=new RegExp("^rgba\\(".concat(Ph,",").concat(Ph,",").concat(Ph,",").concat(Ah,"\\)$")),Lh=new RegExp("^rgba\\(".concat(Th,",").concat(Th,",").concat(Th,",").concat(Ah,"\\)$")),Fh=new RegExp("^hsl\\(".concat(Ah,",").concat(Th,",").concat(Th,"\\)$")),Bh=new RegExp("^hsla\\(".concat(Ah,",").concat(Th,",").concat(Th,",").concat(Ah,"\\)$")),Uh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zh(){return this.rgb().formatHex()}function Vh(){return this.rgb().formatRgb()}function Hh(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Mh.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?Wh(t):3===r?new $h(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?qh(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?qh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Rh.exec(e))?new $h(t[1],t[2],t[3],1):(t=Dh.exec(e))?new $h(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ih.exec(e))?qh(t[1],t[2],t[3],t[4]):(t=Lh.exec(e))?qh(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Fh.exec(e))?Zh(t[1],t[2]/100,t[3]/100,1):(t=Bh.exec(e))?Zh(t[1],t[2]/100,t[3]/100,t[4]):Uh.hasOwnProperty(e)?Wh(Uh[e]):"transparent"===e?new $h(NaN,NaN,NaN,0):null}function Wh(e){return new $h(e>>16&255,e>>8&255,255&e,1)}function qh(e,t,r,n){return n<=0&&(e=t=r=NaN),new $h(e,t,r,n)}function Gh(e,t,r,n){return 1===arguments.length?((a=e)instanceof Oh||(a=Hh(a)),a?new $h((a=a.rgb()).r,a.g,a.b,a.opacity):new $h):new $h(e,t,r,null==n?1:n);var a}function $h(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Kh(){return"#".concat(Qh(this.r)).concat(Qh(this.g)).concat(Qh(this.b))}function Yh(){const e=Xh(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Jh(this.r),", ").concat(Jh(this.g),", ").concat(Jh(this.b)).concat(1===e?")":", ".concat(e,")"))}function Xh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qh(e){return((e=Jh(e))<16?"0":"")+e.toString(16)}function Zh(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new tp(e,t,r,n)}function ep(e){if(e instanceof tp)return new tp(e.h,e.s,e.l,e.opacity);if(e instanceof Oh||(e=Hh(e)),!e)return new tp;if(e instanceof tp)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),s=Math.max(t,r,n),i=NaN,o=s-a,l=(s+a)/2;return o?(i=t===s?(r-n)/o+6*(r<n):r===s?(n-t)/o+2:(t-r)/o+4,o/=l<.5?s+a:2-s-a,i*=60):o=l>0&&l<1?0:i,new tp(i,o,l,e.opacity)}function tp(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function rp(e){return(e=(e||0)%360)<0?e+360:e}function np(e){return Math.max(0,Math.min(1,e||0))}function ap(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}function sp(e,t,r,n,a){var s=e*e,i=s*e;return((1-3*e+3*s-i)*t+(4-6*s+3*i)*r+(1+3*e+3*s-3*i)*n+i*a)/6}Nh(Oh,Hh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:zh,formatHex:zh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ep(this).formatHsl()},formatRgb:Vh,toString:Vh}),Nh($h,Gh,Sh(Oh,{brighter(e){return e=null==e?Eh:Math.pow(Eh,e),new $h(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ch:Math.pow(Ch,e),new $h(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $h(Jh(this.r),Jh(this.g),Jh(this.b),Xh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kh,formatHex:Kh,formatHex8:function(){return"#".concat(Qh(this.r)).concat(Qh(this.g)).concat(Qh(this.b)).concat(Qh(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Yh,toString:Yh})),Nh(tp,function(e,t,r,n){return 1===arguments.length?ep(e):new tp(e,t,r,null==n?1:n)},Sh(Oh,{brighter(e){return e=null==e?Eh:Math.pow(Eh,e),new tp(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ch:Math.pow(Ch,e),new tp(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new $h(ap(e>=240?e-240:e+120,a,n),ap(e,a,n),ap(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new tp(rp(this.h),np(this.s),np(this.l),Xh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xh(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(rp(this.h),", ").concat(100*np(this.s),"%, ").concat(100*np(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const ip=e=>()=>e;function op(e,t){return function(r){return e+r*t}}function lp(e){return 1===(e=+e)?cp:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):ip(isNaN(t)?r:t)}}function cp(e,t){var r=t-e;return r?op(e,r):ip(isNaN(e)?t:e)}const dp=function e(t){var r=lp(t);function n(e,t){var n=r((e=Gh(e)).r,(t=Gh(t)).r),a=r(e.g,t.g),s=r(e.b,t.b),i=cp(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=a(t),e.b=s(t),e.opacity=i(t),e+""}}return n.gamma=e,n}(1);function up(e){return function(t){var r,n,a=t.length,s=new Array(a),i=new Array(a),o=new Array(a);for(r=0;r<a;++r)n=Gh(t[r]),s[r]=n.r||0,i[r]=n.g||0,o[r]=n.b||0;return s=e(s),i=e(i),o=e(o),n.opacity=1,function(e){return n.r=s(e),n.g=i(e),n.b=o(e),n+""}}}up(function(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),a=e[n],s=e[n+1],i=n>0?e[n-1]:2*a-s,o=n<t-1?e[n+2]:2*s-a;return sp((r-n/t)*t,i,a,s,o)}}),up(function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),a=e[(n+t-1)%t],s=e[n%t],i=e[(n+1)%t],o=e[(n+2)%t];return sp((r-n/t)*t,a,s,i,o)}});function hp(e,t){var r,n=t?t.length:0,a=e?Math.min(n,e.length):0,s=new Array(a),i=new Array(n);for(r=0;r<a;++r)s[r]=vp(e[r],t[r]);for(;r<n;++r)i[r]=t[r];return function(e){for(r=0;r<a;++r)i[r]=s[r](e);return i}}function pp(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function mp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function fp(e,t){var r,n={},a={};for(r in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)r in e?n[r]=vp(e[r],t[r]):a[r]=t[r];return function(e){for(r in n)a[r]=n[r](e);return a}}var gp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xp=new RegExp(gp.source,"g");function bp(e,t){var r,n,a,s=gp.lastIndex=xp.lastIndex=0,i=-1,o=[],l=[];for(e+="",t+="";(r=gp.exec(e))&&(n=xp.exec(t));)(a=n.index)>s&&(a=t.slice(s,a),o[i]?o[i]+=a:o[++i]=a),(r=r[0])===(n=n[0])?o[i]?o[i]+=n:o[++i]=n:(o[++i]=null,l.push({i:i,x:mp(r,n)})),s=xp.lastIndex;return s<t.length&&(a=t.slice(s),o[i]?o[i]+=a:o[++i]=a),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var r,n=0;n<t;++n)o[(r=l[n]).i]=r.x(e);return o.join("")})}function yp(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,a=t.slice();return function(s){for(r=0;r<n;++r)a[r]=e[r]*(1-s)+t[r]*s;return a}}function vp(e,t){var r,n,a=typeof t;return null==t||"boolean"===a?ip(t):("number"===a?mp:"string"===a?(r=Hh(t))?(t=r,dp):bp:t instanceof Hh?dp:t instanceof Date?pp:(n=t,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(t)?hp:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?fp:mp:yp))(e,t)}function _p(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kp(e){return+e}var jp=[0,1];function wp(e){return e}function Np(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r});var r}function Sp(e,t,r){var n=e[0],a=e[1],s=t[0],i=t[1];return a<n?(n=Np(a,n),s=r(i,s)):(n=Np(n,a),s=r(s,i)),function(e){return s(n(e))}}function Op(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),s=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)a[i]=Np(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(t){var r=wh(e,t,1,n)-1;return s[r](a[r](t))}}function Cp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Ep(){var e,t,r,n,a,s,i=jp,o=jp,l=vp,c=wp;function d(){var e=Math.min(i.length,o.length);return c!==wp&&(c=function(e,t){var r;return e>t&&(r=e,e=t,t=r),function(r){return Math.max(e,Math.min(t,r))}}(i[0],i[e-1])),n=e>2?Op:Sp,a=s=null,u}function u(t){return null==t||isNaN(t=+t)?r:(a||(a=n(i.map(e),o,l)))(e(c(t)))}return u.invert=function(r){return c(t((s||(s=n(o,i.map(e),mp)))(r)))},u.domain=function(e){return arguments.length?(i=Array.from(e,kp),d()):i.slice()},u.range=function(e){return arguments.length?(o=Array.from(e),d()):o.slice()},u.rangeRound=function(e){return o=Array.from(e),l=_p,d()},u.clamp=function(e){return arguments.length?(c=!!e||wp,d()):c!==wp},u.interpolate=function(e){return arguments.length?(l=e,d()):l},u.unknown=function(e){return arguments.length?(r=e,u):r},function(r,n){return e=r,t=n,d()}}function Pp(){return Ep()(wp,wp)}var Ap,Tp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mp(e){if(!(t=Tp.exec(e)))throw new Error("invalid format: "+e);var t;return new Rp({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Rp(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Dp(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ip(e){return(e=Dp(Math.abs(e)))?e[1]:NaN}function Lp(e,t){var r=Dp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}Mp.prototype=Rp.prototype,Rp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Fp={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Lp(100*e,t),r:Lp,s:function(e,t){var r=Dp(e,t);if(!r)return e+"";var n=r[0],a=r[1],s=a-(Ap=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,i=n.length;return s===i?n:s>i?n+new Array(s-i+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Dp(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Bp(e){return e}var Up,zp,Vp,Hp=Array.prototype.map,Wp=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function qp(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?Bp:(t=Hp.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var a=e.length,s=[],i=0,o=t[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),s.push(e.substring(a-=o,a+o)),!((l+=o+1)>n));)o=t[i=(i+1)%t.length];return s.reverse().join(r)}),a=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?Bp:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Hp.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=Mp(e)).fill,r=e.align,u=e.sign,h=e.symbol,p=e.zero,m=e.width,f=e.comma,g=e.precision,x=e.trim,b=e.type;"n"===b?(f=!0,b="g"):Fp[b]||(void 0===g&&(g=12),x=!0,b="g"),(p||"0"===t&&"="===r)&&(p=!0,t="0",r="=");var y="$"===h?a:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",v="$"===h?s:/[%p]/.test(b)?l:"",_=Fp[b],k=/[defgprs%]/.test(b);function j(e){var a,s,l,h=y,j=v;if("c"===b)j=_(e)+j,e="";else{var w=(e=+e)<0||1/e<0;if(e=isNaN(e)?d:_(Math.abs(e),g),x&&(e=function(e){e:for(var t,r=e.length,n=1,a=-1;n<r;++n)switch(e[n]){case".":a=t=n;break;case"0":0===a&&(a=n),t=n;break;default:if(!+e[n])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),w&&0===+e&&"+"!==u&&(w=!1),h=(w?"("===u?u:c:"-"===u||"("===u?"":u)+h,j=("s"===b?Wp[8+Ap/3]:"")+j+(w&&"("===u?")":""),k)for(a=-1,s=e.length;++a<s;)if(48>(l=e.charCodeAt(a))||l>57){j=(46===l?i+e.slice(a+1):e.slice(a))+j,e=e.slice(0,a);break}}f&&!p&&(e=n(e,1/0));var N=h.length+e.length+j.length,S=N<m?new Array(m-N+1).join(t):"";switch(f&&p&&(e=n(S+e,S.length?m-j.length:1/0),S=""),r){case"<":e=h+e+j+S;break;case"=":e=h+S+e+j;break;case"^":e=S.slice(0,N=S.length>>1)+h+e+j+S.slice(N);break;default:e=S+h+e+j}return o(e)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),j.toString=function(){return e+""},j}return{format:u,formatPrefix:function(e,t){var r=u(((e=Mp(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(Ip(t)/3))),a=Math.pow(10,-n),s=Wp[8+n/3];return function(e){return r(a*e)+s}}}}function Gp(e,t,r,n){var a,s=gh(e,t,r);switch((n=Mp(null==n?",f":n)).type){case"s":var i=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ip(t)/3)))-Ip(Math.abs(e)))}(s,i))||(n.precision=a),Vp(n,i);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ip(t)-Ip(e))+1}(s,Math.max(Math.abs(e),Math.abs(t))))||(n.precision=a-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(a=function(e){return Math.max(0,-Ip(Math.abs(e)))}(s))||(n.precision=a-2*("%"===n.type))}return zp(n)}function $p(e){var t=e.domain;return e.ticks=function(e){var r=t();return mh(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var n=t();return Gp(n[0],n[n.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var n,a,s=t(),i=0,o=s.length-1,l=s[i],c=s[o],d=10;for(c<l&&(a=l,l=c,c=a,a=i,i=o,o=a);d-- >0;){if((a=fh(l,c,r))===n)return s[i]=l,s[o]=c,t(s);if(a>0)l=Math.floor(l/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,c=Math.floor(c*a)/a}n=a}return e},e}function Kp(){var e=Pp();return e.copy=function(){return Cp(e,Kp())},fu.apply(e,arguments),$p(e)}function Yp(e){var t;function r(e){return null==e||isNaN(e=+e)?t:e}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,kp),r):e.slice()},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return Yp(e).unknown(t)},e=arguments.length?Array.from(e,kp):[0,1],$p(r)}function Xp(e,t){var r,n=0,a=(e=e.slice()).length-1,s=e[n],i=e[a];return i<s&&(r=n,n=a,a=r,r=s,s=i,i=r),e[n]=t.floor(s),e[a]=t.ceil(i),e}function Jp(e){return Math.log(e)}function Qp(e){return Math.exp(e)}function Zp(e){return-Math.log(-e)}function em(e){return-Math.exp(-e)}function tm(e){return isFinite(e)?+("1e"+e):e<0?0:e}function rm(e){return(t,r)=>-e(-t,r)}function nm(e){const t=e(Jp,Qp),r=t.domain;let n,a,s=10;function i(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(s),a=function(e){return 10===e?tm:e===Math.E?Math.exp:t=>Math.pow(e,t)}(s),r()[0]<0?(n=rm(n),a=rm(a),e(Zp,em)):e(Jp,Qp),t}return t.base=function(e){return arguments.length?(s=+e,i()):s},t.domain=function(e){return arguments.length?(r(e),i()):r()},t.ticks=e=>{const t=r();let i=t[0],o=t[t.length-1];const l=o<i;l&&([i,o]=[o,i]);let c,d,u=n(i),h=n(o);const p=null==e?10:+e;let m=[];if(!(s%1)&&h-u<p){if(u=Math.floor(u),h=Math.ceil(h),i>0){for(;u<=h;++u)for(c=1;c<s;++c)if(d=u<0?c/a(-u):c*a(u),!(d<i)){if(d>o)break;m.push(d)}}else for(;u<=h;++u)for(c=s-1;c>=1;--c)if(d=u>0?c/a(-u):c*a(u),!(d<i)){if(d>o)break;m.push(d)}2*m.length<p&&(m=mh(i,o,p))}else m=mh(u,h,Math.min(h-u,p)).map(a);return l?m.reverse():m},t.tickFormat=(e,r)=>{if(null==e&&(e=10),null==r&&(r=10===s?"s":","),"function"!==typeof r&&(s%1||null!=(r=Mp(r)).precision||(r.trim=!0),r=zp(r)),e===1/0)return r;const i=Math.max(1,s*e/t.ticks().length);return e=>{let t=e/a(Math.round(n(e)));return t*s<s-.5&&(t*=s),t<=i?r(e):""}},t.nice=()=>r(Xp(r(),{floor:e=>a(Math.floor(n(e))),ceil:e=>a(Math.ceil(n(e)))})),t}function am(){const e=nm(Ep()).domain([1,10]);return e.copy=()=>Cp(e,am()).base(e.base()),fu.apply(e,arguments),e}function sm(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function im(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function om(e){var t=1,r=e(sm(t),im(t));return r.constant=function(r){return arguments.length?e(sm(t=+r),im(t)):t},$p(r)}function lm(){var e=om(Ep());return e.copy=function(){return Cp(e,lm()).constant(e.constant())},fu.apply(e,arguments)}function cm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function dm(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function um(e){return e<0?-e*e:e*e}function hm(e){var t=e(wp,wp),r=1;return t.exponent=function(t){return arguments.length?1===(r=+t)?e(wp,wp):.5===r?e(dm,um):e(cm(r),cm(1/r)):r},$p(t)}function pm(){var e=hm(Ep());return e.copy=function(){return Cp(e,pm()).exponent(e.exponent())},fu.apply(e,arguments),e}function mm(){return pm.apply(null,arguments).exponent(.5)}function fm(e){return Math.sign(e)*e*e}function gm(){var e,t=Pp(),r=[0,1],n=!1;function a(r){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(r));return isNaN(a)?e:n?Math.round(a):a}return a.invert=function(e){return t.invert(fm(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((r=Array.from(e,kp)).map(fm)),a):r.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(n=!!e,a):n},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return gm(t.domain(),r).round(n).clamp(t.clamp()).unknown(e)},fu.apply(a,arguments),$p(a)}function xm(e,t){let r;if(void 0===t)for(const n of e)null!=n&&(r<n||void 0===r&&n>=n)&&(r=n);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(r<a||void 0===r&&a>=a)&&(r=a)}return r}function bm(e,t){let r;if(void 0===t)for(const n of e)null!=n&&(r>n||void 0===r&&n>=n)&&(r=n);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(r>a||void 0===r&&a>=a)&&(r=a)}return r}function ym(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xh;if(e===xh)return vm;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||0===n?n:(0===e(r,r))-(0===e(t,t))}}function vm(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function _m(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=void 0===a?vm:ym(a);n>r;){if(n-r>600){const s=n-r+1,i=t-r+1,o=Math.log(s),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(s-l)/s)*(i-s/2<0?-1:1);_m(e,t,Math.max(r,Math.floor(t-i*l/s+c)),Math.min(n,Math.floor(t+(s-i)*l/s+c)),a)}const s=e[t];let i=r,o=n;for(km(e,r,t),a(e[n],s)>0&&km(e,r,n);i<o;){for(km(e,i,o),++i,--o;a(e[i],s)<0;)++i;for(;a(e[o],s)>0;)--o}0===a(e[r],s)?km(e,r,o):(++o,km(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function km(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function jm(e,t,r){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)null!=(n=t(n,++r,e))&&(n=+n)>=n&&(yield n)}}(e,r)),(n=e.length)&&!isNaN(t=+t)){if(t<=0||n<2)return bm(e);if(t>=1)return xm(e);var n,a=(n-1)*t,s=Math.floor(a),i=xm(_m(e,s).subarray(0,s+1));return i+(bm(e.subarray(s+1))-i)*(a-s)}}function wm(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_h;if((n=e.length)&&!isNaN(t=+t)){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,s=Math.floor(a),i=+r(e[s],s,e);return i+(+r(e[s+1],s+1,e)-i)*(a-s)}}function Nm(){var e,t=[],r=[],n=[];function a(){var e=0,a=Math.max(1,r.length);for(n=new Array(a-1);++e<a;)n[e-1]=wm(t,e/a);return s}function s(t){return null==t||isNaN(t=+t)?e:r[wh(n,t)]}return s.invertExtent=function(e){var a=r.indexOf(e);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let r of e)null==r||isNaN(r=+r)||t.push(r);return t.sort(xh),a()},s.range=function(e){return arguments.length?(r=Array.from(e),a()):r.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return n.slice()},s.copy=function(){return Nm().domain(t).range(r).unknown(e)},fu.apply(s,arguments)}function Sm(){var e,t=0,r=1,n=1,a=[.5],s=[0,1];function i(t){return null!=t&&t<=t?s[wh(a,t,0,n)]:e}function o(){var e=-1;for(a=new Array(n);++e<n;)a[e]=((e+1)*r-(e-n)*t)/(n+1);return i}return i.domain=function(e){return arguments.length?([t,r]=e,t=+t,r=+r,o()):[t,r]},i.range=function(e){return arguments.length?(n=(s=Array.from(e)).length-1,o()):s.slice()},i.invertExtent=function(e){var i=s.indexOf(e);return i<0?[NaN,NaN]:i<1?[t,a[0]]:i>=n?[a[n-1],r]:[a[i-1],a[i]]},i.unknown=function(t){return arguments.length?(e=t,i):i},i.thresholds=function(){return a.slice()},i.copy=function(){return Sm().domain([t,r]).range(s).unknown(e)},fu.apply($p(i),arguments)}function Om(){var e,t=[.5],r=[0,1],n=1;function a(a){return null!=a&&a<=a?r[wh(t,a,0,n)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),n=Math.min(t.length,r.length-1),a):t.slice()},a.range=function(e){return arguments.length?(r=Array.from(e),n=Math.min(t.length,r.length-1),a):r.slice()},a.invertExtent=function(e){var n=r.indexOf(e);return[t[n-1],t[n]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Om().domain(t).range(r).unknown(e)},fu.apply(a,arguments)}Up=qp({thousands:",",grouping:[3],currency:["$",""]}),zp=Up.format,Vp=Up.formatPrefix;const Cm=1e3,Em=6e4,Pm=36e5,Am=864e5,Tm=6048e5,Mm=2592e6,Rm=31536e6,Dm=new Date,Im=new Date;function Lm(e,t,r,n){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=r=>(e(r=new Date(r-1)),t(r,1),e(r),r),a.round=e=>{const t=a(e),r=a.ceil(e);return e-t<r-e?t:r},a.offset=(e,r)=>(t(e=new Date(+e),null==r?1:Math.floor(r)),e),a.range=(r,n,s)=>{const i=[];if(r=a.ceil(r),s=null==s?1:Math.floor(s),!(r<n)||!(s>0))return i;let o;do{i.push(o=new Date(+r)),t(r,s),e(r)}while(o<r&&r<n);return i},a.filter=r=>Lm(t=>{if(t>=t)for(;e(t),!r(t);)t.setTime(t-1)},(e,n)=>{if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!r(e););else for(;--n>=0;)for(;t(e,1),!r(e););}),r&&(a.count=(t,n)=>(Dm.setTime(+t),Im.setTime(+n),e(Dm),e(Im),Math.floor(r(Dm,Im))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(n?t=>n(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const Fm=Lm(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Fm.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Lm(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Fm:null);Fm.range;const Bm=Lm(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Cm)},(e,t)=>(t-e)/Cm,e=>e.getUTCSeconds()),Um=(Bm.range,Lm(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cm)},(e,t)=>{e.setTime(+e+t*Em)},(e,t)=>(t-e)/Em,e=>e.getMinutes())),zm=(Um.range,Lm(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Em)},(e,t)=>(t-e)/Em,e=>e.getUTCMinutes())),Vm=(zm.range,Lm(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cm-e.getMinutes()*Em)},(e,t)=>{e.setTime(+e+t*Pm)},(e,t)=>(t-e)/Pm,e=>e.getHours())),Hm=(Vm.range,Lm(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Pm)},(e,t)=>(t-e)/Pm,e=>e.getUTCHours())),Wm=(Hm.range,Lm(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Em)/Am,e=>e.getDate()-1)),qm=(Wm.range,Lm(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Am,e=>e.getUTCDate()-1)),Gm=(qm.range,Lm(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Am,e=>Math.floor(e/Am)));Gm.range;function $m(e){return Lm(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Em)/Tm)}const Km=$m(0),Ym=$m(1),Xm=$m(2),Jm=$m(3),Qm=$m(4),Zm=$m(5),ef=$m(6);Km.range,Ym.range,Xm.range,Jm.range,Qm.range,Zm.range,ef.range;function tf(e){return Lm(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/Tm)}const rf=tf(0),nf=tf(1),af=tf(2),sf=tf(3),of=tf(4),lf=tf(5),cf=tf(6),df=(rf.range,nf.range,af.range,sf.range,of.range,lf.range,cf.range,Lm(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),uf=(df.range,Lm(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),hf=(uf.range,Lm(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));hf.every=e=>isFinite(e=Math.floor(e))&&e>0?Lm(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)}):null;hf.range;const pf=Lm(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());pf.every=e=>isFinite(e=Math.floor(e))&&e>0?Lm(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)}):null;pf.range;function mf(e,t,r,n,a,s){const i=[[Bm,1,Cm],[Bm,5,5e3],[Bm,15,15e3],[Bm,30,3e4],[s,1,Em],[s,5,3e5],[s,15,9e5],[s,30,18e5],[a,1,Pm],[a,3,108e5],[a,6,216e5],[a,12,432e5],[n,1,Am],[n,2,1728e5],[r,1,Tm],[t,1,Mm],[t,3,7776e6],[e,1,Rm]];function o(t,r,n){const a=Math.abs(r-t)/n,s=yh(e=>{let[,,t]=e;return t}).right(i,a);if(s===i.length)return e.every(gh(t/Rm,r/Rm,n));if(0===s)return Fm.every(Math.max(gh(t,r,n),1));const[o,l]=i[a/i[s-1][2]<i[s][2]/a?s-1:s];return o.every(l)}return[function(e,t,r){const n=t<e;n&&([e,t]=[t,e]);const a=r&&"function"===typeof r.range?r:o(e,t,r),s=a?a.range(e,+t+1):[];return n?s.reverse():s},o]}const[ff,gf]=mf(pf,uf,rf,Gm,Hm,zm),[xf,bf]=mf(hf,df,Km,Wm,Vm,Um);function yf(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function vf(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _f(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}var kf,jf,wf,Nf={"-":"",_:" ",0:"0"},Sf=/^\s*\d+/,Of=/^%/,Cf=/[\\^$*+?|[\]().{}]/g;function Ef(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(t)+a:a)}function Pf(e){return e.replace(Cf,"\\$&")}function Af(e){return new RegExp("^(?:"+e.map(Pf).join("|")+")","i")}function Tf(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Mf(e,t,r){var n=Sf.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Rf(e,t,r){var n=Sf.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Df(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function If(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Lf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Ff(e,t,r){var n=Sf.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Bf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Uf(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function zf(e,t,r){var n=Sf.exec(t.slice(r,r+1));return n?(e.q=3*n[0]-3,r+n[0].length):-1}function Vf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Hf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Wf(e,t,r){var n=Sf.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function qf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Gf(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function $f(e,t,r){var n=Sf.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Kf(e,t,r){var n=Sf.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Yf(e,t,r){var n=Sf.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Xf(e,t,r){var n=Of.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Jf(e,t,r){var n=Sf.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Qf(e,t,r){var n=Sf.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Zf(e,t){return Ef(e.getDate(),t,2)}function eg(e,t){return Ef(e.getHours(),t,2)}function tg(e,t){return Ef(e.getHours()%12||12,t,2)}function rg(e,t){return Ef(1+Wm.count(hf(e),e),t,3)}function ng(e,t){return Ef(e.getMilliseconds(),t,3)}function ag(e,t){return ng(e,t)+"000"}function sg(e,t){return Ef(e.getMonth()+1,t,2)}function ig(e,t){return Ef(e.getMinutes(),t,2)}function og(e,t){return Ef(e.getSeconds(),t,2)}function lg(e){var t=e.getDay();return 0===t?7:t}function cg(e,t){return Ef(Km.count(hf(e)-1,e),t,2)}function dg(e){var t=e.getDay();return t>=4||0===t?Qm(e):Qm.ceil(e)}function ug(e,t){return e=dg(e),Ef(Qm.count(hf(e),e)+(4===hf(e).getDay()),t,2)}function hg(e){return e.getDay()}function pg(e,t){return Ef(Ym.count(hf(e)-1,e),t,2)}function mg(e,t){return Ef(e.getFullYear()%100,t,2)}function fg(e,t){return Ef((e=dg(e)).getFullYear()%100,t,2)}function gg(e,t){return Ef(e.getFullYear()%1e4,t,4)}function xg(e,t){var r=e.getDay();return Ef((e=r>=4||0===r?Qm(e):Qm.ceil(e)).getFullYear()%1e4,t,4)}function bg(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ef(t/60|0,"0",2)+Ef(t%60,"0",2)}function yg(e,t){return Ef(e.getUTCDate(),t,2)}function vg(e,t){return Ef(e.getUTCHours(),t,2)}function _g(e,t){return Ef(e.getUTCHours()%12||12,t,2)}function kg(e,t){return Ef(1+qm.count(pf(e),e),t,3)}function jg(e,t){return Ef(e.getUTCMilliseconds(),t,3)}function wg(e,t){return jg(e,t)+"000"}function Ng(e,t){return Ef(e.getUTCMonth()+1,t,2)}function Sg(e,t){return Ef(e.getUTCMinutes(),t,2)}function Og(e,t){return Ef(e.getUTCSeconds(),t,2)}function Cg(e){var t=e.getUTCDay();return 0===t?7:t}function Eg(e,t){return Ef(rf.count(pf(e)-1,e),t,2)}function Pg(e){var t=e.getUTCDay();return t>=4||0===t?of(e):of.ceil(e)}function Ag(e,t){return e=Pg(e),Ef(of.count(pf(e),e)+(4===pf(e).getUTCDay()),t,2)}function Tg(e){return e.getUTCDay()}function Mg(e,t){return Ef(nf.count(pf(e)-1,e),t,2)}function Rg(e,t){return Ef(e.getUTCFullYear()%100,t,2)}function Dg(e,t){return Ef((e=Pg(e)).getUTCFullYear()%100,t,2)}function Ig(e,t){return Ef(e.getUTCFullYear()%1e4,t,4)}function Lg(e,t){var r=e.getUTCDay();return Ef((e=r>=4||0===r?of(e):of.ceil(e)).getUTCFullYear()%1e4,t,4)}function Fg(){return"+0000"}function Bg(){return"%"}function Ug(e){return+e}function zg(e){return Math.floor(+e/1e3)}function Vg(e){return new Date(e)}function Hg(e){return e instanceof Date?+e:+new Date(+e)}function Wg(e,t,r,n,a,s,i,o,l,c){var d=Pp(),u=d.invert,h=d.domain,p=c(".%L"),m=c(":%S"),f=c("%I:%M"),g=c("%I %p"),x=c("%a %d"),b=c("%b %d"),y=c("%B"),v=c("%Y");function _(e){return(l(e)<e?p:o(e)<e?m:i(e)<e?f:s(e)<e?g:n(e)<e?a(e)<e?x:b:r(e)<e?y:v)(e)}return d.invert=function(e){return new Date(u(e))},d.domain=function(e){return arguments.length?h(Array.from(e,Hg)):h().map(Vg)},d.ticks=function(t){var r=h();return e(r[0],r[r.length-1],null==t?10:t)},d.tickFormat=function(e,t){return null==t?_:c(t)},d.nice=function(e){var r=h();return e&&"function"===typeof e.range||(e=t(r[0],r[r.length-1],null==e?10:e)),e?h(Xp(r,e)):d},d.copy=function(){return Cp(d,Wg(e,t,r,n,a,s,i,o,l,c))},d}function qg(){return fu.apply(Wg(xf,bf,hf,df,Km,Wm,Vm,Um,Bm,jf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Gg(){return fu.apply(Wg(ff,gf,pf,uf,rf,qm,Hm,zm,Bm,wf).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function $g(){var e,t,r,n,a,s=0,i=1,o=wp,l=!1;function c(t){return null==t||isNaN(t=+t)?a:o(0===r?.5:(t=(n(t)-e)*r,l?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var r,n;return arguments.length?([r,n]=t,o=e(r,n),c):[o(0),o(1)]}}return c.domain=function(a){return arguments.length?([s,i]=a,e=n(s=+s),t=n(i=+i),r=e===t?0:1/(t-e),c):[s,i]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(o=e,c):o},c.range=d(vp),c.rangeRound=d(_p),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return n=a,e=a(s),t=a(i),r=e===t?0:1/(t-e),c}}function Kg(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Yg(){var e=$p($g()(wp));return e.copy=function(){return Kg(e,Yg())},gu.apply(e,arguments)}function Xg(){var e=nm($g()).domain([1,10]);return e.copy=function(){return Kg(e,Xg()).base(e.base())},gu.apply(e,arguments)}function Jg(){var e=om($g());return e.copy=function(){return Kg(e,Jg()).constant(e.constant())},gu.apply(e,arguments)}function Qg(){var e=hm($g());return e.copy=function(){return Kg(e,Qg()).exponent(e.exponent())},gu.apply(e,arguments)}function Zg(){return Qg.apply(null,arguments).exponent(.5)}function ex(){var e=[],t=wp;function r(r){if(null!=r&&!isNaN(r=+r))return t((wh(e,r,1)-1)/(e.length-1))}return r.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let r of t)null==r||isNaN(r=+r)||e.push(r);return e.sort(xh),r},r.interpolator=function(e){return arguments.length?(t=e,r):t},r.range=function(){return e.map((r,n)=>t(n/(e.length-1)))},r.quantiles=function(t){return Array.from({length:t+1},(r,n)=>jm(e,n/t))},r.copy=function(){return ex(t).domain(e)},gu.apply(r,arguments)}function tx(){var e,t,r,n,a,s,i,o=0,l=.5,c=1,d=1,u=wp,h=!1;function p(e){return isNaN(e=+e)?i:(e=.5+((e=+s(e))-t)*(d*e<d*t?n:a),u(h?Math.max(0,Math.min(1,e)):e))}function m(e){return function(t){var r,n,a;return arguments.length?([r,n,a]=t,u=function(e,t){void 0===t&&(t=e,e=vp);for(var r=0,n=t.length-1,a=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(a,a=t[++r]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return s[t](e-t)}}(e,[r,n,a]),p):[u(0),u(.5),u(1)]}}return p.domain=function(i){return arguments.length?([o,l,c]=i,e=s(o=+o),t=s(l=+l),r=s(c=+c),n=e===t?0:.5/(t-e),a=t===r?0:.5/(r-t),d=t<e?-1:1,p):[o,l,c]},p.clamp=function(e){return arguments.length?(h=!!e,p):h},p.interpolator=function(e){return arguments.length?(u=e,p):u},p.range=m(vp),p.rangeRound=m(_p),p.unknown=function(e){return arguments.length?(i=e,p):i},function(i){return s=i,e=i(o),t=i(l),r=i(c),n=e===t?0:.5/(t-e),a=t===r?0:.5/(r-t),d=t<e?-1:1,p}}function rx(){var e=$p(tx()(wp));return e.copy=function(){return Kg(e,rx())},gu.apply(e,arguments)}function nx(){var e=nm(tx()).domain([.1,1,10]);return e.copy=function(){return Kg(e,nx()).base(e.base())},gu.apply(e,arguments)}function ax(){var e=om(tx());return e.copy=function(){return Kg(e,ax()).constant(e.constant())},gu.apply(e,arguments)}function sx(){var e=hm(tx());return e.copy=function(){return Kg(e,sx()).exponent(e.exponent())},gu.apply(e,arguments)}function ix(){return sx.apply(null,arguments).exponent(.5)}function ox(e,t){if((a=e.length)>1)for(var r,n,a,s=1,i=e[t[0]],o=i.length;s<a;++s)for(n=i,i=e[t[s]],r=0;r<o;++r)i[r][1]+=i[r][0]=isNaN(n[r][1])?n[r][0]:n[r][1]}!function(e){kf=function(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,s=e.days,i=e.shortDays,o=e.months,l=e.shortMonths,c=Af(a),d=Tf(a),u=Af(s),h=Tf(s),p=Af(i),m=Tf(i),f=Af(o),g=Tf(o),x=Af(l),b=Tf(l),y={a:function(e){return i[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:Zf,e:Zf,f:ag,g:fg,G:xg,H:eg,I:tg,j:rg,L:ng,m:sg,M:ig,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Ug,s:zg,S:og,u:lg,U:cg,V:ug,w:hg,W:pg,x:null,X:null,y:mg,Y:gg,Z:bg,"%":Bg},v={a:function(e){return i[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:yg,e:yg,f:wg,g:Dg,G:Lg,H:vg,I:_g,j:kg,L:jg,m:Ng,M:Sg,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Ug,s:zg,S:Og,u:Cg,U:Eg,V:Ag,w:Tg,W:Mg,x:null,X:null,y:Rg,Y:Ig,Z:Fg,"%":Bg},_={a:function(e,t,r){var n=p.exec(t.slice(r));return n?(e.w=m.get(n[0].toLowerCase()),r+n[0].length):-1},A:function(e,t,r){var n=u.exec(t.slice(r));return n?(e.w=h.get(n[0].toLowerCase()),r+n[0].length):-1},b:function(e,t,r){var n=x.exec(t.slice(r));return n?(e.m=b.get(n[0].toLowerCase()),r+n[0].length):-1},B:function(e,t,r){var n=f.exec(t.slice(r));return n?(e.m=g.get(n[0].toLowerCase()),r+n[0].length):-1},c:function(e,r,n){return w(e,t,r,n)},d:Hf,e:Hf,f:Yf,g:Bf,G:Ff,H:qf,I:qf,j:Wf,L:Kf,m:Vf,M:Gf,p:function(e,t,r){var n=c.exec(t.slice(r));return n?(e.p=d.get(n[0].toLowerCase()),r+n[0].length):-1},q:zf,Q:Jf,s:Qf,S:$f,u:Rf,U:Df,V:If,w:Mf,W:Lf,x:function(e,t,n){return w(e,r,t,n)},X:function(e,t,r){return w(e,n,t,r)},y:Bf,Y:Ff,Z:Uf,"%":Xf};function k(e,t){return function(r){var n,a,s,i=[],o=-1,l=0,c=e.length;for(r instanceof Date||(r=new Date(+r));++o<c;)37===e.charCodeAt(o)&&(i.push(e.slice(l,o)),null!=(a=Nf[n=e.charAt(++o)])?n=e.charAt(++o):a="e"===n?" ":"0",(s=t[n])&&(n=s(r,a)),i.push(n),l=o+1);return i.push(e.slice(l,o)),i.join("")}}function j(e,t){return function(r){var n,a,s=_f(1900,void 0,1);if(w(s,e,r+="",0)!=r.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(t&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(a=(n=vf(_f(s.y,0,1))).getUTCDay(),n=a>4||0===a?nf.ceil(n):nf(n),n=qm.offset(n,7*(s.V-1)),s.y=n.getUTCFullYear(),s.m=n.getUTCMonth(),s.d=n.getUTCDate()+(s.w+6)%7):(a=(n=yf(_f(s.y,0,1))).getDay(),n=a>4||0===a?Ym.ceil(n):Ym(n),n=Wm.offset(n,7*(s.V-1)),s.y=n.getFullYear(),s.m=n.getMonth(),s.d=n.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),a="Z"in s?vf(_f(s.y,0,1)).getUTCDay():yf(_f(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(a+5)%7:s.w+7*s.U-(a+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,vf(s)):yf(s)}}function w(e,t,r,n){for(var a,s,i=0,o=t.length,l=r.length;i<o;){if(n>=l)return-1;if(37===(a=t.charCodeAt(i++))){if(a=t.charAt(i++),!(s=_[a in Nf?t.charAt(i++):a])||(n=s(e,r,n))<0)return-1}else if(a!=r.charCodeAt(n++))return-1}return n}return y.x=k(r,y),y.X=k(n,y),y.c=k(t,y),v.x=k(r,v),v.X=k(n,v),v.c=k(t,v),{format:function(e){var t=k(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=j(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",v);return t.toString=function(){return e},t},utcParse:function(e){var t=j(e+="",!0);return t.toString=function(){return e},t}}}(e),jf=kf.format,kf.parse,wf=kf.utcFormat,kf.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Array.prototype.slice;function lx(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function cx(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function dx(e,t){return e[t]}function ux(e){const t=[];return t.key=e,t}var hx=r(539),px=r.n(hx),mx=r(6745),fx=r.n(mx),gx=r(3538),xx=r.n(gx),bx=r(9853),yx=r.n(bx),vx=r(8210),_x=r.n(vx);function kx(e){return function(e){if(Array.isArray(e))return jx(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return jx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jx(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wx=function(e){return e},Nx={"@@functional/placeholder":!0},Sx=function(e){return e===Nx},Ox=function(e){return function t(){return 0===arguments.length||1===arguments.length&&Sx(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},Cx=function e(t,r){return 1===t?r:Ox(function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];var i=a.filter(function(e){return e!==Nx}).length;return i>=t?r.apply(void 0,a):e(t-i,Ox(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=a.map(function(e){return Sx(e)?t.shift():e});return r.apply(void 0,kx(s).concat(t))}))})},Ex=function(e){return Cx(e.length,e)},Px=function(e,t){for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Ax=Ex(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(e){return t[e]}).map(e)}),Tx=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!t.length)return wx;var n=t.reverse(),a=n[0],s=n.slice(1);return function(){return s.reduce(function(e,t){return t(e)},a.apply(void 0,arguments))}},Mx=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},Rx=function(e){var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return t&&a.every(function(e,r){return e===t[r]})?r:(t=a,r=e.apply(void 0,a))}};var Dx=Ex(function(e,t,r){var n=+e;return n+r*(+t-n)}),Ix=Ex(function(e,t,r){var n=t-+e;return(r-e)/(n=n||1/0)}),Lx=Ex(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Fx={rangeStep:function(e,t,r){for(var n=new(_x())(e),a=0,s=[];n.lt(t)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s},getDigitCount:function(e){return 0===e?1:Math.floor(new(_x())(e).abs().log(10).toNumber())+1},interpolateNumber:Dx,uninterpolateNumber:Ix,uninterpolateTruncation:Lx};function Bx(e){return function(e){if(Array.isArray(e))return Vx(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||zx(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ux(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(l){a=!0,s=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}return r}(e,t)||zx(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zx(e,t){if(e){if("string"===typeof e)return Vx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vx(e,t):void 0}}function Vx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hx(e){var t=Ux(e,2),r=t[0],n=t[1],a=r,s=n;return r>n&&(a=n,s=r),[a,s]}function Wx(e,t,r){if(e.lte(0))return new(_x())(0);var n=Fx.getDigitCount(e.toNumber()),a=new(_x())(10).pow(n),s=e.div(a),i=1!==n?.05:.1,o=new(_x())(Math.ceil(s.div(i).toNumber())).add(r).mul(i).mul(a);return t?o:new(_x())(Math.ceil(o))}function qx(e,t,r){var n=1,a=new(_x())(e);if(!a.isint()&&r){var s=Math.abs(e);s<1?(n=new(_x())(10).pow(Fx.getDigitCount(e)-1),a=new(_x())(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new(_x())(Math.floor(e)))}else 0===e?a=new(_x())(Math.floor((t-1)/2)):r||(a=new(_x())(Math.floor(e)));var i=Math.floor((t-1)/2);return Tx(Ax(function(e){return a.add(new(_x())(e-i).mul(n)).toNumber()}),Px)(0,t)}function Gx(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new(_x())(0),tickMin:new(_x())(0),tickMax:new(_x())(0)};var s,i=Wx(new(_x())(t).sub(e).div(r-1),n,a);s=e<=0&&t>=0?new(_x())(0):(s=new(_x())(e).add(t).div(2)).sub(new(_x())(s).mod(i));var o=Math.ceil(s.sub(e).div(i).toNumber()),l=Math.ceil(new(_x())(t).sub(s).div(i).toNumber()),c=o+l+1;return c>r?Gx(e,t,r,n,a+1):(c<r&&(l=t>0?l+(r-c):l,o=t>0?o:o+(r-c)),{step:i,tickMin:s.sub(new(_x())(o).mul(i)),tickMax:s.add(new(_x())(l).mul(i))})}var $x=Rx(function(e){var t=Ux(e,2),r=t[0],n=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Math.max(a,2),o=Ux(Hx([r,n]),2),l=o[0],c=o[1];if(l===-1/0||c===1/0){var d=c===1/0?[l].concat(Bx(Px(0,a-1).map(function(){return 1/0}))):[].concat(Bx(Px(0,a-1).map(function(){return-1/0})),[c]);return r>n?Mx(d):d}if(l===c)return qx(l,a,s);var u=Gx(l,c,i,s),h=u.step,p=u.tickMin,m=u.tickMax,f=Fx.rangeStep(p,m.add(new(_x())(.1).mul(h)),h);return r>n?Mx(f):f}),Kx=(Rx(function(e){var t=Ux(e,2),r=t[0],n=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Math.max(a,2),o=Ux(Hx([r,n]),2),l=o[0],c=o[1];if(l===-1/0||c===1/0)return[r,n];if(l===c)return qx(l,a,s);var d=Wx(new(_x())(c).sub(l).div(i-1),s,0),u=Tx(Ax(function(e){return new(_x())(l).add(new(_x())(e).mul(d)).toNumber()}),Px)(0,i).filter(function(e){return e>=l&&e<=c});return r>n?Mx(u):u}),Rx(function(e,t){var r=Ux(e,2),n=r[0],a=r[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Ux(Hx([n,a]),2),o=i[0],l=i[1];if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(t,2),d=Wx(new(_x())(l).sub(o).div(c-1),s,0),u=[].concat(Bx(Fx.rangeStep(new(_x())(o),new(_x())(l).sub(new(_x())(.99).mul(d)),d)),[l]);return n>a?Mx(u):u})),Yx=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Xx(e){return Xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xx(e)}function Jx(){return Jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jx.apply(this,arguments)}function Qx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Zx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zx(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eb(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ob(n.key),n)}}function rb(e,t,r){return t=ab(t),function(e,t){if(t&&("object"===Xx(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,nb()?Reflect.construct(t,r||[],ab(e).constructor):t.apply(e,r))}function nb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(nb=function(){return!!e})()}function ab(e){return ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ab(e)}function sb(e,t){return sb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sb(e,t)}function ib(e,t,r){return(t=ob(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ob(e){var t=function(e,t){if("object"!=Xx(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xx(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xx(t)?t:t+""}var lb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rb(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sb(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this.props,t=e.offset,r=e.layout,n=e.width,a=e.dataKey,i=e.data,o=e.dataPointFormatter,l=e.xAxis,c=e.yAxis,d=eb(e,Yx),u=Fi(d,!1);"x"===this.props.direction&&"number"!==l.type&&eo(!1);var h=i.map(function(e){var i=o(e,a),d=i.x,h=i.y,p=i.value,m=i.errorVal;if(!m)return null;var f,g,x=[];if(Array.isArray(m)){var b=Qx(m,2);f=b[0],g=b[1]}else f=g=m;if("vertical"===r){var y=l.scale,v=h+t,_=v+n,k=v-n,j=y(p-f),w=y(p+g);x.push({x1:w,y1:_,x2:w,y2:k}),x.push({x1:j,y1:v,x2:w,y2:v}),x.push({x1:j,y1:_,x2:j,y2:k})}else if("horizontal"===r){var N=c.scale,S=d+t,O=S-n,C=S+n,E=N(p-f),P=N(p+g);x.push({x1:O,y1:P,x2:C,y2:P}),x.push({x1:S,y1:E,x2:S,y2:P}),x.push({x1:O,y1:E,x2:C,y2:E})}return s.createElement(lo,Jx({className:"recharts-errorBar",key:"bar-".concat(x.map(function(e){return"".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)}))},u),x.map(function(e){return s.createElement("line",Jx({},e,{key:"line-".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)}))}))});return s.createElement(lo,{className:"recharts-errorBars"},h)}}],n&&tb(r.prototype,n),a&&tb(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);function cb(e){return cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cb(e)}function db(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ub(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?db(Object(r),!0).forEach(function(t){hb(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):db(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function hb(e,t,r){return t=function(e){var t=function(e,t){if("object"!=cb(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=cb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cb(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ib(lb,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),ib(lb,"displayName","ErrorBar");var pb=function(e){var t=e.children,r=e.formattedGraphicalItems,n=e.legendWidth,a=e.legendContent,s=Ri(t,Sc);if(!s)return null;var i,o=Sc.defaultProps,l=void 0!==o?ub(ub({},o),s.props):{};return i=s.props&&s.props.payload?s.props&&s.props.payload:"children"===a?(r||[]).reduce(function(e,t){var r=t.item,n=t.props,a=n.sectors||n.data||[];return e.concat(a.map(function(e){return{type:s.props.iconType||r.props.legendType,value:e.name,color:e.fill,payload:e}}))},[]):(r||[]).map(function(e){var t=e.item,r=t.type.defaultProps,n=void 0!==r?ub(ub({},r),t.props):{},a=n.dataKey,s=n.name,i=n.legendType;return{inactive:n.hide,dataKey:a,type:l.iconType||i||"square",color:kb(t),value:s||a,payload:n}}),ub(ub(ub({},l),Sc.getWithHeight(s,n)),{},{payload:i,item:s})};function mb(e){return mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mb(e)}function fb(e){return function(e){if(Array.isArray(e))return gb(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return gb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gb(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gb(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function bb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xb(Object(r),!0).forEach(function(t){yb(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xb(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function yb(e,t,r){return t=function(e){var t=function(e,t){if("object"!=mb(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mb(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vb(e,t,r){return di()(e)||di()(t)?r:ei(t)?Ks()(e,t,r):hi()(t)?t(e):r}function _b(e,t,r,n){var a=xx()(e,function(e){return vb(e,t)});if("number"===r){var s=a.filter(function(e){return Zs(e)||parseFloat(e)});return s.length?[fx()(s),px()(s)]:[1/0,-1/0]}return(n?a.filter(function(e){return!di()(e)}):a).map(function(e){return ei(e)||e instanceof Date?e:""})}var kb=function(e){var t,r,n=e.type.displayName,a=null!==(t=e.type)&&void 0!==t&&t.defaultProps?bb(bb({},e.type.defaultProps),e.props):e.props,s=a.stroke,i=a.fill;switch(n){case"Line":r=s;break;case"Area":case"Radar":r=s&&"none"!==s?s:i;break;default:r=i}return r},jb=function(e,t,r,n,a){var s=Mi(t.props.children,lb).filter(function(e){return function(e,t,r){return!!di()(t)||("horizontal"===e?"yAxis"===t:"vertical"===e||"x"===r?"xAxis"===t:"y"!==r||"yAxis"===t)}(n,a,e.props.direction)});if(s&&s.length){var i=s.map(function(e){return e.props.dataKey});return e.reduce(function(e,t){var n=vb(t,r);if(di()(n))return e;var a=Array.isArray(n)?[fx()(n),px()(n)]:[n,n],s=i.reduce(function(e,r){var n=vb(t,r,0),s=a[0]-Math.abs(Array.isArray(n)?n[0]:n),i=a[1]+Math.abs(Array.isArray(n)?n[1]:n);return[Math.min(s,e[0]),Math.max(i,e[1])]},[1/0,-1/0]);return[Math.min(s[0],e[0]),Math.max(s[1],e[1])]},[1/0,-1/0])}return null},wb=function(e,t,r,n,a){var s=t.map(function(t){var s=t.props.dataKey;return"number"===r&&s&&jb(e,t,s,n)||_b(e,s,r,a)});if("number"===r)return s.reduce(function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},[1/0,-1/0]);var i={};return s.reduce(function(e,t){for(var r=0,n=t.length;r<n;r++)i[t[r]]||(i[t[r]]=!0,e.push(t[r]));return e},[])},Nb=function(e,t){return"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t},Sb=function(e,t,r,n){if(n)return e.map(function(e){return e.coordinate});var a,s,i=e.map(function(e){return e.coordinate===t&&(a=!0),e.coordinate===r&&(s=!0),e.coordinate});return a||i.push(t),s||i.push(r),i},Ob=function(e,t,r){if(!e)return null;var n=e.scale,a=e.duplicateDomain,s=e.type,i=e.range,o="scaleBand"===e.realScaleType?n.bandwidth()/2:2,l=(t||r)&&"category"===s&&n.bandwidth?n.bandwidth()/o:0;return l="angleAxis"===e.axisType&&(null===i||void 0===i?void 0:i.length)>=2?2*Js(i[0]-i[1])*l:l,t&&(e.ticks||e.niceTicks)?(e.ticks||e.niceTicks).map(function(e){var t=a?a.indexOf(e):e;return{coordinate:n(t)+l,value:e,offset:l}}).filter(function(e){return!Gs()(e.coordinate)}):e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(e,t){return{coordinate:n(e)+l,value:e,index:t,offset:l}}):n.ticks&&!r?n.ticks(e.tickCount).map(function(e){return{coordinate:n(e)+l,value:e,offset:l}}):n.domain().map(function(e,t){return{coordinate:n(e)+l,value:a?a[e]:e,index:t,offset:l}})},Cb=new WeakMap,Eb=function(e,t){if("function"!==typeof t)return e;Cb.has(e)||Cb.set(e,new WeakMap);var r=Cb.get(e);if(r.has(t))return r.get(t);var n=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return r.set(t,n),n},Pb=1e-4,Ab={sign:function(e){var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,s=0,i=0;i<t;++i){var o=Gs()(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1]):(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1])}},expand:function(e,t){if((n=e.length)>0){for(var r,n,a,s=0,i=e[0].length;s<i;++s){for(a=r=0;r<n;++r)a+=e[r][s][1]||0;if(a)for(r=0;r<n;++r)e[r][s][1]/=a}ox(e,t)}},none:ox,silhouette:function(e,t){if((r=e.length)>0){for(var r,n=0,a=e[t[0]],s=a.length;n<s;++n){for(var i=0,o=0;i<r;++i)o+=e[i][n][1]||0;a[n][1]+=a[n][0]=-o/2}ox(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(n=(r=e[t[0]]).length)>0){for(var r,n,a,s=0,i=1;i<n;++i){for(var o=0,l=0,c=0;o<a;++o){for(var d=e[t[o]],u=d[i][1]||0,h=(u-(d[i-1][1]||0))/2,p=0;p<o;++p){var m=e[t[p]];h+=(m[i][1]||0)-(m[i-1][1]||0)}l+=u,c+=h*u}r[i-1][1]+=r[i-1][0]=s,l&&(s-=c/l)}r[i-1][1]+=r[i-1][0]=s,ox(e,t)}},positive:function(e){var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,s=0;s<t;++s){var i=Gs()(e[s][r][1])?e[s][r][0]:e[s][r][1];i>=0?(e[s][r][0]=a,e[s][r][1]=a+i,a=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}}},Tb=function(e,t,r){var n=t.map(function(e){return e.props.dataKey}),a=Ab[r],s=function(){var e=kl([]),t=cx,r=ox,n=dx;function a(a){var s,i,o=Array.from(e.apply(this,arguments),ux),l=o.length,c=-1;for(const e of a)for(s=0,++c;s<l;++s)(o[s][c]=[0,+n(e,o[s].key,c,a)]).data=e;for(s=0,i=lx(t(o));s<l;++s)o[i[s]].index=s;return r(o,i),o}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:kl(Array.from(t)),a):e},a.value=function(e){return arguments.length?(n="function"===typeof e?e:kl(+e),a):n},a.order=function(e){return arguments.length?(t=null==e?cx:"function"===typeof e?e:kl(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(r=null==e?ox:e,a):r},a}().keys(n).value(function(e,t){return+vb(e,t,0)}).order(cx).offset(a);return s(e)};function Mb(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,s=e.index,i=e.dataKey;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!di()(a[t.dataKey])){var o=ii(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var l=vb(a,di()(i)?t.dataKey:i);return di()(l)?null:t.scale(l)}var Rb=function(e){var t=e.axis,r=e.ticks,n=e.offset,a=e.bandSize,s=e.entry,i=e.index;if("category"===t.type)return r[i]?r[i].coordinate+n:null;var o=vb(s,t.dataKey,t.domain[i]);return di()(o)?null:t.scale(o)-a/2+n},Db=function(e,t,r){return Object.keys(e).reduce(function(n,a){var s=e[a].stackedData.reduce(function(e,n){var a=function(e){return e.reduce(function(e,t){return[fx()(t.concat([e[0]]).filter(Zs)),px()(t.concat([e[1]]).filter(Zs))]},[1/0,-1/0])}(n.slice(t,r+1));return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(s[0],n[0]),Math.max(s[1],n[1])]},[1/0,-1/0]).map(function(e){return e===1/0||e===-1/0?0:e})},Ib=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Lb=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Fb=function(e,t,r){if(hi()(e))return e(t,r);if(!Array.isArray(e))return t;var n=[];if(Zs(e[0]))n[0]=r?e[0]:Math.min(e[0],t[0]);else if(Ib.test(e[0])){var a=+Ib.exec(e[0])[1];n[0]=t[0]-a}else hi()(e[0])?n[0]=e[0](t[0]):n[0]=t[0];if(Zs(e[1]))n[1]=r?e[1]:Math.max(e[1],t[1]);else if(Lb.test(e[1])){var s=+Lb.exec(e[1])[1];n[1]=t[1]+s}else hi()(e[1])?n[1]=e[1](t[1]):n[1]=t[1];return n},Bb=function(e,t,r){if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Qi()(t,function(e){return e.coordinate}),s=1/0,i=1,o=a.length;i<o;i++){var l=a[i],c=a[i-1];s=Math.min((l.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0},Ub=function(e,t,r){return e&&e.length?yx()(e,Ks()(r,"type.defaultProps.domain"))?t:e:t},zb=function(e,t){var r=e.type.defaultProps?bb(bb({},e.type.defaultProps),e.props):e.props,n=r.dataKey,a=r.name,s=r.unit,i=r.formatter,o=r.tooltipType,l=r.chartType,c=r.hide;return bb(bb({},Fi(e,!1)),{},{dataKey:n,unit:s,formatter:i,name:a||n,color:kb(e),value:vb(t,n),type:o,payload:t,chartType:l,hide:c})};function Vb(e){return Vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vb(e)}function Hb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Wb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hb(Object(r),!0).forEach(function(t){qb(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hb(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function qb(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Vb(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Vb(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Vb(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Gb=["Webkit","Moz","O","ms"];function $b(e){return $b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$b(e)}function Kb(){return Kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kb.apply(this,arguments)}function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Xb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(t){ry(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Jb(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ny(n.key),n)}}function Qb(e,t,r){return t=ey(t),function(e,t){if(t&&("object"===$b(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Zb()?Reflect.construct(t,r||[],ey(e).constructor):t.apply(e,r))}function Zb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Zb=function(){return!!e})()}function ey(e){return ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ey(e)}function ty(e,t){return ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ty(e,t)}function ry(e,t,r){return(t=ny(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ny(e){var t=function(e,t){if("object"!=$b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$b(t)?t:t+""}var ay=function(e){return e.changedTouches&&!!e.changedTouches.length},sy=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ry(r=Qb(this,t,[e]),"handleDrag",function(e){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(e):r.state.isSlideMoving&&r.handleSlideDrag(e)}),ry(r,"handleTouchMove",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&r.handleDrag(e.changedTouches[0])}),ry(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var e=r.props,t=e.endIndex,n=e.onDragEnd,a=e.startIndex;null===n||void 0===n||n({endIndex:t,startIndex:a})}),r.detachDragEndListener()}),ry(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),ry(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),ry(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),ry(r,"handleSlideDragStart",function(e){var t=ay(e)?e.changedTouches[0]:e;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:t.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ty(e,t)}(t,e),r=t,n=[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(e){var r=e.startX,n=e.endX,a=this.state.scaleValues,s=this.props,i=s.gap,o=s.data.length-1,l=Math.min(r,n),c=Math.max(r,n),d=t.getIndexInRange(a,l),u=t.getIndexInRange(a,c);return{startIndex:d-d%i,endIndex:u===o?o:u-u%i}}},{key:"getTextOfTick",value:function(e){var t=this.props,r=t.data,n=t.tickFormatter,a=t.dataKey,s=vb(r[e],a,e);return hi()(n)?n(s,e):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(e){var t=this.state,r=t.slideMoveStartX,n=t.startX,a=t.endX,s=this.props,i=s.x,o=s.width,l=s.travellerWidth,c=s.startIndex,d=s.endIndex,u=s.onChange,h=e.pageX-r;h>0?h=Math.min(h,i+o-l-a,i+o-l-n):h<0&&(h=Math.max(h,i-n,i-a));var p=this.getIndex({startX:n+h,endX:a+h});p.startIndex===c&&p.endIndex===d||!u||u(p),this.setState({startX:n+h,endX:a+h,slideMoveStartX:e.pageX})}},{key:"handleTravellerDragStart",value:function(e,t){var r=ay(t)?t.changedTouches[0]:t;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:r.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(e){var t=this.state,r=t.brushMoveStartX,n=t.movingTravellerId,a=t.endX,s=t.startX,i=this.state[n],o=this.props,l=o.x,c=o.width,d=o.travellerWidth,u=o.onChange,h=o.gap,p=o.data,m={startX:this.state.startX,endX:this.state.endX},f=e.pageX-r;f>0?f=Math.min(f,l+c-d-i):f<0&&(f=Math.max(f,l-i)),m[n]=i+f;var g=this.getIndex(m),x=g.startIndex,b=g.endIndex;this.setState(ry(ry({},n,i+f),"brushMoveStartX",e.pageX),function(){u&&function(){var e=p.length-1;return"startX"===n&&(a>s?x%h===0:b%h===0)||a<s&&b===e||"endX"===n&&(a>s?b%h===0:x%h===0)||a>s&&b===e}()&&u(g)})}},{key:"handleTravellerMoveKeyboard",value:function(e,t){var r=this,n=this.state,a=n.scaleValues,s=n.startX,i=n.endX,o=this.state[t],l=a.indexOf(o);if(-1!==l){var c=l+e;if(!(-1===c||c>=a.length)){var d=a[c];"startX"===t&&d>=i||"endX"===t&&d<=s||this.setState(ry({},t,d),function(){r.props.onChange(r.getIndex({startX:r.state.startX,endX:r.state.endX}))})}}}},{key:"renderBackground",value:function(){var e=this.props,t=e.x,r=e.y,n=e.width,a=e.height,i=e.fill,o=e.stroke;return s.createElement("rect",{stroke:o,fill:i,x:t,y:r,width:n,height:a})}},{key:"renderPanorama",value:function(){var e=this.props,t=e.x,r=e.y,n=e.width,a=e.height,i=e.data,o=e.children,l=e.padding,c=s.Children.only(o);return c?s.cloneElement(c,{x:t,y:r,width:n,height:a,margin:l,compact:!0,data:i}):null}},{key:"renderTravellerLayer",value:function(e,r){var n,a,i=this,o=this.props,l=o.y,c=o.travellerWidth,d=o.height,u=o.traveller,h=o.ariaLabel,p=o.data,m=o.startIndex,f=o.endIndex,g=Math.max(e,this.props.x),x=Xb(Xb({},Fi(this.props,!1)),{},{x:g,y:l,width:c,height:d}),b=h||"Min value: ".concat(null===(n=p[m])||void 0===n?void 0:n.name,", Max value: ").concat(null===(a=p[f])||void 0===a?void 0:a.name);return s.createElement(lo,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":e,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(e){["ArrowLeft","ArrowRight"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),i.handleTravellerMoveKeyboard("ArrowRight"===e.key?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(u,x))}},{key:"renderSlide",value:function(e,t){var r=this.props,n=r.y,a=r.height,i=r.stroke,o=r.travellerWidth,l=Math.min(e,t)+o,c=Math.max(Math.abs(t-e)-o,0);return s.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:i,fillOpacity:.2,x:l,y:n,width:c,height:a})}},{key:"renderText",value:function(){var e=this.props,t=e.startIndex,r=e.endIndex,n=e.y,a=e.height,i=e.travellerWidth,o=e.stroke,l=this.state,c=l.startX,d=l.endX,u={pointerEvents:"none",fill:o};return s.createElement(lo,{className:"recharts-brush-texts"},s.createElement(ch,Kb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(c,d)-5,y:n+a/2},u),this.getTextOfTick(t)),s.createElement(ch,Kb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(c,d)+i+5,y:n+a/2},u),this.getTextOfTick(r)))}},{key:"render",value:function(){var e=this.props,t=e.data,r=e.className,n=e.children,a=e.x,i=e.y,o=e.width,l=e.height,c=e.alwaysShowText,d=this.state,u=d.startX,h=d.endX,p=d.isTextActive,m=d.isSlideMoving,f=d.isTravellerMoving,g=d.isTravellerFocused;if(!t||!t.length||!Zs(a)||!Zs(i)||!Zs(o)||!Zs(l)||o<=0||l<=0)return null;var x=Us("recharts-brush",r),b=1===s.Children.count(n),y=function(e,t){if(!e)return null;var r=e.replace(/(\w)/,function(e){return e.toUpperCase()}),n=Gb.reduce(function(e,n){return Wb(Wb({},e),{},qb({},n+r,t))},{});return n[e]=t,n}("userSelect","none");return s.createElement(lo,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:y},this.renderBackground(),b&&this.renderPanorama(),this.renderSlide(u,h),this.renderTravellerLayer(u,"startX"),this.renderTravellerLayer(h,"endX"),(p||m||f||g||c)&&this.renderText())}}],a=[{key:"renderDefaultTraveller",value:function(e){var t=e.x,r=e.y,n=e.width,a=e.height,i=e.stroke,o=Math.floor(r+a/2)-1;return s.createElement(s.Fragment,null,s.createElement("rect",{x:t,y:r,width:n,height:a,fill:i,stroke:"none"}),s.createElement("line",{x1:t+1,y1:o,x2:t+n-1,y2:o,fill:"none",stroke:"#fff"}),s.createElement("line",{x1:t+1,y1:o+2,x2:t+n-1,y2:o+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(e,r){return s.isValidElement(e)?s.cloneElement(e,r):hi()(e)?e(r):t.renderDefaultTraveller(r)}},{key:"getDerivedStateFromProps",value:function(e,t){var r=e.data,n=e.width,a=e.x,s=e.travellerWidth,i=e.updateId,o=e.startIndex,l=e.endIndex;if(r!==t.prevData||i!==t.prevUpdateId)return Xb({prevData:r,prevTravellerWidth:s,prevUpdateId:i,prevX:a,prevWidth:n},r&&r.length?function(e){var t=e.data,r=e.startIndex,n=e.endIndex,a=e.x,s=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var o=t.length,l=Su().domain(Xi()(0,o)).range([a,a+s-i]),c=l.domain().map(function(e){return l(e)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(r),endX:l(n),scale:l,scaleValues:c}}({data:r,width:n,x:a,travellerWidth:s,startIndex:o,endIndex:l}):{scale:null,scaleValues:null});if(t.scale&&(n!==t.prevWidth||a!==t.prevX||s!==t.prevTravellerWidth)){t.scale.range([a,a+n-s]);var c=t.scale.domain().map(function(e){return t.scale(e)});return{prevData:r,prevTravellerWidth:s,prevUpdateId:i,prevX:a,prevWidth:n,startX:t.scale(e.startIndex),endX:t.scale(e.endIndex),scaleValues:c}}return null}},{key:"getIndexInRange",value:function(e,t){for(var r=0,n=e.length-1;n-r>1;){var a=Math.floor((r+n)/2);e[a]>t?n=a:r=a}return t>=e[n]?n:r}}],n&&Jb(r.prototype,n),a&&Jb(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);function iy(e){return iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iy(e)}function oy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ly(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oy(Object(r),!0).forEach(function(t){cy(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oy(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cy(e,t,r){return t=function(e){var t=function(e,t){if("object"!=iy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=iy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==iy(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ry(sy,"displayName","Brush"),ry(sy,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var dy=Math.PI/180,uy=function(e){return 180*e/Math.PI},hy=function(e,t,r,n){return{x:e+Math.cos(-dy*n)*r,y:t+Math.sin(-dy*n)*r}},py=function(e,t){var r=e.x,n=e.y,a=t.cx,s=t.cy,i=function(e,t){var r=e.x,n=e.y,a=t.x,s=t.y;return Math.sqrt(Math.pow(r-a,2)+Math.pow(n-s,2))}({x:r,y:n},{x:a,y:s});if(i<=0)return{radius:i};var o=(r-a)/i,l=Math.acos(o);return n>s&&(l=2*Math.PI-l),{radius:i,angle:uy(l),angleInRadian:l}},my=function(e,t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),s=Math.floor(n/360);return e+360*Math.min(a,s)},fy=function(e,t){var r=e.x,n=e.y,a=py({x:r,y:n},t),s=a.radius,i=a.angle,o=t.innerRadius,l=t.outerRadius;if(s<o||s>l)return!1;if(0===s)return!0;var c,d=function(e){var t=e.startAngle,r=e.endAngle,n=Math.floor(t/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:t-360*s,endAngle:r-360*s}}(t),u=d.startAngle,h=d.endAngle,p=i;if(u<=h){for(;p>h;)p-=360;for(;p<u;)p+=360;c=p>=u&&p<=h}else{for(;p>u;)p-=360;for(;p<h;)p+=360;c=p>=h&&p<=u}return c?ly(ly({},t),{},{radius:s,angle:my(p,t)}):null};function gy(e){return gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gy(e)}var xy=["offset"];function by(e){return function(e){if(Array.isArray(e))return yy(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return yy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yy(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vy(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ky(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_y(Object(r),!0).forEach(function(t){jy(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function jy(e,t,r){return t=function(e){var t=function(e,t){if("object"!=gy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gy(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wy(){return wy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wy.apply(this,arguments)}var Ny=function(e,t,r){var n,a,i=e.position,o=e.viewBox,l=e.offset,c=e.className,d=o,u=d.cx,h=d.cy,p=d.innerRadius,m=d.outerRadius,f=d.startAngle,g=d.endAngle,x=d.clockWise,b=(p+m)/2,y=function(e,t){return Js(t-e)*Math.min(Math.abs(t-e),360)}(f,g),v=y>=0?1:-1;"insideStart"===i?(n=f+v*l,a=x):"insideEnd"===i?(n=g-v*l,a=!x):"end"===i&&(n=g+v*l,a=x),a=y<=0?a:!a;var _=hy(u,h,b,n),k=hy(u,h,b,n+359*(a?1:-1)),j="M".concat(_.x,",").concat(_.y,"\n    A").concat(b,",").concat(b,",0,1,").concat(a?0:1,",\n    ").concat(k.x,",").concat(k.y),w=di()(e.id)?ri("recharts-radial-line-"):e.id;return s.createElement("text",wy({},r,{dominantBaseline:"central",className:Us("recharts-radial-bar-label",c)}),s.createElement("defs",null,s.createElement("path",{id:w,d:j})),s.createElement("textPath",{xlinkHref:"#".concat(w)},t))};function Sy(e){var t,r=e.offset,n=ky({offset:void 0===r?5:r},vy(e,xy)),a=n.viewBox,i=n.position,o=n.value,l=n.children,c=n.content,d=n.className,u=void 0===d?"":d,h=n.textBreakAll;if(!a||di()(o)&&di()(l)&&!(0,s.isValidElement)(c)&&!hi()(c))return null;if((0,s.isValidElement)(c))return(0,s.cloneElement)(c,n);if(hi()(c)){if(t=(0,s.createElement)(c,n),(0,s.isValidElement)(t))return t}else t=function(e){var t=e.value,r=e.formatter,n=di()(e.children)?t:e.children;return hi()(r)?r(n):n}(n);var p=function(e){return"cx"in e&&Zs(e.cx)}(a),m=Fi(n,!0);if(p&&("insideStart"===i||"insideEnd"===i||"end"===i))return Ny(n,t,m);var f=p?function(e){var t=e.viewBox,r=e.offset,n=e.position,a=t,s=a.cx,i=a.cy,o=a.innerRadius,l=a.outerRadius,c=(a.startAngle+a.endAngle)/2;if("outside"===n){var d=hy(s,i,l+r,c),u=d.x;return{x:u,y:d.y,textAnchor:u>=s?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:s,y:i,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:s,y:i,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:s,y:i,textAnchor:"middle",verticalAnchor:"end"};var h=hy(s,i,(o+l)/2,c);return{x:h.x,y:h.y,textAnchor:"middle",verticalAnchor:"middle"}}(n):function(e){var t=e.viewBox,r=e.parentViewBox,n=e.offset,a=e.position,s=t,i=s.x,o=s.y,l=s.width,c=s.height,d=c>=0?1:-1,u=d*n,h=d>0?"end":"start",p=d>0?"start":"end",m=l>=0?1:-1,f=m*n,g=m>0?"end":"start",x=m>0?"start":"end";if("top"===a)return ky(ky({},{x:i+l/2,y:o-d*n,textAnchor:"middle",verticalAnchor:h}),r?{height:Math.max(o-r.y,0),width:l}:{});if("bottom"===a)return ky(ky({},{x:i+l/2,y:o+c+u,textAnchor:"middle",verticalAnchor:p}),r?{height:Math.max(r.y+r.height-(o+c),0),width:l}:{});if("left"===a){var b={x:i-f,y:o+c/2,textAnchor:g,verticalAnchor:"middle"};return ky(ky({},b),r?{width:Math.max(b.x-r.x,0),height:c}:{})}if("right"===a){var y={x:i+l+f,y:o+c/2,textAnchor:x,verticalAnchor:"middle"};return ky(ky({},y),r?{width:Math.max(r.x+r.width-y.x,0),height:c}:{})}var v=r?{width:l,height:c}:{};return"insideLeft"===a?ky({x:i+f,y:o+c/2,textAnchor:x,verticalAnchor:"middle"},v):"insideRight"===a?ky({x:i+l-f,y:o+c/2,textAnchor:g,verticalAnchor:"middle"},v):"insideTop"===a?ky({x:i+l/2,y:o+u,textAnchor:"middle",verticalAnchor:p},v):"insideBottom"===a?ky({x:i+l/2,y:o+c-u,textAnchor:"middle",verticalAnchor:h},v):"insideTopLeft"===a?ky({x:i+f,y:o+u,textAnchor:x,verticalAnchor:p},v):"insideTopRight"===a?ky({x:i+l-f,y:o+u,textAnchor:g,verticalAnchor:p},v):"insideBottomLeft"===a?ky({x:i+f,y:o+c-u,textAnchor:x,verticalAnchor:h},v):"insideBottomRight"===a?ky({x:i+l-f,y:o+c-u,textAnchor:g,verticalAnchor:h},v):mi()(a)&&(Zs(a.x)||Qs(a.x))&&(Zs(a.y)||Qs(a.y))?ky({x:i+ni(a.x,l),y:o+ni(a.y,c),textAnchor:"end",verticalAnchor:"end"},v):ky({x:i+l/2,y:o+c/2,textAnchor:"middle",verticalAnchor:"middle"},v)}(n);return s.createElement(ch,wy({className:Us("recharts-label",u)},m,f,{breakAll:h}),t)}Sy.displayName="Label";var Oy=function(e){var t=e.cx,r=e.cy,n=e.angle,a=e.startAngle,s=e.endAngle,i=e.r,o=e.radius,l=e.innerRadius,c=e.outerRadius,d=e.x,u=e.y,h=e.top,p=e.left,m=e.width,f=e.height,g=e.clockWise,x=e.labelViewBox;if(x)return x;if(Zs(m)&&Zs(f)){if(Zs(d)&&Zs(u))return{x:d,y:u,width:m,height:f};if(Zs(h)&&Zs(p))return{x:h,y:p,width:m,height:f}}return Zs(d)&&Zs(u)?{x:d,y:u,width:0,height:0}:Zs(t)&&Zs(r)?{cx:t,cy:r,startAngle:a||n||0,endAngle:s||n||0,innerRadius:l||0,outerRadius:c||o||i||0,clockWise:g}:e.viewBox?e.viewBox:{}};Sy.parseViewBox=Oy,Sy.renderCallByParent=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Oy(e),i=Mi(n,Sy).map(function(e,r){return(0,s.cloneElement)(e,{viewBox:t||a,key:"label-".concat(r)})});if(!r)return i;var o=function(e,t){return e?!0===e?s.createElement(Sy,{key:"label-implicit",viewBox:t}):ei(e)?s.createElement(Sy,{key:"label-implicit",viewBox:t,value:e}):(0,s.isValidElement)(e)?e.type===Sy?(0,s.cloneElement)(e,{key:"label-implicit",viewBox:t}):s.createElement(Sy,{key:"label-implicit",content:e,viewBox:t}):hi()(e)?s.createElement(Sy,{key:"label-implicit",content:e,viewBox:t}):mi()(e)?s.createElement(Sy,wy({viewBox:t},e,{key:"label-implicit"})):null:null}(e.label,t||a);return[o].concat(by(i))};var Cy=function(e,t){var r=e.alwaysShow,n=e.ifOverflow;return r&&(n="extendDomain"),n===t},Ey=r(1733),Py=r.n(Ey),Ay=r(7002),Ty=r.n(Ay),My=function(e){return null};My.displayName="Cell";var Ry=r(4065),Dy=r.n(Ry);function Iy(e){return Iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iy(e)}var Ly=["valueAccessor"],Fy=["data","dataKey","clockWise","id","textBreakAll"];function By(e){return function(e){if(Array.isArray(e))return Uy(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Uy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uy(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zy(){return zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zy.apply(this,arguments)}function Vy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Hy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vy(Object(r),!0).forEach(function(t){Wy(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vy(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Wy(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Iy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Iy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Iy(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qy(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Gy=function(e){return Array.isArray(e.value)?Dy()(e.value):e.value};function $y(e){var t=e.valueAccessor,r=void 0===t?Gy:t,n=qy(e,Ly),a=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,d=qy(n,Fy);return a&&a.length?s.createElement(lo,{className:"recharts-label-list"},a.map(function(e,t){var n=di()(i)?r(e,t):vb(e&&e.payload,i),a=di()(l)?{}:{id:"".concat(l,"-").concat(t)};return s.createElement(Sy,zy({},Fi(e,!0),d,a,{parentViewBox:e.parentViewBox,value:n,textBreakAll:c,viewBox:Sy.parseViewBox(di()(o)?e:Hy(Hy({},e),{},{clockWise:o})),key:"label-".concat(t),index:t}))})):null}$y.displayName="LabelList",$y.renderCallByParent=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&r&&!e.label)return null;var n=Mi(e.children,$y).map(function(e,r){return(0,s.cloneElement)(e,{data:t,key:"labelList-".concat(r)})});if(!r)return n;var a=function(e,t){return e?!0===e?s.createElement($y,{key:"labelList-implicit",data:t}):s.isValidElement(e)||hi()(e)?s.createElement($y,{key:"labelList-implicit",data:t,content:e}):mi()(e)?s.createElement($y,zy({data:t},e,{key:"labelList-implicit"})):null:null}(e.label,t);return[a].concat(By(n))};var Ky=r(2322),Yy=r.n(Ky),Xy=r(6361),Jy=r.n(Xy);function Qy(e){return Qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qy(e)}function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zy.apply(this,arguments)}function ev(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return tv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tv(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tv(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function nv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rv(Object(r),!0).forEach(function(t){av(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rv(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function av(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Qy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qy(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var sv=function(e,t,r,n,a){var s,i=r-n;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z")},iv={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ov=function(e){var t=nv(nv({},iv),e),r=(0,s.useRef)(),n=ev((0,s.useState)(-1),2),a=n[0],i=n[1];(0,s.useEffect)(function(){if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&i(e)}catch(t){}},[]);var o=t.x,l=t.y,c=t.upperWidth,d=t.lowerWidth,u=t.height,h=t.className,p=t.animationEasing,m=t.animationDuration,f=t.animationBegin,g=t.isUpdateAnimationActive;if(o!==+o||l!==+l||c!==+c||d!==+d||u!==+u||0===c&&0===d||0===u)return null;var x=Us("recharts-trapezoid",h);return g?s.createElement(nu,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:u,x:o,y:l},to:{upperWidth:c,lowerWidth:d,height:u,x:o,y:l},duration:m,animationEasing:p,isActive:g},function(e){var n=e.upperWidth,i=e.lowerWidth,o=e.height,l=e.x,c=e.y;return s.createElement(nu,{canBegin:a>0,from:"0px ".concat(-1===a?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:f,duration:m,easing:p},s.createElement("path",Zy({},Fi(t,!0),{className:x,d:sv(l,c,n,i,o),ref:r})))}):s.createElement("g",null,s.createElement("path",Zy({},Fi(t,!0),{className:x,d:sv(o,l,c,d,u)})))};function lv(e){return lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(e)}function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cv.apply(this,arguments)}function dv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function uv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dv(Object(r),!0).forEach(function(t){hv(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dv(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function hv(e,t,r){return t=function(e){var t=function(e,t){if("object"!=lv(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lv(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pv=function(e){var t=e.cx,r=e.cy,n=e.radius,a=e.angle,s=e.sign,i=e.isExternal,o=e.cornerRadius,l=e.cornerIsExternal,c=o*(i?1:-1)+n,d=Math.asin(o/c)/dy,u=l?a:a+s*d,h=l?a-s*d:a;return{center:hy(t,r,c,u),circleTangency:hy(t,r,n,u),lineTangency:hy(t,r,c*Math.cos(d*dy),h),theta:d}},mv=function(e){var t=e.cx,r=e.cy,n=e.innerRadius,a=e.outerRadius,s=e.startAngle,i=function(e,t){return Js(t-e)*Math.min(Math.abs(t-e),359.999)}(s,e.endAngle),o=s+i,l=hy(t,r,a,s),c=hy(t,r,a,o),d="M ".concat(l.x,",").concat(l.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(i)>180),",").concat(+(s>o),",\n    ").concat(c.x,",").concat(c.y,"\n  ");if(n>0){var u=hy(t,r,n,s),h=hy(t,r,n,o);d+="L ".concat(h.x,",").concat(h.y,"\n            A ").concat(n,",").concat(n,",0,\n            ").concat(+(Math.abs(i)>180),",").concat(+(s<=o),",\n            ").concat(u.x,",").concat(u.y," Z")}else d+="L ".concat(t,",").concat(r," Z");return d},fv={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gv=function(e){var t=uv(uv({},fv),e),r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,h=t.className;if(i<a||d===u)return null;var p,m=Us("recharts-sector",h),f=i-a,g=ni(o,f,0,!0);return p=g>0&&Math.abs(d-u)<360?function(e){var t=e.cx,r=e.cy,n=e.innerRadius,a=e.outerRadius,s=e.cornerRadius,i=e.forceCornerRadius,o=e.cornerIsExternal,l=e.startAngle,c=e.endAngle,d=Js(c-l),u=pv({cx:t,cy:r,radius:a,angle:l,sign:d,cornerRadius:s,cornerIsExternal:o}),h=u.circleTangency,p=u.lineTangency,m=u.theta,f=pv({cx:t,cy:r,radius:a,angle:c,sign:-d,cornerRadius:s,cornerIsExternal:o}),g=f.circleTangency,x=f.lineTangency,b=f.theta,y=o?Math.abs(l-c):Math.abs(l-c)-m-b;if(y<0)return i?"M ".concat(p.x,",").concat(p.y,"\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*s,",0\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*-s,",0\n      "):mv({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:c});var v="M ".concat(p.x,",").concat(p.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(y>180),",").concat(+(d<0),",").concat(g.x,",").concat(g.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,"\n  ");if(n>0){var _=pv({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),k=_.circleTangency,j=_.lineTangency,w=_.theta,N=pv({cx:t,cy:r,radius:n,angle:c,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),S=N.circleTangency,O=N.lineTangency,C=N.theta,E=o?Math.abs(l-c):Math.abs(l-c)-w-C;if(E<0&&0===s)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+="L".concat(O.x,",").concat(O.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,"\n      A").concat(n,",").concat(n,",0,").concat(+(E>180),",").concat(+(d>0),",").concat(k.x,",").concat(k.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(j.x,",").concat(j.y,"Z")}else v+="L".concat(t,",").concat(r,"Z");return v}({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(g,f/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):mv({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u}),s.createElement("path",cv({},Fi(t,!0),{className:m,d:p,role:"img"}))},xv=["option","shapeType","propTransformer","activeClassName","isActive"];function bv(e){return bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(e)}function yv(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vv(Object(r),!0).forEach(function(t){kv(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vv(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function kv(e,t,r){return t=function(e){var t=function(e,t){if("object"!=bv(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bv(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jv(e,t){return _v(_v({},t),e)}function wv(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return s.createElement(mu,r);case"trapezoid":return s.createElement(ov,r);case"sector":return s.createElement(gv,r);case"symbols":if(function(e){return"symbols"===e}(t))return s.createElement(ec,r);break;default:return null}}function Nv(e){var t,r=e.option,n=e.shapeType,a=e.propTransformer,i=void 0===a?jv:a,o=e.activeClassName,l=void 0===o?"recharts-active-shape":o,c=e.isActive,d=yv(e,xv);if((0,s.isValidElement)(r))t=(0,s.cloneElement)(r,_v(_v({},d),function(e){return(0,s.isValidElement)(e)?e.props:e}(r)));else if(hi()(r))t=r(d);else if(Yy()(r)&&!Jy()(r)){var u=i(r,d);t=s.createElement(wv,{shapeType:n,elementProps:u})}else{var h=d;t=s.createElement(wv,{shapeType:n,elementProps:h})}return c?s.createElement(lo,{className:l},t):t}function Sv(e,t){return null!=t&&"trapezoids"in e.props}function Ov(e,t){return null!=t&&"sectors"in e.props}function Cv(e,t){return null!=t&&"points"in e.props}function Ev(e,t){var r,n,a=e.x===(null===t||void 0===t||null===(r=t.labelViewBox)||void 0===r?void 0:r.x)||e.x===t.x,s=e.y===(null===t||void 0===t||null===(n=t.labelViewBox)||void 0===n?void 0:n.y)||e.y===t.y;return a&&s}function Pv(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function Av(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function Tv(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=function(e,t){var r;return Sv(e,t)?r="trapezoids":Ov(e,t)?r="sectors":Cv(e,t)&&(r="points"),r}(r,t),s=function(e,t){var r,n;return Sv(e,t)?null===(r=t.tooltipPayload)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.payload)||void 0===r?void 0:r.payload:Ov(e,t)?null===(n=t.tooltipPayload)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.payload)||void 0===n?void 0:n.payload:Cv(e,t)?t.payload:{}}(r,t),i=n.filter(function(e,n){var i=yx()(s,e),o=r.props[a].filter(function(e){var n=function(e,t){var r;return Sv(e,t)?r=Ev:Ov(e,t)?r=Pv:Cv(e,t)&&(r=Av),r}(r,t);return n(e,t)}),l=r.props[a].indexOf(o[o.length-1]);return i&&n===l});return n.indexOf(i[i.length-1])}var Mv=["x","y"];function Rv(e){return Rv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rv(e)}function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(this,arguments)}function Iv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Lv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Iv(Object(r),!0).forEach(function(t){Fv(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iv(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Fv(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Rv(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Rv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rv(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bv(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Uv(e,t){var r=e.x,n=e.y,a=Bv(e,Mv),s="".concat(r),i=parseInt(s,10),o="".concat(n),l=parseInt(o,10),c="".concat(t.height||a.height),d=parseInt(c,10),u="".concat(t.width||a.width),h=parseInt(u,10);return Lv(Lv(Lv(Lv(Lv({},t),a),i?{x:i}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function zv(e){return s.createElement(Nv,Dv({shapeType:"rectangle",propTransformer:Uv,activeClassName:"recharts-active-bar"},e))}var Vv,Hv=["value","background"];function Wv(e){return Wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wv(e)}function qv(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(this,arguments)}function $v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Kv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$v(Object(r),!0).forEach(function(t){e_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Yv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t_(n.key),n)}}function Xv(e,t,r){return t=Qv(t),function(e,t){if(t&&("object"===Wv(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jv()?Reflect.construct(t,r||[],Qv(e).constructor):t.apply(e,r))}function Jv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Jv=function(){return!!e})()}function Qv(e){return Qv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qv(e)}function Zv(e,t){return Zv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zv(e,t)}function e_(e,t,r){return(t=t_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t_(e){var t=function(e,t){if("object"!=Wv(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wv(t)?t:t+""}var r_=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e_(e=Xv(this,t,[].concat(n)),"state",{isAnimationFinished:!1}),e_(e,"id",ri("recharts-bar-")),e_(e,"handleAnimationEnd",function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),t&&t()}),e_(e,"handleAnimationStart",function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),t&&t()}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zv(e,t)}(t,e),r=t,n=[{key:"renderRectanglesStatically",value:function(e){var t=this,r=this.props,n=r.shape,a=r.dataKey,i=r.activeIndex,o=r.activeBar,l=Fi(this.props,!1);return e&&e.map(function(e,r){var c=r===i,d=c?o:n,u=Kv(Kv(Kv({},l),e),{},{isActive:c,option:d,index:r,dataKey:a,onAnimationStart:t.handleAnimationStart,onAnimationEnd:t.handleAnimationEnd});return s.createElement(lo,Gv({className:"recharts-bar-rectangle"},ji(t.props,e,r),{key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(r)}),s.createElement(zv,u))})}},{key:"renderRectanglesWithAnimation",value:function(){var e=this,t=this.props,r=t.data,n=t.layout,a=t.isAnimationActive,i=t.animationBegin,o=t.animationDuration,l=t.animationEasing,c=t.animationId,d=this.state.prevData;return s.createElement(nu,{begin:i,duration:o,isActive:a,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(t){var a=t.t,i=r.map(function(e,t){var r=d&&d[t];if(r){var s=si(r.x,e.x),i=si(r.y,e.y),o=si(r.width,e.width),l=si(r.height,e.height);return Kv(Kv({},e),{},{x:s(a),y:i(a),width:o(a),height:l(a)})}if("horizontal"===n){var c=si(0,e.height)(a);return Kv(Kv({},e),{},{y:e.y+e.height-c,height:c})}var u=si(0,e.width)(a);return Kv(Kv({},e),{},{width:u})});return s.createElement(lo,null,e.renderRectanglesStatically(i))})}},{key:"renderRectangles",value:function(){var e=this.props,t=e.data,r=e.isAnimationActive,n=this.state.prevData;return!(r&&t&&t.length)||n&&yx()(n,t)?this.renderRectanglesStatically(t):this.renderRectanglesWithAnimation()}},{key:"renderBackground",value:function(){var e=this,t=this.props,r=t.data,n=t.dataKey,a=t.activeIndex,i=Fi(this.props.background,!1);return r.map(function(t,r){t.value;var o=t.background,l=qv(t,Hv);if(!o)return null;var c=Kv(Kv(Kv(Kv(Kv({},l),{},{fill:"#eee"},o),i),ji(e.props,t,r)),{},{onAnimationStart:e.handleAnimationStart,onAnimationEnd:e.handleAnimationEnd,dataKey:n,index:r,className:"recharts-bar-background-rectangle"});return s.createElement(zv,Gv({key:"background-bar-".concat(r),option:e.props.background,isActive:r===a},c))})}},{key:"renderErrorBar",value:function(e,t){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,n=r.data,a=r.xAxis,i=r.yAxis,o=r.layout,l=Mi(r.children,lb);if(!l)return null;var c="vertical"===o?n[0].height/2:n[0].width/2,d=function(e,t){var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:vb(e,t)}},u={clipPath:e?"url(#clipPath-".concat(t,")"):null};return s.createElement(lo,u,l.map(function(e){return s.cloneElement(e,{key:"error-bar-".concat(t,"-").concat(e.props.dataKey),data:n,xAxis:a,yAxis:i,layout:o,offset:c,dataPointFormatter:d})}))}},{key:"render",value:function(){var e=this.props,t=e.hide,r=e.data,n=e.className,a=e.xAxis,i=e.yAxis,o=e.left,l=e.top,c=e.width,d=e.height,u=e.isAnimationActive,h=e.background,p=e.id;if(t||!r||!r.length)return null;var m=this.state.isAnimationFinished,f=Us("recharts-bar",n),g=a&&a.allowDataOverflow,x=i&&i.allowDataOverflow,b=g||x,y=di()(p)?this.id:p;return s.createElement(lo,{className:f},g||x?s.createElement("defs",null,s.createElement("clipPath",{id:"clipPath-".concat(y)},s.createElement("rect",{x:g?o:o-c/2,y:x?l:l-d/2,width:g?c:2*c,height:x?d:2*d}))):null,s.createElement(lo,{className:"recharts-bar-rectangles",clipPath:b?"url(#clipPath-".concat(y,")"):null},h?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(b,y),(!u||m)&&$y.renderCallByParent(this.props,r))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curData:e.data,prevData:t.curData}:e.data!==t.curData?{curData:e.data}:null}}],n&&Yv(r.prototype,n),a&&Yv(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);function n_(e){return n_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n_(e)}function a_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l_(n.key),n)}}function s_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s_(Object(r),!0).forEach(function(t){o_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o_(e,t,r){return(t=l_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l_(e){var t=function(e,t){if("object"!=n_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=n_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n_(t)?t:t+""}Vv=r_,e_(r_,"displayName","Bar"),e_(r_,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Io.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),e_(r_,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,s=e.xAxis,i=e.yAxis,o=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,d=e.dataStartIndex,u=e.displayedData,h=e.offset,p=function(e,t){if(!e)return null;for(var r=0,n=e.length;r<n;r++)if(e[r].item===t)return e[r].position;return null}(n,r);if(!p)return null;var m=t.layout,f=r.type.defaultProps,g=void 0!==f?Kv(Kv({},f),r.props):r.props,x=g.dataKey,b=g.children,y=g.minPointSize,v="horizontal"===m?i:s,_=c?v.scale.domain():null,k=function(e){var t=e.numericAxis,r=t.scale.domain();if("number"===t.type){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]}({numericAxis:v}),j=Mi(b,My),w=u.map(function(e,t){var n,u,h,f,g,b;c?n=function(e,t){if(!t||2!==t.length||!Zs(t[0])||!Zs(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Zs(e[0])||e[0]<r)&&(a[0]=r),(!Zs(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a}(c[d+t],_):(n=vb(e,x),Array.isArray(n)||(n=[k,n]));var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(r,n){if("number"===typeof e)return e;var a="number"===typeof r;return a?e(r,n):(a||eo(!1),t)}}(y,Vv.defaultProps.minPointSize)(n[1],t);if("horizontal"===m){var w,N=[i.scale(n[0]),i.scale(n[1])],S=N[0],O=N[1];u=Rb({axis:s,ticks:o,bandSize:a,offset:p.offset,entry:e,index:t}),h=null!==(w=null!==O&&void 0!==O?O:S)&&void 0!==w?w:void 0,f=p.size;var C=S-O;if(g=Number.isNaN(C)?0:C,b={x:u,y:i.y,width:f,height:i.height},Math.abs(v)>0&&Math.abs(g)<Math.abs(v)){var E=Js(g||v)*(Math.abs(v)-Math.abs(g));h-=E,g+=E}}else{var P=[s.scale(n[0]),s.scale(n[1])],A=P[0],T=P[1];if(u=A,h=Rb({axis:i,ticks:l,bandSize:a,offset:p.offset,entry:e,index:t}),f=T-A,g=p.size,b={x:s.x,y:h,width:s.width,height:g},Math.abs(v)>0&&Math.abs(f)<Math.abs(v))f+=Js(f||v)*(Math.abs(v)-Math.abs(f))}return Kv(Kv(Kv({},e),{},{x:u,y:h,width:f,height:g,value:c?n:n[1],payload:e,background:b},j&&j[t]&&j[t].props),{},{tooltipPayload:[zb(r,e)],tooltipPosition:{x:u+f/2,y:h+g/2}})});return Kv({data:w,layout:m},h)});var c_=function(e,t){var r=e.x,n=e.y,a=t.x,s=t.y;return{x:Math.min(r,a),y:Math.min(n,s),width:Math.abs(a-r),height:Math.abs(s-n)}},d_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scale=t}return t=e,r=[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.bandAware,n=t.position;if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a;case"end":var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}return this.scale(e)}}},{key:"isInRange",value:function(e){var t=this.range(),r=t[0],n=t[t.length-1];return r<=n?e>=r&&e<=n:e>=n&&e<=r}}],n=[{key:"create",value:function(t){return new e(t)}}],r&&a_(t.prototype,r),n&&a_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();o_(d_,"EPS",1e-4);var u_=function(e){var t=Object.keys(e).reduce(function(t,r){return i_(i_({},t),{},o_({},r,d_.create(e[r])))},{});return i_(i_({},t),{},{apply:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.bandAware,a=r.position;return Py()(e,function(e,r){return t[r].apply(e,{bandAware:n,position:a})})},isInRange:function(e){return Ty()(e,function(e,r){return t[r].isInRange(e)})}})};function h_(){return h_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h_.apply(this,arguments)}function p_(e){return p_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p_(e)}function m_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m_(Object(r),!0).forEach(function(t){__(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k_(n.key),n)}}function x_(e,t,r){return t=y_(t),function(e,t){if(t&&("object"===p_(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,b_()?Reflect.construct(t,r||[],y_(e).constructor):t.apply(e,r))}function b_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b_=function(){return!!e})()}function y_(e){return y_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y_(e)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v_(e,t)}function __(e,t,r){return(t=k_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k_(e){var t=function(e,t){if("object"!=p_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=p_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p_(t)?t:t+""}var j_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),x_(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this.props,r=e.x,n=e.y,a=e.r,i=e.alwaysShow,o=e.clipPathId,l=ei(r),c=ei(n);if(li(void 0===i,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!l||!c)return null;var d=function(e){var t=e.x,r=e.y,n=e.xAxis,a=e.yAxis,s=u_({x:n.scale,y:a.scale}),i=s.apply({x:t,y:r},{bandAware:!0});return Cy(e,"discard")&&!s.isInRange(i)?null:i}(this.props);if(!d)return null;var u=d.x,h=d.y,p=this.props,m=p.shape,f=p.className,g=f_(f_({clipPath:Cy(this.props,"hidden")?"url(#".concat(o,")"):void 0},Fi(this.props,!0)),{},{cx:u,cy:h});return s.createElement(lo,{className:Us("recharts-reference-dot",f)},t.renderDot(m,g),Sy.renderCallByParent(this.props,{x:u-a,y:h-a,width:2*a,height:2*a}))}}],n&&g_(r.prototype,n),a&&g_(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);__(j_,"displayName","ReferenceDot"),__(j_,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),__(j_,"renderDot",function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):hi()(e)?e(t):s.createElement(Cc,h_({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"}))});var w_=r(4597),N_=r.n(w_),S_=r(8990),O_=r.n(S_),C_=r(5797),E_=r.n(C_)()(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")});var P_=(0,s.createContext)(void 0),A_=(0,s.createContext)(void 0),T_=(0,s.createContext)(void 0),M_=(0,s.createContext)({}),R_=(0,s.createContext)(void 0),D_=(0,s.createContext)(0),I_=(0,s.createContext)(0),L_=function(e){var t=e.state,r=t.xAxisMap,n=t.yAxisMap,a=t.offset,i=e.clipPathId,o=e.children,l=e.width,c=e.height,d=E_(a);return s.createElement(P_.Provider,{value:r},s.createElement(A_.Provider,{value:n},s.createElement(M_.Provider,{value:a},s.createElement(T_.Provider,{value:d},s.createElement(R_.Provider,{value:i},s.createElement(D_.Provider,{value:c},s.createElement(I_.Provider,{value:l},o)))))))};var F_=function(e){var t=(0,s.useContext)(P_);null==t&&eo(!1);var r=t[e];return null==r&&eo(!1),r},B_=function(e){var t=(0,s.useContext)(A_);null==t&&eo(!1);var r=t[e];return null==r&&eo(!1),r},U_=function(){return(0,s.useContext)(I_)},z_=function(){return(0,s.useContext)(D_)};function V_(e){return V_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V_(e)}function H_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J_(n.key),n)}}function W_(e,t,r){return t=G_(t),function(e,t){if(t&&("object"===V_(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,q_()?Reflect.construct(t,r||[],G_(e).constructor):t.apply(e,r))}function q_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(q_=function(){return!!e})()}function G_(e){return G_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G_(e)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$_(e,t)}function K_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Y_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K_(Object(r),!0).forEach(function(t){X_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function X_(e,t,r){return(t=J_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J_(e){var t=function(e,t){if("object"!=V_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=V_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==V_(t)?t:t+""}function Q_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z_(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ek(){return ek=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ek.apply(this,arguments)}function tk(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=(0,s.useContext)(R_),u=F_(a),h=B_(i),p=(0,s.useContext)(T_);if(!d||!p)return null;li(void 0===c,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=function(e,t,r,n,a,s,i,o,l){var c=a.x,d=a.y,u=a.width,h=a.height;if(r){var p=l.y,m=e.y.apply(p,{position:s});if(Cy(l,"discard")&&!e.y.isInRange(m))return null;var f=[{x:c+u,y:m},{x:c,y:m}];return"left"===o?f.reverse():f}if(t){var g=l.x,x=e.x.apply(g,{position:s});if(Cy(l,"discard")&&!e.x.isInRange(x))return null;var b=[{x:x,y:d+h},{x:x,y:d}];return"top"===i?b.reverse():b}if(n){var y=l.segment.map(function(t){return e.apply(t,{position:s})});return Cy(l,"discard")&&N_()(y,function(t){return!e.isInRange(t)})?null:y}return null}(u_({x:u.scale,y:h.scale}),ei(t),ei(r),n&&2===n.length,p,e.position,u.orientation,h.orientation,e);if(!m)return null;var f=Q_(m,2),g=f[0],x=g.x,b=g.y,y=f[1],v=y.x,_=y.y,k=Y_(Y_({clipPath:Cy(e,"hidden")?"url(#".concat(d,")"):void 0},Fi(e,!0)),{},{x1:x,y1:b,x2:v,y2:_});return s.createElement(lo,{className:Us("recharts-reference-line",l)},function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):hi()(e)?e(t):s.createElement("line",ek({},t,{className:"recharts-reference-line-line"}))}(o,k),Sy.renderCallByParent(e,function(e){var t=e.x1,r=e.y1,n=e.x2,a=e.y2;return c_({x:t,y:r},{x:n,y:a})}({x1:x,y1:b,x2:v,y2:_})))}var rk=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),W_(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return s.createElement(tk,this.props)}}])&&H_(r.prototype,n),a&&H_(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);function nk(){return nk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nk.apply(this,arguments)}function ak(e){return ak="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ak(e)}function sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ik(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sk(Object(r),!0).forEach(function(t){hk(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sk(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ok(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pk(n.key),n)}}function lk(e,t,r){return t=dk(t),function(e,t){if(t&&("object"===ak(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ck()?Reflect.construct(t,r||[],dk(e).constructor):t.apply(e,r))}function ck(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ck=function(){return!!e})()}function dk(e){return dk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dk(e)}function uk(e,t){return uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uk(e,t)}function hk(e,t,r){return(t=pk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pk(e){var t=function(e,t){if("object"!=ak(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ak(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ak(t)?t:t+""}X_(rk,"displayName","ReferenceLine"),X_(rk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});var mk=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lk(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uk(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e=this.props,r=e.x1,n=e.x2,a=e.y1,i=e.y2,o=e.className,l=e.alwaysShow,c=e.clipPathId;li(void 0===l,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=ei(r),u=ei(n),h=ei(a),p=ei(i),m=this.props.shape;if(!d&&!u&&!h&&!p&&!m)return null;var f=function(e,t,r,n,a){var s=a.x1,i=a.x2,o=a.y1,l=a.y2,c=a.xAxis,d=a.yAxis;if(!c||!d)return null;var u=u_({x:c.scale,y:d.scale}),h={x:e?u.x.apply(s,{position:"start"}):u.x.rangeMin,y:r?u.y.apply(o,{position:"start"}):u.y.rangeMin},p={x:t?u.x.apply(i,{position:"end"}):u.x.rangeMax,y:n?u.y.apply(l,{position:"end"}):u.y.rangeMax};return!Cy(a,"discard")||u.isInRange(h)&&u.isInRange(p)?c_(h,p):null}(d,u,h,p,this.props);if(!f&&!m)return null;var g=Cy(this.props,"hidden")?"url(#".concat(c,")"):void 0;return s.createElement(lo,{className:Us("recharts-reference-area",o)},t.renderRect(m,ik(ik({clipPath:g},Fi(this.props,!0)),f)),Sy.renderCallByParent(this.props,f))}}],n&&ok(r.prototype,n),a&&ok(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);function fk(e){return function(e){if(Array.isArray(e))return gk(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return gk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gk(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gk(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}hk(mk,"displayName","ReferenceArea"),hk(mk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),hk(mk,"renderRect",function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):hi()(e)?e(t):s.createElement(mu,nk({},t,{className:"recharts-reference-area-rect"}))});var xk=function(e,t,r,n,a){var s=Mi(e,rk),i=Mi(e,j_),o=[].concat(fk(s),fk(i)),l=Mi(e,mk),c="".concat(n,"Id"),d=n[0],u=t;if(o.length&&(u=o.reduce(function(e,t){if(t.props[c]===r&&Cy(t.props,"extendDomain")&&Zs(t.props[d])){var n=t.props[d];return[Math.min(e[0],n),Math.max(e[1],n)]}return e},u)),l.length){var h="".concat(d,"1"),p="".concat(d,"2");u=l.reduce(function(e,t){if(t.props[c]===r&&Cy(t.props,"extendDomain")&&Zs(t.props[h])&&Zs(t.props[p])){var n=t.props[h],a=t.props[p];return[Math.min(e[0],n,a),Math.max(e[1],n,a)]}return e},u)}return a&&a.length&&(u=a.reduce(function(e,t){return Zs(t)?[Math.min(e[0],t),Math.max(e[1],t)]:e},u)),u},bk=r(7283),yk=new(r.n(bk)()),vk="recharts.syncMouseEvents";function _k(e){return _k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_k(e)}function kk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wk(n.key),n)}}function jk(e,t,r){return(t=wk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wk(e){var t=function(e,t){if("object"!=_k(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_k(t)?t:t+""}var Nk=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),jk(this,"activeIndex",0),jk(this,"coordinateList",[]),jk(this,"layout","horizontal")},t=[{key:"setDetails",value:function(e){var t,r=e.coordinateList,n=void 0===r?null:r,a=e.container,s=void 0===a?null:a,i=e.layout,o=void 0===i?null:i,l=e.offset,c=void 0===l?null:l,d=e.mouseHandlerCallback,u=void 0===d?null:d;this.coordinateList=null!==(t=null!==n&&void 0!==n?n:this.coordinateList)&&void 0!==t?t:[],this.container=null!==s&&void 0!==s?s:this.container,this.layout=null!==o&&void 0!==o?o:this.layout,this.offset=null!==c&&void 0!==c?c:this.offset,this.mouseHandlerCallback=null!==u&&void 0!==u?u:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(e){if(0!==this.coordinateList.length)switch(e.key){case"ArrowRight":if("horizontal"!==this.layout)return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break;case"ArrowLeft":if("horizontal"!==this.layout)return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse()}}},{key:"setIndex",value:function(e){this.activeIndex=e}},{key:"spoofMouse",value:function(){var e,t;if("horizontal"===this.layout&&0!==this.coordinateList.length){var r=this.container.getBoundingClientRect(),n=r.x,a=r.y,s=r.height,i=this.coordinateList[this.activeIndex].coordinate,o=(null===(e=window)||void 0===e?void 0:e.scrollX)||0,l=(null===(t=window)||void 0===t?void 0:t.scrollY)||0,c=n+i+o,d=a+this.offset.top+s/2+l;this.mouseHandlerCallback({pageX:c,pageY:d})}}}],t&&kk(e.prototype,t),r&&kk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Sk(){}function Ok(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Ck(e){this._context=e}function Ek(e){this._context=e}function Pk(e){this._context=e}Ck.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ok(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ok(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Ek.prototype={areaStart:Sk,areaEnd:Sk,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ok(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Pk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Ok(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class Ak{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function Tk(e){this._context=e}function Mk(e){this._context=e}function Rk(e){return new Mk(e)}function Dk(e){return e<0?-1:1}function Ik(e,t,r){var n=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(n||a<0&&-0),i=(r-e._y1)/(a||n<0&&-0),o=(s*a+i*n)/(n+a);return(Dk(s)+Dk(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(o))||0}function Lk(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Fk(e,t,r){var n=e._x0,a=e._y0,s=e._x1,i=e._y1,o=(s-n)/3;e._context.bezierCurveTo(n+o,a+o*t,s-o,i-o*r,s,i)}function Bk(e){this._context=e}function Uk(e){this._context=new zk(e)}function zk(e){this._context=e}function Vk(e){this._context=e}function Hk(e){var t,r,n=e.length-1,a=new Array(n),s=new Array(n),i=new Array(n);for(a[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,s[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/s[t-1],s[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/s[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/s[t];for(s[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function Wk(e,t){this._context=e,this._t=t}function qk(e){return e[0]}function Gk(e){return e[1]}function $k(e,t){var r=kl(!0),n=null,a=Rk,s=null,i=Wl(o);function o(o){var l,c,d,u=(o=lx(o)).length,h=!1;for(null==n&&(s=a(d=i())),l=0;l<=u;++l)!(l<u&&r(c=o[l],l,o))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(c,l,o),+t(c,l,o));if(d)return s=null,d+""||null}return e="function"===typeof e?e:void 0===e?qk:kl(e),t="function"===typeof t?t:void 0===t?Gk:kl(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:kl(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:kl(+e),o):t},o.defined=function(e){return arguments.length?(r="function"===typeof e?e:kl(!!e),o):r},o.curve=function(e){return arguments.length?(a=e,null!=n&&(s=a(n)),o):a},o.context=function(e){return arguments.length?(null==e?n=s=null:s=a(n=e),o):n},o}function Kk(e,t,r){var n=null,a=kl(!0),s=null,i=Rk,o=null,l=Wl(c);function c(c){var d,u,h,p,m,f=(c=lx(c)).length,g=!1,x=new Array(f),b=new Array(f);for(null==s&&(o=i(m=l())),d=0;d<=f;++d){if(!(d<f&&a(p=c[d],d,c))===g)if(g=!g)u=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=d-1;h>=u;--h)o.point(x[h],b[h]);o.lineEnd(),o.areaEnd()}g&&(x[d]=+e(p,d,c),b[d]=+t(p,d,c),o.point(n?+n(p,d,c):x[d],r?+r(p,d,c):b[d]))}if(m)return o=null,m+""||null}function d(){return $k().defined(a).curve(i).context(s)}return e="function"===typeof e?e:void 0===e?qk:kl(+e),t="function"===typeof t?t:kl(void 0===t?0:+t),r="function"===typeof r?r:void 0===r?Gk:kl(+r),c.x=function(t){return arguments.length?(e="function"===typeof t?t:kl(+t),n=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:kl(+t),c):e},c.x1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:kl(+e),c):n},c.y=function(e){return arguments.length?(t="function"===typeof e?e:kl(+e),r=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:kl(+e),c):t},c.y1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:kl(+e),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(n).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:kl(!!e),c):a},c.curve=function(e){return arguments.length?(i=e,null!=s&&(o=i(s)),c):i},c.context=function(e){return arguments.length?(null==e?s=o=null:o=i(s=e),c):s},c}function Yk(e){return Yk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yk(e)}function Xk(){return Xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xk.apply(this,arguments)}function Jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Qk(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jk(Object(r),!0).forEach(function(t){Zk(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jk(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Zk(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Yk(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Yk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yk(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Tk.prototype={areaStart:Sk,areaEnd:Sk,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Mk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Bk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Fk(this,this._t0,Lk(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Fk(this,Lk(this,r=Ik(this,e,t)),r);break;default:Fk(this,this._t0,r=Ik(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}},(Uk.prototype=Object.create(Bk.prototype)).point=function(e,t){Bk.prototype.point.call(this,t,e)},zk.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,s){this._context.bezierCurveTo(t,e,n,r,s,a)}},Vk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===r)this._context.lineTo(e[1],t[1]);else for(var n=Hk(e),a=Hk(t),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],e[i],t[i]);(this._line||0!==this._line&&1===r)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Wk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}}this._x=e,this._y=t}};var ej={curveBasisClosed:function(e){return new Ek(e)},curveBasisOpen:function(e){return new Pk(e)},curveBasis:function(e){return new Ck(e)},curveBumpX:function(e){return new Ak(e,!0)},curveBumpY:function(e){return new Ak(e,!1)},curveLinearClosed:function(e){return new Tk(e)},curveLinear:Rk,curveMonotoneX:function(e){return new Bk(e)},curveMonotoneY:function(e){return new Uk(e)},curveNatural:function(e){return new Vk(e)},curveStep:function(e){return new Wk(e,.5)},curveStepAfter:function(e){return new Wk(e,1)},curveStepBefore:function(e){return new Wk(e,0)}},tj=function(e){return e.x===+e.x&&e.y===+e.y},rj=function(e){return e.x},nj=function(e){return e.y},aj=function(e){var t,r=e.type,n=void 0===r?"linear":r,a=e.points,s=void 0===a?[]:a,i=e.baseLine,o=e.layout,l=e.connectNulls,c=void 0!==l&&l,d=function(e,t){if(hi()(e))return e;var r="curve".concat(Zo()(e));return"curveMonotone"!==r&&"curveBump"!==r||!t?ej[r]||Rk:ej["".concat(r).concat("vertical"===t?"Y":"X")]}(n,o),u=c?s.filter(function(e){return tj(e)}):s;if(Array.isArray(i)){var h=c?i.filter(function(e){return tj(e)}):i,p=u.map(function(e,t){return Qk(Qk({},e),{},{base:h[t]})});return(t="vertical"===o?Kk().y(nj).x1(rj).x0(function(e){return e.base.x}):Kk().x(rj).y1(nj).y0(function(e){return e.base.y})).defined(tj).curve(d),t(p)}return(t="vertical"===o&&Zs(i)?Kk().y(nj).x1(rj).x0(i):Zs(i)?Kk().x(rj).y1(nj).y0(i):$k().x(rj).y(nj)).defined(tj).curve(d),t(u)},sj=function(e){var t=e.className,r=e.points,n=e.path,a=e.pathRef;if((!r||!r.length)&&!n)return null;var i=r&&r.length?aj(e):n;return s.createElement("path",Xk({},Fi(e,!1),ki(e),{className:Us("recharts-curve",t),d:i,ref:a}))};function ij(e){return ij="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ij(e)}var oj=["x","y","top","left","width","height","className"];function lj(){return lj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lj.apply(this,arguments)}function cj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function dj(e,t,r){return t=function(e){var t=function(e,t){if("object"!=ij(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ij(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ij(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uj(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var hj=function(e,t,r,n,a,s){return"M".concat(e,",").concat(a,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r)},pj=function(e){var t=e.x,r=void 0===t?0:t,n=e.y,a=void 0===n?0:n,i=e.top,o=void 0===i?0:i,l=e.left,c=void 0===l?0:l,d=e.width,u=void 0===d?0:d,h=e.height,p=void 0===h?0:h,m=e.className,f=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cj(Object(r),!0).forEach(function(t){dj(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cj(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({x:r,y:a,top:o,left:c,width:u,height:p},uj(e,oj));return Zs(r)&&Zs(a)&&Zs(u)&&Zs(p)&&Zs(o)&&Zs(c)?s.createElement("path",lj({},Fi(f,!0),{className:Us("recharts-cross",m),d:hj(r,a,u,p,o,c)})):null};function mj(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,s=e.endAngle;return{points:[hy(t,r,n,a),hy(t,r,n,s)],cx:t,cy:r,radius:n,startAngle:a,endAngle:s}}function fj(e,t,r){var n,a,s,i;if("horizontal"===e)s=n=t.x,a=r.top,i=r.top+r.height;else if("vertical"===e)i=a=t.y,n=r.left,s=r.left+r.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return mj(t);var o=t.cx,l=t.cy,c=t.innerRadius,d=t.outerRadius,u=t.angle,h=hy(o,l,c,u),p=hy(o,l,d,u);n=h.x,a=h.y,s=p.x,i=p.y}return[{x:n,y:a},{x:s,y:i}]}function gj(e){return gj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gj(e)}function xj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function bj(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xj(Object(r),!0).forEach(function(t){yj(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xj(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function yj(e,t,r){return t=function(e){var t=function(e,t){if("object"!=gj(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gj(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gj(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vj(e){var t,r,n,a=e.element,i=e.tooltipEventType,o=e.isActive,l=e.activeCoordinate,c=e.activePayload,d=e.offset,u=e.activeTooltipIndex,h=e.tooltipAxisBandSize,p=e.layout,m=e.chartName,f=null!==(t=a.props.cursor)&&void 0!==t?t:null===(r=a.type.defaultProps)||void 0===r?void 0:r.cursor;if(!a||!f||!o||!l||"ScatterChart"!==m&&"axis"!==i)return null;var g=sj;if("ScatterChart"===m)n=l,g=pj;else if("BarChart"===m)n=function(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:r.left+.5,y:"horizontal"===e?r.top+.5:t.y-a,width:"horizontal"===e?n:r.width-1,height:"horizontal"===e?r.height-1:n}}(p,l,d,h),g=mu;else if("radial"===p){var x=mj(l),b=x.cx,y=x.cy,v=x.radius;n={cx:b,cy:y,startAngle:x.startAngle,endAngle:x.endAngle,innerRadius:v,outerRadius:v},g=gv}else n={points:fj(p,l,d)},g=sj;var _=bj(bj(bj(bj({stroke:"#ccc",pointerEvents:"none"},d),n),Fi(f,!1)),{},{payload:c,payloadIndex:u,className:Us("recharts-tooltip-cursor",f.className)});return(0,s.isValidElement)(f)?(0,s.cloneElement)(f,_):(0,s.createElement)(g,_)}var _j=["item"],kj=["children","className","width","height","style","compact","title","desc"];function jj(e){return jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jj(e)}function wj(){return wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wj.apply(this,arguments)}function Nj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||Mj(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sj(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Oj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fj(n.key),n)}}function Cj(e,t,r){return t=Pj(t),function(e,t){if(t&&("object"===jj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ej()?Reflect.construct(t,r||[],Pj(e).constructor):t.apply(e,r))}function Ej(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ej=function(){return!!e})()}function Pj(e){return Pj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pj(e)}function Aj(e,t){return Aj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Aj(e,t)}function Tj(e){return function(e){if(Array.isArray(e))return Rj(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mj(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mj(e,t){if(e){if("string"===typeof e)return Rj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rj(e,t):void 0}}function Rj(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ij(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dj(Object(r),!0).forEach(function(t){Lj(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dj(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Lj(e,t,r){return(t=Fj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fj(e){var t=function(e,t){if("object"!=jj(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=jj(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jj(t)?t:t+""}var Bj={xAxis:["bottom","top"],yAxis:["left","right"]},Uj={width:"100%",height:"100%"},zj={x:0,y:0};function Vj(e){return e}var Hj=function(e,t){var r=t.graphicalItems,n=t.dataStartIndex,a=t.dataEndIndex,s=(null!==r&&void 0!==r?r:[]).reduce(function(e,t){var r=t.props.data;return r&&r.length?[].concat(Tj(e),Tj(r)):e},[]);return s.length>0?s:e&&e.length&&Zs(n)&&Zs(a)?e.slice(n,a+1):[]};function Wj(e){return"number"===e?[0,"auto"]:void 0}var qj=function(e,t,r,n){var a=e.graphicalItems,s=e.tooltipAxis,i=Hj(t,e);return r<0||!a||!a.length||r>=i.length?null:a.reduce(function(a,o){var l,c,d=null!==(l=o.props.data)&&void 0!==l?l:t;(d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1)),s.dataKey&&!s.allowDuplicatedCategory)?c=ii(void 0===d?i:d,s.dataKey,n):c=d&&d[r]||i[r];return c?[].concat(Tj(a),[zb(o,c)]):a},[])},Gj=function(e,t,r,n){var a=n||{x:e.chartX,y:e.chartY},s=function(e,t){return"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius}(a,r),i=e.orderedTooltipTicks,o=e.tooltipAxis,l=e.tooltipTicks,c=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=-1,i=null!==(t=null===r||void 0===r?void 0:r.length)&&void 0!==t?t:0;if(i<=1)return 0;if(a&&"angleAxis"===a.axisType&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var o=a.range,l=0;l<i;l++){var c=l>0?n[l-1].coordinate:n[i-1].coordinate,d=n[l].coordinate,u=l>=i-1?n[0].coordinate:n[l+1].coordinate,h=void 0;if(Js(d-c)!==Js(u-d)){var p=[];if(Js(u-d)===Js(o[1]-o[0])){h=u;var m=d+o[1]-o[0];p[0]=Math.min(m,(m+c)/2),p[1]=Math.max(m,(m+c)/2)}else{h=c;var f=u+o[1]-o[0];p[0]=Math.min(d,(f+d)/2),p[1]=Math.max(d,(f+d)/2)}var g=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){s=n[l].index;break}}else{var x=Math.min(c,u),b=Math.max(c,u);if(e>(x+d)/2&&e<=(b+d)/2){s=n[l].index;break}}}else for(var y=0;y<i;y++)if(0===y&&e<=(r[y].coordinate+r[y+1].coordinate)/2||y>0&&y<i-1&&e>(r[y].coordinate+r[y-1].coordinate)/2&&e<=(r[y].coordinate+r[y+1].coordinate)/2||y===i-1&&e>(r[y].coordinate+r[y-1].coordinate)/2){s=r[y].index;break}return s}(s,i,l,o);if(c>=0&&l){var d=l[c]&&l[c].value,u=qj(e,t,c,d),h=function(e,t,r,n){var a=t.find(function(e){return e&&e.index===r});if(a){if("horizontal"===e)return{x:a.coordinate,y:n.y};if("vertical"===e)return{x:n.x,y:a.coordinate};if("centric"===e){var s=a.coordinate,i=n.radius;return Ij(Ij(Ij({},n),hy(n.cx,n.cy,i,s)),{},{angle:s,radius:i})}var o=a.coordinate,l=n.angle;return Ij(Ij(Ij({},n),hy(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return zj}(r,i,c,a);return{activeTooltipIndex:c,activeLabel:d,activePayload:u,activeCoordinate:h}}return null},$j=function(e,t){var r=t.axes,n=t.graphicalItems,a=t.axisType,s=t.axisIdKey,i=t.stackGroups,o=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,d=e.children,u=e.stackOffset,h=Nb(c,a);return r.reduce(function(t,r){var p,m=void 0!==r.type.defaultProps?Ij(Ij({},r.type.defaultProps),r.props):r.props,f=m.type,g=m.dataKey,x=m.allowDataOverflow,b=m.allowDuplicatedCategory,y=m.scale,v=m.ticks,_=m.includeHidden,k=m[s];if(t[k])return t;var j,w,N,S=Hj(e.data,{graphicalItems:n.filter(function(e){var t;return(s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s])===k}),dataStartIndex:o,dataEndIndex:l}),O=S.length;(function(e,t,r){if("number"===r&&!0===t&&Array.isArray(e)){var n=null===e||void 0===e?void 0:e[0],a=null===e||void 0===e?void 0:e[1];if(n&&a&&Zs(n)&&Zs(a))return!0}return!1})(m.domain,x,f)&&(j=Fb(m.domain,null,x),!h||"number"!==f&&"auto"===y||(N=_b(S,g,"category")));var C=Wj(f);if(!j||0===j.length){var E,P=null!==(E=m.domain)&&void 0!==E?E:C;if(g){if(j=_b(S,g,f),"category"===f&&h){var A=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++){if(r[e[n]])return!0;r[e[n]]=!0}return!1}(j);b&&A?(w=j,j=Xi()(0,O)):b||(j=Ub(P,j,r).reduce(function(e,t){return e.indexOf(t)>=0?e:[].concat(Tj(e),[t])},[]))}else if("category"===f)j=b?j.filter(function(e){return""!==e&&!di()(e)}):Ub(P,j,r).reduce(function(e,t){return e.indexOf(t)>=0||""===t||di()(t)?e:[].concat(Tj(e),[t])},[]);else if("number"===f){var T=function(e,t,r,n,a){var s=t.map(function(t){return jb(e,t,r,a,n)}).filter(function(e){return!di()(e)});return s&&s.length?s.reduce(function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},[1/0,-1/0]):null}(S,n.filter(function(e){var t,r,n=s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s],a="hide"in e.props?e.props.hide:null===(r=e.type.defaultProps)||void 0===r?void 0:r.hide;return n===k&&(_||!a)}),g,a,c);T&&(j=T)}!h||"number"!==f&&"auto"===y||(N=_b(S,g,"category"))}else j=h?Xi()(0,O):i&&i[k]&&i[k].hasStack&&"number"===f?"expand"===u?[0,1]:Db(i[k].stackGroups,o,l):wb(S,n.filter(function(e){var t=s in e.props?e.props[s]:e.type.defaultProps[s],r="hide"in e.props?e.props.hide:e.type.defaultProps.hide;return t===k&&(_||!r)}),f,c,!0);if("number"===f)j=xk(d,j,k,a,v),P&&(j=Fb(P,j,x));else if("category"===f&&P){var M=P;j.every(function(e){return M.indexOf(e)>=0})&&(j=M)}}return Ij(Ij({},t),{},Lj({},k,Ij(Ij({},m),{},{axisType:a,domain:j,categoricalDomain:N,duplicateDomain:w,originalDomain:null!==(p=m.domain)&&void 0!==p?p:C,isCategorical:h,layout:c})))},{})},Kj=function(e,t){var r=t.axisType,n=void 0===r?"xAxis":r,a=t.AxisComp,s=t.graphicalItems,i=t.stackGroups,o=t.dataStartIndex,l=t.dataEndIndex,c=e.children,d="".concat(n,"Id"),u=Mi(c,a),h={};return u&&u.length?h=$j(e,{axes:u,graphicalItems:s,axisType:n,axisIdKey:d,stackGroups:i,dataStartIndex:o,dataEndIndex:l}):s&&s.length&&(h=function(e,t){var r=t.graphicalItems,n=t.Axis,a=t.axisType,s=t.axisIdKey,i=t.stackGroups,o=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,d=e.children,u=Hj(e.data,{graphicalItems:r,dataStartIndex:o,dataEndIndex:l}),h=u.length,p=Nb(c,a),m=-1;return r.reduce(function(e,t){var f,g=(void 0!==t.type.defaultProps?Ij(Ij({},t.type.defaultProps),t.props):t.props)[s],x=Wj("number");return e[g]?e:(m++,p?f=Xi()(0,h):i&&i[g]&&i[g].hasStack?(f=Db(i[g].stackGroups,o,l),f=xk(d,f,g,a)):(f=Fb(x,wb(u,r.filter(function(e){var t,r,n=s in e.props?e.props[s]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[s],a="hide"in e.props?e.props.hide:null===(r=e.type.defaultProps)||void 0===r?void 0:r.hide;return n===g&&!a}),"number",c),n.defaultProps.allowDataOverflow),f=xk(d,f,g,a)),Ij(Ij({},e),{},Lj({},g,Ij(Ij({axisType:a},n.defaultProps),{},{hide:!0,orientation:Ks()(Bj,"".concat(a,".").concat(m%2),null),domain:f,originalDomain:x,isCategorical:p,layout:c}))))},{})}(e,{Axis:a,graphicalItems:s,axisType:n,axisIdKey:d,stackGroups:i,dataStartIndex:o,dataEndIndex:l})),h},Yj=function(e){var t=e.children,r=e.defaultShowTooltip,n=Ri(t,sy),a=0,s=0;return e.data&&0!==e.data.length&&(s=e.data.length-1),n&&n.props&&(n.props.startIndex>=0&&(a=n.props.startIndex),n.props.endIndex>=0&&(s=n.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:Boolean(r)}},Xj=function(e){return"horizontal"===e?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:"vertical"===e?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:"centric"===e?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Jj=function(e,t){var r=e.props,n=(e.graphicalItems,e.xAxisMap),a=void 0===n?{}:n,s=e.yAxisMap,i=void 0===s?{}:s,o=r.width,l=r.height,c=r.children,d=r.margin||{},u=Ri(c,sy),h=Ri(c,Sc),p=Object.keys(i).reduce(function(e,t){var r=i[t],n=r.orientation;return r.mirror||r.hide?e:Ij(Ij({},e),{},Lj({},n,e[n]+r.width))},{left:d.left||0,right:d.right||0}),m=Object.keys(a).reduce(function(e,t){var r=a[t],n=r.orientation;return r.mirror||r.hide?e:Ij(Ij({},e),{},Lj({},n,Ks()(e,"".concat(n))+r.height))},{top:d.top||0,bottom:d.bottom||0}),f=Ij(Ij({},m),p),g=f.bottom;u&&(f.bottom+=u.props.height||sy.defaultProps.height),h&&t&&(f=function(e,t,r,n){var a=r.children,s=r.width,i=r.margin,o=s-(i.left||0)-(i.right||0),l=pb({children:a,legendWidth:o});if(l){var c=n||{},d=c.width,u=c.height,h=l.align,p=l.verticalAlign,m=l.layout;if(("vertical"===m||"horizontal"===m&&"middle"===p)&&"center"!==h&&Zs(e[h]))return bb(bb({},e),{},yb({},h,e[h]+(d||0)));if(("horizontal"===m||"vertical"===m&&"center"===h)&&"middle"!==p&&Zs(e[p]))return bb(bb({},e),{},yb({},p,e[p]+(u||0)))}return e}(f,0,r,t));var x=o-f.left-f.right,b=l-f.top-f.bottom;return Ij(Ij({brushBottom:g},f),{},{width:Math.max(x,0),height:Math.max(b,0)})},Qj=function(e,t){return"xAxis"===t?e[t].width:"yAxis"===t?e[t].height:void 0},Zj=["type","layout","connectNulls","ref"],ew=["key"];function tw(e){return tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tw(e)}function rw(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nw(){return nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nw.apply(this,arguments)}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function sw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(t){pw(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function iw(e){return function(e){if(Array.isArray(e))return ow(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return ow(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ow(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ow(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mw(n.key),n)}}function cw(e,t,r){return t=uw(t),function(e,t){if(t&&("object"===tw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,dw()?Reflect.construct(t,r||[],uw(e).constructor):t.apply(e,r))}function dw(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(dw=function(){return!!e})()}function uw(e){return uw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uw(e)}function hw(e,t){return hw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hw(e,t)}function pw(e,t,r){return(t=mw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mw(e){var t=function(e,t){if("object"!=tw(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tw(t)?t:t+""}var fw=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return pw(e=cw(this,t,[].concat(n)),"state",{isAnimationFinished:!0,totalLength:0}),pw(e,"generateSimpleStrokeDasharray",function(e,t){return"".concat(t,"px ").concat(e-t,"px")}),pw(e,"getStrokeDasharray",function(r,n,a){var s=a.reduce(function(e,t){return e+t});if(!s)return e.generateSimpleStrokeDasharray(n,r);for(var i=Math.floor(r/s),o=r%s,l=n-r,c=[],d=0,u=0;d<a.length;u+=a[d],++d)if(u+a[d]>o){c=[].concat(iw(a.slice(0,d)),[o-u]);break}var h=c.length%2===0?[0,l]:[l];return[].concat(iw(t.repeat(a,i)),iw(c),h).map(function(e){return"".concat(e,"px")}).join(", ")}),pw(e,"id",ri("recharts-line-")),pw(e,"pathRef",function(t){e.mainCurve=t}),pw(e,"handleAnimationEnd",function(){e.setState({isAnimationFinished:!0}),e.props.onAnimationEnd&&e.props.onAnimationEnd()}),pw(e,"handleAnimationStart",function(){e.setState({isAnimationFinished:!1}),e.props.onAnimationStart&&e.props.onAnimationStart()}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hw(e,t)}(t,e),r=t,n=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}},{key:"renderErrorBar",value:function(e,t){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,n=r.points,a=r.xAxis,i=r.yAxis,o=r.layout,l=Mi(r.children,lb);if(!l)return null;var c=function(e,t){return{x:e.x,y:e.y,value:e.value,errorVal:vb(e.payload,t)}},d={clipPath:e?"url(#clipPath-".concat(t,")"):null};return s.createElement(lo,d,l.map(function(e){return s.cloneElement(e,{key:"bar-".concat(e.props.dataKey),data:n,xAxis:a,yAxis:i,layout:o,dataPointFormatter:c})}))}},{key:"renderDots",value:function(e,r,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,i=a.dot,o=a.points,l=a.dataKey,c=Fi(this.props,!1),d=Fi(i,!0),u=o.map(function(e,r){var n=sw(sw(sw({key:"dot-".concat(r),r:3},c),d),{},{index:r,cx:e.x,cy:e.y,value:e.value,dataKey:l,payload:e.payload,points:o});return t.renderDotItem(i,n)}),h={clipPath:e?"url(#clipPath-".concat(r?"":"dots-").concat(n,")"):null};return s.createElement(lo,nw({className:"recharts-line-dots",key:"dots"},h),u)}},{key:"renderCurveStatically",value:function(e,t,r,n){var a=this.props,i=a.type,o=a.layout,l=a.connectNulls,c=(a.ref,rw(a,Zj)),d=sw(sw(sw({},Fi(c,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:t?"url(#clipPath-".concat(r,")"):null,points:e},n),{},{type:i,layout:o,connectNulls:l});return s.createElement(sj,nw({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,t){var r=this,n=this.props,a=n.points,i=n.strokeDasharray,o=n.isAnimationActive,l=n.animationBegin,c=n.animationDuration,d=n.animationEasing,u=n.animationId,h=n.animateNewValues,p=n.width,m=n.height,f=this.state,g=f.prevPoints,x=f.totalLength;return s.createElement(nu,{begin:l,duration:c,isActive:o,easing:d,from:{t:0},to:{t:1},key:"line-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(n){var s=n.t;if(g){var o=g.length/a.length,l=a.map(function(e,t){var r=Math.floor(t*o);if(g[r]){var n=g[r],a=si(n.x,e.x),i=si(n.y,e.y);return sw(sw({},e),{},{x:a(s),y:i(s)})}if(h){var l=si(2*p,e.x),c=si(m/2,e.y);return sw(sw({},e),{},{x:l(s),y:c(s)})}return sw(sw({},e),{},{x:e.x,y:e.y})});return r.renderCurveStatically(l,e,t)}var c,d=si(0,x)(s);if(i){var u="".concat(i).split(/[,\s]+/gim).map(function(e){return parseFloat(e)});c=r.getStrokeDasharray(d,x,u)}else c=r.generateSimpleStrokeDasharray(x,d);return r.renderCurveStatically(a,e,t,{strokeDasharray:c})})}},{key:"renderCurve",value:function(e,t){var r=this.props,n=r.points,a=r.isAnimationActive,s=this.state,i=s.prevPoints,o=s.totalLength;return a&&n&&n.length&&(!i&&o>0||!yx()(i,n))?this.renderCurveWithAnimation(e,t):this.renderCurveStatically(n,e,t)}},{key:"render",value:function(){var e,t=this.props,r=t.hide,n=t.dot,a=t.points,i=t.className,o=t.xAxis,l=t.yAxis,c=t.top,d=t.left,u=t.width,h=t.height,p=t.isAnimationActive,m=t.id;if(r||!a||!a.length)return null;var f=this.state.isAnimationFinished,g=1===a.length,x=Us("recharts-line",i),b=o&&o.allowDataOverflow,y=l&&l.allowDataOverflow,v=b||y,_=di()(m)?this.id:m,k=null!==(e=Fi(n,!1))&&void 0!==e?e:{r:3,strokeWidth:2},j=k.r,w=void 0===j?3:j,N=k.strokeWidth,S=void 0===N?2:N,O=(function(e){return e&&"object"===Oi(e)&&"clipDot"in e}(n)?n:{}).clipDot,C=void 0===O||O,E=2*w+S;return s.createElement(lo,{className:x},b||y?s.createElement("defs",null,s.createElement("clipPath",{id:"clipPath-".concat(_)},s.createElement("rect",{x:b?d:d-u/2,y:y?c:c-h/2,width:b?u:2*u,height:y?h:2*h})),!C&&s.createElement("clipPath",{id:"clipPath-dots-".concat(_)},s.createElement("rect",{x:d-E/2,y:c-E/2,width:u+E,height:h+E}))):null,!g&&this.renderCurve(v,_),this.renderErrorBar(v,_),(g||n)&&this.renderDots(v,C,_),(!p||f)&&$y.renderCallByParent(this.props,a))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:t.curPoints}:e.points!==t.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,t){for(var r=e.length%2!==0?[].concat(iw(e),[0]):e,n=[],a=0;a<t;++a)n=[].concat(iw(n),iw(r));return n}},{key:"renderDotItem",value:function(e,t){var r;if(s.isValidElement(e))r=s.cloneElement(e,t);else if(hi()(e))r=e(t);else{var n=t.key,a=rw(t,ew),i=Us("recharts-line-dot","boolean"!==typeof e?e.className:"");r=s.createElement(Cc,nw({key:n},a,{className:i}))}return r}}],n&&lw(r.prototype,n),a&&lw(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.PureComponent);function gw(e,t,r){if(t<1)return[];if(1===t&&void 0===r)return e;for(var n=[],a=0;a<e.length;a+=t){if(void 0!==r&&!0!==r(e[a]))return;n.push(e[a])}return n}function xw(e,t,r){return function(e){var t=e.width,r=e.height,n=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=n*Math.PI/180,s=Math.atan(r/t),i=a>s&&a<Math.PI-s?r/Math.sin(a):t/Math.cos(a);return Math.abs(i)}({width:e.width+t.width,height:e.height+t.height},r)}function bw(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-a)<=0}function yw(e){return yw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yw(e)}function vw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vw(Object(r),!0).forEach(function(t){kw(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vw(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function kw(e,t,r){return t=function(e){var t=function(e,t){if("object"!=yw(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=yw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yw(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jw(e,t,r){var n=e.tick,a=e.ticks,s=e.viewBox,i=e.minTickGap,o=e.orientation,l=e.interval,c=e.tickFormatter,d=e.unit,u=e.angle;if(!a||!a.length||!n)return[];if(Zs(l)||Io.isSsr)return function(e,t){return gw(e,t+1)}(a,"number"===typeof l&&Zs(l)?l:0);var h=[],p="top"===o||"bottom"===o?"width":"height",m=d&&"width"===p?Ru(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},f=function(e,n){var a=hi()(c)?c(e.value,n):e.value;return"width"===p?xw(Ru(a,{fontSize:t,letterSpacing:r}),m,u):Ru(a,{fontSize:t,letterSpacing:r})[p]},g=a.length>=2?Js(a[1].coordinate-a[0].coordinate):1,x=function(e,t,r){var n="width"===r,a=e.x,s=e.y,i=e.width,o=e.height;return 1===t?{start:n?a:s,end:n?a+i:s+o}:{start:n?a+i:s+o,end:n?a:s}}(s,g,p);return"equidistantPreserveStart"===l?function(e,t,r,n,a){for(var s,i=(n||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,h=function(){var t=null===n||void 0===n?void 0:n[c];if(void 0===t)return{v:gw(n,d)};var s,i=c,h=function(){return void 0===s&&(s=r(t,i)),s},p=t.coordinate,m=0===c||bw(e,p,h,u,l);m||(c=0,u=o,d+=1),m&&(u=p+e*(h()/2+a),c+=d)};d<=i.length;)if(s=h())return s.v;return[]}(g,x,f,a,i):(h="preserveStart"===l||"preserveStartEnd"===l?function(e,t,r,n,a,s){var i=(n||[]).slice(),o=i.length,l=t.start,c=t.end;if(s){var d=n[o-1],u=r(d,o-1),h=e*(d.coordinate+e*u/2-c);i[o-1]=d=_w(_w({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),bw(e,d.tickCoord,function(){return u},l,c)&&(c=d.tickCoord-e*(u/2+a),i[o-1]=_w(_w({},d),{},{isShow:!0}))}for(var p=s?o-1:o,m=function(t){var n,s=i[t],o=function(){return void 0===n&&(n=r(s,t)),n};if(0===t){var d=e*(s.coordinate-e*o()/2-l);i[t]=s=_w(_w({},s),{},{tickCoord:d<0?s.coordinate-d*e:s.coordinate})}else i[t]=s=_w(_w({},s),{},{tickCoord:s.coordinate});bw(e,s.tickCoord,o,l,c)&&(l=s.tickCoord+e*(o()/2+a),i[t]=_w(_w({},s),{},{isShow:!0}))},f=0;f<p;f++)m(f);return i}(g,x,f,a,i,"preserveStartEnd"===l):function(e,t,r,n,a){for(var s=(n||[]).slice(),i=s.length,o=t.start,l=t.end,c=function(t){var n,c=s[t],d=function(){return void 0===n&&(n=r(c,t)),n};if(t===i-1){var u=e*(c.coordinate+e*d()/2-l);s[t]=c=_w(_w({},c),{},{tickCoord:u>0?c.coordinate-u*e:c.coordinate})}else s[t]=c=_w(_w({},c),{},{tickCoord:c.coordinate});bw(e,c.tickCoord,d,o,l)&&(l=c.tickCoord-e*(d()/2+a),s[t]=_w(_w({},c),{},{isShow:!0}))},d=i-1;d>=0;d--)c(d);return s}(g,x,f,a,i),h.filter(function(e){return e.isShow}))}pw(fw,"displayName","Line"),pw(fw,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Io.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),pw(fw,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,s=e.yAxisTicks,i=e.dataKey,o=e.bandSize,l=e.displayedData,c=e.offset,d=t.layout,u=l.map(function(e,t){var l=vb(e,i);return"horizontal"===d?{x:Mb({axis:r,ticks:a,bandSize:o,entry:e,index:t}),y:di()(l)?null:n.scale(l),value:l,payload:e}:{x:di()(l)?null:r.scale(l),y:Mb({axis:n,ticks:s,bandSize:o,entry:e,index:t}),value:l,payload:e}});return sw({points:u,layout:d},c)});var ww=["viewBox"],Nw=["viewBox"],Sw=["ticks"];function Ow(e){return Ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ow(e)}function Cw(){return Cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cw.apply(this,arguments)}function Ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ew(Object(r),!0).forEach(function(t){Lw(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ew(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Aw(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Tw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fw(n.key),n)}}function Mw(e,t,r){return t=Dw(t),function(e,t){if(t&&("object"===Ow(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Rw()?Reflect.construct(t,r||[],Dw(e).constructor):t.apply(e,r))}function Rw(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Rw=function(){return!!e})()}function Dw(e){return Dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dw(e)}function Iw(e,t){return Iw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Iw(e,t)}function Lw(e,t,r){return(t=Fw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fw(e){var t=function(e,t){if("object"!=Ow(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ow(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ow(t)?t:t+""}var Bw=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Mw(this,t,[e])).state={fontSize:"",letterSpacing:""},r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iw(e,t)}(t,e),r=t,n=[{key:"shouldComponentUpdate",value:function(e,t){var r=e.viewBox,n=Aw(e,ww),a=this.props,s=a.viewBox,i=Aw(a,Nw);return!gi(r,s)||!gi(n,i)||!gi(t,this.state)}},{key:"componentDidMount",value:function(){var e=this.layerReference;if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];t&&this.setState({fontSize:window.getComputedStyle(t).fontSize,letterSpacing:window.getComputedStyle(t).letterSpacing})}}},{key:"getTickLineCoord",value:function(e){var t,r,n,a,s,i,o=this.props,l=o.x,c=o.y,d=o.width,u=o.height,h=o.orientation,p=o.tickSize,m=o.mirror,f=o.tickMargin,g=m?-1:1,x=e.tickSize||p,b=Zs(e.tickCoord)?e.tickCoord:e.coordinate;switch(h){case"top":t=r=e.coordinate,i=(n=(a=c+ +!m*u)-g*x)-g*f,s=b;break;case"left":n=a=e.coordinate,s=(t=(r=l+ +!m*d)-g*x)-g*f,i=b;break;case"right":n=a=e.coordinate,s=(t=(r=l+ +m*d)+g*x)+g*f,i=b;break;default:t=r=e.coordinate,i=(n=(a=c+ +m*u)+g*x)+g*f,s=b}return{line:{x1:t,y1:n,x2:r,y2:a},tick:{x:s,y:i}}}},{key:"getTickTextAnchor",value:function(){var e,t=this.props,r=t.orientation,n=t.mirror;switch(r){case"left":e=n?"start":"end";break;case"right":e=n?"end":"start";break;default:e="middle"}return e}},{key:"getTickVerticalAnchor",value:function(){var e=this.props,t=e.orientation,r=e.mirror,n="end";switch(t){case"left":case"right":n="middle";break;case"top":n=r?"start":"end";break;default:n=r?"end":"start"}return n}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.x,r=e.y,n=e.width,a=e.height,i=e.orientation,o=e.mirror,l=e.axisLine,c=Pw(Pw(Pw({},Fi(this.props,!1)),Fi(l,!1)),{},{fill:"none"});if("top"===i||"bottom"===i){var d=+("top"===i&&!o||"bottom"===i&&o);c=Pw(Pw({},c),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var u=+("left"===i&&!o||"right"===i&&o);c=Pw(Pw({},c),{},{x1:t+u*n,y1:r,x2:t+u*n,y2:r+a})}return s.createElement("line",Cw({},c,{className:Us("recharts-cartesian-axis-line",Ks()(l,"className"))}))}},{key:"renderTicks",value:function(e,r,n){var a=this,i=this.props,o=i.tickLine,l=i.stroke,c=i.tick,d=i.tickFormatter,u=i.unit,h=jw(Pw(Pw({},this.props),{},{ticks:e}),r,n),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),f=Fi(this.props,!1),g=Fi(c,!1),x=Pw(Pw({},f),{},{fill:"none"},Fi(o,!1)),b=h.map(function(e,r){var n=a.getTickLineCoord(e),i=n.line,b=n.tick,y=Pw(Pw(Pw(Pw({textAnchor:p,verticalAnchor:m},f),{},{stroke:"none",fill:l},g),b),{},{index:r,payload:e,visibleTicksCount:h.length,tickFormatter:d});return s.createElement(lo,Cw({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},ji(a.props,e,r)),o&&s.createElement("line",Cw({},x,i,{className:Us("recharts-cartesian-axis-tick-line",Ks()(o,"className"))})),c&&t.renderTickItem(c,y,"".concat(hi()(d)?d(e.value,r):e.value).concat(u||"")))});return s.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var e=this,t=this.props,r=t.axisLine,n=t.width,a=t.height,i=t.ticksGenerator,o=t.className;if(t.hide)return null;var l=this.props,c=l.ticks,d=Aw(l,Sw),u=c;return hi()(i)&&(u=c&&c.length>0?i(this.props):i(d)),n<=0||a<=0||!u||!u.length?null:s.createElement(lo,{className:Us("recharts-cartesian-axis",o),ref:function(t){e.layerReference=t}},r&&this.renderAxisLine(),this.renderTicks(u,this.state.fontSize,this.state.letterSpacing),Sy.renderCallByParent(this.props))}}],a=[{key:"renderTickItem",value:function(e,t,r){return s.isValidElement(e)?s.cloneElement(e,t):hi()(e)?e(t):s.createElement(ch,Cw({},t,{className:"recharts-cartesian-axis-tick-value"}),r)}}],n&&Tw(r.prototype,n),a&&Tw(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);function Uw(e){return Uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uw(e)}function zw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$w(n.key),n)}}function Vw(e,t,r){return t=Ww(t),function(e,t){if(t&&("object"===Uw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Hw()?Reflect.construct(t,r||[],Ww(e).constructor):t.apply(e,r))}function Hw(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Hw=function(){return!!e})()}function Ww(e){return Ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ww(e)}function qw(e,t){return qw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qw(e,t)}function Gw(e,t,r){return(t=$w(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $w(e){var t=function(e,t){if("object"!=Uw(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Uw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Uw(t)?t:t+""}function Kw(){return Kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kw.apply(this,arguments)}function Yw(e){var t=e.xAxisId,r=U_(),n=z_(),a=F_(t);return null==a?null:s.createElement(Bw,Kw({},a,{className:Us("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(e){return Ob(e,!0)}}))}Lw(Bw,"displayName","CartesianAxis"),Lw(Bw,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Xw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Vw(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qw(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return s.createElement(Yw,this.props)}}])&&zw(r.prototype,n),a&&zw(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);function Jw(e){return Jw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jw(e)}function Qw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aN(n.key),n)}}function Zw(e,t,r){return t=tN(t),function(e,t){if(t&&("object"===Jw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,eN()?Reflect.construct(t,r||[],tN(e).constructor):t.apply(e,r))}function eN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eN=function(){return!!e})()}function tN(e){return tN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tN(e)}function rN(e,t){return rN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rN(e,t)}function nN(e,t,r){return(t=aN(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aN(e){var t=function(e,t){if("object"!=Jw(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Jw(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Jw(t)?t:t+""}function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(this,arguments)}Gw(Xw,"displayName","XAxis"),Gw(Xw,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});var iN=function(e){var t=e.yAxisId,r=U_(),n=z_(),a=B_(t);return null==a?null:s.createElement(Bw,sN({},a,{className:Us("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(e){return Ob(e,!0)}}))},oN=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zw(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rN(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return s.createElement(iN,this.props)}}])&&Qw(r.prototype,n),a&&Qw(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(s.Component);nN(oN,"displayName","YAxis"),nN(oN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});var lN=function(e){var t=e.chartName,r=e.GraphicalChild,n=e.defaultTooltipEventType,a=void 0===n?"axis":n,i=e.validateTooltipEventTypes,o=void 0===i?["axis"]:i,l=e.axisComponents,c=e.legendContent,d=e.formatAxisMap,u=e.defaultProps,h=function(e,t){var r=t.graphicalItems,n=t.stackGroups,a=t.offset,s=t.updateId,i=t.dataStartIndex,o=t.dataEndIndex,c=e.barSize,d=e.layout,u=e.barGap,h=e.barCategoryGap,p=e.maxBarSize,m=Xj(d),f=m.numericAxisName,g=m.cateAxisName,x=function(e){return!(!e||!e.length)&&e.some(function(e){var t=Ei(e&&e.type);return t&&t.indexOf("Bar")>=0})}(r),b=[];return r.forEach(function(r,m){var y=Hj(e.data,{graphicalItems:[r],dataStartIndex:i,dataEndIndex:o}),v=void 0!==r.type.defaultProps?Ij(Ij({},r.type.defaultProps),r.props):r.props,_=v.dataKey,k=v.maxBarSize,j=v["".concat(f,"Id")],w=v["".concat(g,"Id")],N=l.reduce(function(e,r){var n=t["".concat(r.axisType,"Map")],a=v["".concat(r.axisType,"Id")];n&&n[a]||"zAxis"===r.axisType||eo(!1);var s=n[a];return Ij(Ij({},e),{},Lj(Lj({},r.axisType,s),"".concat(r.axisType,"Ticks"),Ob(s)))},{}),S=N[g],O=N["".concat(g,"Ticks")],C=n&&n[j]&&n[j].hasStack&&function(e,t){var r,n=(null!==(r=e.type)&&void 0!==r&&r.defaultProps?bb(bb({},e.type.defaultProps),e.props):e.props).stackId;if(ei(n)){var a=t[n];if(a){var s=a.items.indexOf(e);return s>=0?a.stackedData[s]:null}}return null}(r,n[j].stackGroups),E=Ei(r.type).indexOf("Bar")>=0,P=Bb(S,O),A=[],T=x&&function(e){var t=e.barSize,r=e.totalSize,n=e.stackGroups,a=void 0===n?{}:n;if(!a)return{};for(var s={},i=Object.keys(a),o=0,l=i.length;o<l;o++)for(var c=a[i[o]].stackGroups,d=Object.keys(c),u=0,h=d.length;u<h;u++){var p=c[d[u]],m=p.items,f=p.cateAxisId,g=m.filter(function(e){return Ei(e.type).indexOf("Bar")>=0});if(g&&g.length){var x=g[0].type.defaultProps,b=void 0!==x?bb(bb({},x),g[0].props):g[0].props,y=b.barSize,v=b[f];s[v]||(s[v]=[]);var _=di()(y)?t:y;s[v].push({item:g[0],stackList:g.slice(1),barSize:di()(_)?void 0:ni(_,r,0)})}}return s}({barSize:c,stackGroups:n,totalSize:Qj(N,g)});if(E){var M,R,D=di()(k)?p:k,I=null!==(M=null!==(R=Bb(S,O,!0))&&void 0!==R?R:D)&&void 0!==M?M:0;A=function(e){var t=e.barGap,r=e.barCategoryGap,n=e.bandSize,a=e.sizeList,s=void 0===a?[]:a,i=e.maxBarSize,o=s.length;if(o<1)return null;var l,c=ni(t,n,0,!0),d=[];if(s[0].barSize===+s[0].barSize){var u=!1,h=n/o,p=s.reduce(function(e,t){return e+t.barSize||0},0);(p+=(o-1)*c)>=n&&(p-=(o-1)*c,c=0),p>=n&&h>0&&(u=!0,p=o*(h*=.9));var m={offset:((n-p)/2|0)-c,size:0};l=s.reduce(function(e,t){var r={item:t.item,position:{offset:m.offset+m.size+c,size:u?h:t.barSize}},n=[].concat(fb(e),[r]);return m=n[n.length-1].position,t.stackList&&t.stackList.length&&t.stackList.forEach(function(e){n.push({item:e,position:m})}),n},d)}else{var f=ni(r,n,0,!0);n-2*f-(o-1)*c<=0&&(c=0);var g=(n-2*f-(o-1)*c)/o;g>1&&(g>>=0);var x=i===+i?Math.min(g,i):g;l=s.reduce(function(e,t,r){var n=[].concat(fb(e),[{item:t.item,position:{offset:f+(g+c)*r+(g-x)/2,size:x}}]);return t.stackList&&t.stackList.length&&t.stackList.forEach(function(e){n.push({item:e,position:n[n.length-1].position})}),n},d)}return l}({barGap:u,barCategoryGap:h,bandSize:I!==P?I:P,sizeList:T[w],maxBarSize:D}),I!==P&&(A=A.map(function(e){return Ij(Ij({},e),{},{position:Ij(Ij({},e.position),{},{offset:e.position.offset-I/2})})}))}var L,F,B=r&&r.type&&r.type.getComposedData;B&&b.push({props:Ij(Ij({},B(Ij(Ij({},N),{},{displayedData:y,props:e,dataKey:_,item:r,bandSize:P,barPosition:A,offset:a,stackedData:C,layout:d,dataStartIndex:i,dataEndIndex:o}))),{},Lj(Lj(Lj({key:r.key||"item-".concat(m)},f,N[f]),g,N[g]),"animationId",s)),childIndex:(L=r,F=e.children,Ti(F).indexOf(L)),item:r})}),b},p=function(e,n){var a=e.props,s=e.dataStartIndex,i=e.dataEndIndex,o=e.updateId;if(!Di({props:a}))return null;var c=a.children,u=a.layout,p=a.stackOffset,m=a.data,f=a.reverseStackOrder,g=Xj(u),x=g.numericAxisName,b=g.cateAxisName,y=Mi(c,r),v=function(e,t,r,n,a,s){if(!e)return null;var i=(s?t.reverse():t).reduce(function(e,t){var a,s=null!==(a=t.type)&&void 0!==a&&a.defaultProps?bb(bb({},t.type.defaultProps),t.props):t.props,i=s.stackId;if(s.hide)return e;var o=s[r],l=e[o]||{hasStack:!1,stackGroups:{}};if(ei(i)){var c=l.stackGroups[i]||{numericAxisId:r,cateAxisId:n,items:[]};c.items.push(t),l.hasStack=!0,l.stackGroups[i]=c}else l.stackGroups[ri("_stackId_")]={numericAxisId:r,cateAxisId:n,items:[t]};return bb(bb({},e),{},yb({},o,l))},{});return Object.keys(i).reduce(function(t,s){var o=i[s];return o.hasStack&&(o.stackGroups=Object.keys(o.stackGroups).reduce(function(t,s){var i=o.stackGroups[s];return bb(bb({},t),{},yb({},s,{numericAxisId:r,cateAxisId:n,items:i.items,stackedData:Tb(e,i.items,a)}))},{})),bb(bb({},t),{},yb({},s,o))},{})}(m,y,"".concat(x,"Id"),"".concat(b,"Id"),p,f),_=l.reduce(function(e,t){var r="".concat(t.axisType,"Map");return Ij(Ij({},e),{},Lj({},r,Kj(a,Ij(Ij({},t),{},{graphicalItems:y,stackGroups:t.axisType===x&&v,dataStartIndex:s,dataEndIndex:i}))))},{}),k=Jj(Ij(Ij({},_),{},{props:a,graphicalItems:y}),null===n||void 0===n?void 0:n.legendBBox);Object.keys(_).forEach(function(e){_[e]=d(a,_[e],k,e.replace("Map",""),t)});var j=function(e){var t=ai(e),r=Ob(t,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:Qi()(r,function(e){return e.coordinate}),tooltipAxis:t,tooltipAxisBandSize:Bb(t,r)}}(_["".concat(b,"Map")]),w=h(a,Ij(Ij({},_),{},{dataStartIndex:s,dataEndIndex:i,updateId:o,graphicalItems:y,stackGroups:v,offset:k}));return Ij(Ij({formattedGraphicalItems:w,graphicalItems:y,offset:k,stackGroups:v},j),_)},m=function(e){function r(e){var n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),Lj(i=Cj(this,r,[e]),"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Lj(i,"accessibilityManager",new Nk),Lj(i,"handleLegendBBoxUpdate",function(e){if(e){var t=i.state,r=t.dataStartIndex,n=t.dataEndIndex,a=t.updateId;i.setState(Ij({legendBBox:e},p({props:i.props,dataStartIndex:r,dataEndIndex:n,updateId:a},Ij(Ij({},i.state),{},{legendBBox:e}))))}}),Lj(i,"handleReceiveSyncEvent",function(e,t,r){if(i.props.syncId===e){if(r===i.eventEmitterSymbol&&"function"!==typeof i.props.syncMethod)return;i.applySyncEvent(t)}}),Lj(i,"handleBrushChange",function(e){var t=e.startIndex,r=e.endIndex;if(t!==i.state.dataStartIndex||r!==i.state.dataEndIndex){var n=i.state.updateId;i.setState(function(){return Ij({dataStartIndex:t,dataEndIndex:r},p({props:i.props,dataStartIndex:t,dataEndIndex:r,updateId:n},i.state))}),i.triggerSyncEvent({dataStartIndex:t,dataEndIndex:r})}}),Lj(i,"handleMouseEnter",function(e){var t=i.getMouseInfo(e);if(t){var r=Ij(Ij({},t),{},{isTooltipActive:!0});i.setState(r),i.triggerSyncEvent(r);var n=i.props.onMouseEnter;hi()(n)&&n(r,e)}}),Lj(i,"triggeredAfterMouseMove",function(e){var t=i.getMouseInfo(e),r=t?Ij(Ij({},t),{},{isTooltipActive:!0}):{isTooltipActive:!1};i.setState(r),i.triggerSyncEvent(r);var n=i.props.onMouseMove;hi()(n)&&n(r,e)}),Lj(i,"handleItemMouseEnter",function(e){i.setState(function(){return{isTooltipActive:!0,activeItem:e,activePayload:e.tooltipPayload,activeCoordinate:e.tooltipPosition||{x:e.cx,y:e.cy}}})}),Lj(i,"handleItemMouseLeave",function(){i.setState(function(){return{isTooltipActive:!1}})}),Lj(i,"handleMouseMove",function(e){e.persist(),i.throttleTriggeredAfterMouseMove(e)}),Lj(i,"handleMouseLeave",function(e){i.throttleTriggeredAfterMouseMove.cancel();var t={isTooltipActive:!1};i.setState(t),i.triggerSyncEvent(t);var r=i.props.onMouseLeave;hi()(r)&&r(t,e)}),Lj(i,"handleOuterEvent",function(e){var t,r=function(e){var t=e&&e.type;return t&&Ci[t]?Ci[t]:null}(e),n=Ks()(i.props,"".concat(r));r&&hi()(n)&&n(null!==(t=/.*touch.*/i.test(r)?i.getMouseInfo(e.changedTouches[0]):i.getMouseInfo(e))&&void 0!==t?t:{},e)}),Lj(i,"handleClick",function(e){var t=i.getMouseInfo(e);if(t){var r=Ij(Ij({},t),{},{isTooltipActive:!0});i.setState(r),i.triggerSyncEvent(r);var n=i.props.onClick;hi()(n)&&n(r,e)}}),Lj(i,"handleMouseDown",function(e){var t=i.props.onMouseDown;hi()(t)&&t(i.getMouseInfo(e),e)}),Lj(i,"handleMouseUp",function(e){var t=i.props.onMouseUp;hi()(t)&&t(i.getMouseInfo(e),e)}),Lj(i,"handleTouchMove",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&i.throttleTriggeredAfterMouseMove(e.changedTouches[0])}),Lj(i,"handleTouchStart",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&i.handleMouseDown(e.changedTouches[0])}),Lj(i,"handleTouchEnd",function(e){null!=e.changedTouches&&e.changedTouches.length>0&&i.handleMouseUp(e.changedTouches[0])}),Lj(i,"handleDoubleClick",function(e){var t=i.props.onDoubleClick;hi()(t)&&t(i.getMouseInfo(e),e)}),Lj(i,"handleContextMenu",function(e){var t=i.props.onContextMenu;hi()(t)&&t(i.getMouseInfo(e),e)}),Lj(i,"triggerSyncEvent",function(e){void 0!==i.props.syncId&&yk.emit(vk,i.props.syncId,e,i.eventEmitterSymbol)}),Lj(i,"applySyncEvent",function(e){var t=i.props,r=t.layout,n=t.syncMethod,a=i.state.updateId,s=e.dataStartIndex,o=e.dataEndIndex;if(void 0!==e.dataStartIndex||void 0!==e.dataEndIndex)i.setState(Ij({dataStartIndex:s,dataEndIndex:o},p({props:i.props,dataStartIndex:s,dataEndIndex:o,updateId:a},i.state)));else if(void 0!==e.activeTooltipIndex){var l=e.chartX,c=e.chartY,d=e.activeTooltipIndex,u=i.state,h=u.offset,m=u.tooltipTicks;if(!h)return;if("function"===typeof n)d=n(m,e);else if("value"===n){d=-1;for(var f=0;f<m.length;f++)if(m[f].value===e.activeLabel){d=f;break}}var g=Ij(Ij({},h),{},{x:h.left,y:h.top}),x=Math.min(l,g.x+g.width),b=Math.min(c,g.y+g.height),y=m[d]&&m[d].value,v=qj(i.state,i.props.data,d),_=m[d]?{x:"horizontal"===r?m[d].coordinate:x,y:"horizontal"===r?b:m[d].coordinate}:zj;i.setState(Ij(Ij({},e),{},{activeLabel:y,activeCoordinate:_,activePayload:v,activeTooltipIndex:d}))}else i.setState(e)}),Lj(i,"renderCursor",function(e){var r,n=i.state,a=n.isTooltipActive,o=n.activeCoordinate,l=n.activePayload,c=n.offset,d=n.activeTooltipIndex,u=n.tooltipAxisBandSize,h=i.getTooltipEventType(),p=null!==(r=e.props.active)&&void 0!==r?r:a,m=i.props.layout,f=e.key||"_recharts-cursor";return s.createElement(vj,{key:f,activeCoordinate:o,activePayload:l,activeTooltipIndex:d,chartName:t,element:e,isActive:p,layout:m,offset:c,tooltipAxisBandSize:u,tooltipEventType:h})}),Lj(i,"renderPolarAxis",function(e,t,r){var n=Ks()(e,"type.axisType"),a=Ks()(i.state,"".concat(n,"Map")),o=e.type.defaultProps,l=void 0!==o?Ij(Ij({},o),e.props):e.props,c=a&&a[l["".concat(n,"Id")]];return(0,s.cloneElement)(e,Ij(Ij({},c),{},{className:Us(n,c.className),key:e.key||"".concat(t,"-").concat(r),ticks:Ob(c,!0)}))}),Lj(i,"renderPolarGrid",function(e){var t=e.props,r=t.radialLines,n=t.polarAngles,a=t.polarRadius,o=i.state,l=o.radiusAxisMap,c=o.angleAxisMap,d=ai(l),u=ai(c),h=u.cx,p=u.cy,m=u.innerRadius,f=u.outerRadius;return(0,s.cloneElement)(e,{polarAngles:Array.isArray(n)?n:Ob(u,!0).map(function(e){return e.coordinate}),polarRadius:Array.isArray(a)?a:Ob(d,!0).map(function(e){return e.coordinate}),cx:h,cy:p,innerRadius:m,outerRadius:f,key:e.key||"polar-grid",radialLines:r})}),Lj(i,"renderLegend",function(){var e=i.state.formattedGraphicalItems,t=i.props,r=t.children,n=t.width,a=t.height,o=i.props.margin||{},l=n-(o.left||0)-(o.right||0),d=pb({children:r,formattedGraphicalItems:e,legendWidth:l,legendContent:c});if(!d)return null;var u=d.item,h=Sj(d,_j);return(0,s.cloneElement)(u,Ij(Ij({},h),{},{chartWidth:n,chartHeight:a,margin:o,onBBoxUpdate:i.handleLegendBBoxUpdate}))}),Lj(i,"renderTooltip",function(){var e,t=i.props,r=t.children,n=t.accessibilityLayer,a=Ri(r,Jo);if(!a)return null;var o=i.state,l=o.isTooltipActive,c=o.activeCoordinate,d=o.activePayload,u=o.activeLabel,h=o.offset,p=null!==(e=a.props.active)&&void 0!==e?e:l;return(0,s.cloneElement)(a,{viewBox:Ij(Ij({},h),{},{x:h.left,y:h.top}),active:p,label:u,payload:p?d:[],coordinate:c,accessibilityLayer:n})}),Lj(i,"renderBrush",function(e){var t=i.props,r=t.margin,n=t.data,a=i.state,o=a.offset,l=a.dataStartIndex,c=a.dataEndIndex,d=a.updateId;return(0,s.cloneElement)(e,{key:e.key||"_recharts-brush",onChange:Eb(i.handleBrushChange,e.props.onChange),data:n,x:Zs(e.props.x)?e.props.x:o.left,y:Zs(e.props.y)?e.props.y:o.top+o.height+o.brushBottom-(r.bottom||0),width:Zs(e.props.width)?e.props.width:o.width,startIndex:l,endIndex:c,updateId:"brush-".concat(d)})}),Lj(i,"renderReferenceElement",function(e,t,r){if(!e)return null;var n=i.clipPathId,a=i.state,o=a.xAxisMap,l=a.yAxisMap,c=a.offset,d=e.type.defaultProps||{},u=e.props,h=u.xAxisId,p=void 0===h?d.xAxisId:h,m=u.yAxisId,f=void 0===m?d.yAxisId:m;return(0,s.cloneElement)(e,{key:e.key||"".concat(t,"-").concat(r),xAxis:o[p],yAxis:l[f],viewBox:{x:c.left,y:c.top,width:c.width,height:c.height},clipPathId:n})}),Lj(i,"renderActivePoints",function(e){var t=e.item,n=e.activePoint,a=e.basePoint,s=e.childIndex,i=e.isRange,o=[],l=t.props.key,c=void 0!==t.item.type.defaultProps?Ij(Ij({},t.item.type.defaultProps),t.item.props):t.item.props,d=c.activeDot,u=Ij(Ij({index:s,dataKey:c.dataKey,cx:n.x,cy:n.y,r:4,fill:kb(t.item),strokeWidth:2,stroke:"#fff",payload:n.payload,value:n.value},Fi(d,!1)),ki(d));return o.push(r.renderActiveDot(d,u,"".concat(l,"-activePoint-").concat(s))),a?o.push(r.renderActiveDot(d,Ij(Ij({},u),{},{cx:a.x,cy:a.y}),"".concat(l,"-basePoint-").concat(s))):i&&o.push(null),o}),Lj(i,"renderGraphicChild",function(e,t,r){var n=i.filterFormatItem(e,t,r);if(!n)return null;var a=i.getTooltipEventType(),o=i.state,l=o.isTooltipActive,c=o.tooltipAxis,d=o.activeTooltipIndex,u=o.activeLabel,h=Ri(i.props.children,Jo),p=n.props,m=p.points,f=p.isRange,g=p.baseLine,x=void 0!==n.item.type.defaultProps?Ij(Ij({},n.item.type.defaultProps),n.item.props):n.item.props,b=x.activeDot,y=x.hide,v=x.activeBar,_=x.activeShape,k=Boolean(!y&&l&&h&&(b||v||_)),j={};"axis"!==a&&h&&"click"===h.props.trigger?j={onClick:Eb(i.handleItemMouseEnter,e.props.onClick)}:"axis"!==a&&(j={onMouseLeave:Eb(i.handleItemMouseLeave,e.props.onMouseLeave),onMouseEnter:Eb(i.handleItemMouseEnter,e.props.onMouseEnter)});var w=(0,s.cloneElement)(e,Ij(Ij({},n.props),j));if(k){if(!(d>=0)){var N,S=(null!==(N=i.getItemByXY(i.state.activeCoordinate))&&void 0!==N?N:{graphicalItem:w}).graphicalItem,O=S.item,C=void 0===O?e:O,E=S.childIndex,P=Ij(Ij(Ij({},n.props),j),{},{activeIndex:E});return[(0,s.cloneElement)(C,P),null,null]}var A,T;if(c.dataKey&&!c.allowDuplicatedCategory){var M="function"===typeof c.dataKey?function(e){return"function"===typeof c.dataKey?c.dataKey(e.payload):null}:"payload.".concat(c.dataKey.toString());A=ii(m,M,u),T=f&&g&&ii(g,M,u)}else A=null===m||void 0===m?void 0:m[d],T=f&&g&&g[d];if(_||v){var R=void 0!==e.props.activeIndex?e.props.activeIndex:d;return[(0,s.cloneElement)(e,Ij(Ij(Ij({},n.props),j),{},{activeIndex:R})),null,null]}if(!di()(A))return[w].concat(Tj(i.renderActivePoints({item:n,activePoint:A,basePoint:T,childIndex:d,isRange:f})))}return f?[w,null,null]:[w,null]}),Lj(i,"renderCustomized",function(e,t,r){return(0,s.cloneElement)(e,Ij(Ij({key:"recharts-customized-".concat(r)},i.props),i.state))}),Lj(i,"renderMap",{CartesianGrid:{handler:Vj,once:!0},ReferenceArea:{handler:i.renderReferenceElement},ReferenceLine:{handler:Vj},ReferenceDot:{handler:i.renderReferenceElement},XAxis:{handler:Vj},YAxis:{handler:Vj},Brush:{handler:i.renderBrush,once:!0},Bar:{handler:i.renderGraphicChild},Line:{handler:i.renderGraphicChild},Area:{handler:i.renderGraphicChild},Radar:{handler:i.renderGraphicChild},RadialBar:{handler:i.renderGraphicChild},Scatter:{handler:i.renderGraphicChild},Pie:{handler:i.renderGraphicChild},Funnel:{handler:i.renderGraphicChild},Tooltip:{handler:i.renderCursor,once:!0},PolarGrid:{handler:i.renderPolarGrid,once:!0},PolarAngleAxis:{handler:i.renderPolarAxis},PolarRadiusAxis:{handler:i.renderPolarAxis},Customized:{handler:i.renderCustomized}}),i.clipPathId="".concat(null!==(n=e.id)&&void 0!==n?n:ri("recharts"),"-clip"),i.throttleTriggeredAfterMouseMove=Vs()(i.triggeredAfterMouseMove,null!==(a=e.throttleDelay)&&void 0!==a?a:1e3/60),i.state={},i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Aj(e,t)}(r,e),n=r,i=[{key:"componentDidMount",value:function(){var e,t;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:null!==(e=this.props.margin.left)&&void 0!==e?e:0,top:null!==(t=this.props.margin.top)&&void 0!==t?t:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var e=this.props,t=e.children,r=e.data,n=e.height,a=e.layout,s=Ri(t,Jo);if(s){var i=s.props.defaultIndex;if(!("number"!==typeof i||i<0||i>this.state.tooltipTicks.length-1)){var o=this.state.tooltipTicks[i]&&this.state.tooltipTicks[i].value,l=qj(this.state,r,i,o),c=this.state.tooltipTicks[i].coordinate,d=(this.state.offset.top+n)/2,u="horizontal"===a?{x:c,y:d}:{y:c,x:d},h=this.state.formattedGraphicalItems.find(function(e){return"Scatter"===e.item.type.name});h&&(u=Ij(Ij({},u),h.props.points[i].tooltipPosition),l=h.props.points[i].tooltipPayload);var p={activeTooltipIndex:i,isTooltipActive:!0,activeLabel:o,activePayload:l,activeCoordinate:u};this.setState(p),this.renderCursor(s),this.accessibilityManager.setIndex(i)}}}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return this.props.accessibilityLayer?(this.state.tooltipTicks!==t.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==e.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==e.margin&&this.accessibilityManager.setDetails({offset:{left:null!==(r=this.props.margin.left)&&void 0!==r?r:0,top:null!==(n=this.props.margin.top)&&void 0!==n?n:0}}),null):null;var r,n}},{key:"componentDidUpdate",value:function(e){Bi([Ri(e.children,Jo)],[Ri(this.props.children,Jo)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var e=Ri(this.props.children,Jo);if(e&&"boolean"===typeof e.props.shared){var t=e.props.shared?"axis":"item";return o.indexOf(t)>=0?t:a}return a}},{key:"getMouseInfo",value:function(e){if(!this.container)return null;var t,r=this.container,n=r.getBoundingClientRect(),a={top:(t=n).top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft},s={chartX:Math.round(e.pageX-a.left),chartY:Math.round(e.pageY-a.top)},i=n.width/r.offsetWidth||1,o=this.inRange(s.chartX,s.chartY,i);if(!o)return null;var l=this.state,c=l.xAxisMap,d=l.yAxisMap,u=this.getTooltipEventType(),h=Gj(this.state,this.props.data,this.props.layout,o);if("axis"!==u&&c&&d){var p=ai(c).scale,m=ai(d).scale,f=p&&p.invert?p.invert(s.chartX):null,g=m&&m.invert?m.invert(s.chartY):null;return Ij(Ij({},s),{},{xValue:f,yValue:g},h)}return h?Ij(Ij({},s),h):null}},{key:"inRange",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.props.layout,a=e/r,s=t/r;if("horizontal"===n||"vertical"===n){var i=this.state.offset;return a>=i.left&&a<=i.left+i.width&&s>=i.top&&s<=i.top+i.height?{x:a,y:s}:null}var o=this.state,l=o.angleAxisMap,c=o.radiusAxisMap;if(l&&c){var d=ai(l);return fy({x:a,y:s},d)}return null}},{key:"parseEventsOfWrapper",value:function(){var e=this.props.children,t=this.getTooltipEventType(),r=Ri(e,Jo),n={};return r&&"axis"===t&&(n="click"===r.props.trigger?{onClick:this.handleClick}:{onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu}),Ij(Ij({},ki(this.props,this.handleOuterEvent)),n)}},{key:"addListener",value:function(){yk.on(vk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){yk.removeListener(vk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(e,t,r){for(var n=this.state.formattedGraphicalItems,a=0,s=n.length;a<s;a++){var i=n[a];if(i.item===e||i.props.key===e.key||t===Ei(i.item.type)&&r===i.childIndex)return i}return null}},{key:"renderClipPath",value:function(){var e=this.clipPathId,t=this.state.offset,r=t.left,n=t.top,a=t.height,i=t.width;return s.createElement("defs",null,s.createElement("clipPath",{id:e},s.createElement("rect",{x:r,y:n,height:a,width:i})))}},{key:"getXScales",value:function(){var e=this.state.xAxisMap;return e?Object.entries(e).reduce(function(e,t){var r=Nj(t,2),n=r[0],a=r[1];return Ij(Ij({},e),{},Lj({},n,a.scale))},{}):null}},{key:"getYScales",value:function(){var e=this.state.yAxisMap;return e?Object.entries(e).reduce(function(e,t){var r=Nj(t,2),n=r[0],a=r[1];return Ij(Ij({},e),{},Lj({},n,a.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(e){var t;return null===(t=this.state.xAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getYScaleByAxisId",value:function(e){var t;return null===(t=this.state.yAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getItemByXY",value:function(e){var t=this.state,r=t.formattedGraphicalItems,n=t.activeItem;if(r&&r.length)for(var a=0,s=r.length;a<s;a++){var i=r[a],o=i.props,l=i.item,c=void 0!==l.type.defaultProps?Ij(Ij({},l.type.defaultProps),l.props):l.props,d=Ei(l.type);if("Bar"===d){var u=(o.data||[]).find(function(t){return hu(e,t)});if(u)return{graphicalItem:i,payload:u}}else if("RadialBar"===d){var h=(o.data||[]).find(function(t){return fy(e,t)});if(h)return{graphicalItem:i,payload:h}}else if(Sv(i,n)||Ov(i,n)||Cv(i,n)){var p=Tv({graphicalItem:i,activeTooltipItem:n,itemData:c.data}),m=void 0===c.activeIndex?p:c.activeIndex;return{graphicalItem:Ij(Ij({},i),{},{childIndex:m}),payload:Cv(i,n)?c.data[p]:i.props.data[p]}}}return null}},{key:"render",value:function(){var e=this;if(!Di(this))return null;var t,r,n=this.props,a=n.children,i=n.className,o=n.width,l=n.height,c=n.style,d=n.compact,u=n.title,h=n.desc,p=Sj(n,kj),m=Fi(p,!1);if(d)return s.createElement(L_,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},s.createElement(ao,wj({},m,{width:o,height:l,title:u,desc:h}),this.renderClipPath(),zi(a,this.renderMap)));this.props.accessibilityLayer&&(m.tabIndex=null!==(t=this.props.tabIndex)&&void 0!==t?t:0,m.role=null!==(r=this.props.role)&&void 0!==r?r:"application",m.onKeyDown=function(t){e.accessibilityManager.keyboardEvent(t)},m.onFocus=function(){e.accessibilityManager.focus()});var f=this.parseEventsOfWrapper();return s.createElement(L_,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},s.createElement("div",wj({className:Us("recharts-wrapper",i),style:Ij({position:"relative",cursor:"default",width:o,height:l},c)},f,{ref:function(t){e.container=t}}),s.createElement(ao,wj({},m,{width:o,height:l,title:u,desc:h,style:Uj}),this.renderClipPath(),zi(a,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}],i&&Oj(n.prototype,i),l&&Oj(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,l}(s.Component);Lj(m,"displayName",t),Lj(m,"defaultProps",Ij({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Lj(m,"getDerivedStateFromProps",function(e,t){var r=e.dataKey,n=e.data,a=e.children,s=e.width,i=e.height,o=e.layout,l=e.stackOffset,c=e.margin,d=t.dataStartIndex,u=t.dataEndIndex;if(void 0===t.updateId){var h=Yj(e);return Ij(Ij(Ij({},h),{},{updateId:0},p(Ij(Ij({props:e},h),{},{updateId:0}),t)),{},{prevDataKey:r,prevData:n,prevWidth:s,prevHeight:i,prevLayout:o,prevStackOffset:l,prevMargin:c,prevChildren:a})}if(r!==t.prevDataKey||n!==t.prevData||s!==t.prevWidth||i!==t.prevHeight||o!==t.prevLayout||l!==t.prevStackOffset||!gi(c,t.prevMargin)){var m=Yj(e),f={chartX:t.chartX,chartY:t.chartY,isTooltipActive:t.isTooltipActive},g=Ij(Ij({},Gj(t,n,o)),{},{updateId:t.updateId+1}),x=Ij(Ij(Ij({},m),f),g);return Ij(Ij(Ij({},x),p(Ij({props:e},x),t)),{},{prevDataKey:r,prevData:n,prevWidth:s,prevHeight:i,prevLayout:o,prevStackOffset:l,prevMargin:c,prevChildren:a})}if(!Bi(a,t.prevChildren)){var b,y,v,_,k=Ri(a,sy),j=k&&null!==(b=null===(y=k.props)||void 0===y?void 0:y.startIndex)&&void 0!==b?b:d,w=k&&null!==(v=null===(_=k.props)||void 0===_?void 0:_.endIndex)&&void 0!==v?v:u,N=j!==d||w!==u,S=!di()(n)&&!N?t.updateId:t.updateId+1;return Ij(Ij({updateId:S},p(Ij(Ij({props:e},t),{},{updateId:S,dataStartIndex:j,dataEndIndex:w}),t)),{},{prevChildren:a,dataStartIndex:j,dataEndIndex:w})}return null}),Lj(m,"renderActiveDot",function(e,t,r){var n;return n=(0,s.isValidElement)(e)?(0,s.cloneElement)(e,t):hi()(e)?e(t):s.createElement(Cc,t),s.createElement(lo,{className:"recharts-active-dot",key:r},n)});var f=(0,s.forwardRef)(function(e,t){return s.createElement(m,wj({},e,{ref:t}))});return f.displayName=m.displayName,f}({chartName:"LineChart",GraphicalChild:fw,axisComponents:[{axisType:"xAxis",AxisComp:Xw},{axisType:"yAxis",AxisComp:oN}],formatAxisMap:function(e,r,n,a,s){var i=e.width,o=e.height,l=e.layout,c=e.children,d=Object.keys(r),u={left:n.left,leftMirror:n.left,right:i-n.right,rightMirror:i-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},h=!!Ri(c,r_);return d.reduce(function(i,o){var c,d,p,m,f,g=r[o],x=g.orientation,b=g.domain,y=g.padding,v=void 0===y?{}:y,_=g.mirror,k=g.reversed,j="".concat(x).concat(_?"Mirror":"");if("number"===g.type&&("gap"===g.padding||"no-gap"===g.padding)){var w=b[1]-b[0],N=1/0,S=g.categoricalDomain.sort(oi);if(S.forEach(function(e,t){t>0&&(N=Math.min((e||0)-(S[t-1]||0),N))}),Number.isFinite(N)){var O=N/w,C="vertical"===g.layout?n.height:n.width;if("gap"===g.padding&&(c=O*C/2),"no-gap"===g.padding){var E=ni(e.barCategoryGap,O*C),P=O*C/2;c=P-E-(P-E)/C*E}}}d="xAxis"===a?[n.left+(v.left||0)+(c||0),n.left+n.width-(v.right||0)-(c||0)]:"yAxis"===a?"horizontal"===l?[n.top+n.height-(v.bottom||0),n.top+(v.top||0)]:[n.top+(v.top||0)+(c||0),n.top+n.height-(v.bottom||0)-(c||0)]:g.range,k&&(d=[d[1],d[0]]);var A=function(e,r,n){var a=e.scale,s=e.type,i=e.layout,o=e.axisType;if("auto"===a)return"radial"===i&&"radiusAxis"===o?{scale:wu(),realScaleType:"band"}:"radial"===i&&"angleAxis"===o?{scale:Kp(),realScaleType:"linear"}:"category"===s&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Su(),realScaleType:"point"}:"category"===s?{scale:wu(),realScaleType:"band"}:{scale:Kp(),realScaleType:"linear"};if(Ws()(a)){var l="scale".concat(Zo()(a));return{scale:(t[l]||Su)(),realScaleType:t[l]?l:"point"}}return hi()(a)?{scale:a}:{scale:Su(),realScaleType:"point"}}(g,s,h),T=A.scale,M=A.realScaleType;T.domain(b).range(d),function(e){var t=e.domain();if(t&&!(t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Pb,s=Math.max(n[0],n[1])+Pb,i=e(t[0]),o=e(t[r-1]);(i<a||i>s||o<a||o>s)&&e.domain([t[0],t[r-1]])}}(T);var R=function(e,t){var r=t.realScaleType,n=t.type,a=t.tickCount,s=t.originalDomain,i=t.allowDecimals,o=r||t.scale;if("auto"!==o&&"linear"!==o)return null;if(a&&"number"===n&&s&&("auto"===s[0]||"auto"===s[1])){var l=e.domain();if(!l.length)return null;var c=$x(l,a,i);return e.domain([fx()(c),px()(c)]),{niceTicks:c}}if(a&&"number"===n){var d=e.domain();return{niceTicks:Kx(d,a,i)}}return null}(T,i_(i_({},g),{},{realScaleType:M}));"xAxis"===a?(f="top"===x&&!_||"bottom"===x&&_,p=n.left,m=u[j]-f*g.height):"yAxis"===a&&(f="left"===x&&!_||"right"===x&&_,p=u[j]-f*g.width,m=n.top);var D=i_(i_(i_({},g),R),{},{realScaleType:M,x:p,y:m,scale:T,width:"xAxis"===a?n.width:g.width,height:"yAxis"===a?n.height:g.height});return D.bandSize=Bb(D,R),g.hide||"xAxis"!==a?g.hide||(u[j]+=(f?-1:1)*D.width):u[j]+=(f?-1:1)*D.height,i_(i_({},i),{},o_({},o,D))},{})}}),cN=["x1","y1","x2","y2","key"],dN=["offset"];function uN(e){return uN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uN(e)}function hN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function pN(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hN(Object(r),!0).forEach(function(t){mN(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hN(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function mN(e,t,r){return t=function(e){var t=function(e,t){if("object"!=uN(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=uN(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==uN(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fN(){return fN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fN.apply(this,arguments)}function gN(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var xN=function(e){var t=e.fill;if(!t||"none"===t)return null;var r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,l=e.ry;return s.createElement("rect",{x:n,y:a,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function bN(e,t){var r;if(s.isValidElement(e))r=s.cloneElement(e,t);else if(hi()(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,c=gN(t,cN),d=Fi(c,!1),u=(d.offset,gN(d,dN));r=s.createElement("line",fN({},u,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function yN(e){var t=e.x,r=e.width,n=e.horizontal,a=void 0===n||n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(n,s){var i=pN(pN({},e),{},{x1:t,y1:n,x2:t+r,y2:n,key:"line-".concat(s),index:s});return bN(a,i)});return s.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function vN(e){var t=e.y,r=e.height,n=e.vertical,a=void 0===n||n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(n,s){var i=pN(pN({},e),{},{x1:n,y1:t,x2:n,y2:t+r,key:"line-".concat(s),index:s});return bN(a,i)});return s.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function _N(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal;if(!(void 0===c||c)||!t||!t.length)return null;var d=l.map(function(e){return Math.round(e+a-a)}).sort(function(e,t){return e-t});a!==d[0]&&d.unshift(0);var u=d.map(function(e,l){var c=!d[l+1]?a+o-e:d[l+1]-e;if(c<=0)return null;var u=l%t.length;return s.createElement("rect",{key:"react-".concat(l),y:e,x:n,height:c,width:i,stroke:"none",fill:t[u],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return s.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function kN(e){var t=e.vertical,r=void 0===t||t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(e){return Math.round(e+i-i)}).sort(function(e,t){return e-t});i!==u[0]&&u.unshift(0);var h=u.map(function(e,t){var r=!u[t+1]?i+l-e:u[t+1]-e;if(r<=0)return null;var d=t%n.length;return s.createElement("rect",{key:"react-".concat(t),x:e,y:o,width:r,height:c,stroke:"none",fill:n[d],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return s.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var jN=function(e,t){var r=e.xAxis,n=e.width,a=e.height,s=e.offset;return Sb(jw(pN(pN(pN({},Bw.defaultProps),r),{},{ticks:Ob(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),s.left,s.left+s.width,t)},wN=function(e,t){var r=e.yAxis,n=e.width,a=e.height,s=e.offset;return Sb(jw(pN(pN(pN({},Bw.defaultProps),r),{},{ticks:Ob(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),s.top,s.top+s.height,t)},NN={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function SN(e){var t,r,n,a,i,o,l=U_(),c=z_(),d=(0,s.useContext)(M_),u=pN(pN({},e),{},{stroke:null!==(t=e.stroke)&&void 0!==t?t:NN.stroke,fill:null!==(r=e.fill)&&void 0!==r?r:NN.fill,horizontal:null!==(n=e.horizontal)&&void 0!==n?n:NN.horizontal,horizontalFill:null!==(a=e.horizontalFill)&&void 0!==a?a:NN.horizontalFill,vertical:null!==(i=e.vertical)&&void 0!==i?i:NN.vertical,verticalFill:null!==(o=e.verticalFill)&&void 0!==o?o:NN.verticalFill,x:Zs(e.x)?e.x:d.left,y:Zs(e.y)?e.y:d.top,width:Zs(e.width)?e.width:d.width,height:Zs(e.height)?e.height:d.height}),h=u.x,p=u.y,m=u.width,f=u.height,g=u.syncWithTicks,x=u.horizontalValues,b=u.verticalValues,y=function(){var e=(0,s.useContext)(P_);return ai(e)}(),v=function(){var e=(0,s.useContext)(A_);return O_()(e,function(e){return Ty()(e.domain,Number.isFinite)})||ai(e)}();if(!Zs(m)||m<=0||!Zs(f)||f<=0||!Zs(h)||h!==+h||!Zs(p)||p!==+p)return null;var _=u.verticalCoordinatesGenerator||jN,k=u.horizontalCoordinatesGenerator||wN,j=u.horizontalPoints,w=u.verticalPoints;if((!j||!j.length)&&hi()(k)){var N=x&&x.length,S=k({yAxis:v?pN(pN({},v),{},{ticks:N?x:v.ticks}):void 0,width:l,height:c,offset:d},!!N||g);li(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(uN(S),"]")),Array.isArray(S)&&(j=S)}if((!w||!w.length)&&hi()(_)){var O=b&&b.length,C=_({xAxis:y?pN(pN({},y),{},{ticks:O?b:y.ticks}):void 0,width:l,height:c,offset:d},!!O||g);li(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(uN(C),"]")),Array.isArray(C)&&(w=C)}return s.createElement("g",{className:"recharts-cartesian-grid"},s.createElement(xN,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),s.createElement(yN,fN({},u,{offset:d,horizontalPoints:j,xAxis:y,yAxis:v})),s.createElement(vN,fN({},u,{offset:d,verticalPoints:w,xAxis:y,yAxis:v})),s.createElement(_N,fN({},u,{horizontalPoints:j})),s.createElement(kN,fN({},u,{verticalPoints:w})))}SN.displayName="CartesianGrid";const ON=ze("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),CN=ze("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),EN=ze("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"16",key:"10p56q"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);function PN(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function AN(e,t){if(e){if("string"==typeof e)return PN(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?PN(e,t):void 0}}function TN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||AN(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var MN=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function RN(){return RN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RN.apply(null,arguments)}function DN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Me(n.key),n)}}function IN(e,t){return IN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},IN(e,t)}function LN(e){return LN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},LN(e)}function FN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(FN=function(){return!!e})()}function BN(e,t){if(t&&("object"==Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function UN(e){return function(e){if(Array.isArray(e))return PN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||AN(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var zN=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(dU){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),VN=Math.abs,HN=String.fromCharCode,WN=Object.assign;function qN(e){return e.trim()}function GN(e,t,r){return e.replace(t,r)}function $N(e,t){return e.indexOf(t)}function KN(e,t){return 0|e.charCodeAt(t)}function YN(e,t,r){return e.slice(t,r)}function XN(e){return e.length}function JN(e){return e.length}function QN(e,t){return t.push(e),e}var ZN=1,eS=1,tS=0,rS=0,nS=0,aS="";function sS(e,t,r,n,a,s,i){return{value:e,root:t,parent:r,type:n,props:a,children:s,line:ZN,column:eS,length:i,return:""}}function iS(e,t){return WN(sS("",null,null,"",null,null,0),e,{length:-e.length},t)}function oS(){return nS=rS>0?KN(aS,--rS):0,eS--,10===nS&&(eS=1,ZN--),nS}function lS(){return nS=rS<tS?KN(aS,rS++):0,eS++,10===nS&&(eS=1,ZN++),nS}function cS(){return KN(aS,rS)}function dS(){return rS}function uS(e,t){return YN(aS,e,t)}function hS(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pS(e){return ZN=eS=1,tS=XN(aS=e),rS=0,[]}function mS(e){return aS="",e}function fS(e){return qN(uS(rS-1,bS(91===e?e+2:40===e?e+1:e)))}function gS(e){for(;(nS=cS())&&nS<33;)lS();return hS(e)>2||hS(nS)>3?"":" "}function xS(e,t){for(;--t&&lS()&&!(nS<48||nS>102||nS>57&&nS<65||nS>70&&nS<97););return uS(e,dS()+(t<6&&32==cS()&&32==lS()))}function bS(e){for(;lS();)switch(nS){case e:return rS;case 34:case 39:34!==e&&39!==e&&bS(nS);break;case 40:41===e&&bS(e);break;case 92:lS()}return rS}function yS(e,t){for(;lS()&&e+nS!==57&&(e+nS!==84||47!==cS()););return"/*"+uS(t,rS-1)+"*"+HN(47===e?e:lS())}function vS(e){for(;!hS(cS());)lS();return uS(e,rS)}var _S="-ms-",kS="-moz-",jS="-webkit-",wS="comm",NS="rule",SS="decl",OS="@keyframes";function CS(e,t){for(var r="",n=JN(e),a=0;a<n;a++)r+=t(e[a],a,e,t)||"";return r}function ES(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case SS:return e.return=e.return||e.value;case wS:return"";case OS:return e.return=e.value+"{"+CS(e.children,n)+"}";case NS:e.value=e.props.join(",")}return XN(r=CS(e.children,n))?e.return=e.value+"{"+r+"}":""}function PS(e){return function(t){t.root||(t=t.return)&&e(t)}}function AS(e){return mS(TS("",null,null,null,[""],e=pS(e),0,[0],e))}function TS(e,t,r,n,a,s,i,o,l){for(var c=0,d=0,u=i,h=0,p=0,m=0,f=1,g=1,x=1,b=0,y="",v=a,_=s,k=n,j=y;g;)switch(m=b,b=lS()){case 40:if(108!=m&&58==KN(j,u-1)){-1!=$N(j+=GN(fS(b),"&","&\f"),"&\f")&&(x=-1);break}case 34:case 39:case 91:j+=fS(b);break;case 9:case 10:case 13:case 32:j+=gS(m);break;case 92:j+=xS(dS()-1,7);continue;case 47:switch(cS()){case 42:case 47:QN(RS(yS(lS(),dS()),t,r),l);break;default:j+="/"}break;case 123*f:o[c++]=XN(j)*x;case 125*f:case 59:case 0:switch(b){case 0:case 125:g=0;case 59+d:-1==x&&(j=GN(j,/\f/g,"")),p>0&&XN(j)-u&&QN(p>32?DS(j+";",n,r,u-1):DS(GN(j," ","")+";",n,r,u-2),l);break;case 59:j+=";";default:if(QN(k=MS(j,t,r,c,d,a,o,y,v=[],_=[],u),s),123===b)if(0===d)TS(j,t,k,k,v,s,u,o,_);else switch(99===h&&110===KN(j,3)?100:h){case 100:case 108:case 109:case 115:TS(e,k,k,n&&QN(MS(e,k,k,0,0,a,o,y,a,v=[],u),_),a,_,u,o,n?v:_);break;default:TS(j,k,k,k,[""],_,0,o,_)}}c=d=p=0,f=x=1,y=j="",u=i;break;case 58:u=1+XN(j),p=m;default:if(f<1)if(123==b)--f;else if(125==b&&0==f++&&125==oS())continue;switch(j+=HN(b),b*f){case 38:x=d>0?1:(j+="\f",-1);break;case 44:o[c++]=(XN(j)-1)*x,x=1;break;case 64:45===cS()&&(j+=fS(lS())),h=cS(),d=u=XN(y=j+=vS(dS())),b++;break;case 45:45===m&&2==XN(j)&&(f=0)}}return s}function MS(e,t,r,n,a,s,i,o,l,c,d){for(var u=a-1,h=0===a?s:[""],p=JN(h),m=0,f=0,g=0;m<n;++m)for(var x=0,b=YN(e,u+1,u=VN(f=i[m])),y=e;x<p;++x)(y=qN(f>0?h[x]+" "+b:GN(b,/&\f/g,h[x])))&&(l[g++]=y);return sS(e,t,r,0===a?NS:o,l,c,d)}function RS(e,t,r){return sS(e,t,r,wS,HN(nS),YN(e,2,-2),0)}function DS(e,t,r,n){return sS(e,t,r,SS,YN(e,0,n),YN(e,n+1,-1),n)}var IS=function(e,t,r){for(var n=0,a=0;n=a,a=cS(),38===n&&12===a&&(t[r]=1),!hS(a);)lS();return uS(e,rS)},LS=function(e,t){return mS(function(e,t){var r=-1,n=44;do{switch(hS(n)){case 0:38===n&&12===cS()&&(t[r]=1),e[r]+=IS(rS-1,t,r);break;case 2:e[r]+=fS(n);break;case 4:if(44===n){e[++r]=58===cS()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=HN(n)}}while(n=lS());return e}(pS(e),t))},FS=new WeakMap,BS=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||FS.get(r))&&!n){FS.set(e,!0);for(var a=[],s=LS(t,a),i=r.props,o=0,l=0;o<s.length;o++)for(var c=0;c<i.length;c++,l++)e.props[l]=a[o]?s[o].replace(/&\f/g,i[c]):i[c]+" "+s[o]}}},US=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function zS(e,t){switch(function(e,t){return 45^KN(e,0)?(((t<<2^KN(e,0))<<2^KN(e,1))<<2^KN(e,2))<<2^KN(e,3):0}(e,t)){case 5103:return jS+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return jS+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return jS+e+kS+e+_S+e+e;case 6828:case 4268:return jS+e+_S+e+e;case 6165:return jS+e+_S+"flex-"+e+e;case 5187:return jS+e+GN(e,/(\w+).+(:[^]+)/,jS+"box-$1$2"+_S+"flex-$1$2")+e;case 5443:return jS+e+_S+"flex-item-"+GN(e,/flex-|-self/,"")+e;case 4675:return jS+e+_S+"flex-line-pack"+GN(e,/align-content|flex-|-self/,"")+e;case 5548:return jS+e+_S+GN(e,"shrink","negative")+e;case 5292:return jS+e+_S+GN(e,"basis","preferred-size")+e;case 6060:return jS+"box-"+GN(e,"-grow","")+jS+e+_S+GN(e,"grow","positive")+e;case 4554:return jS+GN(e,/([^-])(transform)/g,"$1"+jS+"$2")+e;case 6187:return GN(GN(GN(e,/(zoom-|grab)/,jS+"$1"),/(image-set)/,jS+"$1"),e,"")+e;case 5495:case 3959:return GN(e,/(image-set\([^]*)/,jS+"$1$`$1");case 4968:return GN(GN(e,/(.+:)(flex-)?(.*)/,jS+"box-pack:$3"+_S+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+jS+e+e;case 4095:case 3583:case 4068:case 2532:return GN(e,/(.+)-inline(.+)/,jS+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(XN(e)-1-t>6)switch(KN(e,t+1)){case 109:if(45!==KN(e,t+4))break;case 102:return GN(e,/(.+:)(.+)-([^]+)/,"$1"+jS+"$2-$3$1"+kS+(108==KN(e,t+3)?"$3":"$2-$3"))+e;case 115:return~$N(e,"stretch")?zS(GN(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==KN(e,t+1))break;case 6444:switch(KN(e,XN(e)-3-(~$N(e,"!important")&&10))){case 107:return GN(e,":",":"+jS)+e;case 101:return GN(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+jS+(45===KN(e,14)?"inline-":"")+"box$3$1"+jS+"$2$3$1"+_S+"$2box$3")+e}break;case 5936:switch(KN(e,t+11)){case 114:return jS+e+_S+GN(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return jS+e+_S+GN(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return jS+e+_S+GN(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return jS+e+_S+e+e}return e}var VS=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case SS:e.return=zS(e.value,e.length);break;case OS:return CS([iS(e,{value:GN(e.value,"@","@"+jS)})],n);case NS:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return CS([iS(e,{props:[GN(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return CS([iS(e,{props:[GN(t,/:(plac\w+)/,":"+jS+"input-$1")]}),iS(e,{props:[GN(t,/:(plac\w+)/,":-moz-$1")]}),iS(e,{props:[GN(t,/:(plac\w+)/,_S+"input-$1")]})],n)}return""})}}],HS=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var n,a,s=e.stylisPlugins||VS,i={},o=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)i[t[r]]=!0;o.push(e)});var l,c=[BS,US],d=[ES,PS(function(e){l.insert(e)})],u=function(e){var t=JN(e);return function(r,n,a,s){for(var i="",o=0;o<t;o++)i+=e[o](r,n,a,s)||"";return i}}(c.concat(s,d));a=function(e,t,r,n){l=r,CS(AS(e?e+"{"+t.styles+"}":t.styles),u),n&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new zN({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:a};return h.sheet.hydrate(o),h};var WS=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)};var qS={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function GS(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var $S=/[A-Z]|^ms/g,KS=/_EMO_([^_]+?)_([^]*?)_EMO_/g,YS=function(e){return 45===e.charCodeAt(1)},XS=function(e){return null!=e&&"boolean"!==typeof e},JS=GS(function(e){return YS(e)?e:e.replace($S,"-$&").toLowerCase()}),QS=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(KS,function(e,t,r){return eO={name:t,styles:r,next:eO},t})}return 1===qS[e]||YS(e)||"number"!==typeof t||0===t?t:t+"px"};function ZS(e,t,r){if(null==r)return"";var n=r;if(void 0!==n.__emotion_styles)return n;switch(typeof r){case"boolean":return"";case"object":var a=r;if(1===a.anim)return eO={name:a.name,styles:a.styles,next:eO},a.name;var s=r;if(void 0!==s.styles){var i=s.next;if(void 0!==i)for(;void 0!==i;)eO={name:i.name,styles:i.styles,next:eO},i=i.next;return s.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var a=0;a<r.length;a++)n+=ZS(e,t,r[a])+";";else for(var s in r){var i=r[s];if("object"!==typeof i){var o=i;null!=t&&void 0!==t[o]?n+=s+"{"+t[o]+"}":XS(o)&&(n+=JS(s)+":"+QS(s,o)+";")}else if(!Array.isArray(i)||"string"!==typeof i[0]||null!=t&&void 0!==t[i[0]]){var l=ZS(e,t,i);switch(s){case"animation":case"animationName":n+=JS(s)+":"+l+";";break;default:n+=s+"{"+l+"}"}}else for(var c=0;c<i.length;c++)XS(i[c])&&(n+=JS(s)+":"+QS(s,i[c])+";")}return n}(e,t,r);case"function":if(void 0!==e){var o=eO,l=r(e);return eO=o,ZS(e,t,l)}}var c=r;if(null==t)return c;var d=t[c];return void 0!==d?d:c}var eO,tO=/label:\s*([^\s;{]+)\s*(;|$)/g;function rO(e,t,r){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,a="";eO=void 0;var s=e[0];null==s||void 0===s.raw?(n=!1,a+=ZS(r,t,s)):a+=s[0];for(var i=1;i<e.length;i++){if(a+=ZS(r,t,e[i]),n)a+=s[i]}tO.lastIndex=0;for(var o,l="";null!==(o=tO.exec(a));)l+="-"+o[1];var c=function(e){for(var t,r=0,n=0,a=e.length;a>=4;++n,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(a){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(a)+l;return{name:c,styles:a,next:eO}}var nO=!!i.useInsertionEffect&&i.useInsertionEffect,aO=nO||function(e){return e()},sO=(nO||s.useLayoutEffect,s.createContext("undefined"!==typeof HTMLElement?HS({key:"css"}):null)),iO=(sO.Provider,function(e){return(0,s.forwardRef)(function(t,r){var n=(0,s.useContext)(sO);return e(t,n,r)})}),oO=s.createContext({});var lO={}.hasOwnProperty,cO="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",dO=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return WS(t,r,n),aO(function(){return function(e,t,r){WS(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+n:"",a,e.sheet,!0),a=a.next}while(void 0!==a)}}(t,r,n)}),null},uO=iO(function(e,t,r){var n=e.css;"string"===typeof n&&void 0!==t.registered[n]&&(n=t.registered[n]);var a=e[cO],i=[n],o="";"string"===typeof e.className?o=function(e,t,r){var n="";return r.split(" ").forEach(function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")}),n}(t.registered,i,e.className):null!=e.className&&(o=e.className+" ");var l=rO(i,void 0,s.useContext(oO));o+=t.key+"-"+l.name;var c={};for(var d in e)lO.call(e,d)&&"css"!==d&&d!==cO&&(c[d]=e[d]);return c.className=o,r&&(c.ref=r),s.createElement(s.Fragment,null,s.createElement(dO,{cache:t,serialized:l,isStringTag:"string"===typeof a}),s.createElement(a,c))}),hO=uO,pO=(r(219),function(e,t){var r=arguments;if(null==t||!lO.call(t,"css"))return s.createElement.apply(void 0,r);var n=r.length,a=new Array(n);a[0]=hO,a[1]=function(e,t){var r={};for(var n in t)lO.call(t,n)&&(r[n]=t[n]);return r[cO]=e,r}(e,t);for(var i=2;i<n;i++)a[i]=r[i];return s.createElement.apply(null,a)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(pO||(pO={}));function mO(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return rO(t)}const fO=Math.min,gO=Math.max,xO=Math.round,bO=Math.floor,yO=e=>({x:e,y:e});function vO(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function _O(){return"undefined"!==typeof window}function kO(e){return NO(e)?(e.nodeName||"").toLowerCase():"#document"}function jO(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function wO(e){var t;return null==(t=(NO(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function NO(e){return!!_O()&&(e instanceof Node||e instanceof jO(e).Node)}function SO(e){return!!_O()&&(e instanceof Element||e instanceof jO(e).Element)}function OO(e){return!!_O()&&(e instanceof HTMLElement||e instanceof jO(e).HTMLElement)}function CO(e){return!(!_O()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof jO(e).ShadowRoot)}function EO(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=TO(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function PO(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function AO(e){return["html","body","#document"].includes(kO(e))}function TO(e){return jO(e).getComputedStyle(e)}function MO(e){if("html"===kO(e))return e;const t=e.assignedSlot||e.parentNode||CO(e)&&e.host||wO(e);return CO(t)?t.host:t}function RO(e){const t=MO(e);return AO(t)?e.ownerDocument?e.ownerDocument.body:e.body:OO(t)&&EO(t)?t:RO(t)}function DO(e,t,r){var n;void 0===t&&(t=[]),void 0===r&&(r=!0);const a=RO(e),s=a===(null==(n=e.ownerDocument)?void 0:n.body),i=jO(a);if(s){const e=IO(i);return t.concat(i,i.visualViewport||[],EO(a)?a:[],e&&r?DO(e):[])}return t.concat(a,DO(a,[],r))}function IO(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function LO(e){const t=TO(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=OO(e),s=a?e.offsetWidth:r,i=a?e.offsetHeight:n,o=xO(r)!==s||xO(n)!==i;return o&&(r=s,n=i),{width:r,height:n,$:o}}function FO(e){return SO(e)?e:e.contextElement}function BO(e){const t=FO(e);if(!OO(t))return yO(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:s}=LO(t);let i=(s?xO(r.width):r.width)/n,o=(s?xO(r.height):r.height)/a;return i&&Number.isFinite(i)||(i=1),o&&Number.isFinite(o)||(o=1),{x:i,y:o}}const UO=yO(0);function zO(e){const t=jO(e);return PO()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:UO}function VO(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1);const a=e.getBoundingClientRect(),s=FO(e);let i=yO(1);t&&(n?SO(n)&&(i=BO(n)):i=BO(e));const o=function(e,t,r){return void 0===t&&(t=!1),!(!r||t&&r!==jO(e))&&t}(s,r,n)?zO(s):yO(0);let l=(a.left+o.x)/i.x,c=(a.top+o.y)/i.y,d=a.width/i.x,u=a.height/i.y;if(s){const e=jO(s),t=n&&SO(n)?jO(n):n;let r=e,a=IO(r);for(;a&&n&&t!==r;){const e=BO(a),t=a.getBoundingClientRect(),n=TO(a),s=t.left+(a.clientLeft+parseFloat(n.paddingLeft))*e.x,i=t.top+(a.clientTop+parseFloat(n.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=s,c+=i,r=jO(a),a=IO(r)}}return vO({width:d,height:u,x:l,y:c})}function HO(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function WO(e,t,r,n){void 0===n&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i="function"===typeof ResizeObserver,layoutShift:o="function"===typeof IntersectionObserver,animationFrame:l=!1}=n,c=FO(e),d=a||s?[...c?DO(c):[],...DO(t)]:[];d.forEach(e=>{a&&e.addEventListener("scroll",r,{passive:!0}),s&&e.addEventListener("resize",r)});const u=c&&o?function(e,t){let r,n=null;const a=wO(e);function s(){var e;clearTimeout(r),null==(e=n)||e.disconnect(),n=null}return function i(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(o||t(),!h||!p)return;const m={rootMargin:-bO(u)+"px "+-bO(a.clientWidth-(d+h))+"px "+-bO(a.clientHeight-(u+p))+"px "+-bO(d)+"px",threshold:gO(0,fO(1,l))||1};let f=!0;function g(t){const n=t[0].intersectionRatio;if(n!==l){if(!f)return i();n?i(!1,n):r=setTimeout(()=>{i(!1,1e-7)},1e3)}1!==n||HO(c,e.getBoundingClientRect())||i(),f=!1}try{n=new IntersectionObserver(g,Ie(Ie({},m),{},{root:a.ownerDocument}))}catch(x){n=new IntersectionObserver(g,m)}n.observe(e)}(!0),s}(c,r):null;let h,p=-1,m=null;i&&(m=new ResizeObserver(e=>{let[n]=e;n&&n.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=m)||e.observe(t)})),r()}),c&&!l&&m.observe(c),m.observe(t));let f=l?VO(e):null;return l&&function t(){const n=VO(e);f&&!HO(f,n)&&r();f=n,h=requestAnimationFrame(t)}(),r(),()=>{var e;d.forEach(e=>{a&&e.removeEventListener("scroll",r),s&&e.removeEventListener("resize",r)}),null==u||u(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(h)}}var qO=s.useLayoutEffect,GO=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],$O=function(){};function KO(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function YO(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var s=[].concat(n);if(t&&e)for(var i in t)t.hasOwnProperty(i)&&t[i]&&s.push("".concat(KO(e,i)));return s.filter(function(e){return e}).map(function(e){return String(e).trim()}).join(" ")}var XO=function(e){return t=e,Array.isArray(t)?e.filter(Boolean):"object"===Te(e)&&null!==e?[e]:[];var t},JO=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,Ie({},Le(e,GO))},QO=function(e,t,r){var n=e.cx,a=e.getStyles,s=e.getClassNames,i=e.className;return{css:a(t,e),className:n(null!==r&&void 0!==r?r:{},s(t,e),i)}};function ZO(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function eC(e){return ZO(e)?window.pageYOffset:e.scrollTop}function tC(e,t){ZO(e)?window.scrollTo(0,t):e.scrollTop=t}function rC(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$O,a=eC(e),s=t-a,i=0;!function t(){var o=function(e,t,r,n){return r*((e=e/n-1)*e*e+1)+t}(i+=10,a,s,r);tC(e,o),i<r?window.requestAnimationFrame(t):n(e)}()}function nC(e,t){var r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),a=t.offsetHeight/3;n.bottom+a>r.bottom?tC(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+a,e.scrollHeight)):n.top-a<r.top&&tC(e,Math.max(t.offsetTop-a,0))}function aC(){try{return document.createEvent("TouchEvent"),!0}catch(dU){return!1}}var sC=!1,iC={get passive(){return sC=!0}},oC="undefined"!==typeof window?window:{};oC.addEventListener&&oC.removeEventListener&&(oC.addEventListener("p",$O,iC),oC.removeEventListener("p",$O,!1));var lC=sC;function cC(e){return null!=e}function dC(e,t,r){return e?t:r}var uC=["children","innerProps"],hC=["children","innerProps"];function pC(e){var t=e.maxHeight,r=e.menuEl,n=e.minHeight,a=e.placement,s=e.shouldScroll,i=e.isFixedPosition,o=e.controlHeight,l=function(e){var t=getComputedStyle(e),r="absolute"===t.position,n=/(auto|scroll)/;if("fixed"===t.position)return document.documentElement;for(var a=e;a=a.parentElement;)if(t=getComputedStyle(a),(!r||"static"!==t.position)&&n.test(t.overflow+t.overflowY+t.overflowX))return a;return document.documentElement}(r),c={placement:"bottom",maxHeight:t};if(!r||!r.offsetParent)return c;var d,u=l.getBoundingClientRect().height,h=r.getBoundingClientRect(),p=h.bottom,m=h.height,f=h.top,g=r.offsetParent.getBoundingClientRect().top,x=i?window.innerHeight:ZO(d=l)?window.innerHeight:d.clientHeight,b=eC(l),y=parseInt(getComputedStyle(r).marginBottom,10),v=parseInt(getComputedStyle(r).marginTop,10),_=g-v,k=x-f,j=_+b,w=u-b-f,N=p-x+b+y,S=b+f-v,O=160;switch(a){case"auto":case"bottom":if(k>=m)return{placement:"bottom",maxHeight:t};if(w>=m&&!i)return s&&rC(l,N,O),{placement:"bottom",maxHeight:t};if(!i&&w>=n||i&&k>=n)return s&&rC(l,N,O),{placement:"bottom",maxHeight:i?k-y:w-y};if("auto"===a||i){var C=t,E=i?_:j;return E>=n&&(C=Math.min(E-y-o,t)),{placement:"top",maxHeight:C}}if("bottom"===a)return s&&tC(l,N),{placement:"bottom",maxHeight:t};break;case"top":if(_>=m)return{placement:"top",maxHeight:t};if(j>=m&&!i)return s&&rC(l,S,O),{placement:"top",maxHeight:t};if(!i&&j>=n||i&&_>=n){var P=t;return(!i&&j>=n||i&&_>=n)&&(P=i?_-v:j-v),s&&rC(l,S,O),{placement:"top",maxHeight:P}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return c}var mC,fC=function(e){return"auto"===e?"bottom":e},gC=(0,s.createContext)(null),xC=function(e){var t=e.children,r=e.minMenuHeight,n=e.maxMenuHeight,a=e.menuPlacement,i=e.menuPosition,o=e.menuShouldScrollIntoView,l=e.theme,c=((0,s.useContext)(gC)||{}).setPortalPlacement,d=(0,s.useRef)(null),u=TN((0,s.useState)(n),2),h=u[0],p=u[1],m=TN((0,s.useState)(null),2),f=m[0],g=m[1],x=l.spacing.controlHeight;return qO(function(){var e=d.current;if(e){var t="fixed"===i,s=pC({maxHeight:n,menuEl:e,minHeight:r,placement:a,shouldScroll:o&&!t,isFixedPosition:t,controlHeight:x});p(s.maxHeight),g(s.placement),null===c||void 0===c||c(s.placement)}},[n,a,i,o,r,c,x]),t({ref:d,placerProps:Ie(Ie({},e),{},{placement:f||fC(a),maxHeight:h})})},bC=function(e){var t=e.children,r=e.innerRef,n=e.innerProps;return pO("div",RN({},QO(e,"menu",{menu:!0}),{ref:r},n),t)},yC=function(e,t){var r=e.theme,n=r.spacing.baseUnit,a=r.colors;return Ie({textAlign:"center"},t?{}:{color:a.neutral40,padding:"".concat(2*n,"px ").concat(3*n,"px")})},vC=yC,_C=yC,kC=["size"],jC=["innerProps","isRtl","size"];var wC={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},NC=function(e){var t=e.size,r=Le(e,kC);return pO("svg",RN({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:wC},r))},SC=function(e){return pO(NC,RN({size:20},e),pO("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},OC=function(e){return pO(NC,RN({size:20},e),pO("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},CC=function(e,t){var r=e.isFocused,n=e.theme,a=n.spacing.baseUnit,s=n.colors;return Ie({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?s.neutral60:s.neutral20,padding:2*a,":hover":{color:r?s.neutral80:s.neutral40}})},EC=CC,PC=CC,AC=function(){var e=mO.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(mC||(mC=jl(["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"]))),TC=function(e){var t=e.delay,r=e.offset;return pO("span",{css:mO({animation:"".concat(AC," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},MC=function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,a=e.innerRef,s=e.innerProps,i=e.menuIsOpen;return pO("div",RN({ref:a},QO(e,"control",{control:!0,"control--is-disabled":r,"control--is-focused":n,"control--menu-is-open":i}),s,{"aria-disabled":r||void 0}),t)},RC=["data"],DC=function(e){var t=e.children,r=e.cx,n=e.getStyles,a=e.getClassNames,s=e.Heading,i=e.headingProps,o=e.innerProps,l=e.label,c=e.theme,d=e.selectProps;return pO("div",RN({},QO(e,"group",{group:!0}),o),pO(s,RN({},i,{selectProps:d,theme:c,getStyles:n,getClassNames:a,cx:r}),l),pO("div",null,t))},IC=["innerRef","isDisabled","isHidden","inputClassName"],LC={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},FC={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ie({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},LC)},BC=function(e){return Ie({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},LC)},UC=function(e){var t=e.cx,r=e.value,n=JO(e),a=n.innerRef,s=n.isDisabled,i=n.isHidden,o=n.inputClassName,l=Le(n,IC);return pO("div",RN({},QO(e,"input",{"input-container":!0}),{"data-value":r||""}),pO("input",RN({className:t({input:!0},o),ref:a,style:BC(i),disabled:s},l)))},zC=function(e){var t=e.children,r=e.innerProps;return pO("div",r,t)};var VC=function(e){var t=e.children,r=e.components,n=e.data,a=e.innerProps,s=e.isDisabled,i=e.removeProps,o=e.selectProps,l=r.Container,c=r.Label,d=r.Remove;return pO(l,{data:n,innerProps:Ie(Ie({},QO(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":s})),a),selectProps:o},pO(c,{data:n,innerProps:Ie({},QO(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:o},t),pO(d,{data:n,innerProps:Ie(Ie({},QO(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},i),selectProps:o}))},HC={ClearIndicator:function(e){var t=e.children,r=e.innerProps;return pO("div",RN({},QO(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||pO(SC,null))},Control:MC,DropdownIndicator:function(e){var t=e.children,r=e.innerProps;return pO("div",RN({},QO(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||pO(OC,null))},DownChevron:OC,CrossIcon:SC,Group:DC,GroupHeading:function(e){var t=JO(e);t.data;var r=Le(t,RC);return pO("div",RN({},QO(e,"groupHeading",{"group-heading":!0}),r))},IndicatorsContainer:function(e){var t=e.children,r=e.innerProps;return pO("div",RN({},QO(e,"indicatorsContainer",{indicators:!0}),r),t)},IndicatorSeparator:function(e){var t=e.innerProps;return pO("span",RN({},t,QO(e,"indicatorSeparator",{"indicator-separator":!0})))},Input:UC,LoadingIndicator:function(e){var t=e.innerProps,r=e.isRtl,n=e.size,a=void 0===n?4:n,s=Le(e,jC);return pO("div",RN({},QO(Ie(Ie({},s),{},{innerProps:t,isRtl:r,size:a}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),pO(TC,{delay:0,offset:r}),pO(TC,{delay:160,offset:!0}),pO(TC,{delay:320,offset:!r}))},Menu:bC,MenuList:function(e){var t=e.children,r=e.innerProps,n=e.innerRef,a=e.isMulti;return pO("div",RN({},QO(e,"menuList",{"menu-list":!0,"menu-list--is-multi":a}),{ref:n},r),t)},MenuPortal:function(e){var t=e.appendTo,r=e.children,n=e.controlElement,a=e.innerProps,i=e.menuPlacement,o=e.menuPosition,c=(0,s.useRef)(null),d=(0,s.useRef)(null),u=TN((0,s.useState)(fC(i)),2),h=u[0],p=u[1],m=(0,s.useMemo)(function(){return{setPortalPlacement:p}},[]),f=TN((0,s.useState)(null),2),g=f[0],x=f[1],b=(0,s.useCallback)(function(){if(n){var e=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(n),t="fixed"===o?0:window.pageYOffset,r=e[h]+t;r===(null===g||void 0===g?void 0:g.offset)&&e.left===(null===g||void 0===g?void 0:g.rect.left)&&e.width===(null===g||void 0===g?void 0:g.rect.width)||x({offset:r,rect:e})}},[n,o,h,null===g||void 0===g?void 0:g.offset,null===g||void 0===g?void 0:g.rect.left,null===g||void 0===g?void 0:g.rect.width]);qO(function(){b()},[b]);var y=(0,s.useCallback)(function(){"function"===typeof d.current&&(d.current(),d.current=null),n&&c.current&&(d.current=WO(n,c.current,b,{elementResize:"ResizeObserver"in window}))},[n,b]);qO(function(){y()},[y]);var v=(0,s.useCallback)(function(e){c.current=e,y()},[y]);if(!t&&"fixed"!==o||!g)return null;var _=pO("div",RN({ref:v},QO(Ie(Ie({},e),{},{offset:g.offset,position:o,rect:g.rect}),"menuPortal",{"menu-portal":!0}),a),r);return pO(gC.Provider,{value:m},t?(0,l.createPortal)(_,t):_)},LoadingMessage:function(e){var t=e.children,r=void 0===t?"Loading...":t,n=e.innerProps,a=Le(e,hC);return pO("div",RN({},QO(Ie(Ie({},a),{},{children:r,innerProps:n}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),r)},NoOptionsMessage:function(e){var t=e.children,r=void 0===t?"No options":t,n=e.innerProps,a=Le(e,uC);return pO("div",RN({},QO(Ie(Ie({},a),{},{children:r,innerProps:n}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),r)},MultiValue:VC,MultiValueContainer:zC,MultiValueLabel:zC,MultiValueRemove:function(e){var t=e.children,r=e.innerProps;return pO("div",RN({role:"button"},r),t||pO(SC,{size:14}))},Option:function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,a=e.isSelected,s=e.innerRef,i=e.innerProps;return pO("div",RN({},QO(e,"option",{option:!0,"option--is-disabled":r,"option--is-focused":n,"option--is-selected":a}),{ref:s,"aria-disabled":r},i),t)},Placeholder:function(e){var t=e.children,r=e.innerProps;return pO("div",RN({},QO(e,"placeholder",{placeholder:!0}),r),t)},SelectContainer:function(e){var t=e.children,r=e.innerProps,n=e.isDisabled,a=e.isRtl;return pO("div",RN({},QO(e,"container",{"--is-disabled":n,"--is-rtl":a}),r),t)},SingleValue:function(e){var t=e.children,r=e.isDisabled,n=e.innerProps;return pO("div",RN({},QO(e,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),n),t)},ValueContainer:function(e){var t=e.children,r=e.innerProps,n=e.isMulti,a=e.hasValue;return pO("div",RN({},QO(e,"valueContainer",{"value-container":!0,"value-container--is-multi":n,"value-container--has-value":a}),r),t)}},WC=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function qC(e,t){return e===t||!(!WC(e)||!WC(t))}function GC(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!qC(e[r],t[r]))return!1;return!0}for(var $C={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},KC=function(e){return pO("span",RN({css:$C},e))},YC={guidance:function(e){var t=e.isSearchable,r=e.isMulti,n=e.tabSelectsValue,a=e.context,s=e.isInitialFocus;switch(a){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(n?", press Tab to select the option and exit the menu":"",".");case"input":return s?"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,r=e.label,n=void 0===r?"":r,a=e.labels,s=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(a.length>1?"s":""," ").concat(a.join(","),", selected.");case"select-option":return"option ".concat(n,s?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(e){var t=e.context,r=e.focused,n=e.options,a=e.label,s=void 0===a?"":a,i=e.selectValue,o=e.isDisabled,l=e.isSelected,c=e.isAppleDevice,d=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&i)return"value ".concat(s," focused, ").concat(d(i,r),".");if("menu"===t&&c){var u=o?" disabled":"",h="".concat(l?" selected":"").concat(u);return"".concat(s).concat(h,", ").concat(d(n,r),".")}return""},onFilter:function(e){var t=e.inputValue,r=e.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},XC=function(e){var t=e.ariaSelection,r=e.focusedOption,n=e.focusedValue,a=e.focusableOptions,i=e.isFocused,o=e.selectValue,l=e.selectProps,c=e.id,d=e.isAppleDevice,u=l.ariaLiveMessages,h=l.getOptionLabel,p=l.inputValue,m=l.isMulti,f=l.isOptionDisabled,g=l.isSearchable,x=l.menuIsOpen,b=l.options,y=l.screenReaderStatus,v=l.tabSelectsValue,_=l.isLoading,k=l["aria-label"],j=l["aria-live"],w=(0,s.useMemo)(function(){return Ie(Ie({},YC),u||{})},[u]),N=(0,s.useMemo)(function(){var e,r="";if(t&&w.onChange){var n=t.option,a=t.options,s=t.removedValue,i=t.removedValues,l=t.value,c=s||n||(e=l,Array.isArray(e)?null:e),d=c?h(c):"",u=a||i||void 0,p=u?u.map(h):[],m=Ie({isDisabled:c&&f(c,o),label:d,labels:p},t);r=w.onChange(m)}return r},[t,w,f,o,h]),S=(0,s.useMemo)(function(){var e="",t=r||n,s=!!(r&&o&&o.includes(r));if(t&&w.onFocus){var i={focused:t,label:h(t),isDisabled:f(t,o),isSelected:s,options:a,context:t===r?"menu":"value",selectValue:o,isAppleDevice:d};e=w.onFocus(i)}return e},[r,n,h,f,w,a,o,d]),O=(0,s.useMemo)(function(){var e="";if(x&&b.length&&!_&&w.onFilter){var t=y({count:a.length});e=w.onFilter({inputValue:p,resultsMessage:t})}return e},[a,p,x,w,b,y,_]),C="initial-input-focus"===(null===t||void 0===t?void 0:t.action),E=(0,s.useMemo)(function(){var e="";if(w.guidance){var t=n?"value":x?"menu":"input";e=w.guidance({"aria-label":k,context:t,isDisabled:r&&f(r,o),isMulti:m,isSearchable:g,tabSelectsValue:v,isInitialFocus:C})}return e},[k,r,n,m,f,g,x,w,o,v,C]),P=pO(s.Fragment,null,pO("span",{id:"aria-selection"},N),pO("span",{id:"aria-focused"},S),pO("span",{id:"aria-results"},O),pO("span",{id:"aria-guidance"},E));return pO(s.Fragment,null,pO(KC,{id:c},C&&P),pO(KC,{"aria-live":j,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},i&&!C&&P))},JC=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],QC=new RegExp("["+JC.map(function(e){return e.letters}).join("")+"]","g"),ZC={},eE=0;eE<JC.length;eE++)for(var tE=JC[eE],rE=0;rE<tE.letters.length;rE++)ZC[tE.letters[rE]]=tE.base;var nE=function(e){return e.replace(QC,function(e){return ZC[e]})},aE=function(e,t){void 0===t&&(t=GC);var r=null;function n(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(r&&r.lastThis===this&&t(n,r.lastArgs))return r.lastResult;var s=e.apply(this,n);return r={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){r=null},n}(nE),sE=function(e){return e.replace(/^\s+|\s+$/g,"")},iE=function(e){return"".concat(e.label," ").concat(e.value)},oE=["innerRef"];function lE(e){var t=e.innerRef,r=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=Object.entries(e).filter(function(e){var t=TN(e,1)[0];return!r.includes(t)});return a.reduce(function(e,t){var r=TN(t,2),n=r[0],a=r[1];return e[n]=a,e},{})}(Le(e,oE),"onExited","in","enter","exit","appear");return pO("input",RN({ref:t},r,{css:mO({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var cE=["boxSizing","height","overflow","paddingRight","position"],dE={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function uE(e){e.cancelable&&e.preventDefault()}function hE(e){e.stopPropagation()}function pE(){var e=this.scrollTop,t=this.scrollHeight,r=e+this.offsetHeight;0===e?this.scrollTop=1:r===t&&(this.scrollTop=e-1)}function mE(){return"ontouchstart"in window||navigator.maxTouchPoints}var fE=!("undefined"===typeof window||!window.document||!window.document.createElement),gE=0,xE={capture:!1,passive:!1};var bE=function(e){var t=e.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},yE={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function vE(e){var t=e.children,r=e.lockEnabled,n=e.captureEnabled,a=function(e){var t=e.isEnabled,r=e.onBottomArrive,n=e.onBottomLeave,a=e.onTopArrive,i=e.onTopLeave,o=(0,s.useRef)(!1),l=(0,s.useRef)(!1),c=(0,s.useRef)(0),d=(0,s.useRef)(null),u=(0,s.useCallback)(function(e,t){if(null!==d.current){var s=d.current,c=s.scrollTop,u=s.scrollHeight,h=s.clientHeight,p=d.current,m=t>0,f=u-h-c,g=!1;f>t&&o.current&&(n&&n(e),o.current=!1),m&&l.current&&(i&&i(e),l.current=!1),m&&t>f?(r&&!o.current&&r(e),p.scrollTop=u,g=!0,o.current=!0):!m&&-t>c&&(a&&!l.current&&a(e),p.scrollTop=0,g=!0,l.current=!0),g&&function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()}(e)}},[r,n,a,i]),h=(0,s.useCallback)(function(e){u(e,e.deltaY)},[u]),p=(0,s.useCallback)(function(e){c.current=e.changedTouches[0].clientY},[]),m=(0,s.useCallback)(function(e){var t=c.current-e.changedTouches[0].clientY;u(e,t)},[u]),f=(0,s.useCallback)(function(e){if(e){var t=!!lC&&{passive:!1};e.addEventListener("wheel",h,t),e.addEventListener("touchstart",p,t),e.addEventListener("touchmove",m,t)}},[m,p,h]),g=(0,s.useCallback)(function(e){e&&(e.removeEventListener("wheel",h,!1),e.removeEventListener("touchstart",p,!1),e.removeEventListener("touchmove",m,!1))},[m,p,h]);return(0,s.useEffect)(function(){if(t){var e=d.current;return f(e),function(){g(e)}}},[t,f,g]),function(e){d.current=e}}({isEnabled:void 0===n||n,onBottomArrive:e.onBottomArrive,onBottomLeave:e.onBottomLeave,onTopArrive:e.onTopArrive,onTopLeave:e.onTopLeave}),i=function(e){var t=e.isEnabled,r=e.accountForScrollbars,n=void 0===r||r,a=(0,s.useRef)({}),i=(0,s.useRef)(null),o=(0,s.useCallback)(function(e){if(fE){var t=document.body,r=t&&t.style;if(n&&cE.forEach(function(e){var t=r&&r[e];a.current[e]=t}),n&&gE<1){var s=parseInt(a.current.paddingRight,10)||0,i=document.body?document.body.clientWidth:0,o=window.innerWidth-i+s||0;Object.keys(dE).forEach(function(e){var t=dE[e];r&&(r[e]=t)}),r&&(r.paddingRight="".concat(o,"px"))}t&&mE()&&(t.addEventListener("touchmove",uE,xE),e&&(e.addEventListener("touchstart",pE,xE),e.addEventListener("touchmove",hE,xE))),gE+=1}},[n]),l=(0,s.useCallback)(function(e){if(fE){var t=document.body,r=t&&t.style;gE=Math.max(gE-1,0),n&&gE<1&&cE.forEach(function(e){var t=a.current[e];r&&(r[e]=t)}),t&&mE()&&(t.removeEventListener("touchmove",uE,xE),e&&(e.removeEventListener("touchstart",pE,xE),e.removeEventListener("touchmove",hE,xE)))}},[n]);return(0,s.useEffect)(function(){if(t){var e=i.current;return o(e),function(){l(e)}}},[t,o,l]),function(e){i.current=e}}({isEnabled:r});return pO(s.Fragment,null,r&&pO("div",{onClick:bE,css:yE}),t(function(e){a(e),i(e)}))}var _E={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},kE=function(e){var t=e.name,r=e.onFocus;return pO("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:_E,value:"",onChange:function(){}})};function jE(e){var t;return"undefined"!==typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function wE(){return jE(/^Mac/i)}function NE(){return jE(/^iPhone/i)||jE(/^iPad/i)||wE()&&navigator.maxTouchPoints>1}var SE={clearIndicator:PC,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},control:function(e,t){var r=e.isDisabled,n=e.isFocused,a=e.theme,s=a.colors,i=a.borderRadius;return Ie({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:a.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?s.neutral5:s.neutral0,borderColor:r?s.neutral10:n?s.primary:s.neutral20,borderRadius:i,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(s.primary):void 0,"&:hover":{borderColor:n?s.primary:s.neutral30}})},dropdownIndicator:EC,group:function(e,t){var r=e.theme.spacing;return t?{}:{paddingBottom:2*r.baseUnit,paddingTop:2*r.baseUnit}},groupHeading:function(e,t){var r=e.theme,n=r.colors,a=r.spacing;return Ie({label:"group",cursor:"default",display:"block"},t?{}:{color:n.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*a.baseUnit,paddingRight:3*a.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e,t){var r=e.isDisabled,n=e.theme,a=n.spacing.baseUnit,s=n.colors;return Ie({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?s.neutral10:s.neutral20,marginBottom:2*a,marginTop:2*a})},input:function(e,t){var r=e.isDisabled,n=e.value,a=e.theme,s=a.spacing,i=a.colors;return Ie(Ie({visibility:r?"hidden":"visible",transform:n?"translateZ(0)":""},FC),t?{}:{margin:s.baseUnit/2,paddingBottom:s.baseUnit/2,paddingTop:s.baseUnit/2,color:i.neutral80})},loadingIndicator:function(e,t){var r=e.isFocused,n=e.size,a=e.theme,s=a.colors,i=a.spacing.baseUnit;return Ie({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?s.neutral60:s.neutral20,padding:2*i})},loadingMessage:_C,menu:function(e,t){var r,n=e.placement,a=e.theme,s=a.borderRadius,i=a.spacing,o=a.colors;return Ie((Re(r={label:"menu"},function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(n),"100%"),Re(r,"position","absolute"),Re(r,"width","100%"),Re(r,"zIndex",1),r),t?{}:{backgroundColor:o.neutral0,borderRadius:s,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:i.menuGutter,marginTop:i.menuGutter})},menuList:function(e,t){var r=e.maxHeight,n=e.theme.spacing.baseUnit;return Ie({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:n,paddingTop:n})},menuPortal:function(e){var t=e.rect,r=e.offset,n=e.position;return{left:t.left,position:n,top:r,width:t.width,zIndex:1}},multiValue:function(e,t){var r=e.theme,n=r.spacing,a=r.borderRadius,s=r.colors;return Ie({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:s.neutral10,borderRadius:a/2,margin:n.baseUnit/2})},multiValueLabel:function(e,t){var r=e.theme,n=r.borderRadius,a=r.colors,s=e.cropWithEllipsis;return Ie({overflow:"hidden",textOverflow:s||void 0===s?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:n/2,color:a.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(e,t){var r=e.theme,n=r.spacing,a=r.borderRadius,s=r.colors,i=e.isFocused;return Ie({alignItems:"center",display:"flex"},t?{}:{borderRadius:a/2,backgroundColor:i?s.dangerLight:void 0,paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:s.dangerLight,color:s.danger}})},noOptionsMessage:vC,option:function(e,t){var r=e.isDisabled,n=e.isFocused,a=e.isSelected,s=e.theme,i=s.spacing,o=s.colors;return Ie({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:a?o.primary:n?o.primary25:"transparent",color:r?o.neutral20:a?o.neutral0:"inherit",padding:"".concat(2*i.baseUnit,"px ").concat(3*i.baseUnit,"px"),":active":{backgroundColor:r?void 0:a?o.primary:o.primary50}})},placeholder:function(e,t){var r=e.theme,n=r.spacing,a=r.colors;return Ie({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:a.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2})},singleValue:function(e,t){var r=e.isDisabled,n=e.theme,a=n.spacing,s=n.colors;return Ie({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?s.neutral40:s.neutral80,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},valueContainer:function(e,t){var r=e.theme.spacing,n=e.isMulti,a=e.hasValue,s=e.selectProps.controlShouldRenderValue;return Ie({alignItems:"center",display:n&&a&&s?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(2*r.baseUnit,"px")})}};var OE,CE={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},EE={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:aC(),captureMenuScroll:!aC(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e,t){if(e.data.__isNew__)return!0;var r=Ie({ignoreCase:!0,ignoreAccents:!0,stringify:iE,trim:!0,matchFrom:"any"},OE),n=r.ignoreCase,a=r.ignoreAccents,s=r.stringify,i=r.trim,o=r.matchFrom,l=i?sE(t):t,c=i?sE(s(e)):s(e);return n&&(l=l.toLowerCase(),c=c.toLowerCase()),a&&(l=aE(l),c=nE(c)),"start"===o?c.substr(0,l.length)===l:c.indexOf(l)>-1},formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(dU){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function PE(e,t,r,n){return{type:"option",data:t,isDisabled:FE(e,t,r),isSelected:BE(e,t,r),label:IE(e,t),value:LE(e,t),index:n}}function AE(e,t){return e.options.map(function(r,n){if("options"in r){var a=r.options.map(function(r,n){return PE(e,r,t,n)}).filter(function(t){return RE(e,t)});return a.length>0?{type:"group",data:r,options:a,index:n}:void 0}var s=PE(e,r,t,n);return RE(e,s)?s:void 0}).filter(cC)}function TE(e){return e.reduce(function(e,t){return"group"===t.type?e.push.apply(e,UN(t.options.map(function(e){return e.data}))):e.push(t.data),e},[])}function ME(e,t){return e.reduce(function(e,r){return"group"===r.type?e.push.apply(e,UN(r.options.map(function(e){return{data:e.data,id:"".concat(t,"-").concat(r.index,"-").concat(e.index)}}))):e.push({data:r.data,id:"".concat(t,"-").concat(r.index)}),e},[])}function RE(e,t){var r=e.inputValue,n=void 0===r?"":r,a=t.data,s=t.isSelected,i=t.label,o=t.value;return(!zE(e)||!s)&&UE(e,{label:i,value:o,data:a},n)}var DE=function(e,t){var r;return(null===(r=e.find(function(e){return e.data===t}))||void 0===r?void 0:r.id)||null},IE=function(e,t){return e.getOptionLabel(t)},LE=function(e,t){return e.getOptionValue(t)};function FE(e,t,r){return"function"===typeof e.isOptionDisabled&&e.isOptionDisabled(t,r)}function BE(e,t,r){if(r.indexOf(t)>-1)return!0;if("function"===typeof e.isOptionSelected)return e.isOptionSelected(t,r);var n=LE(e,t);return r.some(function(t){return LE(e,t)===n})}function UE(e,t,r){return!e.filterOption||e.filterOption(t,r)}var zE=function(e){var t=e.hideSelectedOptions,r=e.isMulti;return void 0===t?r:t},VE=1,HE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IN(e,t)}(r,e);var t=function(e){var t=FN();return function(){var r,n=LN(e);if(t){var a=LN(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return BN(this,r)}}(r);function r(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},n.blockOptionHover=!1,n.isComposing=!1,n.commonProps=void 0,n.initialTouchX=0,n.initialTouchY=0,n.openAfterFocus=!1,n.scrollToFocusedOptionOnUpdate=!1,n.userIsDragging=void 0,n.isAppleDevice=wE()||NE(),n.controlRef=null,n.getControlRef=function(e){n.controlRef=e},n.focusedOptionRef=null,n.getFocusedOptionRef=function(e){n.focusedOptionRef=e},n.menuListRef=null,n.getMenuListRef=function(e){n.menuListRef=e},n.inputRef=null,n.getInputRef=function(e){n.inputRef=e},n.focus=n.focusInput,n.blur=n.blurInput,n.onChange=function(e,t){var r=n.props,a=r.onChange,s=r.name;t.name=s,n.ariaOnChange(e,t),a(e,t)},n.setValue=function(e,t,r){var a=n.props,s=a.closeMenuOnSelect,i=a.isMulti,o=a.inputValue;n.onInputChange("",{action:"set-value",prevInputValue:o}),s&&(n.setState({inputIsHiddenAfterUpdate:!i}),n.onMenuClose()),n.setState({clearFocusValueOnUpdate:!0}),n.onChange(e,{action:t,option:r})},n.selectOption=function(e){var t=n.props,r=t.blurInputOnSelect,a=t.isMulti,s=t.name,i=n.state.selectValue,o=a&&n.isOptionSelected(e,i),l=n.isOptionDisabled(e,i);if(o){var c=n.getOptionValue(e);n.setValue(i.filter(function(e){return n.getOptionValue(e)!==c}),"deselect-option",e)}else{if(l)return void n.ariaOnChange(e,{action:"select-option",option:e,name:s});a?n.setValue([].concat(UN(i),[e]),"select-option",e):n.setValue(e,"select-option")}r&&n.blurInput()},n.removeValue=function(e){var t=n.props.isMulti,r=n.state.selectValue,a=n.getOptionValue(e),s=r.filter(function(e){return n.getOptionValue(e)!==a}),i=dC(t,s,s[0]||null);n.onChange(i,{action:"remove-value",removedValue:e}),n.focusInput()},n.clearValue=function(){var e=n.state.selectValue;n.onChange(dC(n.props.isMulti,[],null),{action:"clear",removedValues:e})},n.popValue=function(){var e=n.props.isMulti,t=n.state.selectValue,r=t[t.length-1],a=t.slice(0,t.length-1),s=dC(e,a,a[0]||null);r&&n.onChange(s,{action:"pop-value",removedValue:r})},n.getFocusedOptionId=function(e){return DE(n.state.focusableOptionsWithIds,e)},n.getFocusableOptionsWithIds=function(){return ME(AE(n.props,n.state.selectValue),n.getElementId("option"))},n.getValue=function(){return n.state.selectValue},n.cx=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return YO.apply(void 0,[n.props.classNamePrefix].concat(t))},n.getOptionLabel=function(e){return IE(n.props,e)},n.getOptionValue=function(e){return LE(n.props,e)},n.getStyles=function(e,t){var r=n.props.unstyled,a=SE[e](t,r);a.boxSizing="border-box";var s=n.props.styles[e];return s?s(a,t):a},n.getClassNames=function(e,t){var r,a;return null===(r=(a=n.props.classNames)[e])||void 0===r?void 0:r.call(a,t)},n.getElementId=function(e){return"".concat(n.state.instancePrefix,"-").concat(e)},n.getComponents=function(){return e=n.props,Ie(Ie({},HC),e.components);var e},n.buildCategorizedOptions=function(){return AE(n.props,n.state.selectValue)},n.getCategorizedOptions=function(){return n.props.menuIsOpen?n.buildCategorizedOptions():[]},n.buildFocusableOptions=function(){return TE(n.buildCategorizedOptions())},n.getFocusableOptions=function(){return n.props.menuIsOpen?n.buildFocusableOptions():[]},n.ariaOnChange=function(e,t){n.setState({ariaSelection:Ie({value:e},t)})},n.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),n.focusInput())},n.onMenuMouseMove=function(e){n.blockOptionHover=!1},n.onControlMouseDown=function(e){if(!e.defaultPrevented){var t=n.props.openMenuOnClick;n.state.isFocused?n.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&n.onMenuClose():t&&n.openMenu("first"):(t&&(n.openAfterFocus=!0),n.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()}},n.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!n.props.isDisabled){var t=n.props,r=t.isMulti,a=t.menuIsOpen;n.focusInput(),a?(n.setState({inputIsHiddenAfterUpdate:!r}),n.onMenuClose()):n.openMenu("first"),e.preventDefault()}},n.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(n.clearValue(),e.preventDefault(),n.openAfterFocus=!1,"touchend"===e.type?n.focusInput():setTimeout(function(){return n.focusInput()}))},n.onScroll=function(e){"boolean"===typeof n.props.closeMenuOnScroll?e.target instanceof HTMLElement&&ZO(e.target)&&n.props.onMenuClose():"function"===typeof n.props.closeMenuOnScroll&&n.props.closeMenuOnScroll(e)&&n.props.onMenuClose()},n.onCompositionStart=function(){n.isComposing=!0},n.onCompositionEnd=function(){n.isComposing=!1},n.onTouchStart=function(e){var t=e.touches,r=t&&t.item(0);r&&(n.initialTouchX=r.clientX,n.initialTouchY=r.clientY,n.userIsDragging=!1)},n.onTouchMove=function(e){var t=e.touches,r=t&&t.item(0);if(r){var a=Math.abs(r.clientX-n.initialTouchX),s=Math.abs(r.clientY-n.initialTouchY);n.userIsDragging=a>5||s>5}},n.onTouchEnd=function(e){n.userIsDragging||(n.controlRef&&!n.controlRef.contains(e.target)&&n.menuListRef&&!n.menuListRef.contains(e.target)&&n.blurInput(),n.initialTouchX=0,n.initialTouchY=0)},n.onControlTouchEnd=function(e){n.userIsDragging||n.onControlMouseDown(e)},n.onClearIndicatorTouchEnd=function(e){n.userIsDragging||n.onClearIndicatorMouseDown(e)},n.onDropdownIndicatorTouchEnd=function(e){n.userIsDragging||n.onDropdownIndicatorMouseDown(e)},n.handleInputChange=function(e){var t=n.props.inputValue,r=e.currentTarget.value;n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange(r,{action:"input-change",prevInputValue:t}),n.props.menuIsOpen||n.onMenuOpen()},n.onInputFocus=function(e){n.props.onFocus&&n.props.onFocus(e),n.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(n.openAfterFocus||n.props.openMenuOnFocus)&&n.openMenu("first"),n.openAfterFocus=!1},n.onInputBlur=function(e){var t=n.props.inputValue;n.menuListRef&&n.menuListRef.contains(document.activeElement)?n.inputRef.focus():(n.props.onBlur&&n.props.onBlur(e),n.onInputChange("",{action:"input-blur",prevInputValue:t}),n.onMenuClose(),n.setState({focusedValue:null,isFocused:!1}))},n.onOptionHover=function(e){if(!n.blockOptionHover&&n.state.focusedOption!==e){var t=n.getFocusableOptions().indexOf(e);n.setState({focusedOption:e,focusedOptionId:t>-1?n.getFocusedOptionId(e):null})}},n.shouldHideSelectedOptions=function(){return zE(n.props)},n.onValueInputFocus=function(e){e.preventDefault(),e.stopPropagation(),n.focus()},n.onKeyDown=function(e){var t=n.props,r=t.isMulti,a=t.backspaceRemovesValue,s=t.escapeClearsValue,i=t.inputValue,o=t.isClearable,l=t.isDisabled,c=t.menuIsOpen,d=t.onKeyDown,u=t.tabSelectsValue,h=t.openMenuOnFocus,p=n.state,m=p.focusedOption,f=p.focusedValue,g=p.selectValue;if(!l&&("function"!==typeof d||(d(e),!e.defaultPrevented))){switch(n.blockOptionHover=!0,e.key){case"ArrowLeft":if(!r||i)return;n.focusValue("previous");break;case"ArrowRight":if(!r||i)return;n.focusValue("next");break;case"Delete":case"Backspace":if(i)return;if(f)n.removeValue(f);else{if(!a)return;r?n.popValue():o&&n.clearValue()}break;case"Tab":if(n.isComposing)return;if(e.shiftKey||!c||!u||!m||h&&n.isOptionSelected(m,g))return;n.selectOption(m);break;case"Enter":if(229===e.keyCode)break;if(c){if(!m)return;if(n.isComposing)return;n.selectOption(m);break}return;case"Escape":c?(n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange("",{action:"menu-close",prevInputValue:i}),n.onMenuClose()):o&&s&&n.clearValue();break;case" ":if(i)return;if(!c){n.openMenu("first");break}if(!m)return;n.selectOption(m);break;case"ArrowUp":c?n.focusOption("up"):n.openMenu("last");break;case"ArrowDown":c?n.focusOption("down"):n.openMenu("first");break;case"PageUp":if(!c)return;n.focusOption("pageup");break;case"PageDown":if(!c)return;n.focusOption("pagedown");break;case"Home":if(!c)return;n.focusOption("first");break;case"End":if(!c)return;n.focusOption("last");break;default:return}e.preventDefault()}},n.state.instancePrefix="react-select-"+(n.props.instanceId||++VE),n.state.selectValue=XO(e.value),e.menuIsOpen&&n.state.selectValue.length){var a=n.getFocusableOptionsWithIds(),s=n.buildFocusableOptions(),i=s.indexOf(n.state.selectValue[0]);n.state.focusableOptionsWithIds=a,n.state.focusedOption=s[i],n.state.focusedOptionId=DE(a,s[i])}return n}return function(e,t,r){t&&DN(e.prototype,t),r&&DN(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&nC(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.isDisabled,n=t.menuIsOpen,a=this.state.isFocused;(a&&!r&&e.isDisabled||a&&n&&!e.menuIsOpen)&&this.focusInput(),a&&r&&!e.isDisabled?this.setState({isFocused:!1},this.onMenuClose):a||r||!e.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(nC(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,r=this.state,n=r.selectValue,a=r.isFocused,s=this.buildFocusableOptions(),i="first"===e?0:s.length-1;if(!this.props.isMulti){var o=s.indexOf(n[0]);o>-1&&(i=o)}this.scrollToFocusedOptionOnUpdate=!(a&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:s[i],focusedOptionId:this.getFocusedOptionId(s[i])},function(){return t.onMenuOpen()})}},{key:"focusValue",value:function(e){var t=this.state,r=t.selectValue,n=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var a=r.indexOf(n);n||(a=-1);var s=r.length-1,i=-1;if(r.length){switch(e){case"previous":i=0===a?0:-1===a?s:a-1;break;case"next":a>-1&&a<s&&(i=a+1)}this.setState({inputIsHidden:-1!==i,focusedValue:r[i]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,r=this.state.focusedOption,n=this.getFocusableOptions();if(n.length){var a=0,s=n.indexOf(r);r||(s=-1),"up"===e?a=s>0?s-1:n.length-1:"down"===e?a=(s+1)%n.length:"pageup"===e?(a=s-t)<0&&(a=0):"pagedown"===e?(a=s+t)>n.length-1&&(a=n.length-1):"last"===e&&(a=n.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:n[a],focusedValue:null,focusedOptionId:this.getFocusedOptionId(n[a])})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(CE):Ie(Ie({},CE),this.props.theme):CE}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,r=this.getStyles,n=this.getClassNames,a=this.getValue,s=this.selectOption,i=this.setValue,o=this.props,l=o.isMulti,c=o.isRtl,d=o.options;return{clearValue:e,cx:t,getStyles:r,getClassNames:n,getValue:a,hasValue:this.hasValue(),isMulti:l,isRtl:c,options:d,selectOption:s,selectProps:o,setValue:i,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,r=e.isMulti;return void 0===t?r:t}},{key:"isOptionDisabled",value:function(e,t){return FE(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return BE(this.props,e,t)}},{key:"filterOption",value:function(e,t){return UE(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var r=this.props.inputValue,n=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:r,selectValue:n})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var e=this.props,t=e.isDisabled,r=e.isSearchable,n=e.inputId,a=e.inputValue,i=e.tabIndex,o=e.form,l=e.menuIsOpen,c=e.required,d=this.getComponents().Input,u=this.state,h=u.inputIsHidden,p=u.ariaSelection,m=this.commonProps,f=n||this.getElementId("input"),g=Ie(Ie(Ie({"aria-autocomplete":"list","aria-expanded":l,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":c,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},l&&{"aria-controls":this.getElementId("listbox")}),!r&&{"aria-readonly":!0}),this.hasValue()?"initial-input-focus"===(null===p||void 0===p?void 0:p.action)&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return r?s.createElement(d,RN({},m,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:f,innerRef:this.getInputRef,isDisabled:t,isHidden:h,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:i,form:o,type:"text",value:a},g)):s.createElement(lE,RN({id:f,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:$O,onFocus:this.onInputFocus,disabled:t,tabIndex:i,inputMode:"none",form:o,value:""},g))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,t=this.getComponents(),r=t.MultiValue,n=t.MultiValueContainer,a=t.MultiValueLabel,i=t.MultiValueRemove,o=t.SingleValue,l=t.Placeholder,c=this.commonProps,d=this.props,u=d.controlShouldRenderValue,h=d.isDisabled,p=d.isMulti,m=d.inputValue,f=d.placeholder,g=this.state,x=g.selectValue,b=g.focusedValue,y=g.isFocused;if(!this.hasValue()||!u)return m?null:s.createElement(l,RN({},c,{key:"placeholder",isDisabled:h,isFocused:y,innerProps:{id:this.getElementId("placeholder")}}),f);if(p)return x.map(function(t,o){var l=t===b,d="".concat(e.getOptionLabel(t),"-").concat(e.getOptionValue(t));return s.createElement(r,RN({},c,{components:{Container:n,Label:a,Remove:i},isFocused:l,isDisabled:h,key:d,index:o,removeProps:{onClick:function(){return e.removeValue(t)},onTouchEnd:function(){return e.removeValue(t)},onMouseDown:function(e){e.preventDefault()}},data:t}),e.formatOptionLabel(t,"value"))});if(m)return null;var v=x[0];return s.createElement(o,RN({},c,{data:v,isDisabled:h}),this.formatOptionLabel(v,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.getComponents().ClearIndicator,t=this.commonProps,r=this.props,n=r.isDisabled,a=r.isLoading,i=this.state.isFocused;if(!this.isClearable()||!e||n||!this.hasValue()||a)return null;var o={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return s.createElement(e,RN({},t,{innerProps:o,isFocused:i}))}},{key:"renderLoadingIndicator",value:function(){var e=this.getComponents().LoadingIndicator,t=this.commonProps,r=this.props,n=r.isDisabled,a=r.isLoading,i=this.state.isFocused;if(!e||!a)return null;return s.createElement(e,RN({},t,{innerProps:{"aria-hidden":"true"},isDisabled:n,isFocused:i}))}},{key:"renderIndicatorSeparator",value:function(){var e=this.getComponents(),t=e.DropdownIndicator,r=e.IndicatorSeparator;if(!t||!r)return null;var n=this.commonProps,a=this.props.isDisabled,i=this.state.isFocused;return s.createElement(r,RN({},n,{isDisabled:a,isFocused:i}))}},{key:"renderDropdownIndicator",value:function(){var e=this.getComponents().DropdownIndicator;if(!e)return null;var t=this.commonProps,r=this.props.isDisabled,n=this.state.isFocused,a={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return s.createElement(e,RN({},t,{innerProps:a,isDisabled:r,isFocused:n}))}},{key:"renderMenu",value:function(){var e=this,t=this.getComponents(),r=t.Group,n=t.GroupHeading,a=t.Menu,i=t.MenuList,o=t.MenuPortal,l=t.LoadingMessage,c=t.NoOptionsMessage,d=t.Option,u=this.commonProps,h=this.state.focusedOption,p=this.props,m=p.captureMenuScroll,f=p.inputValue,g=p.isLoading,x=p.loadingMessage,b=p.minMenuHeight,y=p.maxMenuHeight,v=p.menuIsOpen,_=p.menuPlacement,k=p.menuPosition,j=p.menuPortalTarget,w=p.menuShouldBlockScroll,N=p.menuShouldScrollIntoView,S=p.noOptionsMessage,O=p.onMenuScrollToTop,C=p.onMenuScrollToBottom;if(!v)return null;var E,P=function(t,r){var n=t.type,a=t.data,i=t.isDisabled,o=t.isSelected,l=t.label,c=t.value,p=h===a,m=i?void 0:function(){return e.onOptionHover(a)},f=i?void 0:function(){return e.selectOption(a)},g="".concat(e.getElementId("option"),"-").concat(r),x={id:g,onClick:f,onMouseMove:m,onMouseOver:m,tabIndex:-1,role:"option","aria-selected":e.isAppleDevice?void 0:o};return s.createElement(d,RN({},u,{innerProps:x,data:a,isDisabled:i,isSelected:o,key:g,label:l,type:n,value:c,isFocused:p,innerRef:p?e.getFocusedOptionRef:void 0}),e.formatOptionLabel(t.data,"menu"))};if(this.hasOptions())E=this.getCategorizedOptions().map(function(t){if("group"===t.type){var a=t.data,i=t.options,o=t.index,l="".concat(e.getElementId("group"),"-").concat(o),c="".concat(l,"-heading");return s.createElement(r,RN({},u,{key:l,data:a,options:i,Heading:n,headingProps:{id:c,data:t.data},label:e.formatGroupLabel(t.data)}),t.options.map(function(e){return P(e,"".concat(o,"-").concat(e.index))}))}if("option"===t.type)return P(t,"".concat(t.index))});else if(g){var A=x({inputValue:f});if(null===A)return null;E=s.createElement(l,u,A)}else{var T=S({inputValue:f});if(null===T)return null;E=s.createElement(c,u,T)}var M={minMenuHeight:b,maxMenuHeight:y,menuPlacement:_,menuPosition:k,menuShouldScrollIntoView:N},R=s.createElement(xC,RN({},u,M),function(t){var r=t.ref,n=t.placerProps,o=n.placement,l=n.maxHeight;return s.createElement(a,RN({},u,M,{innerRef:r,innerProps:{onMouseDown:e.onMenuMouseDown,onMouseMove:e.onMenuMouseMove},isLoading:g,placement:o}),s.createElement(vE,{captureEnabled:m,onTopArrive:O,onBottomArrive:C,lockEnabled:w},function(t){return s.createElement(i,RN({},u,{innerRef:function(r){e.getMenuListRef(r),t(r)},innerProps:{role:"listbox","aria-multiselectable":u.isMulti,id:e.getElementId("listbox")},isLoading:g,maxHeight:l,focusedOption:h}),E)}))});return j||"fixed"===k?s.createElement(o,RN({},u,{appendTo:j,controlElement:this.controlRef,menuPlacement:_,menuPosition:k}),R):R}},{key:"renderFormField",value:function(){var e=this,t=this.props,r=t.delimiter,n=t.isDisabled,a=t.isMulti,i=t.name,o=t.required,l=this.state.selectValue;if(o&&!this.hasValue()&&!n)return s.createElement(kE,{name:i,onFocus:this.onValueInputFocus});if(i&&!n){if(a){if(r){var c=l.map(function(t){return e.getOptionValue(t)}).join(r);return s.createElement("input",{name:i,type:"hidden",value:c})}var d=l.length>0?l.map(function(t,r){return s.createElement("input",{key:"i-".concat(r),name:i,type:"hidden",value:e.getOptionValue(t)})}):s.createElement("input",{name:i,type:"hidden",value:""});return s.createElement("div",null,d)}var u=l[0]?this.getOptionValue(l[0]):"";return s.createElement("input",{name:i,type:"hidden",value:u})}}},{key:"renderLiveRegion",value:function(){var e=this.commonProps,t=this.state,r=t.ariaSelection,n=t.focusedOption,a=t.focusedValue,i=t.isFocused,o=t.selectValue,l=this.getFocusableOptions();return s.createElement(XC,RN({},e,{id:this.getElementId("live-region"),ariaSelection:r,focusedOption:n,focusedValue:a,isFocused:i,selectValue:o,focusableOptions:l,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var e=this.getComponents(),t=e.Control,r=e.IndicatorsContainer,n=e.SelectContainer,a=e.ValueContainer,i=this.props,o=i.className,l=i.id,c=i.isDisabled,d=i.menuIsOpen,u=this.state.isFocused,h=this.commonProps=this.getCommonProps();return s.createElement(n,RN({},h,{className:o,innerProps:{id:l,onKeyDown:this.onKeyDown},isDisabled:c,isFocused:u}),this.renderLiveRegion(),s.createElement(t,RN({},h,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:c,isFocused:u,menuIsOpen:d}),s.createElement(a,RN({},h,{isDisabled:c}),this.renderPlaceholderOrValue(),this.renderInput()),s.createElement(r,RN({},h,{isDisabled:c}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=t.prevProps,n=t.clearFocusValueOnUpdate,a=t.inputIsHiddenAfterUpdate,s=t.ariaSelection,i=t.isFocused,o=t.prevWasFocused,l=t.instancePrefix,c=e.options,d=e.value,u=e.menuIsOpen,h=e.inputValue,p=e.isMulti,m=XO(d),f={};if(r&&(d!==r.value||c!==r.options||u!==r.menuIsOpen||h!==r.inputValue)){var g=u?function(e,t){return TE(AE(e,t))}(e,m):[],x=u?ME(AE(e,m),"".concat(l,"-option")):[],b=n?function(e,t){var r=e.focusedValue,n=e.selectValue.indexOf(r);if(n>-1){if(t.indexOf(r)>-1)return r;if(n<t.length)return t[n]}return null}(t,m):null,y=function(e,t){var r=e.focusedOption;return r&&t.indexOf(r)>-1?r:t[0]}(t,g);f={selectValue:m,focusedOption:y,focusedOptionId:DE(x,y),focusableOptionsWithIds:x,focusedValue:b,clearFocusValueOnUpdate:!1}}var v=null!=a&&e!==r?{inputIsHidden:a,inputIsHiddenAfterUpdate:void 0}:{},_=s,k=i&&o;return i&&!k&&(_={value:dC(p,m,m[0]||null),options:m,action:"initial-input-focus"},k=!o),"initial-input-focus"===(null===s||void 0===s?void 0:s.action)&&(_=null),Ie(Ie(Ie({},f),v),{},{prevProps:e,ariaSelection:_,prevWasFocused:k})}}]),r}(s.Component);HE.defaultProps=EE;var WE=(0,s.forwardRef)(function(e,t){var r=function(e){var t=e.defaultInputValue,r=void 0===t?"":t,n=e.defaultMenuIsOpen,a=void 0!==n&&n,i=e.defaultValue,o=void 0===i?null:i,l=e.inputValue,c=e.menuIsOpen,d=e.onChange,u=e.onInputChange,h=e.onMenuClose,p=e.onMenuOpen,m=e.value,f=Le(e,MN),g=TN((0,s.useState)(void 0!==l?l:r),2),x=g[0],b=g[1],y=TN((0,s.useState)(void 0!==c?c:a),2),v=y[0],_=y[1],k=TN((0,s.useState)(void 0!==m?m:o),2),j=k[0],w=k[1],N=(0,s.useCallback)(function(e,t){"function"===typeof d&&d(e,t),w(e)},[d]),S=(0,s.useCallback)(function(e,t){var r;"function"===typeof u&&(r=u(e,t)),b(void 0!==r?r:e)},[u]),O=(0,s.useCallback)(function(){"function"===typeof p&&p(),_(!0)},[p]),C=(0,s.useCallback)(function(){"function"===typeof h&&h(),_(!1)},[h]),E=void 0!==l?l:x,P=void 0!==c?c:v,A=void 0!==m?m:j;return Ie(Ie({},f),{},{inputValue:E,menuIsOpen:P,onChange:N,onInputChange:S,onMenuClose:C,onMenuOpen:O,value:A})}(e);return s.createElement(HE,RN({ref:t},r))}),qE=WE;function GE(e){return e+.5|0}const $E=(e,t,r)=>Math.max(Math.min(e,r),t);function KE(e){return $E(GE(2.55*e),0,255)}function YE(e){return $E(GE(255*e),0,255)}function XE(e){return $E(GE(e/2.55)/100,0,1)}function JE(e){return $E(GE(100*e),0,100)}const QE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ZE=[..."0123456789ABCDEF"],eP=e=>ZE[15&e],tP=e=>ZE[(240&e)>>4]+ZE[15&e],rP=e=>(240&e)>>4===(15&e);function nP(e){var t=(e=>rP(e.r)&&rP(e.g)&&rP(e.b)&&rP(e.a))(e)?eP:tP;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const aP=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function sP(e,t,r){const n=t*Math.min(r,1-r),a=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return r-n*Math.max(Math.min(a-3,9-a,1),-1)};return[a(0),a(8),a(4)]}function iP(e,t,r){const n=function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(n+e/60)%6;return r-r*t*Math.max(Math.min(a,4-a,1),0)};return[n(5),n(3),n(1)]}function oP(e,t,r){const n=sP(e,1,.5);let a;for(t+r>1&&(a=1/(t+r),t*=a,r*=a),a=0;a<3;a++)n[a]*=1-t-r,n[a]+=t;return n}function lP(e){const t=e.r/255,r=e.g/255,n=e.b/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=(a+s)/2;let o,l,c;return a!==s&&(c=a-s,l=i>.5?c/(2-a-s):c/(a+s),o=function(e,t,r,n,a){return e===a?(t-r)/n+(t<r?6:0):t===a?(r-e)/n+2:(e-t)/n+4}(t,r,n,c,a),o=60*o+.5),[0|o,l||0,i]}function cP(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(YE)}function dP(e,t,r){return cP(sP,e,t,r)}function uP(e){return(e%360+360)%360}function hP(e){const t=aP.exec(e);let r,n=255;if(!t)return;t[5]!==r&&(n=t[6]?KE(+t[5]):YE(+t[5]));const a=uP(+t[2]),s=+t[3]/100,i=+t[4]/100;return r="hwb"===t[1]?function(e,t,r){return cP(oP,e,t,r)}(a,s,i):"hsv"===t[1]?function(e,t,r){return cP(iP,e,t,r)}(a,s,i):dP(a,s,i),{r:r[0],g:r[1],b:r[2],a:n}}const pP={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},mP={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let fP;function gP(e){fP||(fP=function(){const e={},t=Object.keys(mP),r=Object.keys(pP);let n,a,s,i,o;for(n=0;n<t.length;n++){for(i=o=t[n],a=0;a<r.length;a++)s=r[a],o=o.replace(s,pP[s]);s=parseInt(mP[i],16),e[o]=[s>>16&255,s>>8&255,255&s]}return e}(),fP.transparent=[0,0,0,0]);const t=fP[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const xP=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const bP=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,yP=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function vP(e,t,r){if(e){let n=lP(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,0===t?360:1)),n=dP(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function _P(e,t){return e?Object.assign(t||{},e):e}function kP(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=YE(e[3]))):(t=_P(e,{r:0,g:0,b:0,a:1})).a=YE(t.a),t}function jP(e){return"r"===e.charAt(0)?function(e){const t=xP.exec(e);let r,n,a,s=255;if(t){if(t[7]!==r){const e=+t[7];s=t[8]?KE(e):$E(255*e,0,255)}return r=+t[1],n=+t[3],a=+t[5],r=255&(t[2]?KE(r):$E(r,0,255)),n=255&(t[4]?KE(n):$E(n,0,255)),a=255&(t[6]?KE(a):$E(a,0,255)),{r:r,g:n,b:a,a:s}}}(e):hP(e)}class wP{constructor(e){if(e instanceof wP)return e;const t=typeof e;let r;"object"===t?r=kP(e):"string"===t&&(r=function(e){var t,r=e.length;return"#"===e[0]&&(4===r||5===r?t={r:255&17*QE[e[1]],g:255&17*QE[e[2]],b:255&17*QE[e[3]],a:5===r?17*QE[e[4]]:255}:7!==r&&9!==r||(t={r:QE[e[1]]<<4|QE[e[2]],g:QE[e[3]]<<4|QE[e[4]],b:QE[e[5]]<<4|QE[e[6]],a:9===r?QE[e[7]]<<4|QE[e[8]]:255})),t}(e)||gP(e)||jP(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=_P(this._rgb);return e&&(e.a=XE(e.a)),e}set rgb(e){this._rgb=kP(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(XE(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0;var e}hexString(){return this._valid?nP(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=lP(e),r=t[0],n=JE(t[1]),a=JE(t[2]);return e.a<255?"hsla(".concat(r,", ").concat(n,"%, ").concat(a,"%, ").concat(XE(e.a),")"):"hsl(".concat(r,", ").concat(n,"%, ").concat(a,"%)")}(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,n=e.rgb;let a;const s=t===a?.5:t,i=2*s-1,o=r.a-n.a,l=((i*o===-1?i:(i+o)/(1+i*o))+1)/2;a=1-l,r.r=255&l*r.r+a*n.r+.5,r.g=255&l*r.g+a*n.g+.5,r.b=255&l*r.b+a*n.b+.5,r.a=s*r.a+(1-s)*n.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,r){const n=yP(XE(e.r)),a=yP(XE(e.g)),s=yP(XE(e.b));return{r:YE(bP(n+r*(yP(XE(t.r))-n))),g:YE(bP(a+r*(yP(XE(t.g))-a))),b:YE(bP(s+r*(yP(XE(t.b))-s))),a:e.a+r*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new wP(this.rgb)}alpha(e){return this._rgb.a=YE(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=GE(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return vP(this._rgb,2,e),this}darken(e){return vP(this._rgb,2,-e),this}saturate(e){return vP(this._rgb,1,e),this}desaturate(e){return vP(this._rgb,1,-e),this}rotate(e){return function(e,t){var r=lP(e);r[0]=uP(r[0]+t),r=dP(r),e.r=r[0],e.g=r[1],e.b=r[2]}(this._rgb,e),this}}function NP(){}const SP=(()=>{let e=0;return()=>e++})();function OP(e){return null===e||void 0===e}function CP(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function EP(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function PP(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function AP(e,t){return PP(e)?e:t}function TP(e,t){return"undefined"===typeof e?t:e}const MP=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function RP(e,t,r){if(e&&"function"===typeof e.call)return e.apply(r,t)}function DP(e,t,r,n){let a,s,i;if(CP(e))if(s=e.length,n)for(a=s-1;a>=0;a--)t.call(r,e[a],a);else for(a=0;a<s;a++)t.call(r,e[a],a);else if(EP(e))for(i=Object.keys(e),s=i.length,a=0;a<s;a++)t.call(r,e[i[a]],i[a])}function IP(e,t){let r,n,a,s;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(a=e[r],s=t[r],a.datasetIndex!==s.datasetIndex||a.index!==s.index)return!1;return!0}function LP(e){if(CP(e))return e.map(LP);if(EP(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let a=0;for(;a<n;++a)t[r[a]]=LP(e[r[a]]);return t}return e}function FP(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function BP(e,t,r,n){if(!FP(e))return;const a=t[e],s=r[e];EP(a)&&EP(s)?UP(a,s,n):t[e]=LP(s)}function UP(e,t,r){const n=CP(t)?t:[t],a=n.length;if(!EP(e))return e;const s=(r=r||{}).merger||BP;let i;for(let o=0;o<a;++o){if(i=n[o],!EP(i))continue;const t=Object.keys(i);for(let n=0,a=t.length;n<a;++n)s(t[n],e,i,r)}return e}function zP(e,t){return UP(e,t,{merger:VP})}function VP(e,t,r){if(!FP(e))return;const n=t[e],a=r[e];EP(n)&&EP(a)?zP(n,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=LP(a))}const HP={"":e=>e,x:e=>e.x,y:e=>e.y};function WP(e,t){const r=HP[t]||(HP[t]=function(e){const t=function(e){const t=e.split("."),r=[];let n="";for(const a of t)n+=a,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}(e);return e=>{for(const r of t){if(""===r)break;e=e&&e[r]}return e}}(t));return r(e)}function qP(e){return e.charAt(0).toUpperCase()+e.slice(1)}const GP=e=>"undefined"!==typeof e,$P=e=>"function"===typeof e,KP=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};const YP=Math.PI,XP=2*YP,JP=XP+YP,QP=Number.POSITIVE_INFINITY,ZP=YP/180,eA=YP/2,tA=YP/4,rA=2*YP/3,nA=Math.log10,aA=Math.sign;function sA(e,t,r){return Math.abs(e-t)<r}function iA(e){const t=Math.round(e);e=sA(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(nA(e))),n=e/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function oA(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function lA(e,t,r){let n,a,s;for(n=0,a=e.length;n<a;n++)s=e[n][r],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function cA(e){return e*(YP/180)}function dA(e){return e*(180/YP)}function uA(e){if(!PP(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function hA(e,t){const r=t.x-e.x,n=t.y-e.y,a=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*YP&&(s+=XP),{angle:s,distance:a}}function pA(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function mA(e,t){return(e-t+JP)%XP-YP}function fA(e){return(e%XP+XP)%XP}function gA(e,t,r,n){const a=fA(e),s=fA(t),i=fA(r),o=fA(s-a),l=fA(i-a),c=fA(a-s),d=fA(a-i);return a===s||a===i||n&&s===i||o>l&&c<d}function xA(e,t,r){return Math.max(t,Math.min(r,e))}function bA(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function yA(e,t,r){r=r||(r=>e[r]<t);let n,a=e.length-1,s=0;for(;a-s>1;)n=s+a>>1,r(n)?s=n:a=n;return{lo:s,hi:a}}const vA=(e,t,r,n)=>yA(e,r,n?n=>{const a=e[n][t];return a<r||a===r&&e[n+1][t]===r}:n=>e[n][t]<r),_A=(e,t,r)=>yA(e,r,n=>e[n][t]>=r);const kA=["push","pop","shift","splice","unshift"];function jA(e,t){const r=e._chartjs;if(!r)return;const n=r.listeners,a=n.indexOf(t);-1!==a&&n.splice(a,1),n.length>0||(kA.forEach(t=>{delete e[t]}),delete e._chartjs)}function wA(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const NA="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function SA(e,t){let r=[],n=!1;return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];r=s,n||(n=!0,NA.call(window,()=>{n=!1,e.apply(t,r)}))}}const OA=e=>"start"===e?"left":"end"===e?"right":"center",CA=(e,t,r)=>"start"===e?t:"end"===e?r:(t+r)/2;function EA(e,t,r){const n=t.length;let a=0,s=n;if(e._sorted){const{iScale:i,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=i.axis,{min:u,max:h,minDefined:p,maxDefined:m}=i.getUserBounds();if(p){if(a=Math.min(vA(l,d,u).lo,r?n:vA(t,d,i.getPixelForValue(u)).lo),c){const e=l.slice(0,a+1).reverse().findIndex(e=>!OP(e[o.axis]));a-=Math.max(0,e)}a=xA(a,0,n-1)}if(m){let e=Math.max(vA(l,i.axis,h,!0).hi+1,r?0:vA(t,d,i.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex(e=>!OP(e[o.axis]));e+=Math.max(0,t)}s=xA(e,a,n)-a}else s=n-a}return{start:a,count:s}}function PA(e){const{xScale:t,yScale:r,_scaleRanges:n}=e,a={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!n)return e._scaleRanges=a,!0;const s=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,a),s}const AA=e=>0===e||1===e,TA=(e,t,r)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*XP/r),MA=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*XP/r)+1,RA={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*eA),easeOutSine:e=>Math.sin(e*eA),easeInOutSine:e=>-.5*(Math.cos(YP*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>AA(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>AA(e)?e:TA(e,.075,.3),easeOutElastic:e=>AA(e)?e:MA(e,.075,.3),easeInOutElastic(e){const t=.1125;return AA(e)?e:e<.5?.5*TA(2*e,t,.45):.5+.5*MA(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-RA.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,r=2.75;return e<1/r?t*e*e:e<2/r?t*(e-=1.5/r)*e+.75:e<2.5/r?t*(e-=2.25/r)*e+.9375:t*(e-=2.625/r)*e+.984375},easeInOutBounce:e=>e<.5?.5*RA.easeInBounce(2*e):.5*RA.easeOutBounce(2*e-1)+.5};function DA(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function IA(e){return DA(e)?e:new wP(e)}function LA(e){return DA(e)?e:new wP(e).saturate(.5).darken(.1).hexString()}const FA=["x","y","borderWidth","radius","tension"],BA=["color","borderColor","backgroundColor"];const UA=new Map;function zA(e,t,r){return function(e,t){t=t||{};const r=e+JSON.stringify(t);let n=UA.get(r);return n||(n=new Intl.NumberFormat(e,t),UA.set(r,n)),n}(t,r).format(e)}const VA={values:e=>CP(e)?e:""+e,numeric(e,t,r){if(0===e)return"0";const n=this.chart.options.locale;let a,s=e;if(r.length>1){const t=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(t<1e-4||t>1e15)&&(a="scientific"),s=function(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e));return r}(e,r)}const i=nA(Math.abs(s)),o=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:a,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),zA(e,n,l)},logarithmic(e,t,r){if(0===e)return"0";const n=r[t].significand||e/Math.pow(10,Math.floor(nA(e)));return[1,2,3,5,10,15].includes(n)||t>.8*r.length?VA.numeric.call(this,e,t,r):""}};var HA={formatters:VA};const WA=Object.create(null),qA=Object.create(null);function GA(e,t){if(!t)return e;const r=t.split(".");for(let n=0,a=r.length;n<a;++n){const t=r[n];e=e[t]||(e[t]=Object.create(null))}return e}function $A(e,t,r){return"string"===typeof t?UP(GA(e,t),r):UP(GA(e,""),t)}class KA{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>LA(t.backgroundColor),this.hoverBorderColor=(e,t)=>LA(t.borderColor),this.hoverColor=(e,t)=>LA(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return $A(this,e,t)}get(e){return GA(this,e)}describe(e,t){return $A(qA,e,t)}override(e,t){return $A(WA,e,t)}route(e,t,r,n){const a=GA(this,e),s=GA(this,r),i="_"+t;Object.defineProperties(a,{[i]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[i],t=s[n];return EP(e)?Object.assign({},t,e):TP(e,t)},set(e){this[i]=e}}})}apply(e){e.forEach(e=>e(this))}}var YA=new KA({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:BA},numbers:{type:"number",properties:FA}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:HA.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function XA(e,t,r,n,a){let s=t[a];return s||(s=t[a]=e.measureText(a).width,r.push(a)),s>n&&(n=s),n}function JA(e,t,r,n){let a=(n=n||{}).data=n.data||{},s=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(a=n.data={},s=n.garbageCollect=[],n.font=t),e.save(),e.font=t;let i=0;const o=r.length;let l,c,d,u,h;for(l=0;l<o;l++)if(u=r[l],void 0===u||null===u||CP(u)){if(CP(u))for(c=0,d=u.length;c<d;c++)h=u[c],void 0===h||null===h||CP(h)||(i=XA(e,a,s,i,h))}else i=XA(e,a,s,i,u);e.restore();const p=s.length/2;if(p>r.length){for(l=0;l<p;l++)delete a[s[l]];s.splice(0,p)}return i}function QA(e,t,r){const n=e.currentDevicePixelRatio,a=0!==r?Math.max(r/2,.5):0;return Math.round((t-a)*n)/n+a}function ZA(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function eT(e,t,r,n){tT(e,t,r,n,null)}function tT(e,t,r,n,a){let s,i,o,l,c,d,u,h;const p=t.pointStyle,m=t.rotation,f=t.radius;let g=(m||0)*ZP;if(p&&"object"===typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return e.save(),e.translate(r,n),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(f)||f<=0)){switch(e.beginPath(),p){default:a?e.ellipse(r,n,a/2,f,0,0,XP):e.arc(r,n,f,0,XP),e.closePath();break;case"triangle":d=a?a/2:f,e.moveTo(r+Math.sin(g)*d,n-Math.cos(g)*f),g+=rA,e.lineTo(r+Math.sin(g)*d,n-Math.cos(g)*f),g+=rA,e.lineTo(r+Math.sin(g)*d,n-Math.cos(g)*f),e.closePath();break;case"rectRounded":c=.516*f,l=f-c,i=Math.cos(g+tA)*l,u=Math.cos(g+tA)*(a?a/2-c:l),o=Math.sin(g+tA)*l,h=Math.sin(g+tA)*(a?a/2-c:l),e.arc(r-u,n-o,c,g-YP,g-eA),e.arc(r+h,n-i,c,g-eA,g),e.arc(r+u,n+o,c,g,g+eA),e.arc(r-h,n+i,c,g+eA,g+YP),e.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*f,d=a?a/2:l,e.rect(r-d,n-l,2*d,2*l);break}g+=tA;case"rectRot":u=Math.cos(g)*(a?a/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(r-u,n-o),e.lineTo(r+h,n-i),e.lineTo(r+u,n+o),e.lineTo(r-h,n+i),e.closePath();break;case"crossRot":g+=tA;case"cross":u=Math.cos(g)*(a?a/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(r-u,n-o),e.lineTo(r+u,n+o),e.moveTo(r+h,n-i),e.lineTo(r-h,n+i);break;case"star":u=Math.cos(g)*(a?a/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(r-u,n-o),e.lineTo(r+u,n+o),e.moveTo(r+h,n-i),e.lineTo(r-h,n+i),g+=tA,u=Math.cos(g)*(a?a/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(a?a/2:f),e.moveTo(r-u,n-o),e.lineTo(r+u,n+o),e.moveTo(r+h,n-i),e.lineTo(r-h,n+i);break;case"line":i=a?a/2:Math.cos(g)*f,o=Math.sin(g)*f,e.moveTo(r-i,n-o),e.lineTo(r+i,n+o);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(g)*(a?a/2:f),n+Math.sin(g)*f);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function rT(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function nT(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function aT(e){e.restore()}function sT(e,t,r,n,a){if(!t)return e.lineTo(r.x,r.y);if("middle"===a){const n=(t.x+r.x)/2;e.lineTo(n,t.y),e.lineTo(n,r.y)}else"after"===a!==!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function iT(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function oT(e,t,r,n,a){if(a.strikethrough||a.underline){const s=e.measureText(n),i=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=r-s.actualBoundingBoxAscent,c=r+s.actualBoundingBoxDescent,d=a.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(i,d),e.lineTo(o,d),e.stroke()}}function lT(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function cT(e,t,r,n,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=CP(t)?t:[t],o=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(e.save(),e.font=a.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),OP(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),l=0;l<i.length;++l)c=i[l],s.backdrop&&lT(e,s.backdrop),o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),OP(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,r,n,s.maxWidth)),e.fillText(c,r,n,s.maxWidth),oT(e,r,n,c,s),n+=Number(a.lineHeight);e.restore()}function dT(e,t){const{x:r,y:n,w:a,h:s,radius:i}=t;e.arc(r+i.topLeft,n+i.topLeft,i.topLeft,1.5*YP,YP,!0),e.lineTo(r,n+s-i.bottomLeft),e.arc(r+i.bottomLeft,n+s-i.bottomLeft,i.bottomLeft,YP,eA,!0),e.lineTo(r+a-i.bottomRight,n+s),e.arc(r+a-i.bottomRight,n+s-i.bottomRight,i.bottomRight,eA,0,!0),e.lineTo(r+a,n+i.topRight),e.arc(r+a-i.topRight,n+i.topRight,i.topRight,0,-eA,!0),e.lineTo(r+i.topLeft,n)}const uT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,hT=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function pT(e,t){const r=(""+e).match(uT);if(!r||"normal"===r[1])return 1.2*t;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100}return t*e}const mT=e=>+e||0;function fT(e,t){const r={},n=EP(t),a=n?Object.keys(t):t,s=EP(e)?n?r=>TP(e[r],e[t[r]]):t=>e[t]:()=>e;for(const i of a)r[i]=mT(s(i));return r}function gT(e){return fT(e,{top:"y",right:"x",bottom:"y",left:"x"})}function xT(e){return fT(e,["topLeft","topRight","bottomLeft","bottomRight"])}function bT(e){const t=gT(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function yT(e,t){e=e||{},t=t||YA.font;let r=TP(e.size,t.size);"string"===typeof r&&(r=parseInt(r,10));let n=TP(e.style,t.style);n&&!(""+n).match(hT)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const a={family:TP(e.family,t.family),lineHeight:pT(TP(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:TP(e.weight,t.weight),string:""};return a.string=function(e){return!e||OP(e.size)||OP(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function vT(e,t,r,n){let a,s,i,o=!0;for(a=0,s=e.length;a<s;++a)if(i=e[a],void 0!==i&&(void 0!==t&&"function"===typeof i&&(i=i(t),o=!1),void 0!==r&&CP(i)&&(i=i[r%i.length],o=!1),void 0!==i))return n&&!o&&(n.cacheable=!1),i}function _T(e,t){return Object.assign(Object.create(e),t)}function kT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const a=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof r&&(r=MT("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:r,_getTarget:n,override:n=>kT([n,...e],t,a,r)};return new Proxy(s,{deleteProperty:(t,r)=>(delete t[r],delete t._keys,delete e[0][r],!0),get:(r,n)=>OT(r,n,()=>function(e,t,r,n){let a;for(const s of t)if(a=MT(NT(s,e),r),"undefined"!==typeof a)return ST(e,a)?AT(r,n,e,a):a}(n,t,e,r)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>RT(e).includes(t),ownKeys:e=>RT(e),set(e,t,r){const a=e._storage||(e._storage=n());return e[t]=a[t]=r,delete e._keys,!0}})}function jT(e,t,r,n){const a={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:wT(e,n),setContext:t=>jT(e,t,r,n),override:a=>jT(e.override(a),t,r,n)};return new Proxy(a,{deleteProperty:(t,r)=>(delete t[r],delete e[r],!0),get:(e,t,r)=>OT(e,t,()=>function(e,t,r){const{_proxy:n,_context:a,_subProxy:s,_descriptors:i}=e;let o=n[t];$P(o)&&i.isScriptable(t)&&(o=function(e,t,r,n){const{_proxy:a,_context:s,_subProxy:i,_stack:o}=r;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(s,i||n);o.delete(e),ST(e,l)&&(l=AT(a._scopes,a,e,l));return l}(t,o,e,r));CP(o)&&o.length&&(o=function(e,t,r,n){const{_proxy:a,_context:s,_subProxy:i,_descriptors:o}=r;if("undefined"!==typeof s.index&&n(e))return t[s.index%t.length];if(EP(t[0])){const r=t,n=a._scopes.filter(e=>e!==r);t=[];for(const l of r){const r=AT(n,a,e,l);t.push(jT(r,s,i&&i[e],o))}}return t}(t,o,e,i.isIndexable));ST(t,o)&&(o=jT(o,a,s&&s[t],i));return o}(e,t,r)),getOwnPropertyDescriptor:(t,r)=>t._descriptors.allKeys?Reflect.has(e,r)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,r),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,r)=>Reflect.has(e,r),ownKeys:()=>Reflect.ownKeys(e),set:(t,r,n)=>(e[r]=n,delete t[r],!0)})}function wT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:a=t.allKeys}=e;return{allKeys:a,scriptable:r,indexable:n,isScriptable:$P(r)?r:()=>r,isIndexable:$P(n)?n:()=>n}}const NT=(e,t)=>e?e+qP(t):t,ST=(e,t)=>EP(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function OT(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const n=r();return e[t]=n,n}function CT(e,t,r){return $P(e)?e(t,r):e}const ET=(e,t)=>!0===e?t:"string"===typeof e?WP(t,e):void 0;function PT(e,t,r,n,a){for(const s of t){const t=ET(r,s);if(t){e.add(t);const s=CT(t._fallback,r,a);if("undefined"!==typeof s&&s!==r&&s!==n)return s}else if(!1===t&&"undefined"!==typeof n&&r!==n)return null}return!1}function AT(e,t,r,n){const a=t._rootScopes,s=CT(t._fallback,r,n),i=[...e,...a],o=new Set;o.add(n);let l=TT(o,i,r,s||r,n);return null!==l&&(("undefined"===typeof s||s===r||(l=TT(o,i,s,l,n),null!==l))&&kT(Array.from(o),[""],a,s,()=>function(e,t,r){const n=e._getTarget();t in n||(n[t]={});const a=n[t];if(CP(a)&&EP(r))return r;return a||{}}(t,r,n)))}function TT(e,t,r,n,a){for(;r;)r=PT(e,t,r,n,a);return r}function MT(e,t){for(const r of t){if(!r)continue;const t=r[e];if("undefined"!==typeof t)return t}}function RT(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const r of e)for(const e of Object.keys(r).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}function DT(e,t,r,n){const{iScale:a}=e,{key:s="r"}=this._parsing,i=new Array(n);let o,l,c,d;for(o=0,l=n;o<l;++o)c=o+r,d=t[c],i[o]={r:a.parse(WP(d,s),c)};return i}const IT=Number.EPSILON||1e-14,LT=(e,t)=>t<e.length&&!e[t].skip&&e[t],FT=e=>"x"===e?"y":"x";function BT(e,t,r,n){const a=e.skip?t:e,s=t,i=r.skip?t:r,o=pA(s,a),l=pA(i,s);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=n*c,h=n*d;return{previous:{x:s.x-u*(i.x-a.x),y:s.y-u*(i.y-a.y)},next:{x:s.x+h*(i.x-a.x),y:s.y+h*(i.y-a.y)}}}function UT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const r=FT(t),n=e.length,a=Array(n).fill(0),s=Array(n);let i,o,l,c=LT(e,0);for(i=0;i<n;++i)if(o=l,l=c,c=LT(e,i+1),l){if(c){const e=c[t]-l[t];a[i]=0!==e?(c[r]-l[r])/e:0}s[i]=o?c?aA(a[i-1])!==aA(a[i])?0:(a[i-1]+a[i])/2:a[i-1]:a[i]}!function(e,t,r){const n=e.length;let a,s,i,o,l,c=LT(e,0);for(let d=0;d<n-1;++d)l=c,c=LT(e,d+1),l&&c&&(sA(t[d],0,IT)?r[d]=r[d+1]=0:(a=r[d]/t[d],s=r[d+1]/t[d],o=Math.pow(a,2)+Math.pow(s,2),o<=9||(i=3/Math.sqrt(o),r[d]=a*i*t[d],r[d+1]=s*i*t[d])))}(e,a,s),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const n=FT(r),a=e.length;let s,i,o,l=LT(e,0);for(let c=0;c<a;++c){if(i=o,o=l,l=LT(e,c+1),!o)continue;const a=o[r],d=o[n];i&&(s=(a-i[r])/3,o["cp1".concat(r)]=a-s,o["cp1".concat(n)]=d-s*t[c]),l&&(s=(l[r]-a)/3,o["cp2".concat(r)]=a+s,o["cp2".concat(n)]=d+s*t[c])}}(e,s,t)}function zT(e,t,r){return Math.max(Math.min(e,r),t)}function VT(e,t,r,n,a){let s,i,o,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)UT(e,a);else{let r=n?e[e.length-1]:e[0];for(s=0,i=e.length;s<i;++s)o=e[s],l=BT(r,o,e[Math.min(s+1,i-(n?0:1))%i],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,r=o}t.capBezierPoints&&function(e,t){let r,n,a,s,i,o=rT(e[0],t);for(r=0,n=e.length;r<n;++r)i=s,s=o,o=r<n-1&&rT(e[r+1],t),s&&(a=e[r],i&&(a.cp1x=zT(a.cp1x,t.left,t.right),a.cp1y=zT(a.cp1y,t.top,t.bottom)),o&&(a.cp2x=zT(a.cp2x,t.left,t.right),a.cp2y=zT(a.cp2y,t.top,t.bottom)))}(e,r)}function HT(){return"undefined"!==typeof window&&"undefined"!==typeof document}function WT(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function qT(e,t,r){let n;return"string"===typeof e?(n=parseInt(e,10),-1!==e.indexOf("%")&&(n=n/100*t.parentNode[r])):n=e,n}const GT=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const $T=["top","right","bottom","left"];function KT(e,t,r){const n={};r=r?"-"+r:"";for(let a=0;a<4;a++){const s=$T[a];n[s]=parseFloat(e[t+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function YT(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:n}=t,a=GT(r),s="border-box"===a.boxSizing,i=KT(a,"padding"),o=KT(a,"border","width"),{x:l,y:c,box:d}=function(e,t){const r=e.touches,n=r&&r.length?r[0]:e,{offsetX:a,offsetY:s}=n;let i,o,l=!1;if(((e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot))(a,s,e.target))i=a,o=s;else{const e=t.getBoundingClientRect();i=n.clientX-e.left,o=n.clientY-e.top,l=!0}return{x:i,y:o,box:l}}(e,r),u=i.left+(d&&o.left),h=i.top+(d&&o.top);let{width:p,height:m}=t;return s&&(p-=i.width+o.width,m-=i.height+o.height),{x:Math.round((l-u)/p*r.width/n),y:Math.round((c-h)/m*r.height/n)}}const XT=e=>Math.round(10*e)/10;function JT(e,t,r,n){const a=GT(e),s=KT(a,"margin"),i=qT(a.maxWidth,e,"clientWidth")||QP,o=qT(a.maxHeight,e,"clientHeight")||QP,l=function(e,t,r){let n,a;if(void 0===t||void 0===r){const s=e&&WT(e);if(s){const e=s.getBoundingClientRect(),i=GT(s),o=KT(i,"border","width"),l=KT(i,"padding");t=e.width-l.width-o.width,r=e.height-l.height-o.height,n=qT(i.maxWidth,s,"clientWidth"),a=qT(i.maxHeight,s,"clientHeight")}else t=e.clientWidth,r=e.clientHeight}return{width:t,height:r,maxWidth:n||QP,maxHeight:a||QP}}(e,t,r);let{width:c,height:d}=l;if("content-box"===a.boxSizing){const e=KT(a,"border","width"),t=KT(a,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-s.width),d=Math.max(0,n?c/n:d-s.height),c=XT(Math.min(c,i,l.maxWidth)),d=XT(Math.min(d,o,l.maxHeight)),c&&!d&&(d=XT(c/2));return(void 0!==t||void 0!==r)&&n&&l.height&&d>l.height&&(d=l.height,c=XT(Math.floor(d*n))),{width:c,height:d}}function QT(e,t,r){const n=t||1,a=Math.floor(e.height*n),s=Math.floor(e.width*n);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const i=e.canvas;return i.style&&(r||!i.style.height&&!i.style.width)&&(i.style.height="".concat(e.height,"px"),i.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==n||i.height!==a||i.width!==s)&&(e.currentDevicePixelRatio=n,i.height=a,i.width=s,e.ctx.setTransform(n,0,0,n,0,0),!0)}const ZT=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};HT()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(dU){}return e}();function eM(e,t){const r=function(e,t){return GT(e).getPropertyValue(t)}(e,t),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function tM(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function rM(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:"middle"===n?r<.5?e.y:t.y:"after"===n?r<1?e.y:t.y:r>0?t.y:e.y}}function nM(e,t,r,n){const a={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},i=tM(e,a,r),o=tM(a,s,r),l=tM(s,t,r),c=tM(i,o,r),d=tM(o,l,r);return tM(c,d,r)}function aM(e,t,r){return e?function(e,t){return{x:r=>e+e+t-r,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,r):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function sM(e,t){let r,n;"ltr"!==t&&"rtl"!==t||(r=e.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function iM(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function oM(e){return"angle"===e?{between:gA,compare:mA,normalize:fA}:{between:bA,compare:(e,t)=>e-t,normalize:e=>e}}function lM(e){let{start:t,end:r,count:n,loop:a,style:s}=e;return{start:t%n,end:r%n,loop:a&&(r-t+1)%n===0,style:s}}function cM(e,t,r){if(!r)return[e];const{property:n,start:a,end:s}=r,i=t.length,{compare:o,between:l,normalize:c}=oM(n),{start:d,end:u,loop:h,style:p}=function(e,t,r){const{property:n,start:a,end:s}=r,{between:i,normalize:o}=oM(n),l=t.length;let c,d,{start:u,end:h,loop:p}=e;if(p){for(u+=l,h+=l,c=0,d=l;c<d&&i(o(t[u%l][n]),a,s);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:p,style:e.style}}(e,t,r),m=[];let f,g,x,b=!1,y=null;const v=()=>b||l(a,x,f)&&0!==o(a,x),_=()=>!b||0===o(s,f)||l(s,x,f);for(let k=d,j=d;k<=u;++k)g=t[k%i],g.skip||(f=c(g[n]),f!==x&&(b=l(f,a,s),null===y&&v()&&(y=0===o(f,a)?k:j),null!==y&&_()&&(m.push(lM({start:y,end:k,loop:h,count:i,style:p})),y=null),j=k,x=f));return null!==y&&m.push(lM({start:y,end:u,loop:h,count:i,style:p})),m}function dM(e,t){const r=[],n=e.segments;for(let a=0;a<n.length;a++){const s=cM(n[a],e.points,t);s.length&&r.push(...s)}return r}function uM(e,t,r,n){return n&&n.setContext&&r?function(e,t,r,n){const a=e._chart.getContext(),s=hM(e.options),{_datasetIndex:i,options:{spanGaps:o}}=e,l=r.length,c=[];let d=s,u=t[0].start,h=u;function p(e,t,n,a){const s=o?-1:1;if(e!==t){for(e+=l;r[e%l].skip;)e-=s;for(;r[t%l].skip;)t+=s;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:n,style:a}),d=a,u=t%l)}}for(const m of t){u=o?u:m.start;let e,t=r[u%l];for(h=u+1;h<=m.end;h++){const s=r[h%l];e=hM(n.setContext(_T(a,{type:"segment",p0:t,p1:s,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),pM(e,d)&&p(u,h-1,m.loop,d),t=s,d=e}u<h-1&&p(u,h-1,m.loop,d)}return c}(e,t,r,n):t}function hM(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function pM(e,t){if(!t)return!1;const r=[],n=function(e,t){return DA(t)?(r.includes(t)||r.push(t),r.indexOf(t)):t};return JSON.stringify(e,n)!==JSON.stringify(t,n)}function mM(e,t,r){return e.options.clip?e[r]:t[r]}function fM(e,t){const r=t._clip;if(r.disabled)return!1;const n=function(e,t){const{xScale:r,yScale:n}=e;return r&&n?{left:mM(r,t,"left"),right:mM(r,t,"right"),top:mM(n,t,"top"),bottom:mM(n,t,"bottom")}:t}(t,e.chartArea);return{left:!1===r.left?0:n.left-(!0===r.left?0:r.left),right:!1===r.right?e.width:n.right+(!0===r.right?0:r.right),top:!1===r.top?0:n.top-(!0===r.top?0:r.top),bottom:!1===r.bottom?e.height:n.bottom+(!0===r.bottom?0:r.bottom)}}class gM{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,n){const a=t.listeners[n],s=t.duration;a.forEach(n=>n({chart:e,initial:t.initial,numSteps:s,currentStep:Math.min(r-t.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=NA.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((r,n)=>{if(!r.running||!r.items.length)return;const a=r.items;let s,i=a.length-1,o=!1;for(;i>=0;--i)s=a[i],s._active?(s._total>r.duration&&(r.duration=s._total),s.tick(e),o=!0):(a[i]=a[a.length-1],a.pop());o&&(n.draw(),this._notify(n,r,e,"progress")),a.length||(r.running=!1,this._notify(n,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let n=r.length-1;for(;n>=0;--n)r[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var xM=new gM;const bM="transparent",yM={boolean:(e,t,r)=>r>.5?t:e,color(e,t,r){const n=IA(e||bM),a=n.valid&&IA(t||bM);return a&&a.valid?a.mix(n,r).hexString():t},number:(e,t,r)=>e+(t-e)*r};class vM{constructor(e,t,r,n){const a=t[r];n=vT([e.to,n,a,e.from]);const s=vT([e.from,a,n]);this._active=!0,this._fn=e.fn||yM[e.type||typeof s],this._easing=RA[e.easing]||RA.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=s,this._to=n,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const n=this._target[this._prop],a=r-this._start,s=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(s,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=vT([e.to,t,n,e.from]),this._from=vT([e.from,n,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,n=this._prop,a=this._from,s=this._loop,i=this._to;let o;if(this._active=a!==i&&(s||t<r),!this._active)return this._target[n]=i,void this._notify(!0);t<0?this._target[n]=a:(o=t/r%2,o=s&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[n]=this._fn(a,i,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let n=0;n<r.length;n++)r[n][t]()}}class _M{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!EP(e))return;const t=Object.keys(YA.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const a=e[n];if(!EP(a))return;const s={};for(const e of t)s[e]=a[e];(CP(a.properties)&&a.properties||[n]).forEach(e=>{e!==n&&r.has(e)||r.set(e,s)})})}_animateOptions(e,t){const r=t.options,n=function(e,t){if(!t)return;let r=e.options;if(!r)return void(e.options=t);r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}}));return r}(e,r);if(!n)return[];const a=this._createAnimations(n,r);return r.$shared&&function(e,t){const r=[],n=Object.keys(t);for(let a=0;a<n.length;a++){const t=e[n[a]];t&&t.active()&&r.push(t.wait())}return Promise.all(r)}(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,n=[],a=e.$animations||(e.$animations={}),s=Object.keys(t),i=Date.now();let o;for(o=s.length-1;o>=0;--o){const l=s[o];if("$"===l.charAt(0))continue;if("options"===l){n.push(...this._animateOptions(e,t));continue}const c=t[l];let d=a[l];const u=r.get(l);if(d){if(u&&d.active()){d.update(u,c,i);continue}d.cancel()}u&&u.duration?(a[l]=d=new vM(u,e,l,c),n.push(d)):e[l]=c}return n}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const r=this._createAnimations(e,t);return r.length?(xM.add(this._chart,r),!0):void 0}}function kM(e,t){const r=e&&e.options||{},n=r.reverse,a=void 0===r.min?t:0,s=void 0===r.max?t:0;return{start:n?s:a,end:n?a:s}}function jM(e,t){const r=[],n=e._getSortedDatasetMetas(t);let a,s;for(a=0,s=n.length;a<s;++a)r.push(n[a].index);return r}function wM(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=e.keys,s="single"===n.mode;let i,o,l,c;if(null===t)return;let d=!1;for(i=0,o=a.length;i<o;++i){if(l=+a[i],l===r){if(d=!0,n.all)continue;break}c=e.values[l],PP(c)&&(s||0===t||aA(t)===aA(c))&&(t+=c)}return d||n.all?t:0}function NM(e,t){const r=e&&e.options.stacked;return r||void 0===r&&void 0!==t.stack}function SM(e,t,r){const n=e[t]||(e[t]={});return n[r]||(n[r]={})}function OM(e,t,r,n){for(const a of t.getMatchingVisibleMetas(n).reverse()){const t=e[a.index];if(r&&t>0||!r&&t<0)return a.index}return null}function CM(e,t){const{chart:r,_cachedMeta:n}=e,a=r._stacks||(r._stacks={}),{iScale:s,vScale:i,index:o}=n,l=s.axis,c=i.axis,d=function(e,t,r){return"".concat(e.id,".").concat(t.id,".").concat(r.stack||r.type)}(s,i,n),u=t.length;let h;for(let p=0;p<u;++p){const e=t[p],{[l]:r,[c]:s}=e;h=(e._stacks||(e._stacks={}))[c]=SM(a,d,r),h[o]=s,h._top=OM(h,i,!0,n.type),h._bottom=OM(h,i,!1,n.type);(h._visualValues||(h._visualValues={}))[o]=s}}function EM(e,t){const r=e.scales;return Object.keys(r).filter(e=>r[e].axis===t).shift()}function PM(e,t){const r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[n]||void 0===t[n][r])return;delete t[n][r],void 0!==t[n]._visualValues&&void 0!==t[n]._visualValues[r]&&delete t[n]._visualValues[r]}}}const AM=e=>"reset"===e||"none"===e,TM=(e,t)=>t?e:Object.assign({},e);class MM{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=NM(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&PM(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),n=(e,t,r,n)=>"x"===e?t:"r"===e?n:r,a=t.xAxisID=TP(r.xAxisID,EM(e,"x")),s=t.yAxisID=TP(r.yAxisID,EM(e,"y")),i=t.rAxisID=TP(r.rAxisID,EM(e,"r")),o=t.indexAxis,l=t.iAxisID=n(o,a,s,i),c=t.vAxisID=n(o,s,a,i);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(s),t.rScale=this.getScaleForId(i),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&jA(this._data,this),e._stacked&&PM(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(EP(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:r,vScale:n}=t,a="x"===r.axis?"x":"y",s="x"===n.axis?"x":"y",i=Object.keys(e),o=new Array(i.length);let l,c,d;for(l=0,c=i.length;l<c;++l)d=i[l],o[l]={[a]:d,[s]:e[d]};return o}(t,e)}else if(r!==t){if(r){jA(r,this);const e=this._cachedMeta;PM(e),e._parsed=[]}t&&Object.isExtensible(t)&&function(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),kA.forEach(t=>{const r="_onData"+qP(t),n=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];const i=n.apply(this,a);return e._chartjs.listeners.forEach(e=>{"function"===typeof e[r]&&e[r](...a)}),i}})}))}(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let n=!1;this._dataCheck();const a=t._stacked;t._stacked=NM(t.vScale,t),t.stack!==r.stack&&(n=!0,PM(t),t.stack=r.stack),this._resyncElements(e),(n||a!==t._stacked)&&(CM(this,t._parsed),t._stacked=NM(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:n}=this,{iScale:a,_stacked:s}=r,i=a.axis;let o,l,c,d=0===e&&t===n.length||r._sorted,u=e>0&&r._parsed[e-1];if(!1===this._parsing)r._parsed=n,r._sorted=!0,c=n;else{c=CP(n[e])?this.parseArrayData(r,n,e,t):EP(n[e])?this.parseObjectData(r,n,e,t):this.parsePrimitiveData(r,n,e,t);const a=()=>null===l[i]||u&&l[i]<u[i];for(o=0;o<t;++o)r._parsed[o+e]=l=c[o],d&&(a()&&(d=!1),u=l);r._sorted=d}s&&CM(this,c)}parsePrimitiveData(e,t,r,n){const{iScale:a,vScale:s}=e,i=a.axis,o=s.axis,l=a.getLabels(),c=a===s,d=new Array(n);let u,h,p;for(u=0,h=n;u<h;++u)p=u+r,d[u]={[i]:c||a.parse(l[p],p),[o]:s.parse(t[p],p)};return d}parseArrayData(e,t,r,n){const{xScale:a,yScale:s}=e,i=new Array(n);let o,l,c,d;for(o=0,l=n;o<l;++o)c=o+r,d=t[c],i[o]={x:a.parse(d[0],c),y:s.parse(d[1],c)};return i}parseObjectData(e,t,r,n){const{xScale:a,yScale:s}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l=new Array(n);let c,d,u,h;for(c=0,d=n;c<d;++c)u=c+r,h=t[u],l[c]={x:a.parse(WP(h,i),u),y:s.parse(WP(h,o),u)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const n=this.chart,a=this._cachedMeta,s=t[e.axis];return wM({keys:jM(n,!0),values:t._stacks[e.axis]._visualValues},s,a.index,{mode:r})}updateRangeFromParsed(e,t,r,n){const a=r[t.axis];let s=null===a?NaN:a;const i=n&&r._stacks[t.axis];n&&i&&(n.values=i,s=wM(n,a,this._cachedMeta.index)),e.min=Math.min(e.min,s),e.max=Math.max(e.max,s)}getMinMax(e,t){const r=this._cachedMeta,n=r._parsed,a=r._sorted&&e===r.iScale,s=n.length,i=this._getOtherScale(e),o=((e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:jM(r,!0),values:null})(t,r,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:r,minDefined:n,maxDefined:a}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:a?r:Number.POSITIVE_INFINITY}}(i);let u,h;function p(){h=n[u];const t=h[i.axis];return!PP(h[e.axis])||c>t||d<t}for(u=0;u<s&&(p()||(this.updateRangeFromParsed(l,e,h,o),!a));++u);if(a)for(u=s-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(l,e,h,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let n,a,s;for(n=0,a=t.length;n<a;++n)s=t[n][e.axis],PP(s)&&r.push(s);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,n=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:n?""+n.getLabelForValue(a[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,r,n,a;return EP(e)?(t=e.top,r=e.right,n=e.bottom,a=e.left):t=r=n=a=e,{top:t,right:r,bottom:n,left:a,disabled:!1===e}}(TP(this.options.clip,function(e,t,r){if(!1===r)return!1;const n=kM(e,r),a=kM(t,r);return{top:a.end,right:n.end,bottom:a.start,left:n.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,n=r.data||[],a=t.chartArea,s=[],i=this._drawStart||0,o=this._drawCount||n.length-i,l=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(e,a,i,o),c=i;c<i+o;++c){const t=n[c];t.hidden||(t.active&&l?s.push(t):t.draw(e,a))}for(c=0;c<s.length;++c)s[c].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const n=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];a=t.$context||(t.$context=function(e,t,r){return _T(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),a.parsed=this.getParsed(e),a.raw=n.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=function(e,t){return _T(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),a.dataset=n,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0;const n="active"===t,a=this._cachedDataOpts,s=e+"-"+t,i=a[s],o=this.enableOptionSharing&&GP(r);if(i)return TM(i,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=n?["".concat(e,"Hover"),"hover",e,""]:[e,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(YA.elements[e]),p=l.resolveNamedOptions(u,h,()=>this.getContext(r,n,t),d);return p.$shared&&(p.$shared=o,a[s]=Object.freeze(TM(p,o))),p}_resolveAnimations(e,t,r){const n=this.chart,a=this._cachedDataOpts,s="animation-".concat(t),i=a[s];if(i)return i;let o;if(!1!==n.options.animation){const n=this.chart.config,a=n.datasetAnimationScopeKeys(this._type,t),s=n.getOptionScopes(this.getDataset(),a);o=n.createResolver(s,this.getContext(e,r,t))}const l=new _M(n,o&&o.animations);return o&&o._cacheable&&(a[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||AM(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),n=this._sharedOptions,a=this.getSharedOptions(r),s=this.includeOptions(t,a)||a!==n;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:s}}updateElement(e,t,r,n){AM(n)?Object.assign(e,r):this._resolveAnimations(t,n).update(e,r)}updateSharedOptions(e,t,r){e&&!AM(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,n){e.active=n;const a=this.getStyle(t,n);this._resolveAnimations(t,r,n).update(e,{options:!n&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[i,o,l]of this._syncList)this[i](o,l);this._syncList=[];const n=r.length,a=t.length,s=Math.min(a,n);s&&this.parse(0,s),a>n?this._insertElements(n,a-n,e):a<n&&this._removeElements(a,n-a)}_insertElements(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this._cachedMeta,a=n.data,s=e+t;let i;const o=e=>{for(e.length+=t,i=e.length-1;i>=s;i--)e[i]=e[i-t]};for(o(a),i=e;i<s;++i)a[i]=new this.dataElementType;this._parsing&&o(n._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,n){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const n=r._parsed.splice(e,t);r._stacked&&PM(r,n)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,n]=e;this[t](r,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function RM(e){const t=e.iScale,r=function(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let n=[];for(let t=0,a=r.length;t<a;t++)n=n.concat(r[t].controller.getAllParsedValues(e));e._cache.$bar=wA(n.sort((e,t)=>e-t))}return e._cache.$bar}(t,e.type);let n,a,s,i,o=t._length;const l=()=>{32767!==s&&-32768!==s&&(GP(i)&&(o=Math.min(o,Math.abs(s-i)||o)),i=s)};for(n=0,a=r.length;n<a;++n)s=t.getPixelForValue(r[n]),l();for(i=void 0,n=0,a=t.ticks.length;n<a;++n)s=t.getPixelForTick(n),l();return o}function DM(e,t,r,n){return CP(e)?function(e,t,r,n){const a=r.parse(e[0],n),s=r.parse(e[1],n),i=Math.min(a,s),o=Math.max(a,s);let l=i,c=o;Math.abs(i)>Math.abs(o)&&(l=o,c=i),t[r.axis]=c,t._custom={barStart:l,barEnd:c,start:a,end:s,min:i,max:o}}(e,t,r,n):t[r.axis]=r.parse(e,n),t}function IM(e,t,r,n){const a=e.iScale,s=e.vScale,i=a.getLabels(),o=a===s,l=[];let c,d,u,h;for(c=r,d=r+n;c<d;++c)h=t[c],u={},u[a.axis]=o||a.parse(i[c],c),l.push(DM(h,u,s,c));return l}function LM(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function FM(e,t,r,n){let a=t.borderSkipped;const s={};if(!a)return void(e.borderSkipped=s);if(!0===a)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:i,end:o,reverse:l,top:c,bottom:d}=function(e){let t,r,n,a,s;return e.horizontal?(t=e.base>e.x,r="left",n="right"):(t=e.base<e.y,r="bottom",n="top"),t?(a="end",s="start"):(a="start",s="end"),{start:r,end:n,reverse:t,top:a,bottom:s}}(e);"middle"===a&&r&&(e.enableBorderRadius=!0,(r._top||0)===n?a=c:(r._bottom||0)===n?a=d:(s[BM(d,i,o,l)]=!0,a=c)),s[BM(a,i,o,l)]=!0,e.borderSkipped=s}function BM(e,t,r,n){var a,s,i;return n?(i=r,e=UM(e=(a=e)===(s=t)?i:a===i?s:a,r,t)):e=UM(e,t,r),e}function UM(e,t,r){return"start"===e?t:"end"===e?r:e}function zM(e,t,r){let{inflateAmount:n}=t;e.inflateAmount="auto"===n?1===r?.33:0:n}Re(MM,"defaults",{}),Re(MM,"datasetElementType",null),Re(MM,"dataElementType",null);class VM extends MM{parsePrimitiveData(e,t,r,n){return IM(e,t,r,n)}parseArrayData(e,t,r,n){return IM(e,t,r,n)}parseObjectData(e,t,r,n){const{iScale:a,vScale:s}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l="x"===a.axis?i:o,c="x"===s.axis?i:o,d=[];let u,h,p,m;for(u=r,h=r+n;u<h;++u)m=t[u],p={},p[a.axis]=a.parse(WP(m,l),u),d.push(DM(WP(m,c),p,s,u));return d}updateRangeFromParsed(e,t,r,n){super.updateRangeFromParsed(e,t,r,n);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:n}=t,a=this.getParsed(e),s=a._custom,i=LM(s)?"["+s.start+", "+s.end+"]":""+n.getLabelForValue(a[n.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:i}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,n){const a="reset"===n,{index:s,_cachedMeta:{vScale:i}}=this,o=i.getBasePixel(),l=i.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(t,n);for(let h=t;h<t+r;h++){const t=this.getParsed(h),r=a||OP(t[i.axis])?{base:o,head:o}:this._calculateBarValuePixels(h),p=this._calculateBarIndexPixels(h,c),m=(t._stacks||{})[i.axis],f={horizontal:l,base:r.base,enableBorderRadius:!m||LM(t._custom)||s===m._top||s===m._bottom,x:l?r.head:p.center,y:l?p.center:r.head,height:l?p.size:Math.abs(r.size),width:l?Math.abs(r.size):p.size};u&&(f.options=d||this.resolveDataElementOptions(h,e[h].active?"active":n));const g=f.options||e[h].options;FM(f,g,m,s),zM(f,g,c.ratio),this.updateElement(e[h],h,f,n)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,n=r.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),a=r.options.stacked,s=[],i=this._cachedMeta.controller.getParsed(t),o=i&&i[r.axis],l=e=>{const t=e._parsed.find(e=>e[r.axis]===o),n=t&&t[e.vScale.axis];if(OP(n)||isNaN(n))return!0};for(const c of n)if((void 0===t||!l(c))&&((!1===a||-1===s.indexOf(c.stack)||void 0===a&&void 0===c.stack)&&s.push(c.stack),c.index===e))break;return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[TP("x"===this.chart.options.indexAxis?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const n=this._getStacks(e,r),a=void 0!==t?n.indexOf(t):-1;return-1===a?n.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,n=[];let a,s;for(a=0,s=t.data.length;a<s;++a)n.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const i=e.barThickness;return{min:i||RM(t),pixels:n,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:i?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:n},options:{base:a,minBarLength:s}}=this,i=a||0,o=this.getParsed(e),l=o._custom,c=LM(l);let d,u,h=o[t.axis],p=0,m=r?this.applyStack(t,o,r):h;m!==h&&(p=m-h,m=h),c&&(h=l.barStart,m=l.barEnd-l.barStart,0!==h&&aA(h)!==aA(l.barEnd)&&(p=0),p+=h);const f=OP(a)||c?p:a;let g=t.getPixelForValue(f);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(p+m):g,u=d-g,Math.abs(u)<s){u=function(e,t,r){return 0!==e?aA(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}(u,t,i)*s,h===i&&(g-=u/2);const e=t.getPixelForDecimal(0),a=t.getPixelForDecimal(1),l=Math.min(e,a),p=Math.max(e,a);g=Math.max(Math.min(g,p),l),d=g+u,r&&!c&&(o._stacks[t.axis]._visualValues[n]=t.getValueForPixel(d)-t.getValueForPixel(g))}if(g===t.getPixelForValue(i)){const e=aA(u)*t.getLineWidthForValue(i)/2;g+=e,u-=e}return{size:u,base:g,head:d,center:d+u/2}}_calculateBarIndexPixels(e,t){const r=t.scale,n=this.options,a=n.skipNull,s=TP(n.maxBarThickness,1/0);let i,o;const l=this._getAxisCount();if(t.grouped){const r=a?this._getStackCount(e):t.stackCount,c="flex"===n.barThickness?function(e,t,r,n){const a=t.pixels,s=a[e];let i=e>0?a[e-1]:null,o=e<a.length-1?a[e+1]:null;const l=r.categoryPercentage;null===i&&(i=s-(null===o?t.end-t.start:o-s)),null===o&&(o=s+s-i);const c=s-(s-Math.min(i,o))/2*l;return{chunk:Math.abs(o-i)/2*l/n,ratio:r.barPercentage,start:c}}(e,t,n,r*l):function(e,t,r,n){const a=r.barThickness;let s,i;return OP(a)?(s=t.min*r.categoryPercentage,i=r.barPercentage):(s=a*n,i=1),{chunk:s/n,ratio:i,start:t.pixels[e]-s/2}}(e,t,n,r*l),d="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,u=this._getAxis().indexOf(TP(d,this.getFirstScaleIdForIndexAxis())),h=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+u;i=c.start+c.chunk*h+c.chunk/2,o=Math.min(s,c.chunk*c.ratio)}else i=r.getPixelForValue(this.getParsed(e)[r.axis],e),o=Math.min(s,t.min*t.ratio);return{base:i-o/2,head:i+o/2,center:i,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,n=r.length;let a=0;for(;a<n;++a)null===this.getParsed(a)[t.axis]||r[a].hidden||r[a].draw(this._ctx)}}Re(VM,"id","bar"),Re(VM,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Re(VM,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class HM extends MM{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,r,n){const a=super.parsePrimitiveData(e,t,r,n);for(let s=0;s<a.length;s++)a[s]._custom=this.resolveDataElementOptions(s+r).radius;return a}parseArrayData(e,t,r,n){const a=super.parseArrayData(e,t,r,n);for(let s=0;s<a.length;s++){const e=t[r+s];a[s]._custom=TP(e[2],this.resolveDataElementOptions(s+r).radius)}return a}parseObjectData(e,t,r,n){const a=super.parseObjectData(e,t,r,n);for(let s=0;s<a.length;s++){const e=t[r+s];a[s]._custom=TP(e&&e.r&&+e.r,this.resolveDataElementOptions(s+r).radius)}return a}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let r=e.length-1;r>=0;--r)t=Math.max(t,e[r].size(this.resolveDataElementOptions(r))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:n,yScale:a}=t,s=this.getParsed(e),i=n.getLabelForValue(s.x),o=a.getLabelForValue(s.y),l=s._custom;return{label:r[e]||"",value:"("+i+", "+o+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,r,n){const a="reset"===n,{iScale:s,vScale:i}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(t,n),c=s.axis,d=i.axis;for(let u=t;u<t+r;u++){const t=e[u],r=!a&&this.getParsed(u),h={},p=h[c]=a?s.getPixelForDecimal(.5):s.getPixelForValue(r[c]),m=h[d]=a?i.getBasePixel():i.getPixelForValue(r[d]);h.skip=isNaN(p)||isNaN(m),l&&(h.options=o||this.resolveDataElementOptions(u,t.active?"active":n),a&&(h.options.radius=0)),this.updateElement(t,u,h,n)}}resolveDataElementOptions(e,t){const r=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const a=n.radius;return"active"!==t&&(n.radius=0),n.radius+=TP(r&&r._custom,a),n}}Re(HM,"id","bubble"),Re(HM,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Re(HM,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class WM extends MM{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,n=this._cachedMeta;if(!1===this._parsing)n._parsed=r;else{let a,s,i=e=>+r[e];if(EP(r[e])){const{key:e="value"}=this._parsing;i=t=>+WP(r[t],e)}for(a=e,s=e+t;a<s;++a)n._parsed[a]=i(a)}}_getRotation(){return cA(this.options.rotation-90)}_getCircumference(){return cA(this.options.circumference)}_getRotationExtents(){let e=XP,t=-XP;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const n=this.chart.getDatasetMeta(r).controller,a=n._getRotation(),s=n._getCircumference();e=Math.min(e,a),t=Math.max(t,a+s)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,n=this._cachedMeta,a=n.data,s=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,i=Math.max((Math.min(r.width,r.height)-s)/2,0),o=Math.min(((e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t)(this.options.cutout,i),1),l=this._getRingWeight(this.index),{circumference:c,rotation:d}=this._getRotationExtents(),{ratioX:u,ratioY:h,offsetX:p,offsetY:m}=function(e,t,r){let n=1,a=1,s=0,i=0;if(t<XP){const o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),u=Math.cos(l),h=Math.sin(l),p=(e,t,n)=>gA(e,o,l,!0)?1:Math.max(t,t*r,n,n*r),m=(e,t,n)=>gA(e,o,l,!0)?-1:Math.min(t,t*r,n,n*r),f=p(0,c,u),g=p(eA,d,h),x=m(YP,c,u),b=m(YP+eA,d,h);n=(f-x)/2,a=(g-b)/2,s=-(f+x)/2,i=-(g+b)/2}return{ratioX:n,ratioY:a,offsetX:s,offsetY:i}}(d,c,o),f=(r.width-s)/u,g=(r.height-s)/h,x=Math.max(Math.min(f,g)/2,0),b=MP(this.options.radius,x),y=(b-Math.max(b*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=p*b,this.offsetY=m*b,n.total=this.calculateTotal(),this.outerRadius=b-y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-y*l,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,n=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||null===n._parsed[e]||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*a/XP)}updateElements(e,t,r,n){const a="reset"===n,s=this.chart,i=s.chartArea,o=s.options.animation,l=(i.left+i.right)/2,c=(i.top+i.bottom)/2,d=a&&o.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:p,includeOptions:m}=this._getSharedOptions(t,n);let f,g=this._getRotation();for(f=0;f<t;++f)g+=this._circumference(f,a);for(f=t;f<t+r;++f){const t=this._circumference(f,a),r=e[f],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:h,innerRadius:u};m&&(s.options=p||this.resolveDataElementOptions(f,r.active?"active":n)),g+=t,this.updateElement(r,f,s,n)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r,n=0;for(r=0;r<t.length;r++){const a=e._parsed[r];null===a||isNaN(a)||!this.chart.getDataVisibility(r)||t[r].hidden||(n+=Math.abs(a))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?XP*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,n=r.data.labels||[],a=zA(t._parsed[e],r.options.locale);return{label:n[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let n,a,s,i,o;if(!e)for(n=0,a=r.data.datasets.length;n<a;++n)if(r.isDatasetVisible(n)){s=r.getDatasetMeta(n),e=s.data,i=s.controller;break}if(!e)return 0;for(n=0,a=e.length;n<a;++n)o=i.resolveDataElementOptions(n),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,n=e.length;r<n;++r){const e=this.resolveDataElementOptions(r);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(TP(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Re(WM,"id","doughnut"),Re(WM,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Re(WM,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Re(WM,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:n}}=e.legend.options;return t.labels.map((t,a)=>{const s=e.getDatasetMeta(0).controller.getStyle(a);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class qM extends MM{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:n=[],_dataset:a}=t,s=this.chart._animationsDisabled;let{start:i,count:o}=EA(t,n,s);this._drawStart=i,this._drawCount=o,PA(t)&&(i=0,o=n.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=n;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(r,void 0,{animated:!s,options:l},e),this.updateElements(n,i,o,e)}updateElements(e,t,r,n){const a="reset"===n,{iScale:s,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,n),u=s.axis,h=i.axis,{spanGaps:p,segment:m}=this.options,f=oA(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||a||"none"===n,x=t+r,b=e.length;let y=t>0&&this.getParsed(t-1);for(let v=0;v<b;++v){const r=e[v],p=g?r:{};if(v<t||v>=x){p.skip=!0;continue}const b=this.getParsed(v),_=OP(b[h]),k=p[u]=s.getPixelForValue(b[u],v),j=p[h]=a||_?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,b,o):b[h],v);p.skip=isNaN(k)||isNaN(j)||_,p.stop=v>0&&Math.abs(b[u]-y[u])>f,m&&(p.parsed=b,p.raw=l.data[v]),d&&(p.options=c||this.resolveDataElementOptions(v,r.active?"active":n)),g||this.updateElement(r,v,p,n),y=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return r;const a=n[0].size(this.resolveDataElementOptions(0)),s=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,a,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Re(qM,"id","line"),Re(qM,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Re(qM,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class GM extends MM{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,n=r.data.labels||[],a=zA(t._parsed[e].r,r.options.locale);return{label:n[e]||"",value:a}}parseObjectData(e,t,r,n){return DT.bind(this)(e,t,r,n)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,r)=>{const n=this.getParsed(r).r;!isNaN(n)&&this.chart.getDataVisibility(r)&&(n<t.min&&(t.min=n),n>t.max&&(t.max=n))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,r=e.options,n=Math.min(t.right-t.left,t.bottom-t.top),a=Math.max(n/2,0),s=(a-Math.max(r.cutoutPercentage?a/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=a-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(e,t,r,n){const a="reset"===n,s=this.chart,i=s.options.animation,o=this._cachedMeta.rScale,l=o.xCenter,c=o.yCenter,d=o.getIndexAngle(0)-.5*YP;let u,h=d;const p=360/this.countVisibleElements();for(u=0;u<t;++u)h+=this._computeAngle(u,n,p);for(u=t;u<t+r;u++){const t=e[u];let r=h,m=h+this._computeAngle(u,n,p),f=s.getDataVisibility(u)?o.getDistanceFromCenterForValue(this.getParsed(u).r):0;h=m,a&&(i.animateScale&&(f=0),i.animateRotate&&(r=m=d));const g={x:l,y:c,innerRadius:0,outerRadius:f,startAngle:r,endAngle:m,options:this.resolveDataElementOptions(u,t.active?"active":n)};this.updateElement(t,u,g,n)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((e,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&t++}),t}_computeAngle(e,t,r){return this.chart.getDataVisibility(e)?cA(this.resolveDataElementOptions(e,t).angle||r):0}}Re(GM,"id","polarArea"),Re(GM,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Re(GM,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:n}}=e.legend.options;return t.labels.map((t,a)=>{const s=e.getDatasetMeta(0).controller.getStyle(a);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class $M extends WM{}Re($M,"id","pie"),Re($M,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class KM extends MM{getLabelAndValue(e){const t=this._cachedMeta.vScale,r=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(r[t.axis])}}parseObjectData(e,t,r,n){return DT.bind(this)(e,t,r,n)}update(e){const t=this._cachedMeta,r=t.dataset,n=t.data||[],a=t.iScale.getLabels();if(r.points=n,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const s={_loop:!0,_fullLoop:a.length===n.length,options:t};this.updateElement(r,void 0,s,e)}this.updateElements(n,0,n.length,e)}updateElements(e,t,r,n){const a=this._cachedMeta.rScale,s="reset"===n;for(let i=t;i<t+r;i++){const t=e[i],r=this.resolveDataElementOptions(i,t.active?"active":n),o=a.getPointPositionForValue(i,this.getParsed(i).r),l=s?a.xCenter:o.x,c=s?a.yCenter:o.y,d={x:l,y:c,angle:o.angle,skip:isNaN(l)||isNaN(c),options:r};this.updateElement(t,i,d,n)}}}Re(KM,"id","radar"),Re(KM,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Re(KM,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class YM extends MM{getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:n,yScale:a}=t,s=this.getParsed(e),i=n.getLabelForValue(s.x),o=a.getLabelForValue(s.y);return{label:r[e]||"",value:"("+i+", "+o+")"}}update(e){const t=this._cachedMeta,{data:r=[]}=t,n=this.chart._animationsDisabled;let{start:a,count:s}=EA(t,r,n);if(this._drawStart=a,this._drawCount=s,PA(t)&&(a=0,s=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:s}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!s._decimated,a.points=r;const i=this.resolveDatasetElementOptions(e);i.segment=this.options.segment,this.updateElement(a,void 0,{animated:!n,options:i},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,a,s,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,r,n){const a="reset"===n,{iScale:s,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,n),d=this.getSharedOptions(c),u=this.includeOptions(n,d),h=s.axis,p=i.axis,{spanGaps:m,segment:f}=this.options,g=oA(m)?m:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||a||"none"===n;let b=t>0&&this.getParsed(t-1);for(let y=t;y<t+r;++y){const t=e[y],r=this.getParsed(y),c=x?t:{},m=OP(r[p]),v=c[h]=s.getPixelForValue(r[h],y),_=c[p]=a||m?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,r,o):r[p],y);c.skip=isNaN(v)||isNaN(_)||m,c.stop=y>0&&Math.abs(r[h]-b[h])>g,f&&(c.parsed=r,c.raw=l.data[y]),u&&(c.options=d||this.resolveDataElementOptions(y,t.active?"active":n)),x||this.updateElement(t,y,c,n),b=r}this.updateSharedOptions(d,n,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let r=t.length-1;r>=0;--r)e=Math.max(e,t[r].size(this.resolveDataElementOptions(r))/2);return e>0&&e}const r=e.dataset,n=r.options&&r.options.borderWidth||0;if(!t.length)return n;const a=t[0].size(this.resolveDataElementOptions(0)),s=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(n,a,s)/2}}Re(YM,"id","scatter"),Re(YM,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Re(YM,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function XM(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class JM{static override(e){Object.assign(JM.prototype,e)}constructor(e){Re(this,"options",void 0),this.options=e||{}}init(){}formats(){return XM()}parse(){return XM()}format(){return XM()}add(){return XM()}diff(){return XM()}startOf(){return XM()}endOf(){return XM()}}var QM=JM;function ZM(e,t,r,n){const{controller:a,data:s,_sorted:i}=e,o=a._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&i&&s.length){const i=o._reversePixels?_A:vA;if(!n){const n=i(s,t,r);if(l){const{vScale:t}=a._cachedMeta,{_parsed:r}=e,s=r.slice(0,n.lo+1).reverse().findIndex(e=>!OP(e[t.axis]));n.lo-=Math.max(0,s);const i=r.slice(n.hi).findIndex(e=>!OP(e[t.axis]));n.hi+=Math.max(0,i)}return n}if(a._sharedOptions){const e=s[0],n="function"===typeof e.getRange&&e.getRange(t);if(n){const e=i(s,t,r-n),a=i(s,t,r+n);return{lo:e.lo,hi:a.hi}}}}return{lo:0,hi:s.length-1}}function eR(e,t,r,n,a){const s=e.getSortedVisibleDatasetMetas(),i=r[t];for(let o=0,l=s.length;o<l;++o){const{index:e,data:r}=s[o],{lo:l,hi:c}=ZM(s[o],t,i,a);for(let t=l;t<=c;++t){const a=r[t];a.skip||n(a,e,t)}}}function tR(e,t,r,n,a){const s=[];if(!a&&!e.isPointInArea(t))return s;return eR(e,r,t,function(r,i,o){(a||rT(r,e.chartArea,0))&&r.inRange(t.x,t.y,n)&&s.push({element:r,datasetIndex:i,index:o})},!0),s}function rR(e,t,r,n,a,s){let i=[];const o=function(e){const t=-1!==e.indexOf("x"),r=-1!==e.indexOf("y");return function(e,n){const a=t?Math.abs(e.x-n.x):0,s=r?Math.abs(e.y-n.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(s,2))}}(r);let l=Number.POSITIVE_INFINITY;return eR(e,r,t,function(r,c,d){const u=r.inRange(t.x,t.y,a);if(n&&!u)return;const h=r.getCenterPoint(a);if(!(!!s||e.isPointInArea(h))&&!u)return;const p=o(t,h);p<l?(i=[{element:r,datasetIndex:c,index:d}],l=p):p===l&&i.push({element:r,datasetIndex:c,index:d})}),i}function nR(e,t,r,n,a,s){return s||e.isPointInArea(t)?"r"!==r||n?rR(e,t,r,n,a,s):function(e,t,r,n){let a=[];return eR(e,r,t,function(e,r,s){const{startAngle:i,endAngle:o}=e.getProps(["startAngle","endAngle"],n),{angle:l}=hA(e,{x:t.x,y:t.y});gA(l,i,o)&&a.push({element:e,datasetIndex:r,index:s})}),a}(e,t,r,a):[]}function aR(e,t,r,n,a){const s=[],i="x"===r?"inXRange":"inYRange";let o=!1;return eR(e,r,t,(e,n,l)=>{e[i]&&e[i](t[r],a)&&(s.push({element:e,datasetIndex:n,index:l}),o=o||e.inRange(t.x,t.y,a))}),n&&!o?[]:s}var sR={evaluateInteractionItems:eR,modes:{index(e,t,r,n){const a=YT(t,e),s=r.axis||"x",i=r.includeInvisible||!1,o=r.intersect?tR(e,a,s,n,i):nR(e,a,s,!1,n,i),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=o[0].index,r=e.data[t];r&&!r.skip&&l.push({element:r,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,r,n){const a=YT(t,e),s=r.axis||"xy",i=r.includeInvisible||!1;let o=r.intersect?tR(e,a,s,n,i):nR(e,a,s,!1,n,i);if(o.length>0){const t=o[0].datasetIndex,r=e.getDatasetMeta(t).data;o=[];for(let e=0;e<r.length;++e)o.push({element:r[e],datasetIndex:t,index:e})}return o},point:(e,t,r,n)=>tR(e,YT(t,e),r.axis||"xy",n,r.includeInvisible||!1),nearest(e,t,r,n){const a=YT(t,e),s=r.axis||"xy",i=r.includeInvisible||!1;return nR(e,a,s,r.intersect,n,i)},x:(e,t,r,n)=>aR(e,YT(t,e),"x",r.intersect,n),y:(e,t,r,n)=>aR(e,YT(t,e),"y",r.intersect,n)}};const iR=["left","top","right","bottom"];function oR(e,t){return e.filter(e=>e.pos===t)}function lR(e,t){return e.filter(e=>-1===iR.indexOf(e.pos)&&e.box.axis===t)}function cR(e,t){return e.sort((e,r)=>{const n=t?r:e,a=t?e:r;return n.weight===a.weight?n.index-a.index:n.weight-a.weight})}function dR(e,t){const r=function(e){const t={};for(const r of e){const{stack:e,pos:n,stackWeight:a}=r;if(!e||!iR.includes(n))continue;const s=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=a}return t}(e),{vBoxMaxWidth:n,hBoxMaxHeight:a}=t;let s,i,o;for(s=0,i=e.length;s<i;++s){o=e[s];const{fullSize:i}=o.box,l=r[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*n:i&&t.availableWidth,o.height=a):(o.width=n,o.height=c?c*a:i&&t.availableHeight)}return r}function uR(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function hR(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function pR(e,t,r,n){const{pos:a,box:s}=r,i=e.maxPadding;if(!EP(a)){r.size&&(e[a]-=r.size);const t=n[r.stack]||{size:0,count:1};t.size=Math.max(t.size,r.horizontal?s.height:s.width),r.size=t.size/t.count,e[a]+=r.size}s.getPadding&&hR(i,s.getPadding());const o=Math.max(0,t.outerWidth-uR(i,e,"left","right")),l=Math.max(0,t.outerHeight-uR(i,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,r.horizontal?{same:c,other:d}:{same:d,other:c}}function mR(e,t){const r=t.maxPadding;function n(e){const n={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{n[e]=Math.max(t[e],r[e])}),n}return n(e?["left","right"]:["top","bottom"])}function fR(e,t,r,n){const a=[];let s,i,o,l,c,d;for(s=0,i=e.length,c=0;s<i;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,mR(o.horizontal,t));const{same:i,other:u}=pR(t,r,o,n);c|=i&&a.length,d=d||u,l.fullSize||a.push(o)}return c&&fR(a,t,r,n)||d}function gR(e,t,r,n,a){e.top=r,e.left=t,e.right=t+n,e.bottom=r+a,e.width=n,e.height=a}function xR(e,t,r,n){const a=r.padding;let{x:s,y:i}=t;for(const o of e){const e=o.box,l=n[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const n=t.w*c,s=l.size||e.height;GP(l.start)&&(i=l.start),e.fullSize?gR(e,a.left,i,r.outerWidth-a.right-a.left,s):gR(e,t.left+l.placed,i,n,s),l.start=i,l.placed+=n,i=e.bottom}else{const n=t.h*c,i=l.size||e.width;GP(l.start)&&(s=l.start),e.fullSize?gR(e,s,a.top,i,r.outerHeight-a.bottom-a.top):gR(e,s,t.top+l.placed,i,n),l.start=s,l.placed+=n,s=e.right}}t.x=s,t.y=i}var bR={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;-1!==r&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,n){if(!e)return;const a=bT(e.options.layout.padding),s=Math.max(t-a.width,0),i=Math.max(r-a.height,0),o=function(e){const t=function(e){const t=[];let r,n,a,s,i,o;for(r=0,n=(e||[]).length;r<n;++r)a=e[r],({position:s,options:{stack:i,stackWeight:o=1}}=a),t.push({index:r,box:a,pos:s,horizontal:a.isHorizontal(),weight:a.weight,stack:i&&s+i,stackWeight:o});return t}(e),r=cR(t.filter(e=>e.box.fullSize),!0),n=cR(oR(t,"left"),!0),a=cR(oR(t,"right")),s=cR(oR(t,"top"),!0),i=cR(oR(t,"bottom")),o=lR(t,"x"),l=lR(t,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:a.concat(l).concat(i).concat(o),chartArea:oR(t,"chartArea"),vertical:n.concat(a).concat(l),horizontal:s.concat(i).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;DP(e.boxes,e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()});const d=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:r,padding:a,availableWidth:s,availableHeight:i,vBoxMaxWidth:s/2/d,hBoxMaxHeight:i/2}),h=Object.assign({},a);hR(h,bT(n));const p=Object.assign({maxPadding:h,w:s,h:i,x:a.left,y:a.top},a),m=dR(l.concat(c),u);fR(o.fullSize,p,u,m),fR(l,p,u,m),fR(c,p,u,m)&&fR(l,p,u,m),function(e){const t=e.maxPadding;function r(r){const n=Math.max(t[r]-e[r],0);return e[r]+=n,n}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}(p),xR(o.leftAndTop,p,u,m),p.x+=p.w,p.y+=p.h,xR(o.rightAndBottom,p,u,m),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},DP(o.chartArea,t=>{const r=t.box;Object.assign(r,e.chartArea),r.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class yR{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,n){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):r)}}isAttached(e){return!0}updateConfig(e){}}class vR extends yR{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const _R="$chartjs",kR={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},jR=e=>null===e||""===e;const wR=!!ZT&&{passive:!0};function NR(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,wR)}function SR(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function OR(e,t,r){const n=e.canvas,a=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||SR(r.addedNodes,n),t=t&&!SR(r.removedNodes,n);t&&r()});return a.observe(document,{childList:!0,subtree:!0}),a}function CR(e,t,r){const n=e.canvas,a=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||SR(r.removedNodes,n),t=t&&!SR(r.addedNodes,n);t&&r()});return a.observe(document,{childList:!0,subtree:!0}),a}const ER=new Map;let PR=0;function AR(){const e=window.devicePixelRatio;e!==PR&&(PR=e,ER.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function TR(e,t,r){const n=e.canvas,a=n&&WT(n);if(!a)return;const s=SA((e,t)=>{const n=a.clientWidth;r(e,t),n<a.clientWidth&&r()},window),i=new ResizeObserver(e=>{const t=e[0],r=t.contentRect.width,n=t.contentRect.height;0===r&&0===n||s(r,n)});return i.observe(a),function(e,t){ER.size||window.addEventListener("resize",AR),ER.set(e,t)}(e,s),i}function MR(e,t,r){r&&r.disconnect(),"resize"===t&&function(e){ER.delete(e),ER.size||window.removeEventListener("resize",AR)}(e)}function RR(e,t,r){const n=e.canvas,a=SA(t=>{null!==e.ctx&&r(function(e,t){const r=kR[e.type]||e.type,{x:n,y:a}=YT(e,t);return{type:r,chart:t,native:e,x:void 0!==n?n:null,y:void 0!==a?a:null}}(t,e))},e);return function(e,t,r){e&&e.addEventListener(t,r,wR)}(n,t,a),a}class DR extends yR{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(function(e,t){const r=e.style,n=e.getAttribute("height"),a=e.getAttribute("width");if(e[_R]={initial:{height:n,width:a,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",jR(a)){const t=eM(e,"width");void 0!==t&&(e.width=t)}if(jR(n))if(""===e.style.height)e.height=e.width/(t||2);else{const t=eM(e,"height");void 0!==t&&(e.height=t)}}(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[_R])return!1;const r=t[_R].initial;["height","width"].forEach(e=>{const n=r[e];OP(n)?t.removeAttribute(e):t.setAttribute(e,n)});const n=r.style||{};return Object.keys(n).forEach(e=>{t.style[e]=n[e]}),t.width=t.width,delete t[_R],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),a={attach:OR,detach:CR,resize:TR}[t]||RR;n[t]=a(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),n=r[t];if(!n)return;({attach:MR,detach:MR,resize:MR}[t]||NR)(e,t,n),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,n){return JT(e,t,r,n)}isAttached(e){const t=e&&WT(e);return!(!t||!t.isConnected)}}class IR{constructor(){Re(this,"x",void 0),Re(this,"y",void 0),Re(this,"active",!1),Re(this,"options",void 0),Re(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return oA(this.x)&&oA(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const n={};return e.forEach(e=>{n[e]=r[e]&&r[e].active()?r[e]._to:this[e]}),n}}function LR(e,t){const r=e.options.ticks,n=function(e){const t=e.options.offset,r=e._tickSize(),n=e._length/r+(t?0:1),a=e._maxLength/r;return Math.floor(Math.min(n,a))}(e),a=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?function(e){const t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}(t):[],i=s.length,o=s[0],l=s[i-1],c=[];if(i>a)return function(e,t,r,n){let a,s=0,i=r[0];for(n=Math.ceil(n),a=0;a<e.length;a++)a===i&&(t.push(e[a]),s++,i=r[s*n])}(t,c,s,i/a),c;const d=function(e,t,r){const n=function(e){const t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}(e),a=t.length/r;if(!n)return Math.max(a,1);const s=function(e){const t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n===0&&(t.push(n),t.push(e/n));return r===(0|r)&&t.push(r),t.sort((e,t)=>e-t).pop(),t}(n);for(let i=0,o=s.length-1;i<o;i++){const e=s[i];if(e>a)return e}return Math.max(a,1)}(s,t,a);if(i>0){let e,r;const n=i>1?Math.round((l-o)/(i-1)):null;for(FR(t,c,d,OP(n)?0:o-n,o),e=0,r=i-1;e<r;e++)FR(t,c,d,s[e],s[e+1]);return FR(t,c,d,l,OP(n)?t.length:l+n),c}return FR(t,c,d),c}function FR(e,t,r,n,a){const s=TP(n,0),i=Math.min(TP(a,e.length),e.length);let o,l,c,d=0;for(r=Math.ceil(r),a&&(o=a-n,r=o/Math.floor(o/r)),c=s;c<0;)d++,c=Math.round(s+d*r);for(l=Math.max(s,0);l<i;l++)l===c&&(t.push(e[l]),d++,c=Math.round(s+d*r))}Re(IR,"defaults",{}),Re(IR,"defaultRoutes",void 0);const BR=(e,t,r)=>"top"===t||"left"===t?e[t]+r:e[t]-r,UR=(e,t)=>Math.min(t||e,e);function zR(e,t){const r=[],n=e.length/t,a=e.length;let s=0;for(;s<a;s+=n)r.push(e[Math.floor(s)]);return r}function VR(e,t,r){const n=e.ticks.length,a=Math.min(t,n-1),s=e._startPixel,i=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(a);if(!(r&&(l=1===n?Math.max(c-s,i-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(a-1))/2,c+=a<t?l:-l,c<s-o||c>i+o)))return c}function HR(e){return e.drawTicks?e.tickLength:0}function WR(e,t){if(!e.display)return 0;const r=yT(e.font,t),n=bT(e.padding);return(CP(e.text)?e.text.length:1)*r.lineHeight+n.height}function qR(e,t,r){let n=OA(e);return(r&&"right"!==t||!r&&"right"===t)&&(n=(e=>"left"===e?"right":"right"===e?"left":e)(n)),n}class GR extends IR{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:n}=this;return e=AP(e,Number.POSITIVE_INFINITY),t=AP(t,Number.NEGATIVE_INFINITY),r=AP(r,Number.POSITIVE_INFINITY),n=AP(n,Number.NEGATIVE_INFINITY),{min:AP(e,r),max:AP(t,n),minDefined:PP(e),maxDefined:PP(t)}}getMinMax(e){let t,{min:r,max:n,minDefined:a,maxDefined:s}=this.getUserBounds();if(a&&s)return{min:r,max:n};const i=this.getMatchingVisibleMetas();for(let o=0,l=i.length;o<l;++o)t=i[o].controller.getMinMax(this,e),a||(r=Math.min(r,t.min)),s||(n=Math.max(n,t.max));return r=s&&r>n?n:r,n=a&&r>n?r:n,{min:AP(r,AP(n,r)),max:AP(n,AP(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){RP(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:n,grace:a,ticks:s}=this.options,i=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,r){const{min:n,max:a}=e,s=MP(t,(a-n)/2),i=(e,t)=>r&&0===e?0:e+t;return{min:i(n,-Math.abs(s)),max:i(a,s)}}(this,a,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=i<this.ticks.length;this._convertTicksToLabels(o?zR(this.ticks,i):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=LR(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,r=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,r=!r),this._startPixel=e,this._endPixel=t,this._reversePixels=r,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){RP(this.options.afterUpdate,[this])}beforeSetDimensions(){RP(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){RP(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),RP(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){RP(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,n,a;for(r=0,n=e.length;r<n;r++)a=e[r],a.label=RP(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){RP(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){RP(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=UR(this.ticks.length,e.ticks.maxTicksLimit),n=t.minRotation||0,a=t.maxRotation;let s,i,o,l=n;if(!this._isVisible()||!t.display||n>=a||r<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=xA(this.chart.width-d,0,this.maxWidth);s=e.offset?this.maxWidth/r:h/(r-1),d+6>s&&(s=h/(r-(e.offset?.5:1)),i=this.maxHeight-HR(e.grid)-t.padding-WR(e.title,this.chart.options.font),o=Math.sqrt(d*d+u*u),l=dA(Math.min(Math.asin(xA((c.highest.height+6)/s,-1,1)),Math.asin(xA(i/o,-1,1))-Math.asin(xA(u/o,-1,1)))),l=Math.max(n,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){RP(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){RP(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:n,grid:a}}=this,s=this._isVisible(),i=this.isHorizontal();if(s){const s=WR(n,t.options.font);if(i?(e.width=this.maxWidth,e.height=HR(a)+s):(e.height=this.maxHeight,e.width=HR(a)+s),r.display&&this.ticks.length){const{first:t,last:n,widest:a,highest:s}=this._getLabelSizes(),o=2*r.padding,l=cA(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(i){const t=r.mirror?0:d*a.width+c*s.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=r.mirror?0:c*a.width+d*s.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,n,d,c)}}this._handleMargins(),i?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,n){const{ticks:{align:a,padding:s},position:i}=this.options,o=0!==this.labelRotation,l="top"!==i&&"x"===this.axis;if(this.isHorizontal()){const i=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;o?l?(d=n*e.width,u=r*t.height):(d=r*e.height,u=n*t.width):"start"===a?u=t.width:"end"===a?d=e.width:"inner"!==a&&(d=e.width/2,u=t.width/2),this.paddingLeft=Math.max((d-i+s)*this.width/(this.width-i),0),this.paddingRight=Math.max((u-c+s)*this.width/(this.width-c),0)}else{let r=t.height/2,n=e.height/2;"start"===a?(r=0,n=e.height):"end"===a&&(r=t.height,n=0),this.paddingTop=r+s,this.paddingBottom=n+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){RP(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,r;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,r=e.length;t<r;t++)OP(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=zR(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:n,_longestTextCache:a}=this,s=[],i=[],o=Math.floor(t/UR(t,r));let l,c,d,u,h,p,m,f,g,x,b,y=0,v=0;for(l=0;l<t;l+=o){if(u=e[l].label,h=this._resolveTickFontOptions(l),n.font=p=h.string,m=a[p]=a[p]||{data:{},gc:[]},f=h.lineHeight,g=x=0,OP(u)||CP(u)){if(CP(u))for(c=0,d=u.length;c<d;++c)b=u[c],OP(b)||CP(b)||(g=XA(n,m.data,m.gc,g,b),x+=f)}else g=XA(n,m.data,m.gc,g,u),x=f;s.push(g),i.push(x),y=Math.max(g,y),v=Math.max(x,v)}!function(e,t){DP(e,e=>{const r=e.gc,n=r.length/2;let a;if(n>t){for(a=0;a<n;++a)delete e.data[r[a]];r.splice(0,n)}})}(a,t);const _=s.indexOf(y),k=i.indexOf(v),j=e=>({width:s[e]||0,height:i[e]||0});return{first:j(0),last:j(t-1),widest:j(_),highest:j(k),widths:s,heights:i}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return function(e){return xA(e,-32768,32767)}(this._alignToPixels?QA(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=function(e,t,r){return _T(e,{tick:r,index:t,type:"tick"})}(this.getContext(),e,r))}return this.$context||(this.$context=_T(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=cA(this.labelRotation),r=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),a=this._getLabelSizes(),s=e.autoSkipPadding||0,i=a?a.widest.width+s:0,o=a?a.highest.height+s:0;return this.isHorizontal()?o*r>i*n?i/r:o/n:o*n<i*r?o/r:i/n}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,n=this.options,{grid:a,position:s,border:i}=n,o=a.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=HR(a),u=[],h=i.setContext(this.getContext()),p=h.display?h.width:0,m=p/2,f=function(e){return QA(r,e,p)};let g,x,b,y,v,_,k,j,w,N,S,O;if("top"===s)g=f(this.bottom),_=this.bottom-d,j=g-m,N=f(e.top)+m,O=e.bottom;else if("bottom"===s)g=f(this.top),N=e.top,O=f(e.bottom)-m,_=g+m,j=this.top+d;else if("left"===s)g=f(this.right),v=this.right-d,k=g-m,w=f(e.left)+m,S=e.right;else if("right"===s)g=f(this.left),w=e.left,S=f(e.right)-m,v=g+m,k=this.left+d;else if("x"===t){if("center"===s)g=f((e.top+e.bottom)/2+.5);else if(EP(s)){const e=Object.keys(s)[0],t=s[e];g=f(this.chart.scales[e].getPixelForValue(t))}N=e.top,O=e.bottom,_=g+m,j=_+d}else if("y"===t){if("center"===s)g=f((e.left+e.right)/2);else if(EP(s)){const e=Object.keys(s)[0],t=s[e];g=f(this.chart.scales[e].getPixelForValue(t))}v=g-m,k=v-d,w=e.left,S=e.right}const C=TP(n.ticks.maxTicksLimit,c),E=Math.max(1,Math.ceil(c/C));for(x=0;x<c;x+=E){const e=this.getContext(x),t=a.setContext(e),n=i.setContext(e),s=t.lineWidth,c=t.color,d=n.dash||[],h=n.dashOffset,p=t.tickWidth,m=t.tickColor,f=t.tickBorderDash||[],g=t.tickBorderDashOffset;b=VR(this,x,o),void 0!==b&&(y=QA(r,b,s),l?v=k=w=S=y:_=j=N=O=y,u.push({tx1:v,ty1:_,tx2:k,ty2:j,x1:w,y1:N,x2:S,y2:O,width:s,color:c,borderDash:d,borderDashOffset:h,tickWidth:p,tickColor:m,tickBorderDash:f,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,u}_computeLabelItems(e){const t=this.axis,r=this.options,{position:n,ticks:a}=r,s=this.isHorizontal(),i=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=a,u=HR(r.grid),h=u+c,p=d?-c:h,m=-cA(this.labelRotation),f=[];let g,x,b,y,v,_,k,j,w,N,S,O,C="middle";if("top"===n)_=this.bottom-p,k=this._getXAxisLabelAlignment();else if("bottom"===n)_=this.top+p,k=this._getXAxisLabelAlignment();else if("left"===n){const e=this._getYAxisLabelAlignment(u);k=e.textAlign,v=e.x}else if("right"===n){const e=this._getYAxisLabelAlignment(u);k=e.textAlign,v=e.x}else if("x"===t){if("center"===n)_=(e.top+e.bottom)/2+h;else if(EP(n)){const e=Object.keys(n)[0],t=n[e];_=this.chart.scales[e].getPixelForValue(t)+h}k=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===n)v=(e.left+e.right)/2-h;else if(EP(n)){const e=Object.keys(n)[0],t=n[e];v=this.chart.scales[e].getPixelForValue(t)}k=this._getYAxisLabelAlignment(u).textAlign}"y"===t&&("start"===o?C="top":"end"===o&&(C="bottom"));const E=this._getLabelSizes();for(g=0,x=i.length;g<x;++g){b=i[g],y=b.label;const e=a.setContext(this.getContext(g));j=this.getPixelForTick(g)+a.labelOffset,w=this._resolveTickFontOptions(g),N=w.lineHeight,S=CP(y)?y.length:1;const t=S/2,r=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let u,h=k;if(s?(v=j,"inner"===k&&(h=g===x-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),O="top"===n?"near"===l||0!==m?-S*N+N/2:"center"===l?-E.highest.height/2-t*N+N:-E.highest.height+N/2:"near"===l||0!==m?N/2:"center"===l?E.highest.height/2-t*N:E.highest.height-S*N,d&&(O*=-1),0===m||e.showLabelBackdrop||(v+=N/2*Math.sin(m))):(_=j,O=(1-S)*N/2),e.showLabelBackdrop){const t=bT(e.backdropPadding),r=E.heights[g],n=E.widths[g];let a=O-t.top,s=0-t.left;switch(C){case"middle":a-=r/2;break;case"bottom":a-=r}switch(k){case"center":s-=n/2;break;case"right":s-=n;break;case"inner":g===x-1?s-=n:g>0&&(s-=n/2)}u={left:s,top:a,width:n+t.width,height:r+t.height,color:e.backdropColor}}f.push({label:y,font:w,textOffset:O,options:{rotation:m,color:r,strokeColor:o,strokeWidth:c,textAlign:h,textBaseline:C,translation:[v,_],backdrop:u}})}return f}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-cA(this.labelRotation))return"top"===e?"left":"right";let r="center";return"start"===t.align?r="left":"end"===t.align?r="right":"inner"===t.align&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:n,padding:a}}=this.options,s=e+a,i=this._getLabelSizes().widest.width;let o,l;return"left"===t?n?(l=this.right+a,"near"===r?o="left":"center"===r?(o="center",l+=i/2):(o="right",l+=i)):(l=this.right-s,"near"===r?o="right":"center"===r?(o="center",l-=i/2):(o="left",l=this.left)):"right"===t?n?(l=this.left+a,"near"===r?o="right":"center"===r?(o="center",l-=i/2):(o="left",l-=i)):(l=this.left+s,"near"===r?o="left":"center"===r?(o="center",l+=i/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:n,width:a,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,n,a,s),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(t=>t.value===e);if(r>=0){return t.setContext(this.getContext(r)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,r=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,s;const i=(e,t,n)=>{n.width&&n.color&&(r.save(),r.lineWidth=n.width,r.strokeStyle=n.color,r.setLineDash(n.borderDash||[]),r.lineDashOffset=n.borderDashOffset,r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.restore())};if(t.display)for(a=0,s=n.length;a<s;++a){const e=n[a];t.drawOnChartArea&&i({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&i({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:n}}=this,a=r.setContext(this.getContext()),s=r.display?a.width:0;if(!s)return;const i=n.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=QA(e,this.left,s)-s/2,c=QA(e,this.right,i)+i/2,d=u=o):(d=QA(e,this.top,s)-s/2,u=QA(e,this.bottom,i)+i/2,l=c=o),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,r=this._computeLabelArea();r&&nT(t,r);const n=this.getLabelItems(e);for(const a of n){const e=a.options,r=a.font;cT(t,a.label,0,a.textOffset,r,e)}r&&aT(t)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:n}}=this;if(!r.display)return;const a=yT(r.font),s=bT(r.padding),i=r.align;let o=a.lineHeight/2;"bottom"===t||"center"===t||EP(t)?(o+=s.bottom,CP(r.text)&&(o+=a.lineHeight*(r.text.length-1))):o+=s.top;const{titleX:l,titleY:c,maxWidth:d,rotation:u}=function(e,t,r,n){const{top:a,left:s,bottom:i,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let u,h,p,m=0;const f=i-a,g=o-s;if(e.isHorizontal()){if(h=CA(n,s,o),EP(r)){const e=Object.keys(r)[0],n=r[e];p=d[e].getPixelForValue(n)+f-t}else p="center"===r?(c.bottom+c.top)/2+f-t:BR(e,r,t);u=o-s}else{if(EP(r)){const e=Object.keys(r)[0],n=r[e];h=d[e].getPixelForValue(n)-g+t}else h="center"===r?(c.left+c.right)/2-g+t:BR(e,r,t);p=CA(n,i,a),m="left"===r?-eA:eA}return{titleX:h,titleY:p,maxWidth:u,rotation:m}}(this,o,t,i);cT(e,r.text,0,0,a,{color:r.color,maxWidth:d,rotation:u,textAlign:qR(i,t,n),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=TP(e.grid&&e.grid.z,-1),n=TP(e.border&&e.border.z,0);return this._isVisible()&&this.draw===GR.prototype.draw?[{z:r,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",n=[];let a,s;for(a=0,s=t.length;a<s;++a){const s=t[a];s[r]!==this.id||e&&s.type!==e||n.push(s)}return n}_resolveTickFontOptions(e){return yT(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class $R{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;(function(e){return"id"in e&&"defaults"in e})(t)&&(r=this.register(t));const n=this.items,a=e.id,s=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in n||(n[a]=e,function(e,t,r){const n=UP(Object.create(null),[r?YA.get(r):{},YA.get(t),e.defaults]);YA.set(t,n),e.defaultRoutes&&function(e,t){Object.keys(t).forEach(r=>{const n=r.split("."),a=n.pop(),s=[e].concat(n).join("."),i=t[r].split("."),o=i.pop(),l=i.join(".");YA.route(s,a,l,o)})}(t,e.defaultRoutes);e.descriptors&&YA.describe(t,e.descriptors)}(e,s,r),this.override&&YA.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,n=this.scope;r in t&&delete t[r],n&&r in YA[n]&&(delete YA[n][r],this.override&&delete WA[r])}}class KR{constructor(){this.controllers=new $R(MM,"datasets",!0),this.elements=new $R(IR,"elements"),this.plugins=new $R(Object,"plugins"),this.scales=new $R(GR,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.scales)}_each(e,t,r){[...t].forEach(t=>{const n=r||this._getRegistryForType(t);r||n.isForType(t)||n===this.plugins&&t.id?this._exec(e,n,t):DP(t,t=>{const n=r||this._getRegistryForType(t);this._exec(e,n,t)})})}_exec(e,t,r){const n=qP(e);RP(r["before"+n],[],r),t[e](r),RP(r["after"+n],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const n=t.get(e);if(void 0===n)throw new Error('"'+e+'" is not a registered '+r+".");return n}}var YR=new KR;class XR{constructor(){this._init=[]}notify(e,t,r,n){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const a=n?this._descriptors(e).filter(n):this._descriptors(e),s=this._notify(a,e,t,r);return"afterDestroy"===t&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(e,t,r,n){n=n||{};for(const a of e){const e=a.plugin;if(!1===RP(e[r],[t,n,a.options],e)&&n.cancelable)return!1}return!0}invalidate(){OP(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,n=TP(r.options&&r.options.plugins,{}),a=function(e){const t={},r=[],n=Object.keys(YR.plugins.items);for(let s=0;s<n.length;s++)r.push(YR.getPlugin(n[s]));const a=e.plugins||[];for(let s=0;s<a.length;s++){const e=a[s];-1===r.indexOf(e)&&(r.push(e),t[e.id]=!0)}return{plugins:r,localIds:t}}(r);return!1!==n||t?function(e,t,r,n){let{plugins:a,localIds:s}=t;const i=[],o=e.getContext();for(const l of a){const t=l.id,a=JR(r[t],n);null!==a&&i.push({plugin:l,options:QR(e.config,{plugin:l,local:s[t]},a,o)})}return i}(e,a,n,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,n=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(n(t,r),e,"stop"),this._notify(n(r,t),e,"start")}}function JR(e,t){return t||!1!==e?!0===e?{}:e:null}function QR(e,t,r,n){let{plugin:a,local:s}=t;const i=e.pluginScopeKeys(a),o=e.getOptionScopes(r,i);return s&&a.defaults&&o.push(a.defaults),e.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ZR(e,t){const r=YA.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function eD(e){if("x"===e||"y"===e||"r"===e)return e}function tD(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function rD(e){if(eD(e))return e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(const a of r){const t=a.axis||tD(a.position)||e.length>1&&eD(e[0].toLowerCase());if(t)return t}throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function nD(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function aD(e,t){const r=WA[e.type]||{scales:{}},n=t.scales||{},a=ZR(e.type,t),s=Object.create(null);return Object.keys(n).forEach(t=>{const i=n[t];if(!EP(i))return console.error("Invalid scale configuration for scale: ".concat(t));if(i._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const o=rD(t,i,function(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(r.length)return nD(e,"x",r[0])||nD(e,"y",r[0])}return{}}(t,e),YA.scales[i.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,a),c=r.scales||{};s[t]=zP(Object.create(null),[{axis:o},i,c[o],c[l]])}),e.data.datasets.forEach(r=>{const a=r.type||e.type,i=r.indexAxis||ZR(a,t),o=(WA[a]||{}).scales||{};Object.keys(o).forEach(e=>{const t=function(e,t){let r=e;return"_index_"===e?r=t:"_value_"===e&&(r="x"===t?"y":"x"),r}(e,i),a=r[t+"AxisID"]||t;s[a]=s[a]||Object.create(null),zP(s[a],[{axis:t},n[a],o[e]])})}),Object.keys(s).forEach(e=>{const t=s[e];zP(t,[YA.scales[t.type],YA.scale])}),s}function sD(e){const t=e.options||(e.options={});t.plugins=TP(t.plugins,{}),t.scales=aD(e,t)}function iD(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const oD=new Map,lD=new Set;function cD(e,t){let r=oD.get(e);return r||(r=t(),oD.set(e,r),lD.add(r)),r}const dD=(e,t,r)=>{const n=WP(t,r);void 0!==n&&e.add(n)};class uD{constructor(e){this._config=function(e){return(e=e||{}).data=iD(e.data),sD(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=iD(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),sD(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cD(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return cD("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return cD("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return cD("".concat(r,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let n=r.get(e);return n&&!t||(n=new Map,r.set(e,n)),n}getOptionScopes(e,t,r){const{options:n,type:a}=this,s=this._cachedScopes(e,r),i=s.get(t);if(i)return i;const o=new Set;t.forEach(t=>{e&&(o.add(e),t.forEach(t=>dD(o,e,t))),t.forEach(e=>dD(o,n,e)),t.forEach(e=>dD(o,WA[a]||{},e)),t.forEach(e=>dD(o,YA,e)),t.forEach(e=>dD(o,qA,e))});const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),lD.has(t)&&s.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,WA[t]||{},YA.datasets[t]||{},{type:t},YA,qA]}resolveNamedOptions(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const a={$shared:!0},{resolver:s,subPrefixes:i}=hD(this._resolverCache,e,n);let o=s;if(function(e,t){const{isScriptable:r,isIndexable:n}=wT(e);for(const a of t){const t=r(a),s=n(a),i=(s||t)&&e[a];if(t&&($P(i)||pD(i))||s&&CP(i))return!0}return!1}(s,t)){a.$shared=!1;o=jT(s,r=$P(r)?r():r,this.createResolver(e,r,i))}for(const l of t)a[l]=o[l];return a}createResolver(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],n=arguments.length>3?arguments[3]:void 0;const{resolver:a}=hD(this._resolverCache,e,r);return EP(t)?jT(a,t,void 0,n):a}}function hD(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));const a=r.join();let s=n.get(a);if(!s){s={resolver:kT(t,r),subPrefixes:r.filter(e=>!e.toLowerCase().includes("hover"))},n.set(a,s)}return s}const pD=e=>EP(e)&&Object.getOwnPropertyNames(e).some(t=>$P(e[t]));const mD=["top","bottom","left","right","chartArea"];function fD(e,t){return"top"===e||"bottom"===e||-1===mD.indexOf(e)&&"x"===t}function gD(e,t){return function(r,n){return r[e]===n[e]?r[t]-n[t]:r[e]-n[e]}}function xD(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),RP(r&&r.onComplete,[e],t)}function bD(e){const t=e.chart,r=t.options.animation;RP(r&&r.onProgress,[e],t)}function yD(e){return HT()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const vD={},_D=e=>{const t=yD(e);return Object.values(vD).filter(e=>e.canvas===t).pop()};function kD(e,t,r){const n=Object.keys(e);for(const a of n){const n=+a;if(n>=t){const s=e[a];delete e[a],(r>0||n>t)&&(e[n+r]=s)}}}class jD{static register(){YR.add(...arguments),wD()}static unregister(){YR.remove(...arguments),wD()}constructor(e,t){const r=this.config=new uD(t),n=yD(e),a=_D(n);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const s=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||function(e){return!HT()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?vR:DR}(n)),this.platform.updateConfig(r);const i=this.platform.acquireContext(n,s.aspectRatio),o=i&&i.canvas,l=o&&o.height,c=o&&o.width;this.id=SP(),this.ctx=i,this.canvas=o,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new XR,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let r;return function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return t?(clearTimeout(r),r=setTimeout(e,t,a)):e.apply(this,a),t}}(e=>this.update(e),s.resizeDelay||0),this._dataChanges=[],vD[this.id]=this,i&&o?(xM.listen(this,"complete",xD),xM.listen(this,"progress",bD),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:n,_aspectRatio:a}=this;return OP(e)?t&&a?a:n?r/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return YR}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():QT(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ZA(this.canvas,this.ctx),this}stop(){return xM.stop(this),this}resize(e,t){xM.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,n=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(n,e,t,a),i=r.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,QT(this,i,!0)&&(this.notifyPlugins("resize",{size:s}),RP(r.onResize,[this,s],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){DP(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,n=Object.keys(r).reduce((e,t)=>(e[t]=!1,e),{});let a=[];t&&(a=a.concat(Object.keys(t).map(e=>{const r=t[e],n=rD(e,r),a="r"===n,s="x"===n;return{options:r,dposition:a?"chartArea":s?"bottom":"left",dtype:a?"radialLinear":s?"category":"linear"}}))),DP(a,t=>{const a=t.options,s=a.id,i=rD(s,a),o=TP(a.type,t.dtype);void 0!==a.position&&fD(a.position,i)===fD(t.dposition)||(a.position=t.dposition),n[s]=!0;let l=null;if(s in r&&r[s].type===o)l=r[s];else{l=new(YR.getScale(o))({id:s,type:o,ctx:this.ctx,chart:this}),r[l.id]=l}l.init(a,e)}),DP(n,(e,t)=>{e||delete r[t]}),DP(r,e=>{bR.configure(this,e,e.options),bR.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((e,t)=>e.index-t.index),r>t){for(let e=t;e<r;++e)this._destroyDatasetMeta(e);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(gD("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,r)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,n;for(this._removeUnreferencedMetasets(),r=0,n=t.length;r<n;r++){const n=t[r];let a=this.getDatasetMeta(r);const s=n.type||this.config.type;if(a.type&&a.type!==s&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=s,a.indexAxis=n.indexAxis||ZR(s,this.options),a.order=n.order||0,a.index=r,a.label=""+n.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{const t=YR.getController(s),{datasetElementType:n,dataElementType:i}=YA.datasets[s];Object.assign(t,{dataElementType:YR.getElement(i),datasetElementType:n&&YR.getElement(n)}),a.controller=new t(this,r),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){DP(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!n&&-1===a.indexOf(e);e.buildOrUpdateElements(t),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=r.layout.autoPadding?s:0,this._updateLayout(s),n||DP(a,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(gD("z","_idx"));const{_active:i,_lastEvent:o}=this;o?this._eventHandler(o,!0):i.length&&this._updateHoverStyles(i,i,!0),this.render()}_updateScales(){DP(this.scales,e=>{bR.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);KP(t,r)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:n,count:a}of t){kD(e,n,"_removeElements"===r?-a:a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),n=r(0);for(let a=1;a<t;a++)if(!KP(n,r(a)))return;return Array.from(n).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;bR.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],DP(this.boxes,e=>{r&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,$P(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),n={meta:r,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(r.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(xM.has(this)?this.attached&&!xM.running(this)&&xM.start(this):(this.draw(),xD({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let n,a;for(n=0,a=t.length;n<a;++n){const a=t[n];e&&!a.visible||r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},n=fM(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(n&&nT(t,n),e.controller.draw(),n&&aT(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return rT(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,n){const a=sR.modes[t];return"function"===typeof a?a(this,e,r,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let n=r.filter(e=>e&&e._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(n)),n}getContext(){return this.$context||(this.$context=_T(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return"boolean"===typeof r.hidden?!r.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const n=r?"show":"hide",a=this.getDatasetMeta(e),s=a.controller._resolveAnimations(void 0,n);GP(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),s.update(a,{visible:r}),this.update(t=>t.datasetIndex===e?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),xM.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ZA(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete vD[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(r,n)=>{t.addEventListener(this,r,n),e[r]=n},n=(e,t,r)=>{e.offsetX=t,e.offsetY=r,this._eventHandler(e)};DP(this.options.events,e=>r(e,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(r,n)=>{t.addEventListener(this,r,n),e[r]=n},n=(r,n)=>{e[r]&&(t.removeEventListener(this,r,n),delete e[r])},a=(e,t)=>{this.canvas&&this.resize(e,t)};let s;const i=()=>{n("attach",i),this.attached=!0,this.resize(),r("resize",a),r("detach",s)};s=()=>{this.attached=!1,n("resize",a),this._stop(),this._resize(0,0),r("attach",i)},t.isAttached(this.canvas)?i():s()}unbindEvents(){DP(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},DP(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const n=r?"set":"remove";let a,s,i,o;for("dataset"===t&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+n+"DatasetHoverStyle"]()),i=0,o=e.length;i<o;++i){s=e[i];const t=s&&this.getDatasetMeta(s.datasetIndex).controller;t&&t[n+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(e=>{let{datasetIndex:t,index:r}=e;const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[r],index:r}});!IP(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,r){const n=this.options.hover,a=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),s=a(t,e),i=r?e:a(e,t);s.length&&this.updateHoverStyle(s,n.mode,!1),i.length&&n.mode&&this.updateHoverStyle(i,n.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},n=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",r,n))return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,n),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:n=[],options:a}=this,s=t,i=this._getActiveElements(e,n,r,s),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,r,n){return r&&"mouseout"!==e.type?n?t:e:null}(e,this._lastEvent,r,o);r&&(this._lastEvent=null,RP(a.onHover,[e,i,this],this),o&&RP(a.onClick,[e,i,this],this));const c=!IP(i,n);return(c||t)&&(this._active=i,this._updateHoverStyles(i,n,t)),this._lastEvent=l,c}_getActiveElements(e,t,r,n){if("mouseout"===e.type)return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,n)}}function wD(){return DP(jD.instances,e=>e._plugins.invalidate())}function ND(e,t,r,n){const a=function(e){return fT(e,["outerStart","outerEnd","innerStart","innerEnd"])}(e.options.borderRadius),s=(r-t)/2,i=Math.min(s,n*t/2),o=e=>{const t=(r-Math.min(s,e))*n/2;return xA(e,0,Math.min(s,t))};return{outerStart:o(a.outerStart),outerEnd:o(a.outerEnd),innerStart:xA(a.innerStart,0,i),innerEnd:xA(a.innerEnd,0,i)}}function SD(e,t,r,n){return{x:r+e*Math.cos(t),y:n+e*Math.sin(t)}}function OD(e,t,r,n,a,s){const{x:i,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,u=Math.max(t.outerRadius+n+r-c,0),h=d>0?d+n+r+c:0;let p=0;const m=a-l;if(n){const e=((d>0?d-n:0)+(u>0?u-n:0))/2;p=(m-(0!==e?m*e/(e+n):m))/2}const f=(m-Math.max(.001,m*u-r/YP)/u)/2,g=l+f+p,x=a-f-p,{outerStart:b,outerEnd:y,innerStart:v,innerEnd:_}=ND(t,h,u,x-g),k=u-b,j=u-y,w=g+b/k,N=x-y/j,S=h+v,O=h+_,C=g+v/S,E=x-_/O;if(e.beginPath(),s){const t=(w+N)/2;if(e.arc(i,o,u,w,t),e.arc(i,o,u,t,N),y>0){const t=SD(j,N,i,o);e.arc(t.x,t.y,y,N,x+eA)}const r=SD(O,x,i,o);if(e.lineTo(r.x,r.y),_>0){const t=SD(O,E,i,o);e.arc(t.x,t.y,_,x+eA,E+Math.PI)}const n=(x-_/h+(g+v/h))/2;if(e.arc(i,o,h,x-_/h,n,!0),e.arc(i,o,h,n,g+v/h,!0),v>0){const t=SD(S,C,i,o);e.arc(t.x,t.y,v,C+Math.PI,g-eA)}const a=SD(k,g,i,o);if(e.lineTo(a.x,a.y),b>0){const t=SD(k,w,i,o);e.arc(t.x,t.y,b,g-eA,w)}}else{e.moveTo(i,o);const t=Math.cos(w)*u+i,r=Math.sin(w)*u+o;e.lineTo(t,r);const n=Math.cos(N)*u+i,a=Math.sin(N)*u+o;e.lineTo(n,a)}e.closePath()}function CD(e,t,r,n,a){const{fullCircles:s,startAngle:i,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:u,borderDashOffset:h,borderRadius:p}=l,m="inner"===l.borderAlign;if(!c)return;e.setLineDash(u||[]),e.lineDashOffset=h,m?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let f=t.endAngle;if(s){OD(e,t,r,n,f,a);for(let t=0;t<s;++t)e.stroke();isNaN(o)||(f=i+(o%XP||XP))}m&&function(e,t,r){const{startAngle:n,pixelMargin:a,x:s,y:i,outerRadius:o,innerRadius:l}=t;let c=a/o;e.beginPath(),e.arc(s,i,o,n-c,r+c),l>a?(c=a/l,e.arc(s,i,l,r+c,n-c,!0)):e.arc(s,i,a,r+eA,n-eA),e.closePath(),e.clip()}(e,t,f),l.selfJoin&&f-i>=YP&&0===p&&"miter"!==d&&function(e,t,r){const{startAngle:n,x:a,y:s,outerRadius:i,innerRadius:o,options:l}=t,{borderWidth:c,borderJoinStyle:d}=l,u=Math.min(c/i,fA(n-r));if(e.beginPath(),e.arc(a,s,i-c/2,n+u/2,r-u/2),o>0){const t=Math.min(c/o,fA(n-r));e.arc(a,s,o+c/2,r-t/2,n+t/2,!0)}else{const t=Math.min(c/2,i*fA(n-r));if("round"===d)e.arc(a,s,t,r-YP/2,n+YP/2,!0);else if("bevel"===d){const i=2*t*t,o=-i*Math.cos(r+YP/2)+a,l=-i*Math.sin(r+YP/2)+s,c=i*Math.cos(n+YP/2)+a,d=i*Math.sin(n+YP/2)+s;e.lineTo(o,l),e.lineTo(c,d)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,f),s||(OD(e,t,r,n,f,a),e.stroke())}Re(jD,"defaults",YA),Re(jD,"instances",vD),Re(jD,"overrides",WA),Re(jD,"registry",YR),Re(jD,"version","4.5.0"),Re(jD,"getChart",_D);class ED extends IR{constructor(e){super(),Re(this,"circumference",void 0),Re(this,"endAngle",void 0),Re(this,"fullCircles",void 0),Re(this,"innerRadius",void 0),Re(this,"outerRadius",void 0),Re(this,"pixelMargin",void 0),Re(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const n=this.getProps(["x","y"],r),{angle:a,distance:s}=hA(n,{x:e,y:t}),{startAngle:i,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),u=(this.options.spacing+this.options.borderWidth)/2,h=TP(d,o-i),p=gA(a,i,o)&&i!==o,m=h>=XP||p,f=bA(s,l+u,c+u);return m&&f}getCenterPoint(e){const{x:t,y:r,startAngle:n,endAngle:a,innerRadius:s,outerRadius:i}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(n+a)/2,d=(s+i+l+o)/2;return{x:t+Math.cos(c)*d,y:r+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,n=(t.offset||0)/4,a=(t.spacing||0)/2,s=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=r>XP?Math.floor(r/XP):0,0===r||this.innerRadius<0||this.outerRadius<0)return;e.save();const i=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(i)*n,Math.sin(i)*n);const o=n*(1-Math.sin(Math.min(YP,r||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,r,n,a){const{fullCircles:s,startAngle:i,circumference:o}=t;let l=t.endAngle;if(s){OD(e,t,r,n,l,a);for(let t=0;t<s;++t)e.fill();isNaN(o)||(l=i+(o%XP||XP))}OD(e,t,r,n,l,a),e.fill()}(e,this,o,a,s),CD(e,this,o,a,s),e.restore()}}function PD(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=TP(r.borderCapStyle,t.borderCapStyle),e.setLineDash(TP(r.borderDash,t.borderDash)),e.lineDashOffset=TP(r.borderDashOffset,t.borderDashOffset),e.lineJoin=TP(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=TP(r.borderWidth,t.borderWidth),e.strokeStyle=TP(r.borderColor,t.borderColor)}function AD(e,t,r){e.lineTo(r.x,r.y)}function TD(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.length,{start:a=0,end:s=n-1}=r,{start:i,end:o}=t,l=Math.max(a,i),c=Math.min(s,o),d=a<i&&s<i||a>o&&s>o;return{count:n,start:l,loop:t.loop,ilen:c<l&&!d?n+c-l:c-l}}function MD(e,t,r,n){const{points:a,options:s}=t,{count:i,start:o,loop:l,ilen:c}=TD(a,r,n),d=function(e){return e.stepped?sT:e.tension||"monotone"===e.cubicInterpolationMode?iT:AD}(s);let u,h,p,{move:m=!0,reverse:f}=n||{};for(u=0;u<=c;++u)h=a[(o+(f?c-u:u))%i],h.skip||(m?(e.moveTo(h.x,h.y),m=!1):d(e,p,h,f,s.stepped),p=h);return l&&(h=a[(o+(f?c:0))%i],d(e,p,h,f,s.stepped)),!!l}function RD(e,t,r,n){const a=t.points,{count:s,start:i,ilen:o}=TD(a,r,n),{move:l=!0,reverse:c}=n||{};let d,u,h,p,m,f,g=0,x=0;const b=e=>(i+(c?o-e:e))%s,y=()=>{p!==m&&(e.lineTo(g,m),e.lineTo(g,p),e.lineTo(g,f))};for(l&&(u=a[b(0)],e.moveTo(u.x,u.y)),d=0;d<=o;++d){if(u=a[b(d)],u.skip)continue;const t=u.x,r=u.y,n=0|t;n===h?(r<p?p=r:r>m&&(m=r),g=(x*g+t)/++x):(y(),e.lineTo(t,r),h=n,x=0,p=m=r),f=r}y()}function DD(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!r?RD:MD}Re(ED,"id","arc"),Re(ED,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Re(ED,"defaultRoutes",{backgroundColor:"backgroundColor"}),Re(ED,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const ID="function"===typeof Path2D;function LD(e,t,r,n){ID&&!t.options.segment?function(e,t,r,n){let a=t._path;a||(a=t._path=new Path2D,t.path(a,r,n)&&a.closePath()),PD(e,t.options),e.stroke(a)}(e,t,r,n):function(e,t,r,n){const{segments:a,options:s}=t,i=DD(t);for(const o of a)PD(e,s,o.style),e.beginPath(),i(e,t,o,{start:r,end:r+n-1})&&e.closePath(),e.stroke()}(e,t,r,n)}class FD extends IR{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||"monotone"===r.cubicInterpolationMode)&&!r.stepped&&!this._pointsUpdated){const n=r.spanGaps?this._loop:this._fullLoop;VT(this._points,r,e,n,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const r=e.points,n=e.options.spanGaps,a=r.length;if(!a)return[];const s=!!e._loop,{start:i,end:o}=function(e,t,r,n){let a=0,s=t-1;if(r&&!n)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,r&&(s+=a);s>a&&e[s%t].skip;)s--;return s%=t,{start:a,end:s}}(r,a,s,n);return uM(e,!0===n?[{start:i,end:o,loop:s}]:function(e,t,r,n){const a=e.length,s=[];let i,o=t,l=e[t];for(i=t+1;i<=r;++i){const r=e[i%a];r.skip||r.stop?l.skip||(n=!1,s.push({start:t%a,end:(i-1)%a,loop:n}),t=o=r.stop?i:null):(o=i,l.skip&&(t=i)),l=r}return null!==o&&s.push({start:t%a,end:o%a,loop:n}),s}(r,i,o<i?o+a:o,!!e._fullLoop&&0===i&&o===a-1),r,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,n=e[t],a=this.points,s=dM(this,{property:t,start:n,end:n});if(!s.length)return;const i=[],o=function(e){return e.stepped?rM:e.tension||"monotone"===e.cubicInterpolationMode?nM:tM}(r);let l,c;for(l=0,c=s.length;l<c;++l){const{start:c,end:d}=s[l],u=a[c],h=a[d];if(u===h){i.push(u);continue}const p=o(u,h,Math.abs((n-u[t])/(h[t]-u[t])),r.stepped);p[t]=e[t],i.push(p)}return 1===i.length?i[0]:i}pathSegment(e,t,r){return DD(this)(e,this,t,r)}path(e,t,r){const n=this.segments,a=DD(this);let s=this._loop;t=t||0,r=r||this.points.length-t;for(const i of n)s&=a(e,this,i,{start:t,end:t+r-1});return!!s}draw(e,t,r,n){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),LD(e,this,r,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function BD(e,t,r,n){const a=e.options,{[r]:s}=e.getProps([r],n);return Math.abs(t-s)<a.radius+a.hitRadius}Re(FD,"id","line"),Re(FD,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Re(FD,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Re(FD,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class UD extends IR{constructor(e){super(),Re(this,"parsed",void 0),Re(this,"skip",void 0),Re(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const n=this.options,{x:a,y:s}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-s,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return BD(this,e,"x",t)}inYRange(e,t){return BD(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const r=this.options;this.skip||r.radius<.1||!rT(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,eT(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function zD(e,t){const{x:r,y:n,base:a,width:s,height:i}=e.getProps(["x","y","base","width","height"],t);let o,l,c,d,u;return e.horizontal?(u=i/2,o=Math.min(r,a),l=Math.max(r,a),c=n-u,d=n+u):(u=s/2,o=r-u,l=r+u,c=Math.min(n,a),d=Math.max(n,a)),{left:o,top:c,right:l,bottom:d}}function VD(e,t,r,n){return e?0:xA(t,r,n)}function HD(e){const t=zD(e),r=t.right-t.left,n=t.bottom-t.top,a=function(e,t,r){const n=e.options.borderWidth,a=e.borderSkipped,s=gT(n);return{t:VD(a.top,s.top,0,r),r:VD(a.right,s.right,0,t),b:VD(a.bottom,s.bottom,0,r),l:VD(a.left,s.left,0,t)}}(e,r/2,n/2),s=function(e,t,r){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),a=e.options.borderRadius,s=xT(a),i=Math.min(t,r),o=e.borderSkipped,l=n||EP(a);return{topLeft:VD(!l||o.top||o.left,s.topLeft,0,i),topRight:VD(!l||o.top||o.right,s.topRight,0,i),bottomLeft:VD(!l||o.bottom||o.left,s.bottomLeft,0,i),bottomRight:VD(!l||o.bottom||o.right,s.bottomRight,0,i)}}(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n,radius:s},inner:{x:t.left+a.l,y:t.top+a.t,w:r-a.l-a.r,h:n-a.t-a.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,s.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(a.b,a.r))}}}}function WD(e,t,r,n){const a=null===t,s=null===r,i=e&&!(a&&s)&&zD(e,n);return i&&(a||bA(t,i.left,i.right))&&(s||bA(r,i.top,i.bottom))}function qD(e,t){e.rect(t.x,t.y,t.w,t.h)}function GD(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.x!==r.x?-t:0,a=e.y!==r.y?-t:0,s=(e.x+e.w!==r.x+r.w?t:0)-n,i=(e.y+e.h!==r.y+r.h?t:0)-a;return{x:e.x+n,y:e.y+a,w:e.w+s,h:e.h+i,radius:e.radius}}Re(UD,"id","point"),Re(UD,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Re(UD,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class $D extends IR{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:n}}=this,{inner:a,outer:s}=HD(this),i=(o=s.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?dT:qD;var o;e.save(),s.w===a.w&&s.h===a.h||(e.beginPath(),i(e,GD(s,t,a)),e.clip(),i(e,GD(a,-t,s)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),i(e,GD(a,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,r){return WD(this,e,t,r)}inXRange(e,t){return WD(this,e,null,t)}inYRange(e,t){return WD(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:n,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+n)/2:t,y:a?r:(r+n)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}Re($D,"id","bar"),Re($D,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Re($D,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const KD=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}};class YD extends IR{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=RP(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,r)=>e.sort(t,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const r=e.labels,n=yT(r.font),a=n.size,s=this._computeTitleHeight(),{boxWidth:i,itemHeight:o}=KD(r,a);let l,c;t.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,a,i,o)+10):(c=this.maxHeight,l=this._fitCols(s,n,i,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,n){const{ctx:a,maxWidth:s,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+i;let d=e;a.textAlign="left",a.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach((e,p)=>{const m=r+t/2+a.measureText(e.text).width;(0===p||l[l.length-1]+m+2*i>s)&&(d+=c,l[l.length-(p>0?0:1)]=0,h+=c,u++),o[p]={left:0,top:h,row:u,width:m,height:n},l[l.length-1]+=m+i}),d}_fitCols(e,t,r,n){const{ctx:a,maxHeight:s,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-e;let d=i,u=0,h=0,p=0,m=0;return this.legendItems.forEach((e,s)=>{const{itemWidth:f,itemHeight:g}=function(e,t,r,n,a){const s=function(e,t,r,n){let a=e.text;a&&"string"!==typeof a&&(a=a.reduce((e,t)=>e.length>t.length?e:t));return t+r.size/2+n.measureText(a).width}(n,e,t,r),i=function(e,t,r){let n=e;"string"!==typeof t.text&&(n=XD(t,r));return n}(a,n,t.lineHeight);return{itemWidth:s,itemHeight:i}}(r,t,a,e,n);s>0&&h+g+2*i>c&&(d+=u+i,l.push({width:u,height:h}),p+=u+i,m++,u=h=0),o[s]={left:p,top:h,col:m,width:f,height:g},u=Math.max(u,f),h+=g+i}),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:n},rtl:a}}=this,s=aM(a,this.left,this.width);if(this.isHorizontal()){let a=0,i=CA(r,this.left+n,this.right-this.lineWidths[a]);for(const o of t)a!==o.row&&(a=o.row,i=CA(r,this.left+n,this.right-this.lineWidths[a])),o.top+=this.top+e+n,o.left=s.leftForLtr(s.x(i),o.width),i+=o.width+n}else{let a=0,i=CA(r,this.top+e+n,this.bottom-this.columnSizes[a].height);for(const o of t)o.col!==a&&(a=o.col,i=CA(r,this.top+e+n,this.bottom-this.columnSizes[a].height)),o.top=i,o.left+=this.left+n,o.left=s.leftForLtr(s.x(o.left),o.width),i+=o.height+n}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;nT(e,this),this._draw(),aT(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:n}=this,{align:a,labels:s}=e,i=YA.color,o=aM(e.rtl,this.left,this.width),l=yT(s.font),{padding:c}=s,d=l.size,u=d/2;let h;this.drawTitle(),n.textAlign=o.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=l.string;const{boxWidth:p,boxHeight:m,itemHeight:f}=KD(s,d),g=this.isHorizontal(),x=this._computeTitleHeight();h=g?{x:CA(a,this.left+c,this.right-r[0]),y:this.top+c+x,line:0}:{x:this.left+c,y:CA(a,this.top+x+c,this.bottom-t[0].height),line:0},sM(this.ctx,e.textDirection);const b=f+c;this.legendItems.forEach((y,v)=>{n.strokeStyle=y.fontColor,n.fillStyle=y.fontColor;const _=n.measureText(y.text).width,k=o.textAlign(y.textAlign||(y.textAlign=s.textAlign)),j=p+u+_;let w=h.x,N=h.y;o.setWidth(this.width),g?v>0&&w+j+c>this.right&&(N=h.y+=b,h.line++,w=h.x=CA(a,this.left+c,this.right-r[h.line])):v>0&&N+b>this.bottom&&(w=h.x=w+t[h.line].width+c,h.line++,N=h.y=CA(a,this.top+x+c,this.bottom-t[h.line].height));if(function(e,t,r){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;n.save();const a=TP(r.lineWidth,1);if(n.fillStyle=TP(r.fillStyle,i),n.lineCap=TP(r.lineCap,"butt"),n.lineDashOffset=TP(r.lineDashOffset,0),n.lineJoin=TP(r.lineJoin,"miter"),n.lineWidth=a,n.strokeStyle=TP(r.strokeStyle,i),n.setLineDash(TP(r.lineDash,[])),s.usePointStyle){const i={radius:m*Math.SQRT2/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:a},l=o.xPlus(e,p/2);tT(n,i,l,t+u,s.pointStyleWidth&&p)}else{const s=t+Math.max((d-m)/2,0),i=o.leftForLtr(e,p),l=xT(r.borderRadius);n.beginPath(),Object.values(l).some(e=>0!==e)?dT(n,{x:i,y:s,w:p,h:m,radius:l}):n.rect(i,s,p,m),n.fill(),0!==a&&n.stroke()}n.restore()}(o.x(w),N,y),w=((e,t,r,n)=>e===(n?"left":"right")?r:"center"===e?(t+r)/2:t)(k,w+p+u,g?w+j:this.right,e.rtl),function(e,t,r){cT(n,r.text,e,t+f/2,l,{strikethrough:r.hidden,textAlign:o.textAlign(r.textAlign)})}(o.x(w),N,y),g)h.x+=j+c;else if("string"!==typeof y.text){const e=l.lineHeight;h.y+=XD(y,e)+c}else h.y+=b}),iM(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=yT(t.font),n=bT(t.padding);if(!t.display)return;const a=aM(e.rtl,this.left,this.width),s=this.ctx,i=t.position,o=r.size/2,l=n.top+o;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=CA(e.align,d,this.right-u);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+CA(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=CA(i,d,d+u);s.textAlign=a.textAlign(OA(i)),s.textBaseline="middle",s.strokeStyle=t.color,s.fillStyle=t.color,s.font=r.string,cT(s,t.text,h,c,r)}_computeTitleHeight(){const e=this.options.title,t=yT(e.font),r=bT(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,n,a;if(bA(e,this.left,this.right)&&bA(t,this.top,this.bottom))for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(n=a[r],bA(e,n.left,n.left+n.width)&&bA(t,n.top,n.top+n.height))return this.legendItems[r];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const n=this._hoveredItem,a=((e,t)=>null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index)(n,r);n&&!a&&RP(t.onLeave,[e,n,this],this),this._hoveredItem=r,r&&!a&&RP(t.onHover,[e,r,this],this)}else r&&RP(t.onClick,[e,r,this],this)}}function XD(e,t){return t*(e.text?e.text.length:0)}var JD={id:"legend",_element:YD,start(e,t,r){const n=e.legend=new YD({ctx:e.ctx,options:r,chart:e});bR.configure(e,n,r),bR.addBox(e,n)},stop(e){bR.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const n=e.legend;bR.configure(e,n,r),n.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const n=t.datasetIndex,a=r.chart;a.isDatasetVisible(n)?(a.hide(n),t.hidden=!0):(a.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:a,color:s,useBorderRadius:i,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const l=e.controller.getStyle(r?0:void 0),c=bT(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:n||l.pointStyle,rotation:l.rotation,textAlign:a||l.textAlign,borderRadius:i&&(o||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class QD extends IR{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const n=CP(r.text)?r.text.length:1;this._padding=bT(r.padding);const a=n*yT(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:r,bottom:n,right:a,options:s}=this,i=s.align;let o,l,c,d=0;return this.isHorizontal()?(l=CA(i,r,a),c=t+e,o=a-r):("left"===s.position?(l=r+e,c=CA(i,n,t),d=-.5*YP):(l=a-e,c=CA(i,t,n),d=.5*YP),o=n-t),{titleX:l,titleY:c,maxWidth:o,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=yT(t.font),n=r.lineHeight/2+this._padding.top,{titleX:a,titleY:s,maxWidth:i,rotation:o}=this._drawArgs(n);cT(e,t.text,0,0,r,{color:t.color,maxWidth:i,rotation:o,textAlign:OA(t.align),textBaseline:"middle",translation:[a,s]})}}var ZD={id:"title",_element:QD,start(e,t,r){!function(e,t){const r=new QD({ctx:e.ctx,options:t,chart:e});bR.configure(e,r,t),bR.addBox(e,r),e.titleBlock=r}(e,r)},stop(e){const t=e.titleBlock;bR.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const n=e.titleBlock;bR.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const eI={average(e){if(!e.length)return!1;let t,r,n=new Set,a=0,s=0;for(t=0,r=e.length;t<r;++t){const r=e[t].element;if(r&&r.hasValue()){const e=r.tooltipPosition();n.add(e.x),a+=e.y,++s}}if(0===s||0===n.size)return!1;const i=[...n].reduce((e,t)=>e+t)/n.size;return{x:i,y:a/s}},nearest(e,t){if(!e.length)return!1;let r,n,a,s=t.x,i=t.y,o=Number.POSITIVE_INFINITY;for(r=0,n=e.length;r<n;++r){const n=e[r].element;if(n&&n.hasValue()){const e=pA(t,n.getCenterPoint());e<o&&(o=e,a=n)}}if(a){const e=a.tooltipPosition();s=e.x,i=e.y}return{x:s,y:i}}};function tI(e,t){return t&&(CP(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function rI(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function nI(e,t){const{element:r,datasetIndex:n,index:a}=t,s=e.getDatasetMeta(n).controller,{label:i,value:o}=s.getLabelAndValue(a);return{chart:e,label:i,parsed:s.getParsed(a),raw:e.data.datasets[n].data[a],formattedValue:o,dataset:s.getDataset(),dataIndex:a,datasetIndex:n,element:r}}function aI(e,t){const r=e.chart.ctx,{body:n,footer:a,title:s}=e,{boxWidth:i,boxHeight:o}=t,l=yT(t.bodyFont),c=yT(t.titleFont),d=yT(t.footerFont),u=s.length,h=a.length,p=n.length,m=bT(t.padding);let f=m.height,g=0,x=n.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(x+=e.beforeBody.length+e.afterBody.length,u&&(f+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),x){f+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(x-p)*l.lineHeight+(x-1)*t.bodySpacing}h&&(f+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);let b=0;const y=function(e){g=Math.max(g,r.measureText(e).width+b)};return r.save(),r.font=c.string,DP(e.title,y),r.font=l.string,DP(e.beforeBody.concat(e.afterBody),y),b=t.displayColors?i+2+t.boxPadding:0,DP(n,e=>{DP(e.before,y),DP(e.lines,y),DP(e.after,y)}),b=0,r.font=d.string,DP(e.footer,y),r.restore(),g+=m.width,{width:g,height:f}}function sI(e,t,r,n){const{x:a,width:s}=r,{width:i,chartArea:{left:o,right:l}}=e;let c="center";return"center"===n?c=a<=(o+l)/2?"left":"right":a<=s/2?c="left":a>=i-s/2&&(c="right"),function(e,t,r,n){const{x:a,width:s}=n,i=r.caretSize+r.caretPadding;return"left"===e&&a+s+i>t.width||"right"===e&&a-s-i<0||void 0}(c,e,t,r)&&(c="center"),c}function iI(e,t,r){const n=r.yAlign||t.yAlign||function(e,t){const{y:r,height:n}=t;return r<n/2?"top":r>e.height-n/2?"bottom":"center"}(e,r);return{xAlign:r.xAlign||t.xAlign||sI(e,t,r,n),yAlign:n}}function oI(e,t,r,n){const{caretSize:a,caretPadding:s,cornerRadius:i}=e,{xAlign:o,yAlign:l}=r,c=a+s,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=xT(i);let m=function(e,t){let{x:r,width:n}=e;return"right"===t?r-=n:"center"===t&&(r-=n/2),r}(t,o);const f=function(e,t,r){let{y:n,height:a}=e;return"top"===t?n+=r:n-="bottom"===t?a+r:a/2,n}(t,l,c);return"center"===l?"left"===o?m+=c:"right"===o&&(m-=c):"left"===o?m-=Math.max(d,h)+a:"right"===o&&(m+=Math.max(u,p)+a),{x:xA(m,0,n.width-t.width),y:xA(f,0,n.height-t.height)}}function lI(e,t,r){const n=bT(r.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-n.right:e.x+n.left}function cI(e){return tI([],rI(e))}function dI(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const uI={beforeTitle:NP,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,n=r?r.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return r[t.dataIndex]}return""},afterTitle:NP,beforeBody:NP,beforeLabel:NP,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return OP(r)||(t+=r),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:NP,afterBody:NP,beforeFooter:NP,footer:NP,afterFooter:NP};function hI(e,t,r,n){const a=e[t].call(r,n);return"undefined"===typeof a?uI[t].call(r,n):a}class pI extends IR{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),n=r.enabled&&t.options.animation&&r.animations,a=new _M(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,r=this._tooltipItems,_T(e,{tooltip:t,tooltipItems:r,type:"tooltip"})));var e,t,r}getTitle(e,t){const{callbacks:r}=t,n=hI(r,"beforeTitle",this,e),a=hI(r,"title",this,e),s=hI(r,"afterTitle",this,e);let i=[];return i=tI(i,rI(n)),i=tI(i,rI(a)),i=tI(i,rI(s)),i}getBeforeBody(e,t){return cI(hI(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,n=[];return DP(e,e=>{const t={before:[],lines:[],after:[]},a=dI(r,e);tI(t.before,rI(hI(a,"beforeLabel",this,e))),tI(t.lines,hI(a,"label",this,e)),tI(t.after,rI(hI(a,"afterLabel",this,e))),n.push(t)}),n}getAfterBody(e,t){return cI(hI(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,n=hI(r,"beforeFooter",this,e),a=hI(r,"footer",this,e),s=hI(r,"afterFooter",this,e);let i=[];return i=tI(i,rI(n)),i=tI(i,rI(a)),i=tI(i,rI(s)),i}_createItems(e){const t=this._active,r=this.chart.data,n=[],a=[],s=[];let i,o,l=[];for(i=0,o=t.length;i<o;++i)l.push(nI(this.chart,t[i]));return e.filter&&(l=l.filter((t,n,a)=>e.filter(t,n,a,r))),e.itemSort&&(l=l.sort((t,n)=>e.itemSort(t,n,r))),DP(l,t=>{const r=dI(e.callbacks,t);n.push(hI(r,"labelColor",this,t)),a.push(hI(r,"labelPointStyle",this,t)),s.push(hI(r,"labelTextColor",this,t))}),this.labelColors=n,this.labelPointStyles=a,this.labelTextColors=s,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),n=this._active;let a,s=[];if(n.length){const e=eI[r.position].call(this,n,this._eventPosition);s=this._createItems(r),this.title=this.getTitle(s,r),this.beforeBody=this.getBeforeBody(s,r),this.body=this.getBody(s,r),this.afterBody=this.getAfterBody(s,r),this.footer=this.getFooter(s,r);const t=this._size=aI(this,r),i=Object.assign({},e,t),o=iI(this.chart,r,i),l=oI(r,i,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,a={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=s,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,n){const a=this.getCaretPosition(e,r,n);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:n,yAlign:a}=this,{caretSize:s,cornerRadius:i}=r,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=xT(i),{x:u,y:h}=e,{width:p,height:m}=t;let f,g,x,b,y,v;return"center"===a?(y=h+m/2,"left"===n?(f=u,g=f-s,b=y+s,v=y-s):(f=u+p,g=f+s,b=y-s,v=y+s),x=f):(g="left"===n?u+Math.max(o,c)+s:"right"===n?u+p-Math.max(l,d)-s:this.caretX,"top"===a?(b=h,y=b-s,f=g-s,x=g+s):(b=h+m,y=b+s,f=g+s,x=g-s),v=b),{x1:f,x2:g,x3:x,y1:b,y2:y,y3:v}}drawTitle(e,t,r){const n=this.title,a=n.length;let s,i,o;if(a){const l=aM(r.rtl,this.x,this.width);for(e.x=lI(this,r.titleAlign,r),t.textAlign=l.textAlign(r.titleAlign),t.textBaseline="middle",s=yT(r.titleFont),i=r.titleSpacing,t.fillStyle=r.titleColor,t.font=s.string,o=0;o<a;++o)t.fillText(n[o],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+i,o+1===a&&(e.y+=r.titleMarginBottom-i)}}_drawColorBox(e,t,r,n,a){const s=this.labelColors[r],i=this.labelPointStyles[r],{boxHeight:o,boxWidth:l}=a,c=yT(a.bodyFont),d=lI(this,"left",a),u=n.x(d),h=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+h;if(a.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:1},r=n.leftForLtr(u,l)+l/2,c=p+o/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,eT(e,t,r,c),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,eT(e,t,r,c)}else{e.lineWidth=EP(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=n.leftForLtr(u,l),r=n.leftForLtr(n.xPlus(u,1),l-2),i=xT(s.borderRadius);Object.values(i).some(e=>0!==e)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,dT(e,{x:t,y:p,w:l,h:o,radius:i}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),dT(e,{x:r,y:p+1,w:l-2,h:o-2,radius:i}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=s.backgroundColor,e.fillRect(r,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:n}=this,{bodySpacing:a,bodyAlign:s,displayColors:i,boxHeight:o,boxWidth:l,boxPadding:c}=r,d=yT(r.bodyFont);let u=d.lineHeight,h=0;const p=aM(r.rtl,this.x,this.width),m=function(r){t.fillText(r,p.x(e.x+h),e.y+u/2),e.y+=u+a},f=p.textAlign(s);let g,x,b,y,v,_,k;for(t.textAlign=s,t.textBaseline="middle",t.font=d.string,e.x=lI(this,f,r),t.fillStyle=r.bodyColor,DP(this.beforeBody,m),h=i&&"right"!==f?"center"===s?l/2+c:l+2+c:0,y=0,_=n.length;y<_;++y){for(g=n[y],x=this.labelTextColors[y],t.fillStyle=x,DP(g.before,m),b=g.lines,i&&b.length&&(this._drawColorBox(t,e,y,p,r),u=Math.max(d.lineHeight,o)),v=0,k=b.length;v<k;++v)m(b[v]),u=d.lineHeight;DP(g.after,m)}h=0,u=d.lineHeight,DP(this.afterBody,m),e.y-=a}drawFooter(e,t,r){const n=this.footer,a=n.length;let s,i;if(a){const o=aM(r.rtl,this.x,this.width);for(e.x=lI(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=o.textAlign(r.footerAlign),t.textBaseline="middle",s=yT(r.footerFont),t.fillStyle=r.footerColor,t.font=s.string,i=0;i<a;++i)t.fillText(n[i],o.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+r.footerSpacing}}drawBackground(e,t,r,n){const{xAlign:a,yAlign:s}=this,{x:i,y:o}=e,{width:l,height:c}=r,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=xT(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(i+d,o),"top"===s&&this.drawCaret(e,t,r,n),t.lineTo(i+l-u,o),t.quadraticCurveTo(i+l,o,i+l,o+u),"center"===s&&"right"===a&&this.drawCaret(e,t,r,n),t.lineTo(i+l,o+c-p),t.quadraticCurveTo(i+l,o+c,i+l-p,o+c),"bottom"===s&&this.drawCaret(e,t,r,n),t.lineTo(i+h,o+c),t.quadraticCurveTo(i,o+c,i,o+c-h),"center"===s&&"left"===a&&this.drawCaret(e,t,r,n),t.lineTo(i,o+d),t.quadraticCurveTo(i,o,i+d,o),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,n=r&&r.x,a=r&&r.y;if(n||a){const r=eI[e.position].call(this,this._active,this._eventPosition);if(!r)return;const s=this._size=aI(this,e),i=Object.assign({},r,this._size),o=iI(t,e,i),l=oI(e,i,o,t);n._to===l.x&&a._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=s.width,this.height=s.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const s=bT(t.padding),i=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&i&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,n,t),sM(e,t.textDirection),a.y+=s.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),iM(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,n=e.map(e=>{let{datasetIndex:t,index:r}=e;const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[r],index:r}}),a=!IP(r,n),s=this._positionChanged(n,t);(a||s)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,a=this._active||[],s=this._getActiveElements(e,a,t,r),i=this._positionChanged(s,e),o=t||!IP(s,a)||i;return o&&(this._active=s,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,r,n){const a=this.options;if("mouseout"===e.type)return[];if(!n)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));const s=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&s.reverse(),s}_positionChanged(e,t){const{caretX:r,caretY:n,options:a}=this,s=eI[a.position].call(this,e,t);return!1!==s&&(r!==s.x||n!==s.y)}}Re(pI,"positioners",eI);var mI={id:"tooltip",_element:pI,positioners:eI,afterInit(e,t,r){r&&(e.tooltip=new pI({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",Ie(Ie({},r),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:uI},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function fI(e,t,r,n){const a=e.indexOf(t);if(-1===a)return((e,t,r,n)=>("string"===typeof t?(r=e.push(t)-1,n.unshift({index:r,label:t})):isNaN(t)&&(r=null),r))(e,t,r,n);return a!==e.lastIndexOf(t)?r:a}function gI(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class xI extends GR{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:r,label:n}of t)e[r]===n&&e.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(OP(e))return null;const r=this.getLabels();return((e,t)=>null===e?null:xA(Math.round(e),0,t))(t=isFinite(t)&&r[t]===e?t:fI(r,e,TP(t,e),this._addedLabels),r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(r=0),t||(n=this.getLabels().length-1)),this.min=r,this.max=n}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,n=[];let a=this.getLabels();a=0===e&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let s=e;s<=t;s++)n.push({value:s});return n}getLabelForValue(e){return gI.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function bI(e,t){const r=[],{bounds:n,step:a,min:s,max:i,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:u}=e,h=a||1,p=c-1,{min:m,max:f}=t,g=!OP(s),x=!OP(i),b=!OP(l),y=(f-m)/(d+1);let v,_,k,j,w=iA((f-m)/p/h)*h;if(w<1e-14&&!g&&!x)return[{value:m},{value:f}];j=Math.ceil(f/w)-Math.floor(m/w),j>p&&(w=iA(j*w/p/h)*h),OP(o)||(v=Math.pow(10,o),w=Math.ceil(w*v)/v),"ticks"===n?(_=Math.floor(m/w)*w,k=Math.ceil(f/w)*w):(_=m,k=f),g&&x&&a&&function(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}((i-s)/a,w/1e3)?(j=Math.round(Math.min((i-s)/w,c)),w=(i-s)/j,_=s,k=i):b?(_=g?s:_,k=x?i:k,j=l-1,w=(k-_)/j):(j=(k-_)/w,j=sA(j,Math.round(j),w/1e3)?Math.round(j):Math.ceil(j));const N=Math.max(uA(w),uA(_));v=Math.pow(10,OP(o)?N:o),_=Math.round(_*v)/v,k=Math.round(k*v)/v;let S=0;for(g&&(u&&_!==s?(r.push({value:s}),_<s&&S++,sA(Math.round((_+S*w)*v)/v,s,yI(s,y,e))&&S++):_<s&&S++);S<j;++S){const e=Math.round((_+S*w)*v)/v;if(x&&e>i)break;r.push({value:e})}return x&&u&&k!==i?r.length&&sA(r[r.length-1].value,i,yI(i,y,e))?r[r.length-1].value=i:r.push({value:i}):x&&k!==i||r.push({value:k}),r}function yI(e,t,r){let{horizontal:n,minRotation:a}=r;const s=cA(a),i=(n?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}Re(xI,"id","category"),Re(xI,"defaults",{ticks:{callback:gI}});class vI extends GR{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return OP(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:a}=this;const s=e=>n=t?n:e,i=e=>a=r?a:e;if(e){const e=aA(n),t=aA(a);e<0&&t<0?i(0):e>0&&t>0&&s(0)}if(n===a){let t=0===a?1:Math.abs(.05*a);i(a+t),e||s(n-t)}this.min=n,this.max=a}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:r,stepSize:n}=e;return n?(t=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(n," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),r=r||11),r&&(t=Math.min(r,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const n=bI({maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&lA(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const n=(r-t)/Math.max(e.length-1,1)/2;t-=n,r+=n}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return zA(e,this.chart.options.locale,this.options.ticks.format)}}class _I extends vI{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=PP(e)?e:0,this.max=PP(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=cA(this.options.ticks.minRotation),n=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/n))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Re(_I,"id","linear"),Re(_I,"defaults",{ticks:{callback:HA.formatters.numeric}});const kI=e=>Math.floor(nA(e)),jI=(e,t)=>Math.pow(10,kI(e)+t);function wI(e){return 1===e/Math.pow(10,kI(e))}function NI(e,t,r){const n=Math.pow(10,r),a=Math.floor(e/n);return Math.ceil(t/n)-a}function SI(e,t){let{min:r,max:n}=t;r=AP(e.min,r);const a=[],s=kI(r);let i=function(e,t){let r=kI(t-e);for(;NI(e,t,r)>10;)r++;for(;NI(e,t,r)<10;)r--;return Math.min(r,kI(e))}(r,n),o=i<0?Math.pow(10,Math.abs(i)):1;const l=Math.pow(10,i),c=s>i?Math.pow(10,s):0,d=Math.round((r-c)*o)/o,u=Math.floor((r-c)/l/10)*l*10;let h=Math.floor((d-u)/Math.pow(10,i)),p=AP(e.min,Math.round((c+u+h*Math.pow(10,i))*o)/o);for(;p<n;)a.push({value:p,major:wI(p),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(i++,h=2,o=i>=0?1:o),p=Math.round((c+u+h*Math.pow(10,i))*o)/o;const m=AP(e.max,p);return a.push({value:m,major:wI(m),significand:h}),a}class OI extends GR{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=vI.prototype.parse.apply(this,[e,t]);if(0!==r)return PP(r)&&r>0?r:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=PP(e)?Math.max(0,e):null,this.max=PP(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!PP(this._userMin)&&(this.min=e===jI(this.min,0)?jI(this.min,-1):jI(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let r=this.min,n=this.max;const a=t=>r=e?r:t,s=e=>n=t?n:e;r===n&&(r<=0?(a(1),s(10)):(a(jI(r,-1)),s(jI(n,1)))),r<=0&&a(jI(n,-1)),n<=0&&s(jI(r,1)),this.min=r,this.max=n}buildTicks(){const e=this.options,t=SI({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&lA(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":zA(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=nA(e),this._valueRange=nA(this.max)-nA(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(nA(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function CI(e){const t=e.ticks;if(t.display&&e.display){const e=bT(t.backdropPadding);return TP(t.font&&t.font.size,YA.font.size)+e.height}return 0}function EI(e,t,r){return r=CP(r)?r:[r],{w:JA(e,t.string,r),h:r.length*t.lineHeight}}function PI(e,t,r,n,a){return e===n||e===a?{start:t-r/2,end:t+r/2}:e<n||e>a?{start:t-r,end:t}:{start:t,end:t+r}}function AI(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},r=Object.assign({},t),n=[],a=[],s=e._pointLabels.length,i=e.options.pointLabels,o=i.centerPointLabels?YP/s:0;for(let l=0;l<s;l++){const s=i.setContext(e.getPointLabelContext(l));a[l]=s.padding;const c=e.getPointPosition(l,e.drawingArea+a[l],o),d=yT(s.font),u=EI(e.ctx,d,e._pointLabels[l]);n[l]=u;const h=fA(e.getIndexAngle(l)+o),p=Math.round(dA(h));TI(r,t,h,PI(p,c.x,u.w,0,180),PI(p,c.y,u.h,90,270))}e.setCenterPoint(t.l-r.l,r.r-t.r,t.t-r.t,r.b-t.b),e._pointLabelItems=function(e,t,r){const n=[],a=e._pointLabels.length,s=e.options,{centerPointLabels:i,display:o}=s.pointLabels,l={extra:CI(s)/2,additionalAngle:i?YP/a:0};let c;for(let d=0;d<a;d++){l.padding=r[d],l.size=t[d];const a=MI(e,d,l);n.push(a),"auto"===o&&(a.visible=RI(a,c),a.visible&&(c=a))}return n}(e,n,a)}function TI(e,t,r,n,a){const s=Math.abs(Math.sin(r)),i=Math.abs(Math.cos(r));let o=0,l=0;n.start<t.l?(o=(t.l-n.start)/s,e.l=Math.min(e.l,t.l-o)):n.end>t.r&&(o=(n.end-t.r)/s,e.r=Math.max(e.r,t.r+o)),a.start<t.t?(l=(t.t-a.start)/i,e.t=Math.min(e.t,t.t-l)):a.end>t.b&&(l=(a.end-t.b)/i,e.b=Math.max(e.b,t.b+l))}function MI(e,t,r){const n=e.drawingArea,{extra:a,additionalAngle:s,padding:i,size:o}=r,l=e.getPointPosition(t,n+a+i,s),c=Math.round(dA(fA(l.angle+eA))),d=function(e,t,r){90===r||270===r?e-=t/2:(r>270||r<90)&&(e-=t);return e}(l.y,o.h,c),u=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,r){"right"===r?e-=t:"center"===r&&(e-=t/2);return e}(l.x,o.w,u);return{visible:!0,x:l.x,y:d,textAlign:u,left:h,top:d,right:h+o.w,bottom:d+o.h}}function RI(e,t){if(!t)return!0;const{left:r,top:n,right:a,bottom:s}=e;return!(rT({x:r,y:n},t)||rT({x:r,y:s},t)||rT({x:a,y:n},t)||rT({x:a,y:s},t))}function DI(e,t,r){const{left:n,top:a,right:s,bottom:i}=r,{backdropColor:o}=t;if(!OP(o)){const r=xT(t.borderRadius),l=bT(t.backdropPadding);e.fillStyle=o;const c=n-l.left,d=a-l.top,u=s-n+l.width,h=i-a+l.height;Object.values(r).some(e=>0!==e)?(e.beginPath(),dT(e,{x:c,y:d,w:u,h:h,radius:r}),e.fill()):e.fillRect(c,d,u,h)}}function II(e,t,r,n){const{ctx:a}=e;if(r)a.arc(e.xCenter,e.yCenter,t,0,XP);else{let r=e.getPointPosition(0,t);a.moveTo(r.x,r.y);for(let s=1;s<n;s++)r=e.getPointPosition(s,t),a.lineTo(r.x,r.y)}}Re(OI,"id","logarithmic"),Re(OI,"defaults",{ticks:{callback:HA.formatters.logarithmic,major:{enabled:!0}}});class LI extends vI{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=bT(CI(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=PP(e)&&!isNaN(e)?e:0,this.max=PP(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/CI(this.options))}generateTickLabels(e){vI.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const r=RP(this.options.pointLabels.callback,[e,t],this);return r||0===r?r:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?AI(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,n))}getIndexAngle(e){return fA(e*(XP/(this._pointLabels.length||1))+cA(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(OP(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(OP(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const r=t[e];return function(e,t,r){return _T(e,{label:r,index:t,type:"pointLabel"})}(this.getContext(),e,r)}}getPointPosition(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.getIndexAngle(e)-eA+r;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:n,bottom:a}=this._pointLabelItems[e];return{left:t,top:r,right:n,bottom:a}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),II(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:n,border:a}=t,s=this._pointLabels.length;let i,o,l;if(t.pointLabels.display&&function(e,t){const{ctx:r,options:{pointLabels:n}}=e;for(let a=t-1;a>=0;a--){const t=e._pointLabelItems[a];if(!t.visible)continue;const s=n.setContext(e.getPointLabelContext(a));DI(r,s,t);const i=yT(s.font),{x:o,y:l,textAlign:c}=t;cT(r,e._pointLabels[a],o,l+i.lineHeight/2,i,{color:s.color,textAlign:c,textBaseline:"middle"})}}(this,s),n.display&&this.ticks.forEach((e,t)=>{if(0!==t||0===t&&this.min<0){o=this.getDistanceFromCenterForValue(e.value);const r=this.getContext(t),i=n.setContext(r),l=a.setContext(r);!function(e,t,r,n,a){const s=e.ctx,i=t.circular,{color:o,lineWidth:l}=t;!i&&!n||!o||!l||r<0||(s.save(),s.strokeStyle=o,s.lineWidth=l,s.setLineDash(a.dash||[]),s.lineDashOffset=a.dashOffset,s.beginPath(),II(e,r,i,n),s.closePath(),s.stroke(),s.restore())}(this,i,o,s,l)}}),r.display){for(e.save(),i=s-1;i>=0;i--){const n=r.setContext(this.getPointLabelContext(i)),{color:a,lineWidth:s}=n;s&&a&&(e.lineWidth=s,e.strokeStyle=a,e.setLineDash(n.borderDash),e.lineDashOffset=n.borderDashOffset,o=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(i,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const n=this.getIndexAngle(0);let a,s;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((n,i)=>{if(0===i&&this.min>=0&&!t.reverse)return;const o=r.setContext(this.getContext(i)),l=yT(o.font);if(a=this.getDistanceFromCenterForValue(this.ticks[i].value),o.showLabelBackdrop){e.font=l.string,s=e.measureText(n.label).width,e.fillStyle=o.backdropColor;const t=bT(o.backdropPadding);e.fillRect(-s/2-t.left,-a-l.size/2-t.top,s+t.width,l.size+t.height)}cT(e,n.label,0,-a,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})}),e.restore()}drawTitle(){}}Re(LI,"id","radialLinear"),Re(LI,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:HA.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),Re(LI,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Re(LI,"descriptors",{angleLines:{_fallback:"grid"}});const FI={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},BI=Object.keys(FI);function UI(e,t){return e-t}function zI(e,t){if(OP(t))return null;const r=e._adapter,{parser:n,round:a,isoWeekday:s}=e._parseOpts;let i=t;return"function"===typeof n&&(i=n(i)),PP(i)||(i="string"===typeof n?r.parse(i,n):r.parse(i)),null===i?null:(a&&(i="week"!==a||!oA(s)&&!0!==s?r.startOf(i,a):r.startOf(i,"isoWeek",s)),+i)}function VI(e,t,r,n){const a=BI.length;for(let s=BI.indexOf(e);s<a-1;++s){const e=FI[BI[s]],a=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((r-t)/(a*e.size))<=n)return BI[s]}return BI[a-1]}function HI(e,t,r){if(r){if(r.length){const{lo:n,hi:a}=yA(r,t);e[r[n]>=t?r[n]:r[a]]=!0}}else e[t]=!0}function WI(e,t,r){const n=[],a={},s=t.length;let i,o;for(i=0;i<s;++i)o=t[i],a[o]=i,n.push({value:o,major:!1});return 0!==s&&r?function(e,t,r,n){const a=e._adapter,s=+a.startOf(t[0].value,n),i=t[t.length-1].value;let o,l;for(o=s;o<=i;o=+a.add(o,1,n))l=r[o],l>=0&&(t[l].major=!0);return t}(e,n,a,r):n}class qI extends GR{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.time||(e.time={}),n=this._adapter=new QM(e.adapters.date);n.init(t),zP(r.displayFormats,n.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:zI(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:n,max:a,minDefined:s,maxDefined:i}=this.getUserBounds();function o(e){s||isNaN(e.min)||(n=Math.min(n,e.min)),i||isNaN(e.max)||(a=Math.max(a,e.max))}s&&i||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),n=PP(n)&&!isNaN(n)?n:+t.startOf(Date.now(),r),a=PP(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(n,a-1),this.max=Math.max(n+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,n="labels"===r.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const a=this.min,s=function(e,t,r){let n=0,a=e.length;for(;n<a&&e[n]<t;)n++;for(;a>n&&e[a-1]>r;)a--;return n>0||a<e.length?e.slice(n,a):e}(n,a,this.max);return this._unit=t.unit||(r.autoSkip?VI(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(e,t,r,n,a){for(let s=BI.length-1;s>=BI.indexOf(r);s--){const r=BI[s];if(FI[r].common&&e._adapter.diff(a,n,r)>=t-1)return r}return BI[r?BI.indexOf(r):0]}(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function(e){for(let t=BI.indexOf(e)+1,r=BI.length;t<r;++t)if(FI[BI[t]].common)return BI[t]}(this._unit):void 0,this.initOffsets(n),e.reverse&&s.reverse(),WI(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=0,a=0;this.options.offset&&r.length&&(e=this.getDecimalForValue(r[0]),n=1===r.length?1-e:(this.getDecimalForValue(r[1])-e)/2,t=this.getDecimalForValue(r[r.length-1]),a=1===r.length?t:(t-this.getDecimalForValue(r[r.length-2]))/2);const s=r.length<3?.5:.25;n=xA(n,0,s),a=xA(a,0,s),this._offsets={start:n,end:a,factor:1/(n+1+a)}}_generate(){const e=this._adapter,t=this.min,r=this.max,n=this.options,a=n.time,s=a.unit||VI(a.minUnit,t,r,this._getLabelCapacity(t)),i=TP(n.ticks.stepSize,1),o="week"===s&&a.isoWeekday,l=oA(o)||!0===o,c={};let d,u,h=t;if(l&&(h=+e.startOf(h,"isoWeek",o)),h=+e.startOf(h,l?"day":s),e.diff(r,t,s)>1e5*i)throw new Error(t+" and "+r+" are too far apart with stepSize of "+i+" "+s);const p="data"===n.ticks.source&&this.getDataTimestamps();for(d=h,u=0;d<r;d=+e.add(d,i,s),u++)HI(c,d,p);return d!==r&&"ticks"!==n.bounds&&1!==u||HI(c,d,p),Object.keys(c).sort(UI).map(e=>+e)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,n=this._unit,a=t||r[n];return this._adapter.format(e,a)}_tickFormatFunction(e,t,r,n){const a=this.options,s=a.ticks.callback;if(s)return RP(s,[e,t,r],this);const i=a.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&i[o],d=l&&i[l],u=r[t],h=l&&d&&u&&u.major;return this._adapter.format(e,n||(h?d:c))}generateTickLabels(e){let t,r,n;for(t=0,r=e.length;t<r;++t)n=e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,n=cA(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(n),s=Math.sin(n),i=this._resolveTickFontOptions(0).size;return{w:r*a+i*s,h:r*s+i*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,n=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,WI(this,[e],this._majorUnit),n),s=this._getLabelSize(a),i=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return i>0?i:1}getDataTimestamps(){let e,t,r=this._cache.data||[];if(r.length)return r;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,t=n.length;e<t;++e)r=r.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const n=this.getLabels();for(t=0,r=n.length;t<r;++t)e.push(zI(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return wA(e.sort(UI))}}function GI(e,t,r){let n,a,s,i,o=0,l=e.length-1;r?(t>=e[o].pos&&t<=e[l].pos&&({lo:o,hi:l}=vA(e,"pos",t)),({pos:n,time:s}=e[o]),({pos:a,time:i}=e[l])):(t>=e[o].time&&t<=e[l].time&&({lo:o,hi:l}=vA(e,"time",t)),({time:n,pos:s}=e[o]),({time:a,pos:i}=e[l]));const c=a-n;return c?s+(i-s)*(t-n)/c:s}Re(qI,"id","time"),Re(qI,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class $I extends qI{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=GI(t,this.min),this._tableRange=GI(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,n=[],a=[];let s,i,o,l,c;for(s=0,i=e.length;s<i;++s)l=e[s],l>=t&&l<=r&&n.push(l);if(n.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(s=0,i=n.length;s<i;++s)c=n[s+1],o=n[s-1],l=n[s],Math.round((c+o)/2)!==l&&a.push({time:l,pos:s/(i-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return r.includes(e)&&r.length||r.splice(0,0,e),r.includes(t)&&1!==r.length||r.push(t),r.sort((e,t)=>e-t)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return e=t.length&&r.length?this.normalize(t.concat(r)):t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(GI(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return GI(this._table,r*this._tableRange+this._minPos,!0)}}Re($I,"id","timeseries"),Re($I,"defaults",qI.defaults);const KI=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],YI="label";function XI(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function JI(e,t){e.labels=t}function QI(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:YI;const n=[];e.datasets=t.map(t=>{const a=e.datasets.find(e=>e[r]===t[r]);return a&&t.data&&!n.includes(a)?(n.push(a),Object.assign(a,t),a):Ie({},t)})}function ZI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:YI;const r={labels:[],datasets:[]};return JI(r,e.labels),QI(r,e.datasets,t),r}function eL(e,t){const{height:r=150,width:n=300,redraw:a=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h}=e,p=Le(e,KI),m=(0,s.useRef)(null),f=(0,s.useRef)(null),g=()=>{m.current&&(f.current=new jD(m.current,{type:o,data:ZI(l,i),options:c&&Ie({},c),plugins:d}),XI(t,f.current))},x=()=>{XI(t,null),f.current&&(f.current.destroy(),f.current=null)};return(0,s.useEffect)(()=>{!a&&f.current&&c&&function(e,t){const r=e.options;r&&t&&Object.assign(r,t)}(f.current,c)},[a,c]),(0,s.useEffect)(()=>{!a&&f.current&&JI(f.current.config.data,l.labels)},[a,l.labels]),(0,s.useEffect)(()=>{!a&&f.current&&l.datasets&&QI(f.current.config.data,l.datasets,i)},[a,l.datasets]),(0,s.useEffect)(()=>{f.current&&(a?(x(),setTimeout(g)):f.current.update(h))},[a,c,l.labels,l.datasets,h]),(0,s.useEffect)(()=>{f.current&&(x(),setTimeout(g))},[o]),(0,s.useEffect)(()=>(g(),()=>x()),[]),s.createElement("canvas",Ie({ref:m,role:"img",height:r,width:n},p),u)}const tL=(0,s.forwardRef)(eL);function rL(e,t){return jD.register(t),(0,s.forwardRef)((t,r)=>s.createElement(tL,Ie(Ie({},t),{},{ref:r,type:e})))}const nL=rL("line",qM);jD.register(xI,_I,UD,FD,ZD,mI,JD);const aL={control:(e,t)=>Ie(Ie({},e),{},{background:"#FFFFFF",borderColor:t.isFocused?"#4F46E5":"#CBD5E0",boxShadow:t.isFocused?"0 0 0 1px #4F46E5":"none","&:hover":{borderColor:"#4F46E5"},padding:"2px",fontSize:"0.9rem"}),option:(e,t)=>Ie(Ie({},e),{},{backgroundColor:t.isSelected?"#4F46E5":t.isFocused?"#EEF2FF":"transparent",color:t.isSelected?"white":"#1A202C","&:hover":{backgroundColor:t.isSelected?"#4F46E5":"#EEF2FF"},cursor:"pointer",fontSize:"0.9rem"}),multiValue:e=>Ie(Ie({},e),{},{backgroundColor:"#EEF2FF",border:"1px solid #E2E8F0"}),multiValueLabel:e=>Ie(Ie({},e),{},{color:"#4F46E5",fontWeight:500}),multiValueRemove:e=>Ie(Ie({},e),{},{color:"#4F46E5","&:hover":{backgroundColor:"#4F46E5",color:"white"}}),menu:e=>Ie(Ie({},e),{},{zIndex:100,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",backgroundColor:"#FFFFFF"}),placeholder:e=>Ie(Ie({},e),{},{color:"#718096"}),input:e=>Ie(Ie({},e),{},{color:"#1A202C"}),singleValue:e=>Ie(Ie({},e),{},{color:"#1A202C"})},sL=Ie(Ie({},aL),{},{control:(e,t)=>Ie(Ie({},aL.control(e,t)),{},{background:"#1F2937",borderColor:t.isFocused?"#4F46E5":"#4B5563","&:hover":{borderColor:"#4F46E5"}}),option:(e,t)=>Ie(Ie({},aL.option(e,t)),{},{backgroundColor:t.isSelected?"#4F46E5":t.isFocused?"#374151":"#1F2937",color:t.isSelected?"white":"#F3F4F6"}),multiValue:e=>Ie(Ie({},aL.multiValue(e)),{},{backgroundColor:"#374151",border:"1px solid #4B5563"}),multiValueLabel:e=>Ie(Ie({},aL.multiValueLabel(e)),{},{color:"#F3F4F6"}),multiValueRemove:e=>Ie(Ie({},aL.multiValueRemove(e)),{},{color:"#F3F4F6","&:hover":{backgroundColor:"#4F46E5",color:"white"}}),menu:e=>Ie(Ie({},aL.menu(e)),{},{backgroundColor:"#1F2937",border:"1px solid #4B5563"}),placeholder:e=>Ie(Ie({},aL.placeholder(e)),{},{color:"#9CA3AF"}),input:e=>Ie(Ie({},e),{},{color:"#F3F4F6"}),singleValue:e=>Ie(Ie({},e),{},{color:"#F3F4F6"})}),iL={default:{bg:"bg-gray-100 dark:bg-gray-700",text:"text-gray-500 dark:text-gray-400"},trial_started:{bg:"bg-yellow-100 dark:bg-yellow-900/50",text:"text-yellow-800 dark:text-yellow-200"},trial_converted:{bg:"bg-green-100 dark:bg-green-900/50",text:"text-green-800 dark:text-green-200"},trial_cancelled:{bg:"bg-red-100 dark:bg-red-900/50",text:"text-red-800 dark:text-red-200"},conversion_cancelled:{bg:"bg-green-50 dark:bg-green-900/30",text:"text-green-600 dark:text-green-300"},refunded:{bg:"bg-red-50 dark:bg-red-900/30",text:"text-red-600 dark:text-red-300"}},oL=e=>{var t;let{filterStats:r}=e;if(!r)return null;const{filtering_steps:n,base_cohort_count:a,final_cohort_count:s}=r,i=(e,t)=>t?(e/t*100).toFixed(1):0;return(0,ut.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-white dark:bg-gray-700 shadow-sm",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ut.jsx)(Mt,{size:18,className:"text-indigo-600 dark:text-indigo-400"}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-white",children:"Cohort Filtering Statistics"})]}),(0,ut.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between mb-4 p-3 bg-indigo-50 dark:bg-indigo-900/30 rounded-md",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Base Cohort"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-300",children:a}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"100%"})]}),(0,ut.jsx)("div",{className:"hidden md:block text-gray-400",children:"\u2192"}),n.slice(1).map((e,t)=>(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:["After ",e.step]}),(0,ut.jsx)("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-300",children:e.users_count}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i(e.users_count,a),"% of base"]})]},t)),s!==(null===(t=n[n.length-1])||void 0===t?void 0:t.users_count)&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("div",{className:"hidden md:block text-gray-400",children:"\u2192"}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Final Cohort"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-300",children:s}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i(s,a),"% of base"]})]})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Filter Step"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Description"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Users Count"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Users Filtered"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"% of Base"})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:n.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"":"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:e.step}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:e.description}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:e.users_count}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:e.users_filtered||0}),(0,ut.jsxs)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:[i(e.users_count,a),"%"]})]},t))})]})})]})},lL=e=>{let{data:t,position:r,onClose:n}=e;return t?(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md",style:{left:Math.min(r.x,window.innerWidth-400),top:Math.max(r.y-100,10)},children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-white",children:"Estimated Revenue Calculation"}),(0,ut.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]}),(0,ut.jsxs)("div",{className:"space-y-3 text-sm",children:[(()=>{const e=t.breakdown||{},r=e.trial_converted||{},n=e.initial_purchase||{},a=r.actual_revenue>0,s=n.actual_revenue>0;return a||s?(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg border border-blue-200 dark:border-blue-700 mb-3",children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\ud83c\udfaf Refund Rate Analysis"}),a&&(0,ut.jsxs)("div",{className:"mb-2",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Trial Conversion Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-900 dark:text-blue-100",children:(()=>{const e=r.actual_revenue||0,t=r.estimated_refunds||0,n=e>0?t/e*100:0;return"".concat(t.toFixed(2)," / ").concat(e.toFixed(2)," = ").concat(n.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["$",(r.estimated_refunds||0).toFixed(2)," estimated refunds on $",(r.actual_revenue||0).toFixed(2)," revenue"]})]}),s&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Initial Purchase Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-900 dark:text-blue-100",children:(()=>{const e=n.actual_revenue||0,t=n.estimated_refunds||0,r=e>0?t/e*100:0;return"".concat(t.toFixed(2)," / ").concat(e.toFixed(2)," = ").concat(r.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["$",(n.estimated_refunds||0).toFixed(2)," estimated refunds on $",(n.actual_revenue||0).toFixed(2)," revenue"]})]})]}):null})(),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Formula:"}),(0,ut.jsx)("div",{className:"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded",children:t.formula})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Calculation:"}),(0,ut.jsx)("div",{className:"font-mono text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded",children:t.calculation})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Components:"}),(0,ut.jsx)("div",{className:"text-xs space-y-1",children:Object.entries(t.components||{}).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsx)("span",{className:"font-mono",children:r})]},t)})})]}),(0,ut.jsx)("div",{className:"border-t pt-2",children:(0,ut.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,ut.jsx)("span",{children:"Result:"}),(0,ut.jsx)("span",{className:"text-green-600 dark:text-green-400",children:t.result})]})})]})]}):null},cL=()=>{var e,t,r,n,a,i,o,l,c,d,u,h,p,m,f,g,x,b,y,v,_,k,j,w,N,S,O,C,E,P,A,T,M;const[R,D]=(0,s.useState)({date_from_str:"",date_to_str:"",optional_filters:[]}),[I,L]=(0,s.useState)([]),[F,B]=(0,s.useState)([]),[U,z]=(0,s.useState)({}),[V,H]=(0,s.useState)(!1),[W,q]=(0,s.useState)(null),[G,$]=(0,s.useState)(null),[K,Y]=(0,s.useState)(!1),[X,J]=(0,s.useState)(!1),[Q,Z]=(0,s.useState)(""),[ee,te]=(0,s.useState)(!0),[re,ne]=(0,s.useState)(null),[ae,se]=(0,s.useState)(!1),[ie,oe]=(0,s.useState)(null),[le,ce]=(0,s.useState)(null),[de,ue]=(0,s.useState)(!1),[he,pe]=(0,s.useState)(null),[me,fe]=(0,s.useState)(""),[ge,xe]=(0,s.useState)(""),[be,ye]=(0,s.useState)([]),[ve,_e]=(0,s.useState)([]),[ke,je]=(0,s.useState)(null),[we,Ne]=(0,s.useState)(null),[Se,Oe]=(0,s.useState)({x:0,y:0}),[Ce,Ee]=s.useState({}),[Pe,Ae]=s.useState(""),[Te,Me]=s.useState(!1);(0,s.useEffect)(()=>{const e=localStorage.getItem("cohortAnalyzerFilters");if(e)try{const t=JSON.parse(e);D(e=>Ie(Ie(Ie({},e),t),{},{optional_filters:t.optional_filters||[]}))}catch(G){console.error("Error loading saved filters:",G)}},[]),(0,s.useEffect)(()=>{const e={date_from_str:R.date_from_str,date_to_str:R.date_to_str,optional_filters:R.optional_filters};localStorage.setItem("cohortAnalyzerFilters",JSON.stringify(e))},[R.date_from_str,R.date_to_str,R.optional_filters]);const Re=(0,s.useCallback)(async()=>{try{const e=await Ra();if(L(e.event_properties||[]),B(e.user_properties||[]),(!e.event_properties||0===e.event_properties.length)&&(!e.user_properties||0===e.user_properties.length)&&"discovery_initiated"===e.status){Z(e.message||"Property discovery auto-triggered. Please wait..."),J(!0);const t=setInterval(async()=>{try{"completed"===(await Fa()).status&&(clearInterval(t),J(!1),Z("Discovery completed! Refreshing properties..."),setTimeout(Re,1e3))}catch(e){console.error("Error checking discovery status:",e)}},3e3)}}catch(e){if(console.error("Error fetching discoverable properties:",e),"tables_missing"===e.code)try{await La(),Z("Property system initialized. Please wait while we discover properties..."),setTimeout(Re,2e3)}catch(t){$("Could not initialize property system. Please try again or check server logs.")}else $("Could not load filter property lists. Try triggering discovery or check console.")}},[]),De=(0,s.useCallback)(async()=>{try{const e=await Fa();e.active?(J(!0),Z(e.message||"Property discovery in progress...")):"completed"===e.status&&J(!1)}catch(e){console.error("Error checking discovery status:",e)}},[]);(0,s.useEffect)(()=>{(async()=>{te(!0);try{await La(),await De(),await Re()}catch(e){console.error("Error initializing properties:",e),$("Could not initialize property system. Please check server logs.")}finally{te(!1)}})()},[Re,De]);const Le=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;D(n=>{const a=Ie({},n);if("date_from_str"===e||"date_to_str"===e)a[e]=t;else if("optional_filter_property"===e)a.optional_filters[r].property_name=t,a.optional_filters[r].property_values=[],t&&Fe(t,"user","optional_filter_"+r);else if("optional_filter_values"===e)a.optional_filters[r].property_values=t;else if(e.startsWith("optional_filter_")){const n=e.substring(16);"property"===n?(a.optional_filters[r].property_name=t,a.optional_filters[r].property_values=[],t&&a.optional_filters[r].property_source&&Fe(t,a.optional_filters[r].property_source,"optional_filter_".concat(r))):"values"===n?a.optional_filters[r].property_values=t:"source"===n&&(a.optional_filters[r].property_source=t,a.optional_filters[r].property_name&&Fe(a.optional_filters[r].property_name,t,"optional_filter_".concat(r)))}return a})},Fe=async(e,t,r)=>{if(e&&t)try{const n=await Da(e,t);z(t=>Ie(Ie({},t),{},{[r+"_"+e]:n.values||[]}))}catch(n){console.error("Error fetching values for ".concat(e,":"),n),z(t=>Ie(Ie({},t),{},{[r+"_"+e]:[]}))}},Be=async()=>{se(!0);try{console.log("[DEBUG] fetchUserTimeline called with filters:",R);const e=await Ta(R);console.log("[DEBUG] fetchUserTimeline response:",e),e.error?(console.log("[DEBUG] fetchUserTimeline error:",e.error),oe(e.error)):(console.log("[DEBUG] Setting userTimelineData:",e),ne(e))}catch(e){console.error("Timeline fetch error:",e),oe(e.message||"Could not load user timeline data.")}se(!1)},Ue=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;ue(!0),pe(null);try{console.log("[DEBUG] fetchEventRevenueTimeline called with filters:",R,"distinctId:",e,"productId:",t);const r=await Ma(R,e,t);console.log("[DEBUG] fetchEventRevenueTimeline response:",r),r.error?(console.log("[DEBUG] fetchEventRevenueTimeline error:",r.error),pe(r.error)):(console.log("[DEBUG] Setting eventRevenueTimelineData:",r),ce(r),r.available_users&&ye(r.available_users),r.available_products&&_e(r.available_products))}catch(r){console.error("Event revenue timeline fetch error:",r),pe(r.message||"Could not load event revenue timeline data.")}ue(!1)},ze=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rate_denominator_count";if(console.log('[DEBUG] renderLifecycleTable called for "'.concat(e,'"')),console.log("[DEBUG] ratesData:",t),!t)return console.log('[DEBUG] No ratesData for "'.concat(e,'"')),(0,ut.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:["Lifecycle rate data not available for ",e,"."]});const n=t.rates_by_product||t.aggregate_rates;if(console.log("[DEBUG] isNewFormat: ".concat(n,' for "').concat(e,'"')),n){const r=t.aggregate_rates,n=t.rates_by_product||{};if(console.log("[DEBUG] aggregateRates:",r),console.log("[DEBUG] productRates:",n),!r||!r.rates_by_day||0===Object.keys(r.rates_by_day).length)return console.log('[DEBUG] No valid aggregateRates for "'.concat(e,'"')),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg",children:[(0,ut.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:[e," - Debug Info"]}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Raw data structure (for debugging):"}),(0,ut.jsx)("pre",{className:"text-xs bg-gray-100 dark:bg-gray-800 p-2 rounded overflow-x-auto",children:JSON.stringify(t,null,2)})]});const a=Pe&&n[Pe]?n[Pe]:r,s=a.rates_by_day,i=Object.keys(s).map(Number).sort((e,t)=>e-t),o=[{metric:"Raw Daily Cancellation %",dataKey:"raw_daily_cancellation_rate"},{metric:"Smoothed Daily Cancellation %",dataKey:"smoothed_daily_cancellation_rate"},{metric:"Raw Cumulative Cancellation %",dataKey:"raw_cumulative_cancellation_rate"},{metric:"Smoothed Cumulative Cancellation %",dataKey:"smoothed_cumulative_cancellation_rate"},{metric:"Raw Daily Refund %",dataKey:"raw_daily_refund_rate"},{metric:"Smoothed Daily Refund %",dataKey:"smoothed_daily_refund_rate"},{metric:"Raw Cumulative Refund %",dataKey:"raw_cumulative_refund_rate"},{metric:"Smoothed Cumulative Refund %",dataKey:"smoothed_cumulative_refund_rate"}];return(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:e}),(0,ut.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[(0,ut.jsx)("h5",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Smoothing Method Information"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Method:"})," ",a.smoothing_method||"none"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Quality:"})," ",a.smoothing_quality||"N/A"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Sample Size:"})," ",a.total_sample_size||0]})]}),a.smoothing_details&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{children:(0,ut.jsx)("strong",{children:"Data Characteristics:"})}),(0,ut.jsx)("ul",{className:"ml-4 mt-1",children:a.smoothing_details.cancellation&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("li",{children:["Early Concentration: ",a.smoothing_details.cancellation.early_concentration]}),(0,ut.jsxs)("li",{children:["Sparsity: ",a.smoothing_details.cancellation.sparsity]}),(0,ut.jsxs)("li",{children:["Max Rate: ",a.smoothing_details.cancellation.max_rate]})]})})]})]})]}),(0,ut.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:(0,ut.jsxs)("div",{className:"flex",children:[(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700",children:"Metric"}),o.map((e,t)=>(0,ut.jsx)("div",{className:"px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ".concat(t%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800"," text-gray-900 dark:text-white font-medium"),children:e.metric},t))]}),(0,ut.jsx)("div",{className:"flex-1 overflow-x-auto",children:(0,ut.jsx)("div",{className:"flex",children:i.map(e=>{const t=e.toString(),r=s[t];return(0,ut.jsxs)("div",{className:"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:[(0,ut.jsxs)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700",children:["Day ",e]}),o.map((e,t)=>(0,ut.jsxs)("div",{className:"px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ".concat(t%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800"," text-gray-500 dark:text-gray-300"),children:[r?(r[e.dataKey]||0).toFixed(2):"0.00","%"]},t))]},t)})})})]})})]})}if(!t.rates_by_day||0===Object.keys(t.rates_by_day).length)return(0,ut.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:["No lifecycle rate data available for ",e,"."]});const a=Object.keys(t.rates_by_day).map(Number).sort((e,t)=>e-t),s=t[r]||0,i=[{metric:"Daily Cancel %",dataKey:"cancelled_daily_pct"},{metric:"Cumulative Cancel %",dataKey:"cancelled_cumulative_pct"},{metric:"Daily Convert %",dataKey:"converted_daily_pct"},{metric:"Cumulative Convert %",dataKey:"converted_cumulative_pct"}];return(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:e}),(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Based on ",s," users. ",t.message]}),(0,ut.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:(0,ut.jsxs)("div",{className:"flex",children:[(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700",children:"Metric"}),i.map((e,t)=>(0,ut.jsx)("div",{className:"px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ".concat(t%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800"," text-gray-900 dark:text-white font-medium"),children:e.metric},t))]}),(0,ut.jsx)("div",{className:"flex-1 overflow-x-auto",children:(0,ut.jsx)("div",{className:"flex",children:a.map(e=>{const r=e.toString(),n=t.rates_by_day[r];return(0,ut.jsxs)("div",{className:"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:[(0,ut.jsxs)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700",children:["Day ",e]}),i.map((e,t)=>(0,ut.jsxs)("div",{className:"px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ".concat(t%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800"," text-gray-500 dark:text-gray-300"),children:[n?(n[e.dataKey]||0).toFixed(2):"0.00","%"]},t))]},r)})})})]})})]})},Ve=e=>null===e||void 0===e?"N/A":e.toLocaleString("en-US",{style:"currency",currency:"USD"}),qe=(null===W||void 0===W?void 0:W.daily_data.map(e=>{const t=e.cumulative_revenue_actual_net||0,r=t+(e.estimated_additional_revenue_from_pending_trials_net_refund||0)-(e.estimated_future_refunds_on_actual_revenue_amount||0),n=e.daily_trials_started||0,a=e.daily_trials_converted_actual||0,s=a+(e.daily_trials_cancelled_actual||0),i=e.daily_trials_started-s;return{date:e.date,daily_trials_started:n,daily_trials_ended:s,daily_trials_pending:i,daily_conversions:a,daily_conversions_net_refunds:a-(e.daily_refund_count_actual||0),daily_estimated_conversions_net_refunds:a-(e.daily_estimated_refunds||0),daily_refunds:e.daily_refund_count_actual||0,daily_revenue:e.daily_revenue_actual||0,daily_revenue_net:e.daily_revenue_actual_net||0,daily_estimated_revenue:e.daily_estimated_revenue||0,cumulative_trials_started:e.cumulative_trials_started||0,cumulative_trials_ended:(e.cumulative_trials_converted_actual||0)+(e.cumulative_trials_cancelled_actual||0),cumulative_trials_pending:e.cumulative_trials_started-((e.cumulative_trials_converted_actual||0)+(e.cumulative_trials_cancelled_actual||0)),cumulative_conversions:e.cumulative_trials_converted_actual||0,cumulative_conversions_net_refunds:(e.cumulative_trials_converted_actual||0)-(e.cumulative_refund_count_actual||0),cumulative_estimated_conversions_net_refunds:(e.cumulative_trials_converted_actual||0)-(e.cumulative_estimated_refunds||0),cumulative_refunds:e.cumulative_refund_count_actual||0,cumulative_revenue:e.cumulative_revenue_actual||0,cumulative_revenue_net:t,cumulative_estimated_revenue:r}}))||[],[Ge,$e]=(0,s.useState)({daily_trials_started:!0,daily_trials_ended:!1,daily_trials_pending:!1,daily_conversions:!0,daily_conversions_net_refunds:!1,daily_estimated_conversions_net_refunds:!1,daily_refunds:!1,cumulative_trials_started:!0,cumulative_trials_ended:!1,cumulative_trials_pending:!1,cumulative_conversions:!0,cumulative_conversions_net_refunds:!1,cumulative_estimated_conversions_net_refunds:!1,cumulative_refunds:!1}),[Ke,Ye]=(0,s.useState)({daily_revenue:!0,daily_revenue_net:!1,daily_estimated_revenue:!1,cumulative_revenue:!1,cumulative_revenue_net:!0,cumulative_estimated_revenue:!0}),Xe=()=>document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches?sL:aL,Je=()=>{if(!Te||null===W||void 0===W||!W.lifecycle_rates)return null;const e=W.lifecycle_rates,t=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cancellation_refund";if(null===e||void 0===e||!e.rates_by_day)return null;const n=Object.keys(e.rates_by_day).map(Number).sort((e,t)=>e-t);let a=[];return"cancellation_refund"===r?a=[{label:"Raw Cumulative Cancellation %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.raw_cumulative_cancellation_rate)||0}),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.1)",borderDash:[],tension:.1},{label:"Smoothed Cumulative Cancellation %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.smoothed_cumulative_cancellation_rate)||0}),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.3)",borderDash:[5,5],tension:.1},{label:"Raw Cumulative Refund %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.raw_cumulative_refund_rate)||0}),borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.1)",borderDash:[],tension:.1},{label:"Smoothed Cumulative Refund %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.smoothed_cumulative_refund_rate)||0}),borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.3)",borderDash:[5,5],tension:.1}]:"conversion_cancellation"===r&&(a=[{label:"Raw Cumulative Conversion %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.raw_cumulative_conversion_rate)||0}),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.1)",borderDash:[],tension:.1},{label:"Smoothed Cumulative Conversion %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.smoothed_cumulative_conversion_rate)||0}),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.3)",borderDash:[5,5],tension:.1},{label:"Raw Cumulative Cancellation %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.raw_cumulative_cancellation_rate)||0}),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.1)",borderDash:[],tension:.1},{label:"Smoothed Cumulative Cancellation %",data:n.map(t=>{var r;return(null===(r=e.rates_by_day[t.toString()])||void 0===r?void 0:r.smoothed_cumulative_cancellation_rate)||0}),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.3)",borderDash:[5,5],tension:.1}]),{labels:n.map(e=>"Day ".concat(e)),datasets:a}},r={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Raw vs Smoothed Cumulative Rates"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Percentage (%)"}},x:{title:{display:!0,text:"Days"}}}},n=e=>e?Pe&&e.rates_by_product&&e.rates_by_product[Pe]?e.rates_by_product[Pe]:e.aggregate_rates||e:null,a=n(e.trial_to_outcome_rates),s=n(e.trial_to_cancellation_rates||e.trial_to_refund_rates);return(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Lifecycle Rate Charts"}),(0,ut.jsx)("button",{onClick:()=>Me(!1),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,ut.jsx)(ON,{size:24})})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a&&(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Trial to Outcome (Conversion vs Cancellation)"}),(0,ut.jsx)(nL,{data:t(a,"Trial to Outcome","conversion_cancellation"),options:r})]}),s&&(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Cancellation vs Refund Rates"}),(0,ut.jsx)(nL,{data:t(s,"Cancellation vs Refund","cancellation_refund"),options:r})]})]}),(0,ut.jsxs)("div",{className:"mt-6 text-sm text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)("p",{children:(0,ut.jsx)("strong",{children:"Legend:"})}),(0,ut.jsxs)("ul",{className:"list-disc list-inside mt-2",children:[(0,ut.jsx)("li",{children:"Solid lines represent raw data"}),(0,ut.jsx)("li",{children:"Dashed lines represent smoothed curves"}),(0,ut.jsx)("li",{children:"The smoothing algorithm first smooths cumulative rates, then derives daily rates"})]})]})]})})})};return(0,ut.jsxs)("div",{className:"p-6 max-w-full mx-auto bg-white dark:bg-gray-800 min-h-screen",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 border-gray-200 dark:border-gray-600",children:"Cohort Analyzer"}),ee?(0,ut.jsxs)("div",{className:"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md",children:[(0,ut.jsx)(CN,{className:"animate-spin mr-2 text-indigo-600 dark:text-indigo-400"}),(0,ut.jsx)("p",{className:"text-gray-700 dark:text-white",children:"Initializing cohort analyzer..."})]}):(0,ut.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),H(!0),$(null),q(null),ne(null),oe(null),ce(null),pe(null),fe(""),xe(""),je(null);try{if(!R.date_from_str||!R.date_to_str)throw new Error("Start Date and End Date are required.");if(R.optional_filters.length>0&&R.optional_filters[0].property_name&&0===R.optional_filters[0].property_values.length)throw new Error("Please select values for the optional filters or clear the property selection.");for(const r of R.optional_filters)if(!r.property_name||0===r.property_values.length)throw new Error("Optional filter is incomplete. Please select both property and values for all filters or remove unused ones.");const e=Ie(Ie({},R),{},{enforce_trial_started:!0,cohort_definition:{required_event:"RC Trial started",date_range:{from:R.date_from_str,to:R.date_to_str},strict_filtering:!0}}),t=await Ea(e);if(t.error)$(t.error);else{if(t.cohort_event_occurrence&&t.cohort_event_occurrence.trial_started&&t.summary_stats&&t.summary_stats.total_users_in_final_cohort){const e=t.cohort_event_occurrence.trial_started.user_count,r=t.summary_stats.total_users_in_final_cohort;if(e!==r){const t="Warning: Cohort definition may not be correctly applied. "+"Cohort users (".concat(r,") should equal ")+"trial started users (".concat(e,").");console.warn(t),je(t)}}q(t),Be(),Ue()}}catch(t){console.error("Analysis error:",t),$(t.message||"Analysis failed. Please check that you have selected valid filter criteria.")}H(!1)},className:"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md mb-8",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6 border-b border-gray-200 dark:border-gray-600 pb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{htmlFor:"date_from_str",className:"block text-sm font-medium text-gray-700 dark:text-white mb-2",children:"Start Date *"}),(0,ut.jsx)("input",{type:"date",id:"date_from_str",value:R.date_from_str,onChange:e=>Le("date_from_str",e.target.value),className:"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white",required:!0})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{htmlFor:"date_to_str",className:"block text-sm font-medium text-gray-700 dark:text-white mb-2",children:"End Date *"}),(0,ut.jsx)("input",{type:"date",id:"date_to_str",value:R.date_to_str,onChange:e=>Le("date_to_str",e.target.value),className:"mt-1 block w-full p-2.5 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white",required:!0})]})]}),(0,ut.jsxs)("div",{className:"mb-6 p-5 border rounded-md border-teal-200 dark:border-teal-500 bg-teal-50 dark:bg-teal-900/40",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Additional Event/User Property Filters"}),(0,ut.jsx)("button",{type:"button",onClick:()=>{D(e=>Ie(Ie({},e),{},{optional_filters:[...e.optional_filters,{id:Date.now().toString(),property_name:"",property_values:[],property_source:"event"}]}))},className:"p-1.5 bg-teal-100 dark:bg-teal-600 text-teal-700 dark:text-white rounded-full hover:bg-teal-200 dark:hover:bg-teal-500 transition-colors",children:(0,ut.jsx)(EN,{size:18})})]}),0===R.optional_filters.length&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 italic mb-2",children:"No additional filters. Click the + button to add a filter."}),R.optional_filters.map((e,t)=>(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end mb-4 p-4 border-t dark:border-gray-600 bg-white dark:bg-gray-600 rounded-md shadow-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-white mb-1",children:"Source Type"}),(0,ut.jsxs)("select",{value:e.property_source,onChange:e=>Le("optional_filter_source",e.target.value,t),className:"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,ut.jsx)("option",{value:"event",children:"Event Property"}),(0,ut.jsx)("option",{value:"user",children:"User Property"})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-white mb-1",children:"Property Name"}),(0,ut.jsxs)("select",{value:e.property_name,onChange:e=>Le("optional_filter_property",e.target.value,t),className:"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"-- Select Property --"}),("event"===e.property_source?I:F).map(e=>(0,ut.jsx)("option",{value:e.key,children:e.display_name||e.key},e.key))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-white mb-1",children:"Property Value(s)"}),(0,ut.jsx)(qE,{isMulti:!0,isDisabled:!e.property_name||!e.property_source,options:(U["optional_filter_".concat(t,"_")+e.property_name]||[]).map(e=>({value:e,label:e})),value:e.property_values.map(e=>({value:e,label:e})),onChange:e=>Le("optional_filter_values",e?e.map(e=>e.value):[],t),styles:Xe(),placeholder:"Select values..."})]}),(0,ut.jsx)("div",{className:"flex justify-end",children:(0,ut.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void D(e=>Ie(Ie({},e),{},{optional_filters:e.optional_filters.filter(e=>e.id!==t)}));var t},className:"p-1.5 bg-red-100 dark:bg-red-700 text-red-600 dark:text-white rounded-full hover:bg-red-200 dark:hover:bg-red-600 transition-colors",children:(0,ut.jsx)(ON,{size:18})})})]},e.id))]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between mt-8",children:[(0,ut.jsx)("button",{type:"submit",disabled:V,className:"px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-md shadow hover:bg-indigo-700 disabled:opacity-50 flex items-center transition-colors",children:V?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(CN,{className:"animate-spin mr-2",size:16}),"Analyzing..."]}):"Analyze Cohort"}),(0,ut.jsx)("button",{type:"button",onClick:async()=>{J(!0),Z("Property discovery initiated...");try{const e=await Ia();Z(e.message+" Refresh page after a few moments to see updated filter options."),setTimeout(()=>Re(),5e3)}catch(e){Z("Error triggering discovery: "+(e.message||"Unknown error"))}},disabled:X,className:"px-5 py-2.5 bg-teal-600 text-white text-sm font-medium rounded-md hover:bg-teal-700 disabled:opacity-50 flex items-center transition-colors",children:X?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(CN,{className:"animate-spin mr-2",size:16}),"Discovery Running..."]}):"Discover Filter Properties"})]}),Q&&(0,ut.jsx)("div",{className:"mt-3 p-3 bg-teal-50 dark:bg-teal-900/40 border border-teal-200 dark:border-teal-600 rounded-md",children:(0,ut.jsx)("p",{className:"text-sm text-teal-700 dark:text-teal-300",children:Q})})]}),G&&(0,ut.jsx)("div",{className:"my-4 p-4 bg-red-100 dark:bg-red-800 text-red-700 dark:text-white rounded-md shadow-md border border-red-300 dark:border-red-600",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(We,{className:"mr-2 flex-shrink-0"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium block",children:"Analysis Error:"}),(0,ut.jsx)("span",{className:"block mt-1",children:G})]})]})}),ke&&(0,ut.jsx)("div",{className:"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(We,{className:"mr-2 flex-shrink-0"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium block",children:"Cohort Definition Warning:"}),(0,ut.jsx)("span",{className:"block mt-1",children:ke}),(0,ut.jsx)("span",{className:"block mt-1 text-sm italic",children:"The backend may not be correctly filtering users based on trial started events."})]})]})}),W&&(0,ut.jsxs)("div",{className:"mt-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-800 dark:text-white",children:"Analysis Results"}),W.filter_stats&&(0,ut.jsx)(oL,{filterStats:W.filter_stats}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-600 rounded-md",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white",children:"Cohort Users (Trial Started)"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-300",children:(null===(e=W.summary_stats)||void 0===e?void 0:e.total_users_in_final_cohort)||0}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-300",children:"Unique users who had an 'RC Trial started' event in the selected date range (and match primary filter if applied)."})]}),(0,ut.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-600 rounded-md",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white",children:"Events Analyzed (Cohort Only)"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-300",children:(null===(t=W.summary_stats)||void 0===t?void 0:t.total_events_analyzed)||0}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-300",children:"Events from users in the trial started cohort"})]}),(0,ut.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-600 rounded-md",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white",children:"Cohort ARPC (Overall)"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-300",children:Ve(null===(r=W.summary_stats)||void 0===r?void 0:r.arpc_cohort)}),(0,ut.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-300",children:["Basis: ",null===(n=W.summary_stats)||void 0===n?void 0:n.arpc_datapoints," users. ",null===(a=W.summary_stats)||void 0===a?void 0:a.arpc_calculation_basis]}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-300 italic",children:"See per-product breakdown below"})]})]}),le&&le.arpc_per_product&&Object.keys(le.arpc_per_product).length>0&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white mb-3",children:"ARPC Per Product"}),(0,ut.jsx)("div",{className:"bg-gray-50 dark:bg-gray-600 rounded-lg p-3",children:(0,ut.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:Object.entries(le.arpc_per_product).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-md p-3 border border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 truncate",title:t,children:t}),(0,ut.jsx)("div",{className:"text-lg font-bold text-green-600 dark:text-green-400 leading-tight",children:Ve("object"===typeof r?r.arpc:r)}),"object"===typeof r&&(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 space-y-0.5",children:[(0,ut.jsxs)("div",{children:[r.event_count," events"]}),(0,ut.jsxs)("div",{children:[r.unique_users," users"]}),(0,ut.jsx)("div",{className:"font-medium",children:Ve(r.total_revenue)})]})]},t)})})})]}),W.event_user_counts&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white mb-3",children:"Unique Users Per Event Type"}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Event Type"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Unique Users"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Total Events"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Events Per User"})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:Object.entries(W.event_user_counts).map((e,t)=>{let[r,n]=e;return(0,ut.jsxs)("tr",{className:t%2===0?"":"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:r}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:n.unique_users||0}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:n.total_events||0}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:n.unique_users>0?(n.total_events/n.unique_users).toFixed(2):"0.00"})]},r)})})]})})]}),W.cohort_event_occurrence&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"font-semibold text-gray-700 dark:text-white mb-3",children:"Cohort Event Occurrence"}),(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:["Number of users in the cohort who have had each event at least once.",(0,ut.jsx)("span",{className:"italic",children:' Note: Cohort is defined as users in the database who have a "Trial started" event within the selected date range. All other users are excluded.'})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Event"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"User Count"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"% of Cohort"})]})}),(0,ut.jsxs)("tbody",{className:"bg-white dark:bg-gray-800",children:[(0,ut.jsxs)("tr",{className:"bg-indigo-50 dark:bg-indigo-900/30",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-white",children:"Trial Started"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(i=W.cohort_event_occurrence.trial_started)||void 0===i||null===(o=i.user_count)||void 0===o?void 0:o.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:"100%"})]}),(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:"Trial Ended (Total)"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(l=W.cohort_event_occurrence.trial_ended)||void 0===l||null===(c=l.user_count)||void 0===c?void 0:c.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(d=W.cohort_event_occurrence.trial_ended)&&void 0!==d&&d.percentage?W.cohort_event_occurrence.trial_ended.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700 pl-4",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300",children:"\u2192 Trial Converted"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(u=W.cohort_event_occurrence.trial_converted)||void 0===u||null===(h=u.user_count)||void 0===h?void 0:h.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(p=W.cohort_event_occurrence.trial_converted)&&void 0!==p&&p.percentage?W.cohort_event_occurrence.trial_converted.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300",children:"\u2192 Trial Cancelled"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(m=W.cohort_event_occurrence.trial_cancelled)||void 0===m||null===(f=m.user_count)||void 0===f?void 0:f.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(g=W.cohort_event_occurrence.trial_cancelled)&&void 0!==g&&g.percentage?W.cohort_event_occurrence.trial_cancelled.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:"Initial Purchase"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(x=W.cohort_event_occurrence.initial_purchase)||void 0===x||null===(b=x.user_count)||void 0===b?void 0:b.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(y=W.cohort_event_occurrence.initial_purchase)&&void 0!==y&&y.percentage?W.cohort_event_occurrence.initial_purchase.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:"Renewal"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(v=W.cohort_event_occurrence.renewal)||void 0===v||null===(_=v.user_count)||void 0===_?void 0:_.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(k=W.cohort_event_occurrence.renewal)&&void 0!==k&&k.percentage?W.cohort_event_occurrence.renewal.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:"RC Cancellation (Total)"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(j=W.cohort_event_occurrence.rc_cancellation)||void 0===j||null===(w=j.user_count)||void 0===w?void 0:w.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(N=W.cohort_event_occurrence.rc_cancellation)&&void 0!==N&&N.percentage?W.cohort_event_occurrence.rc_cancellation.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300",children:"\u2192 Refund (revenue < 0)"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(S=W.cohort_event_occurrence.rc_refund)||void 0===S||null===(O=S.user_count)||void 0===O?void 0:O.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(C=W.cohort_event_occurrence.rc_refund)&&void 0!==C&&C.percentage?W.cohort_event_occurrence.rc_refund.percentage.toFixed(1)+"%":"0%"})]}),(0,ut.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 pl-8 text-gray-700 dark:text-gray-300",children:"\u2192 Cancelled (revenue = 0)"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(null===(E=W.cohort_event_occurrence.rc_cancel_no_refund)||void 0===E||null===(P=E.user_count)||void 0===P?void 0:P.toLocaleString())||"0"}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:null!==(A=W.cohort_event_occurrence.rc_cancel_no_refund)&&void 0!==A&&A.percentage?W.cohort_event_occurrence.rc_cancel_no_refund.percentage.toFixed(1)+"%":"0%"})]})]})]})})]}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("button",{onClick:()=>Y(!K),className:"text-indigo-600 dark:text-indigo-300 hover:underline text-sm mb-2",children:[K?(0,ut.jsx)(He,{className:"inline mr-1",size:16}):(0,ut.jsx)(rt,{className:"inline mr-1",size:16}),"Show/Hide Lifecycle Rate Tables"]}),(console.log("[DEBUG] showLifecycleTables:",K,"lifecycle_rates exists:",!(null===W||void 0===W||!W.lifecycle_rates)),K&&null!==W&&void 0!==W&&W.lifecycle_rates&&(console.log("[DEBUG] Lifecycle tables section should render!",W.lifecycle_rates),console.log("[DEBUG] Available lifecycle rate keys:",Object.keys(W.lifecycle_rates))),null)]}),K&&(null===W||void 0===W?void 0:W.lifecycle_rates)&&(0,ut.jsxs)("div",{className:"space-y-6 mb-8 p-4 border-t dark:border-gray-600",children:[(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-blue-800 dark:text-blue-200 mb-3",children:"Enhanced Product-Based Lifecycle Analysis System"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold mb-2",children:"Key Improvements:"}),(0,ut.jsxs)("ul",{className:"list-disc ml-5 space-y-1",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Fixed Cumulative Calculation:"})," Now shows actual percentage of cohort that performs action, not forced 100%"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Product-Level Granularity:"})," Analyze lifecycle patterns per product ID"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Intelligent Smoothing:"})," Adaptive smoothing that handles high-early, low-later patterns effectively"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Extended Lookback:"})," Automatically extends lookback 30-60 days when sample size < 100"]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold mb-2",children:"Metrics Displayed:"}),(0,ut.jsxs)("ul",{className:"list-disc ml-5 space-y-1",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Raw Daily Rates:"})," Actual percentage of cohort performing action on specific day"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Smoothed Daily Rates:"})," Algorithm-enhanced rates accounting for data sparsity"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Cumulative Rates:"})," Total percentage who have performed action by day X (using smoothed data)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Separate Tracking:"})," 14 days for refunds, 400 days for cancellations"]})]})]})]})]}),(()=>{const e=new Set,t=W.lifecycle_rates||{};Object.values(t).forEach(t=>{t&&t.rates_by_product&&Object.keys(t.rates_by_product).forEach(t=>{e.add(t)})});const r=Array.from(e).sort();return r.length>0?(0,ut.jsx)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/30 rounded-lg border border-green-200 dark:border-green-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold text-green-800 dark:text-green-200 mb-1",children:"Product Analysis Filter"}),(0,ut.jsx)("p",{className:"text-sm text-green-700 dark:text-green-300",children:"Select a specific product to analyze, or view aggregate data across all products."})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("label",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Product:"}),(0,ut.jsxs)("select",{value:Pe,onChange:e=>Ae(e.target.value),className:"px-4 py-2 border border-green-300 dark:border-green-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[(0,ut.jsx)("option",{value:"",children:"All Products (Aggregate)"}),r.map(e=>(0,ut.jsxs)("option",{value:e,children:["Product ",e]},e))]}),(0,ut.jsxs)("button",{onClick:()=>Me(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors duration-200 flex items-center space-x-2",children:[(0,ut.jsx)("span",{children:"\ud83d\udcca"}),(0,ut.jsx)("span",{children:"View Charts"})]})]})]})}):null})(),(0,ut.jsxs)("div",{className:"space-y-8",children:[W.lifecycle_rates.trial_to_cancellation_rates&&ze("Trial Converted -> Cancellation Rates",W.lifecycle_rates.trial_to_cancellation_rates),W.lifecycle_rates.trial_to_refund_rates&&ze("Trial Converted -> Refund Rates",W.lifecycle_rates.trial_to_refund_rates),W.lifecycle_rates.initial_purchase_to_cancellation_rates&&ze("Initial Purchase -> Cancellation Rates",W.lifecycle_rates.initial_purchase_to_cancellation_rates),W.lifecycle_rates.initial_purchase_to_refund_rates&&ze("Initial Purchase -> Refund Rates",W.lifecycle_rates.initial_purchase_to_refund_rates),W.lifecycle_rates.renewal_to_cancellation_rates&&ze("Renewal -> Cancellation Rates",W.lifecycle_rates.renewal_to_cancellation_rates),W.lifecycle_rates.renewal_to_refund_rates&&ze("Renewal -> Refund Rates",W.lifecycle_rates.renewal_to_refund_rates),W.lifecycle_rates.trial_to_outcome_rates&&ze("Trial to Outcome Rates",W.lifecycle_rates.trial_to_outcome_rates)]})]}),(0,ut.jsx)("h3",{className:"text-xl font-semibold mb-3 text-gray-700 dark:text-white",children:"Daily Performance Charts"}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-700 dark:text-white mb-2",children:"Absolute Values"}),(0,ut.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:Object.keys(Ge).map(e=>(0,ut.jsx)("button",{onClick:()=>{return t=e,void $e(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"px-3 py-1 text-xs rounded-full ".concat(Ge[e]?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white"),children:e.split("_").join(" ")},e))}),(0,ut.jsx)("div",{className:"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:qe,margin:{top:5,right:30,left:20,bottom:5},children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"date"}),(0,ut.jsx)(oN,{}),(0,ut.jsx)(Jo,{formatter:e=>"number"===typeof e?e.toLocaleString():e}),(0,ut.jsx)(JD,{}),Ge.daily_trials_started&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_trials_started",stroke:"#8884d8",name:"Daily Trials Started"}),Ge.daily_trials_ended&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_trials_ended",stroke:"#82ca9d",name:"Daily Trials Ended"}),Ge.daily_trials_pending&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_trials_pending",stroke:"#ffc658",name:"Daily Trials Pending"}),Ge.daily_conversions&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_conversions",stroke:"#ff7300",name:"Daily Conversions"}),Ge.daily_conversions_net_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_conversions_net_refunds",stroke:"#ff0000",name:"Daily Conv. Net Refunds"}),Ge.daily_estimated_conversions_net_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_estimated_conversions_net_refunds",stroke:"#b967ff",name:"Daily Est. Conv. Net Refunds"}),Ge.daily_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_refunds",stroke:"#ff67b3",name:"Daily Refunds"}),Ge.cumulative_trials_started&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_trials_started",stroke:"#8884d8",strokeDasharray:"5 5",name:"Cum. Trials Started"}),Ge.cumulative_trials_ended&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_trials_ended",stroke:"#82ca9d",strokeDasharray:"5 5",name:"Cum. Trials Ended"}),Ge.cumulative_trials_pending&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_trials_pending",stroke:"#ffc658",strokeDasharray:"5 5",name:"Cum. Trials Pending"}),Ge.cumulative_conversions&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_conversions",stroke:"#ff7300",strokeDasharray:"5 5",name:"Cum. Conversions"}),Ge.cumulative_conversions_net_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_conversions_net_refunds",stroke:"#ff0000",strokeDasharray:"5 5",name:"Cum. Conv. Net Refunds"}),Ge.cumulative_estimated_conversions_net_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_estimated_conversions_net_refunds",stroke:"#b967ff",strokeDasharray:"5 5",name:"Cum. Est. Conv. Net Refunds"}),Ge.cumulative_refunds&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_refunds",stroke:"#ff67b3",strokeDasharray:"5 5",name:"Cum. Refunds"})]})})})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-700 dark:text-white mb-2",children:"Revenue Values"}),(0,ut.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:Object.keys(Ke).map(e=>(0,ut.jsx)("button",{onClick:()=>{return t=e,void Ye(e=>Ie(Ie({},e),{},{[t]:!e[t]}));var t},className:"px-3 py-1 text-xs rounded-full ".concat(Ke[e]?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white"),children:e.split("_").join(" ")},e))}),(0,ut.jsx)("div",{className:"h-80 w-full mb-8 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:qe,margin:{top:5,right:30,left:20,bottom:5},children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"date"}),(0,ut.jsx)(oN,{}),(0,ut.jsx)(Jo,{formatter:e=>Ve(e)}),(0,ut.jsx)(JD,{}),Ke.daily_revenue&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_revenue",stroke:"#00b300",name:"Daily Revenue"}),Ke.daily_revenue_net&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_revenue_net",stroke:"#00e600",name:"Daily Net Revenue"}),Ke.daily_estimated_revenue&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"daily_estimated_revenue",stroke:"#4dff4d",name:"Daily Est. Revenue"}),Ke.cumulative_revenue&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_revenue",stroke:"#009900",strokeDasharray:"5 5",name:"Cum. Revenue"}),Ke.cumulative_revenue_net&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_revenue_net",stroke:"#00cc00",strokeDasharray:"5 5",name:"Cum. Net Revenue"}),Ke.cumulative_estimated_revenue&&(0,ut.jsx)(fw,{type:"monotone",dataKey:"cumulative_estimated_revenue",stroke:"#00e600",strokeDasharray:"5 5",name:"Cum. Est. Revenue"})]})})})]})]}),le?(0,ut.jsxs)("div",{className:"mb-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Event & Revenue Timeline"}),(0,ut.jsx)("div",{className:"flex gap-2",children:(0,ut.jsx)("span",{className:"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full",children:me&&ge?"Detailed View":"Aggregate View"})})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 border rounded-lg bg-gray-50 dark:bg-gray-600",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{htmlFor:"user-select",className:"block text-sm font-medium text-gray-700 dark:text-white mb-2",children:"Select User (Optional)"}),(0,ut.jsx)(qE,{id:"user-select",isClearable:!0,isSearchable:!0,options:be.map(e=>({value:e,label:e})),value:me?{value:me,label:me}:null,onChange:e=>{const t=e?e.value:"";fe(t),Ue(t,ge)},styles:Xe(),placeholder:"Type to search users..."})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{htmlFor:"product-select",className:"block text-sm font-medium text-gray-700 dark:text-white mb-2",children:"Select Product (Optional)"}),(0,ut.jsx)(qE,{id:"product-select",isClearable:!0,isSearchable:!0,options:ve.map(e=>({value:e,label:e})),value:ge?{value:ge,label:ge}:null,onChange:e=>{const t=e?e.value:"";xe(t),Ue(me,t)},styles:Xe(),placeholder:"Type to search products..."})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10 min-w-[200px]",children:"Metric"}),le.dates.map(e=>(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap min-w-[80px]",children:e},e))]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:(()=>{const e=[{key:"daily_trial_started",label:"Trial Started",category:"daily_absolute",categoryLabel:"Daily Absolute Values",getValue:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.event_rows||{};return me||ge?(null===(r=s.trial_started)||void 0===r?void 0:r[e])||0:(null===(n=s.trial_started)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_trials_started)||0}},{key:"daily_trial_pending",label:"Trial Pending",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).trial_pending)||void 0===r?void 0:r[e])||0}},{key:"daily_trial_ended",label:"Trial Ended",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).trial_ended)||void 0===r?void 0:r[e])||0}},{key:"daily_trial_cancelled",label:"Trial Cancelled",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).trial_canceled)||void 0===r?void 0:r[e])||0}},{key:"daily_trial_converted",label:"Trial Converted",category:"daily_absolute",getValue:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.event_rows||{};return me||ge?(null===(r=s.trial_converted)||void 0===r?void 0:r[e])||0:(null===(n=s.trial_converted)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_conversions)||0}},{key:"daily_initial_purchase",label:"Initial Purchase",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).initial_purchase)||void 0===r?void 0:r[e])||0}},{key:"daily_subscription_active",label:"Subscription Active",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).subscription_active)||void 0===r?void 0:r[e])||0}},{key:"daily_subscription_cancelled",label:"Subscription Cancelled",category:"daily_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).subscription_cancelled)||void 0===r?void 0:r[e])||0}},{key:"daily_refund",label:"Refund",category:"daily_absolute",getValue:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.event_rows||{};return me||ge?(null===(r=s.refund)||void 0===r?void 0:r[e])||0:(null===(n=s.refund)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_refunds)||0}},{key:"daily_revenue",label:"Revenue (Actual)",category:"daily_revenue",categoryLabel:"Daily Revenue",getValue:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.estimate_rows||{},i=me||ge?(null===(r=s.current_revenue)||void 0===r?void 0:r[e])||0:(null===(n=s.current_revenue)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_revenue)||0;return Ve(i)}},{key:"daily_est_revenue",label:"Est. Revenue",category:"daily_revenue",isEstimatedRevenue:!0,getValue:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.estimate_rows||{},i=me||ge?(null===(r=s.estimated_net_revenue)||void 0===r?void 0:r[e])||0:(null===(n=s.estimated_revenue)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_estimated_revenue)||0;return Ve(i)},getTooltipData:(e,t)=>{var r,n;const a=qe?qe.find(t=>t.date===e):null,s=le.estimate_rows||{},i=me||ge?(null===(r=s.estimated_net_revenue)||void 0===r?void 0:r[e])||0:(null===(n=s.estimated_revenue)||void 0===n?void 0:n[e])||(null===a||void 0===a?void 0:a.daily_estimated_revenue)||0;return{formula:"Est_Revenue = (Active_Trials \xd7 Trial_Conv_Rate \xd7 Avg_Revenue) + (Active_Subs \xd7 (1 - Churn_Rate) \xd7 Avg_Revenue) - (Expected_Refunds \xd7 Avg_Refund)",calculation:"(".concat((null===a||void 0===a?void 0:a.daily_trials_pending)||0," \xd7 0.15 \xd7 $9.99) + (").concat((null===a||void 0===a?void 0:a.daily_trials_pending)||0," \xd7 0.95 \xd7 $9.99) - (").concat((null===a||void 0===a?void 0:a.daily_refunds)||0," \xd7 $9.99)"),components:{"Active Trials":(null===a||void 0===a?void 0:a.daily_trials_pending)||0,"Trial Conversion Rate":"15%","Active Subscriptions":"N/A","Churn Rate":"5%","Avg Revenue":"$9.99","Expected Refunds":(null===a||void 0===a?void 0:a.daily_refunds)||0,"Avg Refund":"$9.99"},result:Ve(i)}}},{key:"cumulative_trial_started",label:"Trial Started",category:"cumulative_absolute",categoryLabel:"Cumulative Absolute Values",getValue:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.event_rows||{};return me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.trial_started)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_trials_started)||0}},{key:"cumulative_trial_pending",label:"Trial Pending",category:"cumulative_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).trial_pending)||void 0===r?void 0:r[e])||0}},{key:"cumulative_trial_ended",label:"Trial Ended",category:"cumulative_absolute",getValue:(e,t)=>{const r=le.event_rows||{};return le.dates.slice(0,t+1).reduce((e,t)=>{var n;return e+((null===(n=r.trial_ended)||void 0===n?void 0:n[t])||0)},0)}},{key:"cumulative_trial_cancelled",label:"Trial Cancelled",category:"cumulative_absolute",getValue:(e,t)=>{const r=le.event_rows||{};return me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var n;return e+((null===(n=r.trial_canceled)||void 0===n?void 0:n[t])||0)},0):qe?qe.slice(0,t+1).reduce((e,t)=>{var n;return e+((null===(n=r.trial_canceled)||void 0===n?void 0:n[t.date])||0)},0):0}},{key:"cumulative_trial_converted",label:"Trial Converted",category:"cumulative_absolute",getValue:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.event_rows||{};return me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.trial_converted)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_conversions)||0}},{key:"cumulative_initial_purchase",label:"Initial Purchase",category:"cumulative_absolute",getValue:(e,t)=>{var r;const n=le.event_rows||{};return me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.initial_purchase)||void 0===r?void 0:r[t])||0)},0):(null===(r=n.cumulative_initial_purchase)||void 0===r?void 0:r[e])||0}},{key:"cumulative_subscription_active",label:"Subscription Active",category:"cumulative_absolute",getValue:(e,t)=>{var r;return(null===(r=(le.event_rows||{}).subscription_active)||void 0===r?void 0:r[e])||0}},{key:"cumulative_subscription_cancelled",label:"Subscription Cancelled",category:"cumulative_absolute",getValue:(e,t)=>{const r=le.event_rows||{};return le.dates.slice(0,t+1).reduce((e,t)=>{var n;return e+((null===(n=r.subscription_cancelled)||void 0===n?void 0:n[t])||0)},0)}},{key:"cumulative_refund",label:"Refund",category:"cumulative_absolute",getValue:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.event_rows||{};return me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.refund)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_refunds)||0}},{key:"cumulative_revenue",label:"Revenue (Actual)",category:"cumulative_revenue",categoryLabel:"Cumulative Revenue",getValue:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.estimate_rows||{},a=me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.current_revenue)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_revenue)||0;return Ve(a)}},{key:"cumulative_est_revenue",label:"Est. Revenue",category:"cumulative_revenue",isEstimatedRevenue:!0,getValue:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.estimate_rows||{},a=me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.estimated_net_revenue)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_estimated_revenue)||0;return Ve(a)},getTooltipData:(e,t)=>{const r=qe?qe.find(t=>t.date===e):null,n=le.estimate_rows||{},a=me||ge?le.dates.slice(0,t+1).reduce((e,t)=>{var r;return e+((null===(r=n.estimated_net_revenue)||void 0===r?void 0:r[t])||0)},0):(null===r||void 0===r?void 0:r.cumulative_estimated_revenue)||0;return{formula:"Cumulative_Est_Revenue = \u03a3(Daily_Est_Revenue) from start to date",calculation:"Sum of daily estimated revenue from start date to ".concat(e),components:{Period:"Start to ".concat(e),Days:t+1,"Avg Daily Est":Ve(a/(t+1))},result:Ve(a)}}}],t={daily_absolute:"bg-blue-50 dark:bg-blue-900/30",daily_revenue:"bg-green-50 dark:bg-green-900/30",cumulative_absolute:"bg-indigo-50 dark:bg-indigo-900/30",cumulative_revenue:"bg-emerald-50 dark:bg-emerald-900/30"};return e.map((r,n)=>{const a=0===n||e[n-1].category!==r.category;return(0,ut.jsxs)(s.Fragment,{children:[a&&r.categoryLabel&&(0,ut.jsx)("tr",{className:"".concat(t[r.category]," border-t-2 border-gray-300 dark:border-gray-500"),children:(0,ut.jsx)("td",{colSpan:le.dates.length+1,className:"p-2 border-b dark:border-gray-600 text-center font-semibold text-gray-700 dark:text-white",children:r.categoryLabel})}),(0,ut.jsxs)("tr",{className:n%2===0?"":"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10 bg-inherit",children:r.label}),le.dates.map((e,t)=>(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 whitespace-nowrap ".concat(r.isEstimatedRevenue?"cursor-help hover:bg-yellow-50 dark:hover:bg-yellow-900/20":""),onMouseEnter:r.isEstimatedRevenue?n=>{const a=r.getTooltipData(e,t);Ne(a),Oe({x:n.clientX,y:n.clientY})}:void 0,onMouseLeave:r.isEstimatedRevenue?()=>{Ne(null)}:void 0,children:r.getValue(e,t)},e))]})]},r.key)})})()})]})})]}):de?(0,ut.jsxs)("div",{className:"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4",children:[(0,ut.jsx)(CN,{className:"animate-spin mr-2 text-indigo-600 dark:text-indigo-400"}),(0,ut.jsx)("p",{className:"text-gray-700 dark:text-white",children:"Loading event revenue timeline..."})]}):he?(0,ut.jsx)("div",{className:"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(We,{className:"mr-2 flex-shrink-0"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium block",children:"Event Revenue Timeline Error:"}),(0,ut.jsx)("span",{className:"block mt-1",children:he})]})]})}):null,re?(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,ut.jsx)("h3",{className:"text-xl font-semibold text-gray-700 dark:text-white",children:"User Timeline"}),(0,ut.jsxs)("div",{className:"flex gap-2",children:[(0,ut.jsxs)("span",{className:"text-sm font-medium px-3 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full",children:[re.unique_users_count||re.total_users," Unique Users"]}),(0,ut.jsxs)("span",{className:"text-sm font-medium px-3 py-1 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100 rounded-full",children:[re.total_user_product_combinations||(null===(T=re.users)||void 0===T?void 0:T.length)," User-Product Combinations"]}),(0,ut.jsxs)("span",{className:"text-sm font-medium px-3 py-1 bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-100 rounded-full",children:[(null===(M=re.valid_product_ids)||void 0===M?void 0:M.length)||0," Unique Products"]})]})]}),re.filter_stats&&(0,ut.jsx)(oL,{filterStats:re.filter_stats}),(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsxs)("div",{className:"flex flex-wrap gap-3 mb-2",children:[(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.default.bg," ").concat(iL.default.text),children:"No Event"}),(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.trial_started.bg," ").concat(iL.trial_started.text),children:"Trial Started"}),(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.trial_converted.bg," ").concat(iL.trial_converted.text),children:"Trial Converted"}),(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.trial_cancelled.bg," ").concat(iL.trial_cancelled.text),children:"Trial Cancelled"}),(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.conversion_cancelled.bg," ").concat(iL.conversion_cancelled.text),children:"Conversion Cancelled"}),(0,ut.jsx)("div",{className:"px-3 py-2 rounded ".concat(iL.refunded.bg," ").concat(iL.refunded.text),children:"Refunded"})]}),(0,ut.jsxs)("div",{className:"relative flex items-center bg-gray-100 dark:bg-gray-700 p-2 rounded text-sm",children:[(0,ut.jsx)("span",{className:"mr-2",children:"Multiple events on the same day:"}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsxs)("div",{className:"relative mr-8 px-4 py-2 rounded bg-green-100 dark:bg-green-900/50",style:{minWidth:"180px"},children:[(0,ut.jsx)("span",{className:"text-green-800 dark:text-green-200",children:"Trial Converted"}),(0,ut.jsx)("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center",children:"3"}),(0,ut.jsxs)("div",{className:"mt-1 flex flex-col gap-1 w-full",children:[(0,ut.jsx)("div",{className:"px-1 py-0.5 text-[9px] w-full text-center rounded bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200",children:"Trial started"}),(0,ut.jsx)("div",{className:"px-1 py-0.5 text-[9px] w-full text-center rounded bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300",children:"Refunded"})]})]}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"The cell is colored by the first event, with a counter and full-text badges for each additional event"})]})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10",children:"User ID"}),(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-[150px] bg-gray-50 dark:bg-gray-700 z-10",children:"Product ID"}),re.dates.map(e=>(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap",children:e},e))]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:re.users.map((e,t)=>{const r=0===t||re.users[t-1].id!==e.id,n=r?t%4<2?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700":"";return(0,ut.jsxs)("tr",{className:n,children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300 sticky left-0 z-10",style:{backgroundColor:"inherit"},children:r?e.id:""}),(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-green-700 dark:text-green-300 sticky left-[150px] z-10",style:{backgroundColor:"inherit"},children:e.product_id}),re.dates.map(t=>{const r=((e,t,r)=>{if(!r[e]||!r[e][t]){let n=null,a="default";if(r[e])for(const s in r[e])if(s<=t&&(!n||s>n)){n=s;const t=r[e][s],i=t[t.length-1];"RC Trial started"===i.type?a="trial_started":"RC Trial converted"===i.type?a="trial_converted":"RC Trial cancelled"===i.type?a="trial_cancelled":"RC Initial purchase"===i.type||"RC Renewal"===i.type?a="trial_converted":"RC Cancellation"===i.type&&(a=i.has_refund?"refunded":"conversion_cancelled")}return a}const n=r[e][t][0];return"RC Trial started"===n.type?"trial_started":"RC Trial converted"===n.type?"trial_converted":"RC Trial cancelled"===n.type?"trial_cancelled":"RC Initial purchase"===n.type||"RC Renewal"===n.type?"trial_converted":"RC Cancellation"===n.type?n.has_refund?"refunded":"conversion_cancelled":"default"})(e.user_product_key,t,re.events),n=((e,t,r)=>r[e]&&r[e][t]?r[e][t]:[])(e.user_product_key,t,re.events),a=n.length>0;return(0,ut.jsx)("td",{className:"p-2 border dark:border-gray-600 text-xs relative ".concat(iL[r].bg),children:a?(0,ut.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ut.jsx)("div",{className:"text-center w-full ".concat(iL[r].text," font-medium"),children:n[0].type.replace("RC ","")}),n.length>1&&(0,ut.jsx)("div",{className:"mt-1 flex flex-col items-center w-full gap-1",children:n.slice(1).map((e,t)=>{const r=e.type.replace("RC ","");let n="default";return"RC Trial started"===e.type?n="trial_started":"RC Trial converted"===e.type?n="trial_converted":"RC Trial cancelled"===e.type?n="trial_cancelled":"RC Cancellation"===e.type?n=e.has_refund?"refunded":"conversion_cancelled":("RC Initial purchase"===e.type||"RC Renewal"===e.type)&&(n="trial_converted"),(0,ut.jsx)("div",{className:"px-1 py-0.5 text-[9px] w-full text-center rounded ".concat(iL[n].bg," ").concat(iL[n].text),title:"".concat(r," at ").concat(e.time," for ").concat(e.product_id),children:r},t)})}),n.length>1&&(0,ut.jsx)("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 bg-blue-500 text-white text-[8px] rounded-full w-4 h-4 flex items-center justify-center",children:n.length})]}):""},t)})]},e.user_product_key)})})]})})]}):ae?(0,ut.jsxs)("div",{className:"flex items-center justify-center p-8 bg-white dark:bg-gray-700 rounded-lg shadow-md my-4",children:[(0,ut.jsx)(CN,{className:"animate-spin mr-2 text-indigo-600 dark:text-indigo-400"}),(0,ut.jsx)("p",{className:"text-gray-700 dark:text-white",children:"Loading user timeline data..."})]}):ie?(0,ut.jsx)("div",{className:"my-4 p-4 bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-white rounded-md shadow-md border border-yellow-300 dark:border-yellow-600",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(We,{className:"mr-2 flex-shrink-0"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium block",children:"Timeline Error:"}),(0,ut.jsx)("span",{className:"block mt-1",children:ie})]})]})}):null,(0,ut.jsx)(lL,{data:we,position:Se,onClose:()=>Ne(null)}),(0,ut.jsx)(Je,{})]})},dL=e=>{var t,r,n,a,i,o,l,c,d,u,h,p,m;let{config:f,analysisParams:g,onConfigChange:x}=e;const[b,y]=(0,s.useState)(!1),[v,_]=(0,s.useState)([]),[k,j]=(0,s.useState)([]),[w,N]=(0,s.useState)({}),[S,O]=(0,s.useState)(!1),[C,E]=(0,s.useState)("");(0,s.useEffect)(()=>{P()},[]);const P=async()=>{O(!0);try{const e=await Ra();e.event_properties&&_(e.event_properties),e.user_properties&&j(e.user_properties)}catch(e){console.error("Failed to load properties:",e),E("Failed to load available properties. Some features may be limited.")}O(!1)},A=async(e,t,r)=>{if(e&&t)try{const n=await Da(e,t);N(t=>Ie(Ie({},t),{},{[r+"_"+e]:n.values||[]}))}catch(n){console.error("Error fetching values for ".concat(e,":"),n),N(t=>Ie(Ie({},t),{},{[r+"_"+e]:[]}))}},T=e=>{const t=Ie(Ie({},g),{},{config:Ie(Ie({},g.config),e)});x(t)},M=(e,t)=>{const r=Ie(Ie({},f.product_filter),{},{[e]:t});T({product_filter:r})},R=(e,t)=>{const r=Ie(Ie({},f.lifecycle),{},{[e]:t});T({lifecycle:r})},D=(e,t)=>{const r=Ie(Ie({},f.timeline),{},{[e]:t});T({timeline:r})},I=(e,t)=>{const r=Ie(Ie({},g),{},{[e]:t});x(r)},L=(e,t,r)=>{const n=[...g.optional_filters||[]],a=n[r];"property_source"===e?(a.property_source=t,a.property_values=[],a.property_name&&A(a.property_name,t,"optional_filter_".concat(r))):"property_name"===e?(a.property_name=t,a.property_values=[],t&&a.property_source&&A(t,a.property_source,"optional_filter_".concat(r))):"property_values"===e&&(a.property_values=t);const s=Ie(Ie({},g),{},{optional_filters:n});x(s)};return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Analysis Configuration"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("button",{onClick:async()=>{O(!0),E("Discovering available properties...");try{await P(),E("Property discovery completed successfully!"),setTimeout(()=>E(""),3e3)}catch(e){E("Property discovery failed. Please try again."),setTimeout(()=>E(""),5e3)}O(!1)},disabled:S,className:"px-3 py-1 text-sm bg-teal-200 hover:bg-teal-300 dark:bg-teal-700 dark:hover:bg-teal-600 text-teal-700 dark:text-teal-300 rounded-lg transition-colors disabled:opacity-50",title:"Refresh available properties",children:S?"Loading...":"Discover Properties"}),(0,ut.jsx)("button",{onClick:()=>y(!b),className:"px-3 py-1 text-sm bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",children:b?"Hide Advanced":"Show Advanced"})]})]}),C&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-teal-50 dark:bg-teal-900/40 border border-teal-200 dark:border-teal-600 rounded-md",children:(0,ut.jsx)("p",{className:"text-sm text-teal-700 dark:text-teal-300",children:C})}),(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date From"}),(0,ut.jsx)("input",{type:"date",value:g.date_from,onChange:e=>I("date_from",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date To"}),(0,ut.jsx)("input",{type:"date",value:g.date_to,onChange:e=>I("date_to",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]})]}),(0,ut.jsxs)("div",{className:"border-t pt-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"User & Event Property Filters"}),(0,ut.jsx)("button",{type:"button",onClick:()=>{const e=Ie(Ie({},g),{},{optional_filters:[...g.optional_filters||[],{id:Date.now().toString(),property_name:"",property_values:[],property_source:"event"}]});x(e)},className:"p-1.5 bg-teal-100 dark:bg-teal-600 text-teal-700 dark:text-white rounded-full hover:bg-teal-200 dark:hover:bg-teal-500 transition-colors",title:"Add optional filter",children:(0,ut.jsx)(EN,{size:18})})]}),(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(0,ut.jsx)("strong",{children:"Optional:"})," Add filters to narrow down your cohort. User property filters will only include users with the specified property values. Event property filters will only include users who have events with the specified property values."]}),(0===(null===(t=g.optional_filters)||void 0===t?void 0:t.length)||!g.optional_filters)&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic mb-4",children:"No filters applied. All users with trial/purchase events in the time frame will be included. Click the + button to add a filter."}),(g.optional_filters||[]).map((e,t)=>(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end mb-4 p-4 border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 rounded-md",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:"Source Type"}),(0,ut.jsxs)("select",{value:e.property_source,onChange:e=>L("property_source",e.target.value,t),className:"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white",children:[(0,ut.jsx)("option",{value:"event",children:"Event Property"}),(0,ut.jsx)("option",{value:"user",children:"User Property"})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:"Property Name"}),(0,ut.jsxs)("select",{value:e.property_name,onChange:e=>L("property_name",e.target.value,t),className:"block w-full p-2 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-600 text-gray-900 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"-- Select Property --"}),("event"===e.property_source?v:k).map(e=>(0,ut.jsx)("option",{value:e.key,children:e.display_name||e.key},e.key))]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-300 mb-1",children:"Property Value(s)"}),(0,ut.jsx)(qE,{isMulti:!0,isDisabled:!e.property_name||!e.property_source,options:(w["optional_filter_".concat(t,"_").concat(e.property_name)]||[]).map(e=>({value:e,label:e})),value:e.property_values.map(e=>({value:e,label:e})),onChange:e=>L("property_values",e?e.map(e=>e.value):[],t),styles:{control:(e,t)=>Ie(Ie({},e),{},{backgroundColor:"var(--select-bg, white)",borderColor:t.isFocused?"#3b82f6":"#d1d5db",boxShadow:t.isFocused?"0 0 0 1px #3b82f6":"none","&:hover":{borderColor:"#3b82f6"}}),menu:e=>Ie(Ie({},e),{},{backgroundColor:"var(--select-menu-bg, white)",zIndex:9999}),option:(e,t)=>Ie(Ie({},e),{},{backgroundColor:t.isSelected?"#3b82f6":t.isFocused?"#eff6ff":"var(--select-option-bg, white)",color:t.isSelected?"white":"var(--select-option-color, black)"}),multiValue:e=>Ie(Ie({},e),{},{backgroundColor:"#eff6ff"}),multiValueLabel:e=>Ie(Ie({},e),{},{color:"#1e40af"}),multiValueRemove:e=>Ie(Ie({},e),{},{color:"#1e40af","&:hover":{backgroundColor:"#dbeafe",color:"#1e40af"}})},placeholder:"Select values..."})]}),(0,ut.jsx)("div",{className:"flex justify-end",children:(0,ut.jsx)("button",{type:"button",onClick:()=>(e=>{const t=Ie(Ie({},g),{},{optional_filters:(g.optional_filters||[]).filter(t=>t.id!==e)});x(t)})(e.id),className:"p-1.5 bg-red-100 dark:bg-red-700 text-red-600 dark:text-white rounded-full hover:bg-red-200 dark:hover:bg-red-600 transition-colors",title:"Remove this filter",children:(0,ut.jsx)(ON,{size:18})})})]},e.id))]}),(0,ut.jsxs)("div",{className:"border-t pt-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Product Filtering"}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Include Products Containing (comma-separated)"}),(0,ut.jsx)("input",{type:"text",value:(null===(r=f.product_filter)||void 0===r||null===(n=r.include_patterns)||void 0===n?void 0:n.join(", "))||"",onChange:e=>M("include_patterns",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),placeholder:"e.g., gluten, premium, pro",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Products containing any of these patterns will be included"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Specific Product IDs (comma-separated)"}),(0,ut.jsx)("input",{type:"text",value:(null===(a=f.product_filter)||void 0===a||null===(i=a.specific_product_ids)||void 0===i?void 0:i.join(", "))||"",onChange:e=>M("specific_product_ids",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),placeholder:"e.g., prod_R7oYuL3bSUecnr, prod_ABC123",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"These exact product IDs will always be included"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exclude Products Containing (comma-separated)"}),(0,ut.jsx)("input",{type:"text",value:(null===(o=f.product_filter)||void 0===o||null===(l=o.exclude_patterns)||void 0===l?void 0:l.join(", "))||"",onChange:e=>M("exclude_patterns",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),placeholder:"e.g., test, demo, staging",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Products containing any of these patterns will be excluded"})]})]})]}),b&&(0,ut.jsxs)("div",{className:"border-t pt-6 space-y-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Advanced Configuration"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Lifecycle Rate Settings"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-1",children:"Trial Window (days)"}),(0,ut.jsx)("input",{type:"number",value:(null===(c=f.lifecycle)||void 0===c?void 0:c.trial_window_days)||7,onChange:e=>R("trial_window_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-1",children:"Cancellation Window (days)"}),(0,ut.jsx)("input",{type:"number",value:(null===(d=f.lifecycle)||void 0===d?void 0:d.cancellation_window_days)||30,onChange:e=>R("cancellation_window_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),(0,ut.jsx)("div",{className:"flex items-center",children:(0,ut.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:!1!==(null===(u=f.lifecycle)||void 0===u?void 0:u.smoothing_enabled),onChange:e=>R("smoothing_enabled",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,ut.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Smoothing Enabled"})]})})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Timeline Settings"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ut.jsx)("div",{className:"flex items-center",children:(0,ut.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:!1!==(null===(h=f.timeline)||void 0===h?void 0:h.include_estimates),onChange:e=>D("include_estimates",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,ut.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include Revenue Estimates"})]})}),(0,ut.jsx)("div",{className:"flex items-center",children:(0,ut.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:!1!==(null===(p=f.timeline)||void 0===p?void 0:p.include_confidence_intervals),onChange:e=>D("include_confidence_intervals",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,ut.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include Confidence Intervals"})]})})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Detailed Events Analysis"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-1",children:"Specific User ID (for detailed event analysis)"}),(0,ut.jsx)("input",{type:"text",value:(null===(m=f.detailed_events)||void 0===m?void 0:m.user_id)||"",onChange:e=>((e,t)=>{const r=Ie(Ie({},f.detailed_events),{},{[e]:t});T({detailed_events:r})})("user_id",e.target.value),placeholder:"e.g., user_12345 or distinct_id",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Leave empty for cohort-wide analysis, or enter a specific user ID to see detailed events for that user"})]})]})]})]})]})},uL=e=>{var t;let{data:r,debugStage:n}=e;const[a,i]=(0,s.useState)("summary"),[o,l]=(0,s.useState)(new Set(["summary"]));if(!r)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No debug data available. Run an analysis in debug mode to see results."})});const c=function(e){if((arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)>=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:3))return"object"===typeof e?"[Object]":String(e);try{return JSON.stringify(e,null,2)}catch(dU){return String(e)}},d=e=>{var t,a,s,i;return{summary:{title:"Analysis Summary",data:{success:r.success,message:r.message,timestamp:r.timestamp,execution_metadata:r.execution_metadata,debug_stage:n}},cohort_summary:{title:"Cohort Summary",data:null===(t=r.data)||void 0===t?void 0:t.cohort_summary},arpu_data:{title:"ARPU Data",data:null===(a=r.data)||void 0===a?void 0:a.arpu_data},lifecycle_rates:{title:"Lifecycle Rates",data:null===(s=r.data)||void 0===s?void 0:s.lifecycle_rates},timeline_data:{title:"Timeline Data",data:null===(i=r.data)||void 0===i?void 0:i.timeline_data},raw_response:{title:"Raw API Response",data:r}}[e]||{title:"Unknown",data:null}},u=["summary","cohort_summary","arpu_data","lifecycle_rates","timeline_data","raw_response"].filter(e=>{const t=d(e);return null!==t.data&&void 0!==t.data}),h=e=>{let{sectionKey:t,title:r,data:n,isExpanded:a}=e;if(!n)return null;const s=n&&("object"!==typeof n||Object.keys(n).length>0);return(0,ut.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,ut.jsxs)("button",{onClick:()=>(e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),l(t)})(t),className:"w-full px-4 py-3 text-left bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-t-lg flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:r}),s&&(0,ut.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-2 py-1 rounded",children:"object"===typeof n&&null!==n?"".concat(Object.keys(n).length," keys"):"Data available"})]}),(0,ut.jsx)("span",{className:"text-gray-400",children:a?"\u25bc":"\u25b6"})]}),a&&(0,ut.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:s?(0,ut.jsx)("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg overflow-auto max-h-96",children:(0,ut.jsx)("pre",{className:"text-sm whitespace-pre-wrap",children:c(n)})}):(0,ut.jsx)("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"No data available for this section"})})]})};return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"text-yellow-600 dark:text-yellow-400",children:"\ud83d\udc1b"}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-200",children:"Debug Mode Active"})]}),(0,ut.jsx)("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:n?(0,ut.jsxs)(ut.Fragment,{children:["Showing debug data for stage: ",(0,ut.jsx)("strong",{children:n})]}):"Showing complete analysis debug data"})]}),(0,ut.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map(e=>{const t=d(e),r=a===e;return(0,ut.jsx)("button",{onClick:()=>i(e),className:"px-3 py-2 text-sm rounded-lg transition-colors ".concat(r?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),children:t.title},e)})}),(0,ut.jsx)("div",{className:"space-y-4",children:u.map(e=>{const t=d(e),r=o.has(e);return(0,ut.jsx)(h,{sectionKey:e,title:t.title,data:t.data,isExpanded:r},e)})}),(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Debug Actions"}),(0,ut.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,ut.jsx)("button",{onClick:()=>l(new Set(u)),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Expand All"}),(0,ut.jsx)("button",{onClick:()=>l(new Set),className:"px-3 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Collapse All"}),(0,ut.jsx)("button",{onClick:()=>{const e=JSON.stringify(r,null,2);navigator.clipboard.writeText(e)},className:"px-3 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Copy to Clipboard"}),(0,ut.jsx)("button",{onClick:()=>{const e=JSON.stringify(r,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="debug-data-".concat(n||"full","-").concat((new Date).toISOString(),".json"),s.click(),URL.revokeObjectURL(a)},className:"px-3 py-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Download JSON"})]})]}),r.execution_metadata&&(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-200 mb-3",children:"Performance Metrics"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Duration"}),(0,ut.jsxs)("div",{className:"text-blue-600 dark:text-blue-400",children:[null===(t=r.execution_metadata.duration_seconds)||void 0===t?void 0:t.toFixed(2),"s"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Pipeline Version"}),(0,ut.jsx)("div",{className:"text-blue-600 dark:text-blue-400",children:r.execution_metadata.pipeline_version||"N/A"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Analysis Type"}),(0,ut.jsx)("div",{className:"text-blue-600 dark:text-blue-400",children:r.execution_metadata.analysis_type||"full"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Start Time"}),(0,ut.jsx)("div",{className:"text-blue-600 dark:text-blue-400",children:r.execution_metadata.start_time?new Date(r.execution_metadata.start_time).toLocaleTimeString():"N/A"})]})]})]})]})},hL=ze("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),pL=ze("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),mL=ze("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),fL=e=>{var t,r,n;let{data:a}=e;if(!a)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No cohort data available. Run an analysis to see filtering statistics."})});const i=a.legacy_format||(null===(t=a.data)||void 0===t?void 0:t.legacy_format),o=a.structured_format||(null===(r=a.data)||void 0===r?void 0:r.structured_format),l=a.summary||(null===(n=a.data)||void 0===n?void 0:n.summary);let c=[],d=0,u=0,h=0,p=0,m=0,f=0,g=60,x=0,b=0,y=0;var v;if((l&&(y=l.extended_cohort_count||0,u=l.final_cohort_count||0,p=u,m=l.base_user_count||0,f=l.lookback_user_count||0,h=l.total_event_count||0,x=l.base_event_count||0,b=l.lookback_event_count||0),i)&&(0===u&&(u=i.cohort_size||0),0===p&&(p=i.comprehensive_cohort_size||u),0===m&&(m=i.base_users||0),0===f&&(f=i.lookback_users||0),0===y&&(y=i.extended_cohort_size||0),0===h&&(h=i.total_events||i.event_count||0),0===x&&(x=i.base_events||0),0===b&&(b=i.lookback_events||0),null!==(v=i.metadata)&&void 0!==v&&v.lookback_days_used&&(g=i.metadata.lookback_days_used),i.filter_stats)){const e=i.filter_stats;c=e.filtering_steps||[],d=e.base_cohort_count||e.extended_cohort_size||0,0===u&&(u=e.final_cohort_count||e.final_cohort_size||0),0===y&&(y=e.extended_cohort_size||0)}if(null!==o&&void 0!==o&&o.unified_pipeline_data){const e=o.unified_pipeline_data;if(e.unified_cohort){const t=e.unified_cohort;if(0===u&&(u=t.size||0),0===p&&(p=u),0===m&&(m=t.base_size||0),0===f&&(f=t.lookback_size||0),0===y&&(y=t.extended_size||0),t.metadata&&(60===g&&(g=t.metadata.lookback_days_used||60),0===y&&(y=t.metadata.extended_cohort_size||0),t.metadata.filter_stats&&0===c.length)){const e=t.metadata.filter_stats;c=e.filtering_steps||[],0===d&&(d=e.base_cohort_count||e.extended_cohort_size||0),0===y&&(y=e.extended_cohort_size||0)}}if(e.unified_events){const t=e.unified_events;0===h&&(h=t.size||0),0===x&&(x=t.base_size||0),0===b&&(b=t.lookback_size||0)}if(e.categorized_data){const t=e.categorized_data;0===u&&(u=t.total_cohort_size||0),0===m&&(m=t.base_cohort_size||0),0===h&&(h=t.total_events_count||0),0===x&&(x=t.base_events_count||0)}}if(null!==o&&void 0!==o&&o.cohort_data&&(null===o||void 0===o||!o.unified_pipeline_data)){var _;const e=null===(_=o.cohort_analysis)||void 0===_?void 0:_.cohort_breakdown;e&&(0===p&&(p=e.total_users||0),0===m&&(m=e.base_users||0),0===f&&(f=e.lookback_users||0));const t=o.event_data;t&&(0===x&&(x=t.base_size||0),0===b&&(b=t.lookback_size||0),0===h&&(h=x+b))}const k={userMathCorrect:m+f===p,eventMathCorrect:x+b===h,basePriorityApplied:m>0&&f>=0,extendedToFinalFlow:y>=p},j=(e,t)=>t?(e/t*100).toFixed(1):0,w=(null===i||void 0===i?void 0:i.event_type_breakdown)||{},N=w&&0!==Object.keys(w).length?Object.entries(w).map(e=>{let[t,r]=e;return{eventType:t,count:r,percentage:j(r,u)}}):null;return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,ut.jsx)(Mt,{size:24,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Unified Cohort Pipeline"}),k.userMathCorrect&&k.basePriorityApplied&&(0,ut.jsxs)("div",{className:"ml-auto flex items-center gap-1 text-green-600 dark:text-green-400 text-sm",children:[(0,ut.jsx)("span",{children:"\u2713"}),(0,ut.jsx)("span",{children:"Three-Phase Unified Approach"})]})]}),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,ut.jsx)(et,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Unified Three-Phase Approach"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-blue-600 dark:text-blue-400 mb-1",children:"Phase 1: Extended Collection"}),(0,ut.jsxs)("div",{className:"text-gray-700 dark:text-gray-300",children:["Collect maximum dataset (+",g," days lookback)"]}),y>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Extended cohort: ",y.toLocaleString()," users"]})]}),(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-green-600 dark:text-green-400 mb-1",children:"Phase 2: Unified Filtering"}),(0,ut.jsx)("div",{className:"text-gray-700 dark:text-gray-300",children:"Apply all filters to extended dataset"}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Filtered cohort: ",p.toLocaleString()," users"]})]}),(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-purple-600 dark:text-purple-400 mb-1",children:"Phase 3: Categorization"}),(0,ut.jsx)("div",{className:"text-gray-700 dark:text-gray-300",children:"Split by timeline with base priority"}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Base: ",m.toLocaleString(),", Lookback: ",f.toLocaleString()]})]})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(Qe,{size:20,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-200",children:"Final Cohort Size"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:p.toLocaleString()}),(0,ut.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:"Users after unified filtering"}),(m>0||f>0)&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:[(0,ut.jsxs)("div",{className:"text-xs font-medium text-blue-800 dark:text-blue-300 mb-2",children:[(0,ut.jsx)(hL,{size:12,className:"inline mr-1"}),"Timeline Categorization:"]}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:[(0,ut.jsx)(It,{size:12,className:"inline mr-1"}),"Base Period:"]}),(0,ut.jsxs)("span",{className:"font-medium text-blue-700 dark:text-blue-300",children:[m.toLocaleString()," (",j(m,p),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-blue-500 dark:text-blue-500",children:[(0,ut.jsx)(Ze,{size:12,className:"inline mr-1"}),"Lookback Only:"]}),(0,ut.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:[f.toLocaleString()," (",j(f,p),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-blue-200 dark:border-blue-700 pt-1",children:[(0,ut.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"Total:"}),(0,ut.jsxs)("span",{className:"text-blue-700 dark:text-blue-300",children:[(m+f).toLocaleString(),k.userMathCorrect?" \u2713":" \u26a0\ufe0f"]})]}),g>0&&(0,ut.jsxs)("div",{className:"text-xs text-blue-500 dark:text-blue-500 mt-1",children:["Extended by ",g," days"]})]})]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(pL,{size:20,className:"text-green-600 dark:text-green-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-200",children:"Events in Cohort"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-300",children:h>0?h.toLocaleString():"N/A"}),(0,ut.jsx)("p",{className:"text-sm text-green-700 dark:text-green-400",children:"Total events analyzed"}),(x>0||b>0)&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-700",children:[(0,ut.jsxs)("div",{className:"text-xs font-medium text-green-800 dark:text-green-300 mb-2",children:[(0,ut.jsx)(hL,{size:12,className:"inline mr-1"}),"Event Timeline Categorization:"]}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:[(0,ut.jsx)(It,{size:12,className:"inline mr-1"}),"Base Period:"]}),(0,ut.jsxs)("span",{className:"font-medium text-green-700 dark:text-green-300",children:[x.toLocaleString()," (",j(x,h),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-green-500 dark:text-green-500",children:[(0,ut.jsx)(Ze,{size:12,className:"inline mr-1"}),"Lookback Only:"]}),(0,ut.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:[b.toLocaleString()," (",j(b,h),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-green-200 dark:border-green-700 pt-1",children:[(0,ut.jsx)("span",{className:"text-green-700 dark:text-green-300",children:"Total:"}),(0,ut.jsxs)("span",{className:"text-green-700 dark:text-green-300",children:[(x+b).toLocaleString(),k.eventMathCorrect?" \u2713":" \u26a0\ufe0f"]})]})]})]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(mL,{size:20,className:"text-purple-600 dark:text-purple-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-purple-900 dark:text-purple-200",children:"Filter Efficiency"})]}),(0,ut.jsxs)("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-300",children:[y>0?j(p,y):"0","%"]}),(0,ut.jsx)("p",{className:"text-sm text-purple-700 dark:text-purple-400",children:"Users retained from extended cohort"}),y>0&&(0,ut.jsx)("div",{className:"mt-3 pt-3 border-t border-purple-200 dark:border-purple-700",children:(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsx)("span",{className:"text-purple-600 dark:text-purple-400",children:"Extended cohort:"}),(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-300",children:y.toLocaleString()})]}),(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsx)("span",{className:"text-purple-600 dark:text-purple-400",children:"Filtered out:"}),(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-300",children:(y-p).toLocaleString()})]}),(0,ut.jsxs)("div",{className:"flex justify-between font-medium border-t border-purple-200 dark:border-purple-700 pt-1",children:[(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-300",children:"Final:"}),(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-300",children:p.toLocaleString()})]})]})})]})]}),c&&c.length>0&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Unified Pipeline Flow"}),(0,ut.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg overflow-x-auto",children:[(0,ut.jsxs)("div",{className:"text-center min-w-0 flex-shrink-0",children:[(0,ut.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1 font-medium",children:"Extended Collection"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:y>0?y.toLocaleString():"N/A"}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Base + ",g," days"]})]}),(0,ut.jsx)("div",{className:"hidden md:block text-gray-400 mx-2",children:"\u2192"}),c.slice(1).map((e,t)=>{const r=e.users_after||e.users_count||0,n=t===c.slice(1).length-1;return(0,ut.jsxs)(s.Fragment,{children:[(0,ut.jsxs)("div",{className:"text-center min-w-0 flex-shrink-0",children:[(0,ut.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400 mb-1",children:e.step_name||e.step}),(0,ut.jsx)("div",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:r.toLocaleString()}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y>0?j(r,y):"0","% retained"]})]}),!n&&(0,ut.jsx)("div",{className:"hidden md:block text-gray-400 mx-2",children:"\u2192"})]},t)}),(0,ut.jsx)("div",{className:"hidden md:block text-gray-400 mx-2",children:"\u2192"}),(0,ut.jsxs)("div",{className:"text-center min-w-0 flex-shrink-0",children:[(0,ut.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400 mb-1 font-medium",children:"Timeline Categorization"}),(0,ut.jsxs)("div",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1",children:[m.toLocaleString()," + ",f.toLocaleString()]}),(0,ut.jsxs)("div",{className:"text-xs space-y-0.5",children:[(0,ut.jsxs)("div",{className:"text-blue-600 dark:text-blue-400",children:["Base: ",j(m,p),"%"]}),(0,ut.jsxs)("div",{className:"text-green-600 dark:text-green-400",children:["Lookback: ",j(f,p),"%"]})]})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Pipeline Step"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Description"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Users After Step"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Users Filtered"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"% Retained"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Phase"})]})}),(0,ut.jsxs)("tbody",{className:"bg-white dark:bg-gray-800",children:[c.map((e,t)=>{const r=e.users_after||e.users_count||0,n=e.users_filtered||0,a=e.step_name||e.step||"";let s="Filtering",i="text-green-600 dark:text-green-400";return a.includes("extended_cohort_selection")?(s="Extended Collection",i="text-blue-600 dark:text-blue-400"):("Timeline Split"===a||a.includes("timeline_split"))&&(s="Categorization",i="text-purple-600 dark:text-purple-400"),(0,ut.jsxs)("tr",{className:t%2===0?"":"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-gray-300",children:e.step_name||e.step}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:e.description}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300 font-medium",children:r.toLocaleString()}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:a.includes("extended_cohort_selection")?"N/A":n.toLocaleString()}),(0,ut.jsxs)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:[y>0?j(r,y):"0","%"]}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center font-medium ".concat(i),children:s})]},t)}),(m>0||f>0)&&(0,ut.jsxs)("tr",{className:"bg-purple-50 dark:bg-purple-900/20",children:[(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 font-medium text-purple-700 dark:text-purple-300",children:"Timeline Split"}),(0,ut.jsxs)("td",{className:"p-3 border-b dark:border-gray-600 text-purple-700 dark:text-purple-300",children:["Base period: ",m.toLocaleString()," users, Lookback only: ",f.toLocaleString()," users"]}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300 font-medium",children:(m+f).toLocaleString()}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300",children:"Split only"}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-purple-700 dark:text-purple-300",children:"100%"}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center font-medium text-purple-600 dark:text-purple-400",children:"Categorization"})]})]})]})})]}),N&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Unique Users by Event Type"}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(e=>{let{eventType:t,count:r,percentage:n}=e;return(0,ut.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:t.replace("RC ","")}),(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n,"%"]})]}),(0,ut.jsx)("p",{className:"text-xl font-bold text-gray-700 dark:text-gray-300",children:r.toLocaleString()}),(0,ut.jsx)("div",{className:"mt-2 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:(0,ut.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(n,100),"%")}})})]},t)})})]}),(!c||0===c.length)&&!N&&(0,ut.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsx)(Mt,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"No detailed filtering statistics available"}),(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Run a full analysis to see the complete unified pipeline breakdown"})]})]})},gL=ze("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),xL=ze("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),bL=ze("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),yL=e=>{var t,r,n;let{data:a}=e,s=null;if(null!==a&&void 0!==a&&null!==(t=a.stage_results)&&void 0!==t&&t.stage2?s=a.stage_results.stage2:null!==a&&void 0!==a&&null!==(r=a.data)&&void 0!==r&&null!==(n=r.stage_results)&&void 0!==n&&n.stage2&&(s=a.data.stage_results.stage2),!s)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No Stage 2 data available. Run analysis to see user segment matching results."})});const i=s.matching_stats||{},o=s.users_with_segments||[],l=e=>"number"!==typeof e?"0":e.toLocaleString(),c=(e,t)=>t&&"number"===typeof e?(e/t*100).toFixed(1)+"%":"0.0%";return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,ut.jsx)(It,{size:24,className:"text-green-600 dark:text-green-400"}),(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Stage 2: User-to-Segment Matching Results"}),(0,ut.jsxs)("div",{className:"ml-auto flex items-center gap-1 text-green-600 dark:text-green-400 text-sm",children:[(0,ut.jsx)("span",{children:"\u2713"}),(0,ut.jsx)("span",{children:"Conversion Probability Segment Matching"})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(Bt,{size:20,className:"text-green-600 dark:text-green-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-200",children:"Successful Matches"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-300",children:l(i.successful_matches||0)}),(0,ut.jsxs)("p",{className:"text-sm text-green-700 dark:text-green-400",children:[c(i.successful_matches,i.total_users)," success rate"]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(gL,{size:20,className:"text-red-600 dark:text-red-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-red-900 dark:text-red-200",children:"Failed Matches"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-red-600 dark:text-red-300",children:l(i.failed_matches||0)}),(0,ut.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400",children:"No viable segments found"})]}),(0,ut.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(nt,{size:20,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-200",children:"Rollups Applied"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:l(i.rollups_applied||0)}),(0,ut.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:[c(i.rollups_applied,i.successful_matches)," rollup rate"]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(xL,{size:20,className:"text-purple-600 dark:text-purple-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-purple-900 dark:text-purple-200",children:"Average Accuracy"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-300",children:Object.keys(i.accuracy_distribution||{}).length>0?Object.keys(i.accuracy_distribution)[0]:"N/A"}),(0,ut.jsx)("p",{className:"text-sm text-purple-700 dark:text-purple-400",children:"Prediction quality score"})]})]}),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,ut.jsx)(et,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Economic Tier Classification System"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-green-600 dark:text-green-400 mb-1",children:"Tier 1: High Income"}),(0,ut.jsx)("div",{className:"text-gray-700 dark:text-gray-300",children:"US, CA, UK, AU, DE, FR, etc."}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"World Bank high-income classification"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-yellow-600 dark:text-yellow-400 mb-1",children:"Tier 2: Medium Income"}),(0,ut.jsx)("div",{className:"text-gray-700 dark:text-gray-300",children:"BR, MX, TR, RU, AR, etc."}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"World Bank upper-middle-income"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-medium text-red-600 dark:text-red-400 mb-1",children:"Tier 3: Low Income"}),(0,ut.jsx)("div",{className:"text-gray-700 dark:text-gray-300",children:"IN, PH, VN, ID, EG, etc."}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"World Bank lower-middle & low-income"})]})]})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Individual User Segment Matching Results"}),(0,ut.jsxs)("div",{className:"mb-4 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:[(0,ut.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,ut.jsx)(Ft,{size:16,className:"text-yellow-600 dark:text-yellow-400"}),"How to Read This Table"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700 dark:text-gray-300",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-blue-600 dark:text-blue-400 mb-1",children:"\ud83d\udcca 4 Key Metrics Column:"}),(0,ut.jsxs)("ul",{className:"text-xs space-y-1 ml-4",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Trial Conv:"})," % who convert from trial to paid"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Refund:"})," % who refund after trial conversion"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Init. Refund:"})," % who refund initial purchase"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Renewal Refund:"})," % who refund renewals"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Sample:"})," Number of users in this segment"]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-green-600 dark:text-green-400 mb-1",children:"\ud83c\udfaf Match Type Column:"}),(0,ut.jsxs)("ul",{className:"text-xs space-y-1 ml-4",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Direct:"})," Exact match found at user's specific level"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Applied (X steps):"})," Had to use more general segment"]}),(0,ut.jsx)("li",{children:"More steps = less specific match = lower accuracy"}),(0,ut.jsx)("li",{children:"Rollup helps when exact match has too few users"})]})]})]})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"User Distinct ID"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"User Properties"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Matched Segment"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white",children:"Target Segment (if rollup)"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"4 Key Metrics (Trial, Refunds)"}),(0,ut.jsx)("th",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white",children:"Prediction Accuracy"})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:o.slice(0,20).map((e,t)=>{var r,n,a,s,i,o,l,c,d,u,h,p,m,f,g,x,b,y,v,_;const k=e.segment_match_result||{},j=e.user_properties||{},w=k.rollup_chain||[],N=w.length>0?w[0]:null,S=w.length>0?w[w.length-1]:null,O=k.rollup_applied&&w.length>1;return(0,ut.jsxs)("tr",{className:t%2===0?"":"bg-gray-50 dark:bg-gray-700",children:[(0,ut.jsxs)("td",{className:"p-3 border-b dark:border-gray-600 font-mono text-xs text-gray-700 dark:text-gray-300",children:[(0,ut.jsx)("div",{className:"max-w-[200px] break-all",children:e.user_id}),(0,ut.jsxs)("div",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:["Short: ",e.user_id.substring(0,8),"..."]})]}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Product:"})," ",j.product_id||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Store:"})," ",j.app_store||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Price:"})," ",j.price_bucket||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Country:"})," ",j.country||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Economic Tier:"})," ",j.economic_tier||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Region:"})," ",j.region||"N/A"]})]})}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:k.success&&N?(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{className:"font-medium text-blue-600 dark:text-blue-400 mb-2",children:["ID: ",(null===(r=k.matched_segment_id)||void 0===r?void 0:r.substring(0,8))||"Unknown","..."]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Product:"})," ",(null===(n=N.properties)||void 0===n?void 0:n.product_id)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Store:"})," ",(null===(a=N.properties)||void 0===a?void 0:a.app_store)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Price:"})," ",(null===(s=N.properties)||void 0===s?void 0:s.price_bucket)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Country:"})," ",(null===(i=N.properties)||void 0===i?void 0:i.country)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Economic Tier:"})," ",(null===(o=N.properties)||void 0===o?void 0:o.economic_tier)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Region:"})," ",(null===(l=N.properties)||void 0===l?void 0:l.region)||"N/A"]}),(0,ut.jsxs)("div",{className:"pt-1 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("strong",{children:"Users:"})," ",N.cohort_size||0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Level:"})," ",N.level||"N/A"]})]}):k.success?(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{className:"font-medium text-blue-600 dark:text-blue-400 mb-2",children:["ID: ",(null===(c=k.matched_segment_id)||void 0===c?void 0:c.substring(0,8))||"Unknown","..."]}),(0,ut.jsx)("div",{className:"text-gray-500",children:"Segment properties not available"}),k.conversion_metrics&&(0,ut.jsxs)("div",{className:"pt-1 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("strong",{children:"Users:"})," ",k.conversion_metrics.trial_started_count||0]})]}):(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400 text-xs",children:"No match found"})}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-gray-700 dark:text-gray-300",children:O&&S?(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{className:"font-medium text-green-600 dark:text-green-400 mb-2",children:["ID: ",(null===(d=k.final_viable_segment_id)||void 0===d?void 0:d.substring(0,8))||"Unknown","..."]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Product:"})," ",(null===(u=S.properties)||void 0===u?void 0:u.product_id)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Store:"})," ",(null===(h=S.properties)||void 0===h?void 0:h.app_store)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Price:"})," ",(null===(p=S.properties)||void 0===p?void 0:p.price_bucket)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Country:"})," ",(null===(m=S.properties)||void 0===m?void 0:m.country)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Economic Tier:"})," ",(null===(f=S.properties)||void 0===f?void 0:f.economic_tier)||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Region:"})," ",(null===(g=S.properties)||void 0===g?void 0:g.region)||"N/A"]}),(0,ut.jsxs)("div",{className:"pt-1 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("strong",{children:"Users:"})," ",S.cohort_size||0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Level:"})," ",S.level||"N/A"]})]}):(0,ut.jsx)("div",{className:"text-xs text-gray-400",children:k.success?"Direct match - no rollup needed":""})}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:k.success?(0,ut.jsx)("div",{className:"text-xs",children:(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-bold text-blue-600 dark:text-blue-400 text-sm",children:[(100*((null===(x=k.conversion_metrics)||void 0===x?void 0:x.trial_conversion_rate)||0)).toFixed(1),"%"]}),(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"Trial Conv."})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-orange-600 dark:text-orange-400 text-xs",children:[(100*((null===(b=k.conversion_metrics)||void 0===b?void 0:b.trial_converted_to_refund_rate)||0)).toFixed(1),"%"]}),(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"Refund"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-red-600 dark:text-red-400 text-xs",children:[(100*((null===(y=k.conversion_metrics)||void 0===y?void 0:y.initial_purchase_to_refund_rate)||0)).toFixed(1),"%"]}),(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"Init. Refund"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-purple-600 dark:text-purple-400 text-xs",children:[(100*((null===(v=k.conversion_metrics)||void 0===v?void 0:v.renewal_to_refund_rate)||0)).toFixed(1),"%"]}),(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"Renewal Refund"})]}),(0,ut.jsx)("div",{className:"pt-1 border-t border-gray-200 dark:border-gray-600",children:(0,ut.jsxs)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:["Sample: ",(null===(_=k.conversion_metrics)||void 0===_?void 0:_.trial_started_count)||0]})})]})}):(0,ut.jsx)("span",{className:"text-gray-400 text-xs",children:"-"})}),(0,ut.jsx)("td",{className:"p-3 border-b dark:border-gray-600 text-center text-gray-700 dark:text-gray-300",children:k.success?(0,ut.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,ut.jsx)(bL,{size:12,className:"text-yellow-500"}),(0,ut.jsx)("span",{className:"text-xs font-medium px-2 py-1 rounded ".concat("very_high"===k.accuracy_score?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200":"high"===k.accuracy_score?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"medium"===k.accuracy_score?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"low"===k.accuracy_score?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"),children:k.accuracy_score||"Unknown"})]}):(0,ut.jsx)("span",{className:"text-gray-400 text-xs",children:"-"})})]},e.user_id)})})]})}),o.length>20&&(0,ut.jsxs)("div",{className:"mt-4 text-center text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 p-3 rounded",children:["Showing first 20 users of ",o.length," total users"]})]}),s.error&&(0,ut.jsxs)("div",{className:"text-center py-8 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,ut.jsx)(gL,{size:48,className:"mx-auto text-red-400 mb-4"}),(0,ut.jsxs)("p",{className:"text-red-600 dark:text-red-400 mb-2",children:["Stage 2 Error: ",s.error]})]}),0===o.length&&!s.error&&(0,ut.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsx)(It,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"No user segment matching data available"}),(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Run Stage 2 analysis to see user-to-segment matching results"})]})]})},vL=ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),_L=ze("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),kL=ze("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),jL=ze("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),wL=e=>{var t,r,n,a,i,o,l;let{data:c,position:d,onClose:u}=e;const[h,p]=s.useState(!1),m=s.useRef(null);if(!c||!c.breakdown)return null;const{breakdown:f}=c,g=(null===(t=f.total)||void 0===t?void 0:t.final_net_revenue)||0,x=(e,t)=>{if(!t)return null;return t.users>0||t.estimated_revenue||t.actual_revenue?(0,ut.jsxs)("div",{className:"border-b border-gray-700 pb-2 mb-2",children:[(0,ut.jsxs)("h5",{className:"font-bold text-blue-300 mb-2",children:[e," ",t.users>0?"(".concat(t.users," users)"):""]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 text-xs",children:[t.hasOwnProperty("estimated_revenue")&&(0,ut.jsx)("div",{children:"Est. Revenue:"}),t.hasOwnProperty("estimated_revenue")&&(0,ut.jsxs)("div",{className:"text-right font-mono",children:["$",t.estimated_revenue.toFixed(2)]}),t.hasOwnProperty("actual_revenue")&&(0,ut.jsx)("div",{children:"Actual Revenue:"}),t.hasOwnProperty("actual_revenue")&&(0,ut.jsxs)("div",{className:"text-right font-mono",children:["$",t.actual_revenue.toFixed(2)]}),t.hasOwnProperty("actual_refunds")&&(0,ut.jsx)("div",{children:"Actual Refunds:"}),t.hasOwnProperty("actual_refunds")&&(0,ut.jsxs)("div",{className:"text-right font-mono text-red-400",children:["-$",t.actual_refunds.toFixed(2)]}),t.hasOwnProperty("estimated_refunds")&&(0,ut.jsx)("div",{children:"Est. Refunds:"}),t.hasOwnProperty("estimated_refunds")&&(0,ut.jsxs)("div",{className:"text-right font-mono text-yellow-400",children:["-$",t.estimated_refunds.toFixed(2)]}),(0,ut.jsx)("div",{className:"border-t border-gray-600 mt-1 pt-1",children:"Net Revenue:"}),(0,ut.jsx)("div",{className:"text-right font-mono border-t border-gray-600 mt-1 pt-1",children:t.hasOwnProperty("net_estimated_revenue")?"$".concat(t.net_estimated_revenue.toFixed(2)):t.hasOwnProperty("net_revenue_after_estimated_refunds")?"$".concat(t.net_revenue_after_estimated_refunds.toFixed(2)):"$".concat((t.actual_revenue-t.actual_refunds).toFixed(2))})]})]}):null};return(0,ut.jsxs)("div",{className:"fixed z-50 bg-gray-800 border border-gray-600 text-white rounded-lg shadow-lg p-4 w-96 pointer-events-auto",style:{left:d.x,top:d.y},onMouseEnter:()=>{p(!0),clearTimeout(m.current)},onMouseLeave:()=>{p(!1),m.current=setTimeout(u,300)},children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,ut.jsxs)("h4",{className:"font-semibold",children:["Est. Net Revenue: $",g.toFixed(2)]}),(0,ut.jsx)("button",{onClick:u,className:"text-gray-400 hover:text-gray-200",children:"\xd7"})]}),(()=>{const e=f.trial_converted||{},t=f.initial_purchase||{},r=e.actual_revenue>0,n=t.actual_revenue>0;return r||n?(0,ut.jsxs)("div",{className:"bg-blue-900 p-3 rounded-lg border border-blue-600 mb-3",children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-blue-200 mb-2",children:"\ud83c\udfaf Refund Rate Analysis"}),r&&(0,ut.jsxs)("div",{className:"mb-2",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-300",children:"Trial Conversion Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-100",children:(()=>{const t=e.actual_revenue||0,r=e.estimated_refunds||0,n=t>0?r/t*100:0;return"".concat(r.toFixed(2)," / ").concat(t.toFixed(2)," = ").concat(n.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-400",children:["$",(e.estimated_refunds||0).toFixed(2)," estimated refunds on $",(e.actual_revenue||0).toFixed(2)," revenue"]})]}),n&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-300",children:"Initial Purchase Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-100",children:(()=>{const e=t.actual_revenue||0,r=t.estimated_refunds||0,n=e>0?r/e*100:0;return"".concat(r.toFixed(2)," / ").concat(e.toFixed(2)," = ").concat(n.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-400",children:["$",(t.estimated_refunds||0).toFixed(2)," estimated refunds on $",(t.actual_revenue||0).toFixed(2)," revenue"]})]})]}):null})(),x("-- Pending Trial --",f.pending_trial),x("-- Trial Converted --",f.trial_converted),x("-- Initial Purchase --",f.initial_purchase),(0,ut.jsxs)("div",{className:"pt-2",children:[(0,ut.jsx)("h5",{className:"font-bold text-green-300 mb-2",children:"-- Total --"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 text-xs",children:[(0,ut.jsx)("div",{children:"Total Actual Revenue:"}),(0,ut.jsxs)("div",{className:"text-right font-mono",children:["$",((null===(r=f.total)||void 0===r?void 0:r.total_actual_revenue)||0).toFixed(2)]}),(0,ut.jsx)("div",{children:"Total Actual Refunds:"}),(0,ut.jsxs)("div",{className:"text-right font-mono text-red-400",children:["-$",((null===(n=f.total)||void 0===n?void 0:n.total_actual_refunds)||0).toFixed(2)]}),(0,ut.jsx)("div",{children:"Total Net Revenue:"}),(0,ut.jsxs)("div",{className:"text-right font-mono",children:["$",((null===(a=f.total)||void 0===a?void 0:a.total_net_revenue)||0).toFixed(2)]}),(0,ut.jsx)("div",{children:"Est. Revenue (from trials):"}),(0,ut.jsxs)("div",{className:"text-right font-mono",children:["$",((null===(i=f.total)||void 0===i?void 0:i.est_revenue_from_trials)||0).toFixed(2)]}),(0,ut.jsx)("div",{children:"Est. Refunds (from pending trials, trial converted, and initial purchase):"}),(0,ut.jsxs)("div",{className:"text-right font-mono text-yellow-400",children:["-$",((null===(o=f.total)||void 0===o?void 0:o.est_refunds_from_all_sources)||0).toFixed(2)]}),(0,ut.jsx)("div",{className:"font-bold border-t border-gray-600 mt-1 pt-1",children:"Final Net Revenue:"}),(0,ut.jsxs)("div",{className:"font-bold text-right font-mono border-t border-gray-600 mt-1 pt-1",children:["$",((null===(l=f.total)||void 0===l?void 0:l.final_net_revenue)||0).toFixed(2)]})]})]})]})},NL=e=>{let{data:t,position:r,onClose:n}=e;const[a,i]=s.useState(!1),o=s.useRef(null);if(!t)return null;const{value:l=0,sources:c={},buckets:d={}}=t;return(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md pointer-events-auto",style:{left:r.x,top:r.y,pointerEvents:"auto"},onMouseEnter:()=>{i(!0),o.current&&(clearTimeout(o.current),o.current=null)},onMouseLeave:()=>{i(!1),o.current=setTimeout(()=>{n()},300)},children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,ut.jsxs)("h4",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:["Actual Revenue: $",l.toFixed(2)]}),(0,ut.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 ml-2",children:"\xd7"})]}),(0,ut.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h5",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 mb-1",children:"By Source"}),Object.keys(c).length>0?Object.entries(c).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[r.count," txn, $",r.total.toFixed(2)]})]},t)}):(0,ut.jsx)("p",{className:"text-gray-500 italic",children:"No source data."})]}),(0,ut.jsxs)("div",{className:"border-t dark:border-gray-600 pt-2",children:[(0,ut.jsx)("h5",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 mb-1",children:"By Amount ($5 Buckets)"}),Object.keys(d).length>0?Object.entries(d).sort().map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[r," transactions"]})]},t)}):(0,ut.jsx)("p",{className:"text-gray-500 italic",children:"No bucket data."})]})]})]})},SL=e=>{let{data:t,position:r,onClose:n}=e;const[a,i]=s.useState(!1),o=s.useRef(null);if(!t)return null;const{value:l=0,sources:c={},buckets:d={}}=t;return(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md pointer-events-auto",style:{left:r.x,top:r.y,pointerEvents:"auto"},onMouseEnter:()=>{i(!0),o.current&&(clearTimeout(o.current),o.current=null)},onMouseLeave:()=>{i(!1),o.current=setTimeout(()=>{n()},300)},children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,ut.jsxs)("h4",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:["Actual Refunds: $",l.toFixed(2)]}),(0,ut.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 ml-2",children:"\xd7"})]}),(0,ut.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h5",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 mb-1",children:"By Source"}),Object.keys(c).length>0?Object.entries(c).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[r.count," txn, $",r.total.toFixed(2)]})]},t)}):(0,ut.jsx)("p",{className:"text-gray-500 italic",children:"No source data."})]}),(0,ut.jsxs)("div",{className:"border-t dark:border-gray-600 pt-2",children:[(0,ut.jsx)("h5",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 mb-1",children:"By Amount ($5 Buckets)"}),Object.keys(d).length>0?Object.entries(d).sort().map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[r," transactions"]})]},t)}):(0,ut.jsx)("p",{className:"text-gray-500 italic",children:"No bucket data."})]})]})]})},OL=e=>{var t;let{data:r,selectedUserId:n="",selectedProductId:a=""}=e;const[i,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),d=s.useRef(null);let u=[],h={},p={},m={},f={};if(null!==r&&void 0!==r&&r.data){if(u=r.data.dates||[],h=r.data.daily_metrics||{},p=r.data.cumulative_metrics||{},m=r.data.user_timelines||{},f=r.data.user_daily_metrics||{},console.log("\ud83d\udd0d [EventTimelineTableV3] Received data structure:"),console.log("\ud83d\udd0d   - dates count:",u.length),console.log("\ud83d\udd0d   - dailyMetrics dates:",Object.keys(h).length),console.log("\ud83d\udd0d   - userDailyMetrics users:",Object.keys(f).length),console.log("\ud83d\udd0d   - selectedUserId:",n),Object.keys(f).length>0){console.log("\ud83d\udd0d   - userDailyMetrics keys:",Object.keys(f));const e=Object.keys(f)[0],t=f[e];if(console.log("\ud83d\udd0d   - First user ID:",e),console.log("\ud83d\udd0d   - First user dates:",Object.keys(t||{})),t&&Object.keys(t).length>0){const e=Object.keys(t)[0],r=t[e];console.log("\ud83d\udd0d   - First date data sample:",e,r),console.log("\ud83d\udd0d   - Has tooltip_data:",!(null===r||void 0===r||!r.tooltip_data)),null!==r&&void 0!==r&&r.tooltip_data&&console.log("\ud83d\udd0d   - tooltip_data structure:",Object.keys(r.tooltip_data))}if(n&&n in f){console.log("\ud83d\udd0d   - selectedUserId found in userDailyMetrics!");const e=f[n];if(console.log("\ud83d\udd0d   - selectedUser dates:",Object.keys(e||{})),e&&Object.keys(e).length>0){const t=Object.keys(e)[0],r=e[t];console.log("\ud83d\udd0d   - selectedUser sample date data:",t,r),console.log("\ud83d\udd0d   - selectedUser has tooltip_data:",!(null===r||void 0===r||!r.tooltip_data))}}else n&&(console.log("\ud83d\udd0d   - selectedUserId NOT found in userDailyMetrics:",n),console.log("\ud83d\udd0d   - Available user IDs:",Object.keys(f)))}const e="2025-05-14";if(n&&n.includes("056F1F33-A295-47F1-9284"))if(console.log("\ud83d\udd25 STAGE3 SUCCESS: V3 Data Correctly Fixed"),console.log("\ud83d\udd25   - Selected User ID:",n),console.log("\ud83d\udd25   - Target Date:",e),f[n]&&f[n][e]){const t=f[n][e];console.log("\ud83d\udd25   - trial_converted:",t.trial_converted),console.log("\ud83d\udd25   - initial_purchase:",t.initial_purchase),1===t.trial_converted&&0===t.initial_purchase?console.log("\ud83d\udd25   \u2705 BUSINESS RULE COMPLIANCE: trial_converted=1, initial_purchase=0 (FIXED!)"):console.log("\ud83d\udd25   \u274c BUSINESS RULE VIOLATION: Both values still showing as 1")}else console.log("\ud83d\udd25   \u274c TARGET USER DATA NOT FOUND in userDailyMetrics")}s.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),console.log("[DEBUG V3] EventTimelineTable received data:",r),console.log("[DEBUG V3] Data structure check:",{hasData:!!r,hasDataData:!(null===r||void 0===r||!r.data),dataKeys:r?Object.keys(r):[],dataDataKeys:null!==r&&void 0!==r&&r.data?Object.keys(r.data):[]}),console.log("[DEBUG V3] Raw data.data structure:",null===r||void 0===r?void 0:r.data),console.log("[DEBUG V3] Available keys in data.data:",null!==r&&void 0!==r&&r.data?Object.keys(r.data):[]),null!==r&&void 0!==r&&null!==(t=r.data)&&void 0!==t&&t.daily_metrics&&(console.log("[DEBUG V3] daily_metrics type:",typeof r.data.daily_metrics),console.log("[DEBUG V3] daily_metrics sample keys:",Object.keys(r.data.daily_metrics).slice(0,3)));const{availableUsers:g,availableProducts:x}=(0,s.useMemo)(()=>{const e=new Set,t=new Set;return Object.keys(f).forEach(t=>{e.add(t)}),Object.keys(m).forEach(r=>{var n;e.add(r);const a=m[r];a.events&&a.events.forEach(e=>{e.product_id&&t.add(e.product_id)}),null!==(n=a.summary)&&void 0!==n&&n.product_summaries&&Object.keys(a.summary.product_summaries).forEach(e=>{t.add(e)})}),Object.values(h).forEach(r=>{var n;null!==(n=r.estimated_revenue_breakdown)&&void 0!==n&&n.user_breakdowns&&Object.keys(r.estimated_revenue_breakdown.user_breakdowns).forEach(n=>{e.add(n);const a=r.estimated_revenue_breakdown.user_breakdowns[n];a.product_breakdowns&&Object.keys(a.product_breakdowns).forEach(e=>{t.add(e)})})}),{availableUsers:Array.from(e).sort(),availableProducts:Array.from(t).sort()}},[f,m,h]),b=(0,s.useMemo)(()=>{if(!n&&!a)return{dailyMetrics:h,cumulativeMetrics:p};const e={},t={};if(n&&!a){const r="2025-05-14",a=n.includes("056F1F33-A295-47F1-9284");a&&(console.log("\ud83d\udd25 STAGE3 FILTERED DATA DEBUG - Processing Target User:"),console.log("\ud83d\udd25   - Selected User ID:",n),console.log("\ud83d\udd25   - Raw User Metrics:",f[n]));const s=f[n];if(s){let n={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0};u.forEach(i=>{const o=s[i];o?(e[i]=Ie(Ie({},o),{},{revenue_net:(o.revenue||0)-(o.refund||0)}),a&&i===r&&(console.log("\ud83d\udd25 STAGE3 FILTERED DATA DEBUG - Target Date Processing:"),console.log("\ud83d\udd25   - Date:",i),console.log("\ud83d\udd25   - Raw Backend Data:",o),console.log("\ud83d\udd25   - trial_converted (backend):",o.trial_converted),console.log("\ud83d\udd25   - initial_purchase (backend):",o.initial_purchase),console.log("\ud83d\udd25   - Filtered Daily Result:",e[i])),n.trial_started+=o.trial_started||0,n.trial_ended+=o.trial_ended||0,n.trial_converted+=o.trial_converted||0,n.trial_cancelled+=o.trial_cancelled||0,n.initial_purchase+=o.initial_purchase||0,n.subscription_cancelled+=o.subscription_cancelled||0,n.revenue+=o.revenue||0,n.refund+=o.refund||0,n.refund_count+=o.refund_count||0,t[i]={trial_pending:o.trial_pending||0,subscription_active:o.subscription_active||0,estimated_revenue:o.estimated_revenue||0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund}):(e[i]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[i]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund})})}else u.forEach(r=>{e[r]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[r]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:0,cumulative_trial_ended:0,cumulative_trial_converted:0,cumulative_trial_cancelled:0,cumulative_initial_purchase:0,cumulative_subscription_cancelled:0,cumulative_revenue:0,cumulative_refund:0,cumulative_refund_count:0,cumulative_revenue_net:0}})}else if(a&&!n)u.forEach(r=>{e[r]=Ie({},h[r]),p[r]&&Object.keys(p[r]).length>0?t[r]=Ie({},p[r]):(console.warn("Missing cumulative metrics for date ".concat(r,", this should be handled by Stage3RevenueResultsV3")),t[r]=Ie({},p[r])||{})});else if(n&&a){const r=f[n];if(r){let n={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0};u.forEach(a=>{const s=r[a];s?(e[a]=Ie(Ie({},s),{},{revenue_net:(s.revenue||0)-(s.refund||0)}),n.trial_started+=s.trial_started||0,n.trial_ended+=s.trial_ended||0,n.trial_converted+=s.trial_converted||0,n.trial_cancelled+=s.trial_cancelled||0,n.initial_purchase+=s.initial_purchase||0,n.subscription_cancelled+=s.subscription_cancelled||0,n.revenue+=s.revenue||0,n.refund+=s.refund||0,n.refund_count+=s.refund_count||0,t[a]={trial_pending:s.trial_pending||0,subscription_active:s.subscription_active||0,estimated_revenue:s.estimated_revenue||0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund}):(e[a]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[a]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund})})}else u.forEach(r=>{e[r]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[r]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:0,cumulative_trial_ended:0,cumulative_trial_converted:0,cumulative_trial_cancelled:0,cumulative_initial_purchase:0,cumulative_subscription_cancelled:0,cumulative_revenue:0,cumulative_refund:0,cumulative_refund_count:0,cumulative_revenue_net:0}})}return{dailyMetrics:e,cumulativeMetrics:t}},[n,a,h,p,f,u]);if(!r)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})});const y=e=>{if(null===e||void 0===e)return"$0";const t=Math.round(Number(e));return"$".concat(t.toLocaleString())},v=e=>null===e||void 0===e?"0":Number(e).toLocaleString(),_=[{key:"daily_trial_started",label:"Trial Started",category:"daily_absolute",categoryLabel:"Daily Absolute Values",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_started)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_started)||0},format:v},{key:"daily_trial_pending",label:"Trial Pending",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_pending)||0},getCumulativeValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_pending)||0},format:v},{key:"daily_trial_ended",label:"Trial Ended",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_ended)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_ended)||0},format:v},{key:"daily_trial_cancelled",label:"Trial Cancelled",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_cancelled)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_cancelled)||0},format:v},{key:"daily_trial_converted",label:"Trial Converted",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.trial_converted)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_converted)||0},format:v},{key:"daily_initial_purchase",label:"Initial Purchase",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.initial_purchase)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_initial_purchase)||0},format:v},{key:"daily_subscription_active",label:"Subscription Active",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.subscription_active)||0},getCumulativeValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.subscription_active)||0},format:v},{key:"daily_subscription_cancelled",label:"Subscription Cancelled",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.subscription_cancelled)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_subscription_cancelled)||0},format:v},{key:"daily_users",label:"Daily Users",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.daily_users)||0},getCumulativeValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.cumulative_users)||0},format:v},{key:"daily_refund_count",label:"Refunds",category:"daily_absolute",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.refund_count)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_refund_count)||0},format:v},{key:"daily_revenue",label:"Revenue",category:"revenue",categoryLabel:"Revenue Values",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.revenue)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_revenue)||0},format:y,isRevenue:!0,getTooltipData:e=>{var t,r;return((e,t)=>{var r;const n="number"===typeof t?t:0;if(0===n)return null;const a=null===(r=h[e])||void 0===r?void 0:r.revenue_tooltip_data;return a?Ie({value:n},a):null})(e,i?(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_revenue)||0:(null===(r=b.dailyMetrics[e])||void 0===r?void 0:r.revenue)||0)}},{key:"daily_refund",label:"Refunds",category:"revenue",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.refund)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_refund)||0},format:y,isRefund:!0,getTooltipData:e=>{var t,r;return((e,t)=>{var r;const n="number"===typeof t?t:0;if(0===n)return null;const a=null===(r=h[e])||void 0===r?void 0:r.refund_tooltip_data;return a?Ie({value:n},a):null})(e,i?(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_refund)||0:(null===(r=b.dailyMetrics[e])||void 0===r?void 0:r.refund)||0)}},{key:"daily_revenue_net",label:"Net Revenue",category:"revenue",getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.revenue_net)||0},getCumulativeValue:e=>{var t;return(null===(t=b.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_revenue_net)||0},format:y},{key:"daily_estimated_revenue",label:"Estimated Revenue",category:"revenue",isEstimatedRevenue:!0,getValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0},getCumulativeValue:e=>{var t;return(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0},format:y,getTooltipData:e=>{var t,r;return((e,t)=>{const r="number"===typeof t?t:0;if(0===r&&!n)return null;if(n){const t=f[n];return t&&t[e]&&t[e].tooltip_data?t[e].tooltip_data:(console.warn("[WARN] No individual tooltip data for user ".concat(n," on date ").concat(e)),{value:0,breakdown:{formula:"\u26ab Inactive: Est_Revenue = 0 (No active trial or subscription)",calculation:"No data for this user on this date.",components:{"User ID":n.substring(0,16)+"...",Date:e,"Current State":"Inactive"},components_order:["User ID","Date","Current State"]}})}{const t=h[e];if(!t||!t.estimated_revenue_breakdown)return console.warn("[WARN] No aggregate breakdown data for date ".concat(e)),null;const n=t.estimated_revenue_breakdown;return{value:r,estimated_trial_revenue_component:n.total_trial_revenue,estimated_trial_converted_revenue_component:n.total_trial_converted_revenue,estimated_initial_purchase_revenue_component:n.total_initial_purchase_revenue,estimated_trial_refund_component:n.total_trial_refunds,estimated_trial_converted_refund_component:n.total_trial_converted_refunds,estimated_initial_purchase_refund_component:n.total_initial_purchase_refunds,breakdown:n}}})(e,i?(null===(t=b.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0:(null===(r=b.dailyMetrics[e])||void 0===r?void 0:r.estimated_revenue)||0)}},{key:"daily_estimated_refunds",label:"Estimated Refunds (Potential)",category:"revenue",isEstimatedRefunds:!0,getValue:e=>{const t=b.dailyMetrics[e];return((null===t||void 0===t?void 0:t.estimated_trial_refund_component)||0)+((null===t||void 0===t?void 0:t.estimated_subscription_refund_component)||0)},getCumulativeValue:e=>{const t=b.dailyMetrics[e];return((null===t||void 0===t?void 0:t.estimated_trial_refund_component)||0)+((null===t||void 0===t?void 0:t.estimated_subscription_refund_component)||0)},format:y,getTooltipData:e=>{const t=b.dailyMetrics[e],r=(null===t||void 0===t?void 0:t.estimated_trial_refund_component)||0,s=(null===t||void 0===t?void 0:t.estimated_subscription_refund_component)||0,i=r+s;return 0===i?null:((e,t,r,s)=>{if(0===s)return null;if(console.log("[DEBUG] getEstimatedRefundsTooltipData called with:",{date:e,trialRefunds:t,subscriptionRefunds:r,totalRefunds:s,selectedUserId:n,selectedProductId:a,isAggregateView:!n}),!n){console.log("[DEBUG] Creating aggregate refunds tooltip for date ".concat(e));const n=h[e];if(!n)return console.warn("[WARN] No aggregate data found for date ".concat(e)),null;let a=0,i=0,o=0;return Object.keys(f).forEach(t=>{const r=f[t][e];r&&(o++,(r.estimated_trial_refund_component||0)>0&&a++,(r.estimated_subscription_refund_component||0)>0&&i++)}),{value:s,estimated_trial_refund_component:t,estimated_subscription_refund_component:r,estimated_trial_revenue_component:t,estimated_trial_converted_revenue_component:n.estimated_trial_converted_refund_component||0,estimated_initial_purchase_revenue_component:n.estimated_initial_purchase_refund_component||0,breakdown:{formula:"\ud83d\udd04 Aggregate Estimated Potential Refunds: \u03a3(Trial_Refunds) + \u03a3(Subscription_Refunds) across all users",calculation:"Trial: $".concat(t.toFixed(2)," (").concat(a," users) + Subscription: $").concat(r.toFixed(2)," (").concat(i," users) = $").concat(s.toFixed(2)),components:{"View Type":"Aggregate (All Users)",Date:e,"Total Users":o,"Total Estimated Refunds (Potential)":"$".concat(s.toFixed(2)),"Estimated Refunds from Trials (Potential)":"$".concat(t.toFixed(2)),"Users with Trial Refunds":a,"Estimated Refunds from Subscriptions (Potential)":"$".concat(r.toFixed(2)),"Users with Subscription Refunds":i,"Trial Refunds Explanation":"Refunds expected if pending trials convert then users request refunds","Subscription Refunds Explanation":"Refunds expected from active subscriptions based on age and historical patterns"},components_order:["View Type","Date","Total Users","Total Estimated Refunds (Potential)","Estimated Refunds from Trials (Potential)","Users with Trial Refunds","Estimated Refunds from Subscriptions (Potential)","Users with Subscription Refunds","Trial Refunds Explanation","Subscription Refunds Explanation"]}}}const i=f[n];if(!i||!i[e])return console.warn("[WARN] No user metrics found for user ".concat(n," on date ").concat(e)),null;const o=i[e].tooltip_data;if(!o||!o.breakdown)return console.warn("[WARN] No tooltip breakdown data found for estimated refunds"),null;const l=o.breakdown.components||{};return{value:s,breakdown:{formula:"\ud83d\udd04 Estimated Potential Refunds: Trial_Refunds + Subscription_Refunds",calculation:"Trial: $".concat(t.toFixed(2)," + Subscription: $").concat(r.toFixed(2)," = $").concat(s.toFixed(2)),components:{"View Type":"Individual User","Product ID":l["Product ID"]||"Unknown","Current State":l["Current State"]||"Unknown","Total Estimated Refunds (Potential)":"$".concat(s.toFixed(2)),"Estimated Refunds from Trial (Potential)":"$".concat(t.toFixed(2)),"Estimated Refunds from Subscription (Potential)":"$".concat(r.toFixed(2)),"Segment Base Refund Rate":l["Segment Base Refund Rate"]||"Unknown","Current Refund Probability":l["Current Refund Probability"]||l["Refund Likelihood"]||"Unknown",Notes:t>0?"Refunds expected if trial converts then user requests refund":"Refunds expected based on subscription age and historical patterns"},components_order:["View Type","Product ID","Current State","Total Estimated Refunds (Potential)","Estimated Refunds from Trial (Potential)","Estimated Refunds from Subscription (Potential)","Segment Base Refund Rate","Current Refund Probability","Notes"]}}})(e,r,s,i)}}],k=_.reduce((e,t)=>(e[t.category]||(e[t.category]={label:t.categoryLabel||t.category,metrics:[]}),e[t.category].metrics.push(t),e),{});return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"mb-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Event & Revenue Timeline"}),(0,ut.jsx)("div",{className:"flex gap-2",children:(0,ut.jsx)("button",{onClick:()=>o(!i),className:"px-3 py-1 text-sm rounded-full ".concat(i?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white"),children:i?"Show Daily":"Show Cumulative"})})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10 min-w-[200px]",children:"Metric"}),u.map(e=>(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap min-w-[80px]",children:e},e))]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:Object.entries(k).map(e=>{let[t,r]=e;return(0,ut.jsxs)(s.Fragment,{children:[(0,ut.jsx)("tr",{className:"bg-gray-100 dark:bg-gray-600",children:(0,ut.jsx)("td",{colSpan:u.length+1,className:"p-2 font-semibold text-gray-800 dark:text-white border-b dark:border-gray-600",children:r.label})}),r.metrics.map(e=>(0,ut.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-white sticky left-0 bg-white dark:bg-gray-800 z-10",children:e.label}),u.map(t=>{const r=i?e.getCumulativeValue(t):e.getValue(t);return(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white ".concat(e.isEstimatedRevenue||e.isRevenue||e.isRefund||e.isEstimatedRefunds?"cursor-help hover:bg-yellow-50 dark:hover:bg-yellow-900/20 relative":""),onMouseEnter:e.isRevenue||e.isRefund||e.isEstimatedRevenue||e.isEstimatedRefunds?n=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const a=n.target.getBoundingClientRect(),s=e.getTooltipData(t,r);if(s){const t=400,r=480,n=window.innerWidth-a.right,i=a.left;let o,l;o=n>=t+20?a.right+10:i>=t+20?a.left-t-10:Math.max(10,(window.innerWidth-t)/2);const d=a.top+a.height/2;l=Math.max(10,d-r-200),l=Math.min(l,window.innerHeight-r-10);let u="estimated_revenue";e.isRevenue?u="revenue":e.isRefund?u="refund":e.isEstimatedRefunds&&(u="estimated_refunds"),c({type:u,data:s,position:{x:o,y:l}})}},150)}:void 0,onMouseLeave:e.isEstimatedRevenue||e.isRevenue||e.isRefund||e.isEstimatedRefunds?()=>{d.current&&(clearTimeout(d.current),d.current=null);const e=setTimeout(()=>{c(null)},100);d.current=e}:void 0,children:e.format(r)},t)})]},e.key))]},t)})})]})}),0===u.length&&(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})})]}),"estimated_revenue"===(null===l||void 0===l?void 0:l.type)&&(0,ut.jsx)(wL,{data:l.data,position:l.position,onClose:()=>c(null),selectedUserId:n,selectedProductId:a}),"revenue"===(null===l||void 0===l?void 0:l.type)&&(0,ut.jsx)(NL,{data:l.data,position:l.position,onClose:()=>c(null),selectedUserId:n,selectedProductId:a}),"refund"===(null===l||void 0===l?void 0:l.type)&&(0,ut.jsx)(SL,{data:l.data,position:l.position,onClose:()=>c(null),selectedUserId:n,selectedProductId:a}),"estimated_refunds"===(null===l||void 0===l?void 0:l.type)&&(0,ut.jsx)(wL,{data:l.data,position:l.position,onClose:()=>c(null),selectedUserId:n,selectedProductId:a})]})},CL=e=>{var t,r,n,a,i,o,l,c,d;let{data:u}=e;const[h,p]=(0,s.useState)(""),[m,f]=(0,s.useState)(""),[g,x]=(0,s.useState)("");let b=null;null!==u&&void 0!==u&&null!==(t=u.stage_results)&&void 0!==t&&t.stage3?b=u.stage_results.stage3:null!==u&&void 0!==u&&null!==(r=u.data)&&void 0!==r&&null!==(n=r.stage_results)&&void 0!==n&&n.stage3&&(b=u.data.stage_results.stage3);const y=(null===(a=b)||void 0===a?void 0:a.timeline_results)||{},v=y.aggregate_stats||{},_=y.user_timelines||{},k=y.timeline_data||{},j=y.user_daily_metrics||{},w=y.user_timelines_events||{};if(Object.keys(y).length>0){console.log("\ud83d\udd0d [FRONTEND TIMELINE DEBUG] Data received from backend:"),console.log("\ud83d\udd0d   - timeline_data dates:",k?Object.keys(k).length:0),console.log("\ud83d\udd0d   - user_daily_metrics users:",j?Object.keys(j).length:0),console.log("\ud83d\udd0d   - user_timelines_events users:",w?Object.keys(w).length:0),console.log("***** SEND THIS TO AI - DEBUG LOG #1 *****"),console.log("ISSUE 2 DEBUG - Specific User Daily Metrics Check:");const e="$device:07BDA330-D882-45B2-946E-A2E81B011718";if(console.log("Target User ID:",e),console.log("User found in backendUserDailyMetrics:",e in j),j[e]){const t=j[e];console.log("Available dates for user:",Object.keys(t));const r=t["2025-05-27"];console.log("May 27th data exists:",r?"YES":"NO"),r&&(console.log("May 27th COMPLETE data:",r),console.log("trial_started:",r.trial_started),console.log("trial_ended:",r.trial_ended,"\u2190 Should be 1"),console.log("trial_cancelled:",r.trial_cancelled,"\u2190 Should be 1"),console.log("trial_converted:",r.trial_converted),console.log("trial_pending:",r.trial_pending))}else console.log("User NOT FOUND in backendUserDailyMetrics!"),console.log("Available users (first 5):",Object.keys(j).slice(0,5));if(console.log("***** END DEBUG LOG #1 *****"),console.log("***** SEND THIS TO AI - DEBUG LOG #2 *****"),console.log("ISSUE 1 DEBUG - Product Selector Data Check:"),console.log("User found in backendUserTimelinesEvents:",e in w),w[e]){const t=w[e];console.log("User timeline events structure keys:",Object.keys(t)),console.log("Has summary:","summary"in t),t.summary?(console.log("Summary keys:",Object.keys(t.summary)),console.log("Has product_summaries:","product_summaries"in t.summary),t.summary.product_summaries?(console.log("Product summaries keys:",Object.keys(t.summary.product_summaries)),console.log("Number of products:",Object.keys(t.summary.product_summaries).length),console.log("COMPLETE product_summaries data:",t.summary.product_summaries)):console.log("ERROR: product_summaries is missing from summary!")):console.log("ERROR: summary is missing from user timeline events!")}else console.log("User NOT FOUND in backendUserTimelinesEvents!"),console.log("Available users in backendUserTimelinesEvents (first 5):",Object.keys(w).slice(0,5));if(console.log("***** END DEBUG LOG #2 *****"),console.log("***** SEND THIS TO AI - DEBUG LOG #3 *****"),console.log("GENERAL DATA STRUCTURE CHECK:"),console.log("backendTimelineData exists:",!!k),console.log("backendUserDailyMetrics exists:",!!j),console.log("backendUserTimelinesEvents exists:",!!w),console.log("Number of users in backendUserDailyMetrics:",Object.keys(j).length),console.log("Number of users in backendUserTimelinesEvents:",Object.keys(w).length),Object.keys(j).length>0){const e=Object.keys(j)[0],t=j[e],r=Object.keys(t)[0];console.log("Sample user daily metrics structure:",{userId:e,date:r,metrics:t[r]})}if(console.log("***** END DEBUG LOG #3 *****"),k&&Object.keys(k).length>0){const e=Object.keys(k)[0],t=k[e];console.log("\ud83d\udd0d   - Sample timeline_data[".concat(e,"]:")),console.log("\ud83d\udd0d     - trial_started:",t.trial_started||0),console.log("\ud83d\udd0d     - trial_converted:",t.trial_converted||0),console.log("\ud83d\udd0d     - revenue:",t.revenue||0),console.log("\ud83d\udd0d     - estimated_revenue:",t.estimated_revenue||0)}if(j&&Object.keys(j).length>0){const e=Object.keys(j)[0],t=j[e];if(console.log("\ud83d\udd0d   - Sample user_daily_metrics[".concat(e,"]:")),console.log("\ud83d\udd0d     - Dates available:",Object.keys(t).length),Object.keys(t).length>0){const e=Object.keys(t)[0],r=t[e];console.log("\ud83d\udd0d     - Sample date[".concat(e,"]:")),console.log("\ud83d\udd0d       - trial_started:",r.trial_started||0),console.log("\ud83d\udd0d       - trial_converted:",r.trial_converted||0),console.log("\ud83d\udd0d       - revenue:",r.revenue||0),console.log("\ud83d\udd0d       - estimated_revenue:",r.estimated_revenue||0)}}if(w&&Object.keys(w).length>0){const e=Object.keys(w)[0],t=w[e];console.log("\ud83d\udd0d   - Sample user_timelines_events[".concat(e,"]:")),console.log("\ud83d\udd0d     - Structure keys:",Object.keys(t)),console.log("\ud83d\udd0d     - Events count:",t.events?t.events.length:0),console.log("\ud83d\udd0d     - Products count:",t.products?Object.keys(t.products).length:0),t.summary&&(console.log("\ud83d\udd0d     - Summary total_estimated_revenue:",t.summary.total_estimated_revenue||0),console.log("\ud83d\udd0d     - Summary total_actual_revenue:",t.summary.total_actual_revenue||0))}}const N=(0,s.useMemo)(()=>{const e={};return Object.entries(w).forEach(t=>{let[r,n]=t;if(n.summary&&n.summary.product_summaries){const t=Object.keys(n.summary.product_summaries);t.length>1&&(e[r]=t)}}),e},[w]),S=(0,s.useMemo)(()=>{if(!h||!w[h])return[];const e=w[h];return e.summary&&e.summary.product_summaries?Object.keys(e.summary.product_summaries):[]},[h,w]),O=S.length>1,C=(0,s.useMemo)(()=>{const e=w&&Object.keys(w).length>0?w:_,t=Object.entries(e).map(e=>{let[t,r]=e,n="pending",a=0,s=0;r.summary?(n=r.summary.outcome_type||"pending",a=r.summary.total_estimated_revenue||0,s=r.summary.total_actual_revenue||0):void 0!==r.outcome_type&&(n=r.outcome_type||"pending",a=r.total_estimated_revenue||0,s=r.total_actual_revenue||0);const i=!!N[t],o=i?" \ud83d\udce6":"";return{userId:t,timeline:r,displayName:"".concat(t.substring(0,8),"... (").concat(n,")").concat(o),fullId:t,outcomeType:n,estimatedRevenue:a,actualRevenue:s,hasMultipleProducts:i}});return m?t.filter(e=>e.userId.toLowerCase().includes(m.toLowerCase())||e.outcomeType.toLowerCase().includes(m.toLowerCase())):t},[_,w,m,N]);if(!b)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No Stage 3 data available. Run analysis to see revenue timeline results."})});const E=e=>"number"!==typeof e?"$0":"$"+e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,ut.jsx)(Ge,{size:24,className:"text-purple-600 dark:text-purple-400"}),(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Stage 3: Revenue Timeline Generation Results"}),(0,ut.jsxs)("div",{className:"ml-auto flex items-center gap-1 text-purple-600 dark:text-purple-400 text-sm",children:[(0,ut.jsx)("span",{children:"\u2713"}),(0,ut.jsx)("span",{children:"Revenue Estimation & Timeline Projection"})]})]}),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ut.jsx)(vL,{size:20,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"View Selection"})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select User (or leave empty for aggregate)"}),(0,ut.jsxs)("div",{className:"space-y-2",children:[(0,ut.jsx)("input",{type:"text",placeholder:"Search by User ID or outcome...",value:m,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),(0,ut.jsxs)("select",{value:h,onChange:e=>{p(e.target.value),x("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[(0,ut.jsx)("option",{value:"",children:"\ud83c\udf0d Aggregate View (All Users)"}),C.map(e=>(0,ut.jsxs)("option",{value:e.userId,children:["\ud83d\udc64 ",e.displayName," - Est: ",E(e.estimatedRevenue)]},e.userId))]})]}),h&&O&&(0,ut.jsxs)("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(_L,{size:16,className:"text-yellow-600 dark:text-yellow-400"}),(0,ut.jsx)("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Multiple Products Detected"})]}),(0,ut.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[(0,ut.jsx)("option",{value:"",children:"\ud83d\udcca All Products (Combined)"}),S.map(e=>(0,ut.jsxs)("option",{value:e,children:["\ud83d\udce6 ",e]},e))]}),(0,ut.jsxs)("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:["This user has trials for ",S.length," different products. Select a specific product or view combined data."]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current View"}),(0,ut.jsx)("div",{className:"p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700",children:h?(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,ut.jsx)(vL,{size:16,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:"Individual User"})]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 break-all",children:["ID: ",h]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Status: ",(null===(i=_[h])||void 0===i?void 0:i.outcome_type)||"pending"]}),O&&(0,ut.jsxs)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:["Products: ",S.length," (",g||"All",")"]})]}):(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,ut.jsx)(kL,{size:16,className:"text-green-600 dark:text-green-400"}),(0,ut.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:"Aggregate View"})]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing data for all ",Object.keys(_).length," users"]}),(0,ut.jsxs)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Multi-product users: ",Object.keys(N).length]})]})})]})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(Qe,{size:20,className:"text-purple-600 dark:text-purple-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-purple-900 dark:text-purple-200",children:"Users with Timelines"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-300",children:h?"1":(P=b.users_with_timelines||0,"number"!==typeof P?"0":P.toLocaleString())}),(0,ut.jsx)("p",{className:"text-sm text-purple-700 dark:text-purple-400",children:h?"Individual view":"Revenue projections generated"})]}),(0,ut.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(Xe,{size:20,className:"text-green-600 dark:text-green-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-200",children:"Estimated Revenue"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-300",children:E(h?(null===(o=_[h])||void 0===o?void 0:o.total_estimated_revenue)||0:v.total_estimated_revenue||0)}),(0,ut.jsx)("p",{className:"text-sm text-green-700 dark:text-green-400",children:"Based on conversion probabilities"})]}),(0,ut.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(pL,{size:20,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-200",children:"Actual Revenue"})]}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:E(h?(null===(l=_[h])||void 0===l?void 0:l.total_actual_revenue)||0:v.total_actual_revenue||0)}),(0,ut.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:"From confirmed outcomes"})]}),(0,ut.jsxs)("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)(Ze,{size:20,className:"text-orange-600 dark:text-orange-400"}),(0,ut.jsx)("h3",{className:"font-semibold text-orange-900 dark:text-orange-200",children:"Timeline End"})]}),(0,ut.jsx)("p",{className:"text-lg font-bold text-orange-600 dark:text-orange-300",children:b.timeline_end_date||"N/A"}),(0,ut.jsx)("p",{className:"text-sm text-orange-700 dark:text-orange-400",children:"Projection end date"})]})]}),(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsxs)("div",{className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,ut.jsx)(jL,{size:20,className:"text-green-600 dark:text-green-400"}),"Revenue Calculation Using Event State Tracker"]}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 font-mono text-sm mb-4",children:(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"\ud83d\udd35 Pre-Outcome (Trial Pending)"}),(0,ut.jsx)("div",{className:"text-base text-blue-600 dark:text-blue-400",children:"estimated_revenue = conversion_probability \xd7 (1 - refund_rate) \xd7 price"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"\ud83d\udfe2 Post-Conversion (Subscription Active)"}),(0,ut.jsx)("div",{className:"text-base text-green-600 dark:text-green-400",children:"revenue = price \xd7 (1 - current_refund_rate)"}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"current_refund_rate degrades linearly to 0% over 30 days"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"\ud83d\udd34 Post-Cancellation (Subscription Cancelled)"}),(0,ut.jsx)("div",{className:"text-base text-red-600 dark:text-red-400",children:"revenue = $0.00"})]})]})}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)("strong",{children:"\ud83d\udcc8 State Tracking:"}),"\u2022 Backend uses event_state_tracker.py for proper event state management \u2022 Trial states: started \u2192 pending \u2192 ended (converted/cancelled) \u2022 Subscription states: active \u2192 cancelled \u2022 Revenue tracking includes actual event revenue and refunds"]})]})}),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,ut.jsx)(It,{size:20,className:"text-purple-600 dark:text-purple-400"}),"User & Segment Details"]}),h?(()=>{const e=w[h];if(!e)return(0,ut.jsxs)("div",{className:"text-red-500 text-center",children:["Error: No timeline event data found for user ",h,"."]});const t=e.segment_info||{},r=t.user_properties||{},n=t.conversion_metrics||{},a=t.matched_segment_id||t.segment_id,s=t.final_viable_segment_id||t.segment_id,i=a&&s&&a!==s;let o=r,l=r,c=n.sample_size||n.cohort_size||"Unknown",d=c;return(0,ut.jsx)("div",{className:"space-y-4",children:(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[(0,ut.jsxs)("div",{className:"bg-gray-800 text-white p-4 rounded-lg text-sm",children:[(0,ut.jsx)("div",{className:"font-mono text-xs mb-3 text-blue-300 break-all",children:h}),(0,ut.jsxs)("div",{className:"text-xs text-gray-400 mb-3",children:["Short: ",h.substring(0,8),"..."]}),(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Product:"})," ",r.product_id||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Store:"})," ",r.app_store||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Price:"})," ",r.price_bucket||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Country:"})," ",r.country||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Economic Tier:"})," ",r.economic_tier||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Region:"})," ",r.region||"N/A"]})]})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 text-white p-4 rounded-lg text-sm",children:[(0,ut.jsxs)("div",{className:"font-medium text-blue-300 mb-2 text-xs",children:["ID: ",a?a.substring(0,8)+"...":"Unknown"]}),(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Product:"})," ",o.product_id||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Store:"})," ",o.app_store||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Price:"})," ",o.price_bucket||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Country:"})," ",o.country||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Economic Tier:"})," ",o.economic_tier||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Region:"})," ",o.region||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Level:"})," ",0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Users:"})," ",c]})]})]}),(0,ut.jsx)("div",{className:"bg-gray-800 text-white p-4 rounded-lg text-sm",children:i?(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-green-300 mb-2 text-xs",children:["ID: ",s?s.substring(0,8)+"...":"Unknown"]}),(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Product:"})," ",l.product_id||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Store:"})," ",l.app_store||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Price:"})," ",l.price_bucket||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Country:"})," ",l.country||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Economic Tier:"})," ",l.economic_tier||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Region:"})," ",l.region||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Level:"})," ",0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Users:"})," ",d]})]})]}):(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-blue-300 mb-2 text-xs",children:["ID: ",s?s.substring(0,8)+"...":"Same as matched"]}),(0,ut.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Product:"})," ",l.product_id||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Store:"})," ",l.app_store||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Price:"})," ",l.price_bucket||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Country:"})," ",l.country||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Economic Tier:"})," ",l.economic_tier||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Region:"})," ",l.region||"N/A"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Level:"})," ",0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Users:"})," ",d]})]}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 mt-2 italic",children:"Direct match - no rollup applied"})]})}),(0,ut.jsx)("div",{className:"bg-gray-800 text-white p-4 rounded-lg text-sm",children:(0,ut.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Trial Conv.:"}),(0,ut.jsxs)("span",{className:"ml-1 text-green-300",children:[(100*(n.trial_conversion_rate||0)).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Refund:"}),(0,ut.jsxs)("span",{className:"ml-1 text-red-300",children:[(100*(n.trial_converted_to_refund_rate||0)).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Init. Refund:"}),(0,ut.jsxs)("span",{className:"ml-1 text-red-300",children:[(100*(n.initial_purchase_to_refund_rate||0)).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Renewal Refund:"}),(0,ut.jsxs)("span",{className:"ml-1 text-red-300",children:[(100*(n.renewal_to_refund_rate||0)).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Sample size:"}),(0,ut.jsx)("span",{className:"ml-1 text-blue-300",children:d})]})]})}),(0,ut.jsx)("div",{className:"bg-gray-800 text-white p-4 rounded-lg text-sm",children:(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"\n                                                px-3 py-2 rounded-full text-xs font-medium\n                                                ".concat("high"===t.accuracy_score?"bg-green-600 text-white":"medium"===t.accuracy_score?"bg-yellow-600 text-white":"bg-red-600 text-white","\n                                            "),children:(t.accuracy_score||"Unknown").toUpperCase()}),(0,ut.jsx)("div",{className:"text-xs text-gray-400 mt-2",children:"Prediction Accuracy"})]})})]})})})():(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400 italic text-center py-8",children:"Select an individual user to view segment details"})]}),b&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:[h?"Revenue Timeline for User ".concat(h.substring(0,16),"..."):"Aggregate Revenue Timeline",h&&g&&(0,ut.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400 ml-2",children:["(Product: ",g,")"]})]}),(0,ut.jsx)(OL,{data:(()=>{if(h&&j[h]){var e,t;const r=Object.keys(j[h]).sort(),n={},a={};r.forEach(e=>{n[e]=j[h][e]});let s={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0};r.forEach(e=>{const t=n[e];Object.keys(s).forEach(r=>{"trial_pending"===r||"subscription_active"===r?(a[e]=a[e]||{},a[e]["cumulative_".concat(r)]=t[r]||0):(s[r]+=t[r]||0,a[e]=a[e]||{},a[e]["cumulative_".concat(r)]=s[r])}),a[e].cumulative_revenue_net=s.revenue-s.refund});return{data:{dates:r,daily_metrics:n,cumulative_metrics:a,user_timelines:w,user_daily_metrics:{[h]:j[h]},summary_stats:{total_users:1,total_estimated_revenue:(null===(e=_[h])||void 0===e?void 0:e.total_estimated_revenue)||0,total_actual_revenue:(null===(t=_[h])||void 0===t?void 0:t.total_actual_revenue)||0}}}}const r=Object.keys(k).sort(),n={};let a={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0};r.forEach(e=>{const t=k[e]||{};Object.keys(a).forEach(e=>{e in t&&"number"===typeof t[e]&&(a[e]+=t[e])}),n[e]={trial_pending:t.trial_pending||0,subscription_active:t.subscription_active||0,estimated_revenue:t.estimated_revenue||0,cumulative_trial_started:a.trial_started,cumulative_trial_ended:a.trial_ended,cumulative_trial_converted:a.trial_converted,cumulative_trial_cancelled:a.trial_cancelled,cumulative_initial_purchase:a.initial_purchase,cumulative_subscription_cancelled:a.subscription_cancelled,cumulative_revenue:a.revenue,cumulative_refund:a.refund,cumulative_refund_count:a.refund_count,cumulative_revenue_net:a.revenue-a.refund}});return{data:{dates:r,daily_metrics:k,cumulative_metrics:n,user_timelines:w,user_daily_metrics:j,summary_stats:v}}})(),selectedUserId:h,selectedProductId:g||(h?null===(c=_[h])||void 0===c||null===(d=c.user_properties)||void 0===d?void 0:d.product_id:null)})]}),b.error&&(0,ut.jsxs)("div",{className:"text-center py-8 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,ut.jsx)(gL,{size:48,className:"mx-auto text-red-400 mb-4"}),(0,ut.jsxs)("p",{className:"text-red-600 dark:text-red-400 mb-2",children:["Stage 3 Error: ",b.error]})]}),0===Object.keys(_).length&&!b.error&&(0,ut.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsx)(Ge,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"No revenue timeline data available"}),(0,ut.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Run Stage 3 analysis to see revenue timeline projections"})]})]});var P},EL=()=>{const e="cohort_pipeline_v3_debug_mode",t=(()=>{try{const t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load saved debug state:",t)}return{debugMode:!1,debugStage:null,stageHistory:[]}})(),[r,n]=(0,s.useState)(t.debugMode),[a,i]=(0,s.useState)(t.debugStage),[o,l]=(0,s.useState)(t.stageHistory);(0,s.useEffect)(()=>{((t,r,n)=>{try{const a={debugMode:t,debugStage:r,stageHistory:n};localStorage.setItem(e,JSON.stringify(a))}catch(a){console.warn("Failed to save debug state:",a)}})(r,a,o)},[r,a,o]);const c=[{id:"stage1",name:"Cohort Identification",description:"Take ad set/campaign ID and return corresponding user cohort with properties",order:1},{id:"stage2",name:"User-to-Segment Matching",description:"Connect users to conversion probabilities using pre-calculated segment data",order:2},{id:"stage3",name:"Revenue Timeline Generation",description:"Generate revenue timelines using conversion rates and refund rates",order:3}],d=(0,s.useCallback)(()=>{n(e=>{const t=!e;return t||(i(null),l([])),t})},[]),u=(0,s.useCallback)(e=>{n(e),e||(i(null),l([]))},[]),h=(0,s.useCallback)(e=>{i(e),e&&!o.includes(e)&&l(t=>[...t,e])},[o]),p=(0,s.useCallback)(e=>c.find(t=>t.id===e),[]),m=(0,s.useCallback)(e=>{const t=p(e);return t?c.find(e=>e.order===t.order+1):null},[p]),f=(0,s.useCallback)(e=>{const t=p(e);return t?c.find(e=>e.order===t.order-1):null},[p]),g=(0,s.useCallback)(()=>{const e=m(a);e&&h(e.id)},[a,m,h]),x=(0,s.useCallback)(()=>{const e=f(a);e&&h(e.id)},[a,f,h]),b=(0,s.useCallback)(()=>{n(!1),i(null),l([])},[]),y=(0,s.useCallback)(e=>o.includes(e),[o]),v=(0,s.useCallback)(()=>{if(!a)return c;const e=p(a);return e?c.filter(t=>t.order<=e.order):c},[a,p]),_=(0,s.useCallback)(()=>{var e;return{enabled:r,currentStage:a,currentStageInfo:a?p(a):null,stagesExecuted:o.length,totalStages:c.length,canGoNext:!!m(a),canGoPrevious:!!f(a),progress:a?((null===(e=p(a))||void 0===e?void 0:e.order)||0)/c.length*100:0}},[r,a,o,p,m,f]);return{debugMode:r,debugStage:a,stageHistory:o,availableStages:c,setDebugMode:u,setDebugStage:h,toggleDebugMode:d,goToNextStage:g,goToPreviousStage:x,resetDebugState:b,currentStageInfo:a?p(a):null,nextStage:m(a),previousStage:f(a),executableStages:v(),debugStatus:_(),getStageInfo:p,isStageExecuted:y}},PL=()=>{var e,t,r,n,a,i,o,l,c;const d="cohort_v3_refactored_analysis_params",u={date_from:"2025-01-01",date_to:"2025-01-31",optional_filters:[],primary_user_filter:{property_name:"",property_values:[]},secondary_filters:[],config:{product_filter:{include_patterns:["gluten"],exclude_patterns:[],specific_product_ids:["prod_R7oYuL3bSUecnr"]},lifecycle:{trial_window_days:7,cancellation_window_days:30,smoothing_enabled:!0},timeline:{include_estimates:!0,include_confidence_intervals:!1},detailed_events:{user_id:""}}},[h,p]=(0,s.useState)(()=>{try{const a=localStorage.getItem(d);if(a){var e,t,r,n;const s=JSON.parse(a);return Ie(Ie(Ie({},u),s),{},{optional_filters:s.optional_filters||[],secondary_filters:s.secondary_filters||[],config:Ie(Ie(Ie({},u.config),s.config),{},{product_filter:Ie(Ie({},u.config.product_filter),null===(e=s.config)||void 0===e?void 0:e.product_filter),lifecycle:Ie(Ie({},u.config.lifecycle),null===(t=s.config)||void 0===t?void 0:t.lifecycle),timeline:Ie(Ie({},u.config.timeline),null===(r=s.config)||void 0===r?void 0:r.timeline),detailed_events:Ie(Ie({},u.config.detailed_events),null===(n=s.config)||void 0===n?void 0:n.detailed_events)})})}}catch(w){console.warn("Failed to load saved analysis parameters:",w)}return u}),[m,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(e=>{try{localStorage.setItem(d,JSON.stringify(e))}catch(w){console.warn("Failed to save analysis parameters:",w)}})(h),f(!0);const e=setTimeout(()=>f(!1),1e3);return()=>clearTimeout(e)},[h]);const{debugMode:g,debugStage:x,setDebugMode:b,setDebugStage:y}=EL(),[v,_]=(0,s.useState)(null),[k,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null),S=(null===v||void 0===v?void 0:v.stage_results)||(null===v||void 0===v||null===(e=v.data)||void 0===e?void 0:e.stage_results),O={stage1:!(null===S||void 0===S||!S.stage1||S.stage1.error),stage2:!(null===S||void 0===S||!S.stage2||S.stage2.error),stage3:!(null===S||void 0===S||!S.stage3||S.stage3.error)};return(0,s.useEffect)(()=>{var e;v?(console.log("\ud83d\udd0d [DEBUG] pipelineData structure:",v),console.log("\ud83d\udd0d [DEBUG] pipelineData.stage_results (direct):",v.stage_results),console.log("\ud83d\udd0d [DEBUG] pipelineData.data.stage_results (nested):",null===(e=v.data)||void 0===e?void 0:e.stage_results),console.log("\ud83d\udd0d [DEBUG] computed stageResults:",S),console.log("\ud83d\udd0d [DEBUG] stageProgress:",O),console.log("\ud83d\udd0d [DEBUG] Keys in pipelineData:",Object.keys(v)),S&&(console.log("\ud83d\udd0d [DEBUG] Stage results keys:",Object.keys(S)),console.log("\ud83d\udd0d [DEBUG] Stage 1 data:",S.stage1),console.log("\ud83d\udd0d [DEBUG] Stage 2 data:",S.stage2),console.log("\ud83d\udd0d [DEBUG] Stage 3 data:",S.stage3)),v.data&&console.log("\ud83d\udd0d [DEBUG] Data keys:",Object.keys(v.data))):console.log("\ud83d\udd0d [DEBUG] No pipelineData available")},[v,S,O]),(0,ut.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Cohort Pipeline V3 - Refactored Architecture"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"3-stage conversion probability-based cohort analysis with segment matching and revenue timeline generation"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[m&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-green-600 dark:text-green-400 text-sm",children:[(0,ut.jsx)("span",{children:"\ud83d\udcbe"}),(0,ut.jsx)("span",{children:"Saved"})]}),(0,ut.jsx)("button",{onClick:()=>{p(u)},className:"px-3 py-2 text-sm bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",title:"Reset all settings to defaults",children:"Reset to Defaults"}),(0,ut.jsx)("button",{onClick:()=>{localStorage.removeItem(d),p(u)},className:"px-3 py-2 text-sm bg-red-200 hover:bg-red-300 dark:bg-red-700 dark:hover:bg-red-600 text-red-700 dark:text-red-300 rounded-lg transition-colors",title:"Clear all saved data including debug state",children:"Clear All Data"}),(0,ut.jsx)("button",{onClick:()=>{const e=JSON.stringify(h,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),r="cohort-v3-refactored-config-".concat((new Date).toISOString().split("T")[0],".json"),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",r),n.click()},className:"px-3 py-2 text-sm bg-blue-200 hover:bg-blue-300 dark:bg-blue-700 dark:hover:bg-blue-600 text-blue-700 dark:text-blue-300 rounded-lg transition-colors",title:"Export current settings to JSON file",children:"Export Settings"}),(0,ut.jsxs)("label",{className:"px-3 py-2 text-sm bg-green-200 hover:bg-green-300 dark:bg-green-700 dark:hover:bg-green-600 text-green-700 dark:text-green-300 rounded-lg transition-colors cursor-pointer",children:["Import Settings",(0,ut.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{try{const t=JSON.parse(e.target.result),r=Ie(Ie(Ie({},u),t),{},{config:Ie(Ie({},u.config),t.config)});p(r)}catch(w){console.error("Failed to import settings:",w)}},e.readAsText(t)}e.target.value=""},className:"hidden"})]})]})]}),(0,ut.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"\ud83d\udcbe Settings are automatically saved and will persist across page reloads"})]}),(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"V3 Refactored Pipeline Controls"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:g,onChange:e=>b(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,ut.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-300",children:"Debug Mode"})]}),g&&(0,ut.jsxs)("select",{value:x||"",onChange:e=>y(e.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"Select stage..."}),(0,ut.jsx)("option",{value:"stage1",children:"Stage 1: User Properties Input"}),(0,ut.jsx)("option",{value:"stage2",children:"Stage 2: Segment Matching"}),(0,ut.jsx)("option",{value:"stage3",children:"Stage 3: Revenue Timeline"})]}),(0,ut.jsx)("button",{onClick:()=>{g&&x?(console.log("[V3-Refactored DEBUG] Running stage analysis:",x),(async(e,t)=>{j(!0),N(null);try{console.log("[V3-Refactored] ENTERING runV3StageAnalysis for stage: ".concat(t)),console.log("[V3-Refactored] Params being passed:",e),console.log("[V3-Refactored] About to call api.runV3RefactoredStageAnalysis...");const r=await Aa(e,t),n=JSON.stringify(r).length;console.log("[V3-Refactored] Stage ".concat(t," response size: ").concat((n/1048576).toFixed(2)," MB")),console.log("[V3-Refactored] RECEIVED result from api.runV3RefactoredStageAnalysis:",r),_(r)}catch(r){console.error("[V3-Refactored] Stage ".concat(t," analysis failed:"),r),r.message&&(r.message.includes("out of memory")||r.message.includes("Maximum call stack"))?N("Stage ".concat(t," analysis failed due to large dataset size. Please reduce the date range.")):N(r.message||"V3 refactored stage ".concat(t," analysis failed"))}finally{j(!1)}})(h,x)):(console.log("[V3-Refactored DEBUG] Running full analysis"),(async e=>{j(!0),N(null);try{console.log("[V3-Refactored] Running full V3 refactored analysis with params:",e);const t=(new Date(e.date_to)-new Date(e.date_from))/864e5;t>35&&console.warn("[V3-Refactored] Large date range detected (".concat(t," days). Response may be very large."));const r=await Pa(e),n=JSON.stringify(r).length;if(console.log("[V3-Refactored] Response size: ".concat((n/1048576).toFixed(2)," MB")),n>52428800)return console.warn("[V3-Refactored] Large response detected. Consider using debug mode to analyze stages individually."),void N("Response is very large (>50MB). Consider using debug mode to analyze stages individually, or reduce the date range.");console.log("[V3-Refactored] Full analysis result:",r),_(r)}catch(t){console.error("[V3-Refactored] Full analysis failed:",t),t.message&&(t.message.includes("out of memory")||t.message.includes("Maximum call stack"))?N("Analysis failed due to large dataset size. Please use debug mode to analyze stages individually or reduce the date range."):"ERR_INSUFFICIENT_RESOURCES"===t.code?N("Browser ran out of memory processing the large response. Please use debug mode or reduce the date range."):N(t.message||"V3 refactored analysis failed")}finally{j(!1)}})(h))},disabled:k,className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(k?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:k?"Running...":"Run Analysis"})]})]})})}),(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsx)(dL,{config:h.config,analysisParams:h,onConfigChange:e=>{p(e)}}),(()=>{const e=(new Date(h.date_to)-new Date(h.date_from))/864e5;return e>35?(0,ut.jsx)("div",{className:"mt-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ut.jsx)("div",{className:"text-yellow-600 dark:text-yellow-400",children:"\u26a0\ufe0f"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-yellow-800 dark:text-yellow-200 font-semibold mb-2",children:"Large Date Range Detected"}),(0,ut.jsxs)("p",{className:"text-yellow-700 dark:text-yellow-300 text-sm mb-2",children:["You've selected a ",Math.round(e)," day range. This may result in a very large response (",">","500MB) that could crash your browser."]}),(0,ut.jsxs)("div",{className:"text-yellow-700 dark:text-yellow-300 text-sm",children:[(0,ut.jsx)("strong",{children:"Recommendations:"}),(0,ut.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,ut.jsxs)("li",{children:["Use ",(0,ut.jsx)("strong",{children:"Debug Mode"})," to analyze stages individually"]}),(0,ut.jsx)("li",{children:"Reduce your date range to 30 days or less"}),(0,ut.jsx)("li",{children:"Consider analyzing individual months separately"})]})]})]})]})}):null})()]}),k&&(0,ut.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,ut.jsxs)("div",{className:"ml-3",children:[(0,ut.jsx)("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Running V3 refactored analysis..."}),(new Date(h.date_to)-new Date(h.date_from))/864e5>35?(0,ut.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-1",children:"\u26a0\ufe0f Large date range detected - this may take several minutes and could fail due to browser memory limits"}):null]})]}),(0,ut.jsxs)("div",{className:"space-y-6",children:[w&&(0,ut.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-red-800 dark:text-red-200 font-semibold mb-2",children:"Analysis Error"}),(0,ut.jsx)("p",{className:"text-red-700 dark:text-red-300",children:w})]}),v&&(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-blue-800 dark:text-blue-200 font-semibold mb-2",children:"Debug: V3 Refactored API Data Structure"}),(0,ut.jsxs)("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[(0,ut.jsxs)("div",{children:["Has pipelineData: ",v?"\u2705":"\u274c"]}),(0,ut.jsxs)("div",{children:["Has stage_results (direct): ",null!==v&&void 0!==v&&v.stage_results?"\u2705":"\u274c"]}),(0,ut.jsxs)("div",{children:["Has stage_results (nested): ",null!==v&&void 0!==v&&null!==(t=v.data)&&void 0!==t&&t.stage_results?"\u2705":"\u274c"]}),(0,ut.jsxs)("div",{children:["Stage 1 Complete: ",O.stage1?"\u2705":"\u274c"]}),(0,ut.jsxs)("div",{children:["Stage 2 Complete: ",O.stage2?"\u2705":"\u274c"]}),(0,ut.jsxs)("div",{children:["Stage 3 Complete: ",O.stage3?"\u2705":"\u274c"]}),(null===S||void 0===S||null===(r=S.stage1)||void 0===r?void 0:r.error)&&(0,ut.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Stage 1 Error: ",S.stage1.error]}),(null===S||void 0===S||null===(n=S.stage2)||void 0===n?void 0:n.error)&&(0,ut.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Stage 2 Error: ",S.stage2.error]}),(null===S||void 0===S||null===(a=S.stage3)||void 0===a?void 0:a.error)&&(0,ut.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Stage 3 Error: ",S.stage3.error]}),(0,ut.jsxs)("div",{children:["Main data keys: ",v?Object.keys(v).join(", "):"None"]}),S&&(0,ut.jsxs)("div",{children:["Stage results keys: ",Object.keys(S).join(", ")]}),(null===S||void 0===S?void 0:S.stage1)&&(0,ut.jsxs)("div",{children:["Stage 1 users: ",S.stage1.total_users||S.stage1.cohort_size||"N/A"]}),(null===S||void 0===S?void 0:S.stage2)&&(0,ut.jsxs)("div",{children:["Stage 2 matches: ",(null===(i=S.stage2.matching_stats)||void 0===i?void 0:i.successful_matches)||0,"/",(null===(o=S.stage2.matching_stats)||void 0===o?void 0:o.total_users)||0]})]})]}),v&&(0,ut.jsxs)(ut.Fragment,{children:[O.stage1&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,ut.jsx)(Lt,{size:24,className:"text-blue-600 dark:text-blue-400"}),(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Stage 1: User Properties Input - Complete"})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ut.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-200",children:"Total Users Found"}),(0,ut.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:(null===(l=v.stage_results)||void 0===l||null===(c=l.stage1)||void 0===c?void 0:c.total_users)||0})]}),(0,ut.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-200",children:"Date Range"}),(0,ut.jsxs)("p",{className:"text-sm font-medium text-green-600 dark:text-green-300",children:[h.date_from," to ",h.date_to]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsx)("h3",{className:"font-semibold text-purple-900 dark:text-purple-200",children:"Stage Status"}),(0,ut.jsx)("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-300",children:"\u2705 User Cohort Extracted"})]})]})]}),O.stage2&&(0,ut.jsx)(yL,{data:v}),O.stage3&&(0,ut.jsx)(CL,{data:v})]}),g&&v&&(0,ut.jsx)(uL,{data:v,stage:x,title:"V3 Refactored Pipeline Debug Data"})]})]})})},AL=e=>{let{debugMode:t,debugStage:r,onDebugModeChange:n,onDebugStageChange:a,onRunAnalysis:s,loading:i,error:o}=e;const l=[{id:"stage1",name:"Cohort Identification",description:"Take ad set/campaign ID and return corresponding user cohort with properties",order:1},{id:"stage2",name:"User-to-Segment Matching",description:"Connect users to conversion probabilities using pre-calculated segment data",order:2},{id:"stage3",name:"Revenue Timeline Generation",description:"Generate revenue timelines using conversion rates and refund rates",order:3}],c=r?l.find(e=>e.id===r):null;return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"V3 Refactored Pipeline Controls"}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"3-stage conversion probability-based cohort analysis"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:t,onChange:e=>n(e.target.checked),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 dark:focus:ring-purple-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,ut.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-300",children:"Debug Mode"})]}),(0,ut.jsx)("button",{onClick:s,disabled:i,className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),children:i?"Running V3 Analysis...":"Run V3 Analysis"})]})]}),t&&(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select V3 Pipeline Stage"}),(0,ut.jsxs)("select",{value:r||"",onChange:e=>a(e.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"Run complete V3 pipeline..."}),l.map(e=>(0,ut.jsxs)("option",{value:e.id,children:[e.order,". ",e.name]},e.id))]})]}),c&&(0,ut.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[(0,ut.jsxs)("h3",{className:"font-semibold text-purple-900 dark:text-purple-200 mb-2",children:["Stage ",c.order,": ",c.name]}),(0,ut.jsx)("p",{className:"text-purple-700 dark:text-purple-300 text-sm",children:c.description})]}),(0,ut.jsxs)("div",{className:"mt-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"V3 Refactored Pipeline Progress"}),(0,ut.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>{var n;const a=r===e.id,s=r&&(null===(n=l.find(e=>e.id===r))||void 0===n?void 0:n.order)>e.order;return(0,ut.jsxs)("div",{className:"flex items-center p-3 rounded-lg border transition-colors ".concat(a?"bg-purple-100 border-purple-300 dark:bg-purple-900/30 dark:border-purple-600":s?"bg-green-100 border-green-300 dark:bg-green-900/30 dark:border-green-600":"bg-gray-50 border-gray-200 dark:bg-gray-700 dark:border-gray-600"),children:[(0,ut.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-3 ".concat(a?"bg-purple-600 text-white":s?"bg-green-600 text-white":"bg-gray-300 text-gray-600 dark:bg-gray-600 dark:text-gray-300"),children:s?"\u2713":e.order}),(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsx)("h4",{className:"font-medium ".concat(a?"text-purple-900 dark:text-purple-200":s?"text-green-900 dark:text-green-200":"text-gray-700 dark:text-gray-300"),children:e.name}),(0,ut.jsx)("p",{className:"text-sm ".concat(a?"text-purple-700 dark:text-purple-300":s?"text-green-700 dark:text-green-300":"text-gray-500 dark:text-gray-400"),children:e.description})]}),(0,ut.jsxs)("div",{className:"ml-3",children:[a&&(0,ut.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-purple-600 text-white rounded-full",children:"Current"}),s&&(0,ut.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-green-600 text-white rounded-full",children:"Complete"})]})]},e.id)})})]})]}),!t&&(0,ut.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-700",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ut.jsx)("span",{className:"text-purple-600 dark:text-purple-400",children:"\ud83d\ude80"}),(0,ut.jsx)("h4",{className:"font-medium text-purple-900 dark:text-purple-200",children:"V3 Refactored Pipeline"})]}),(0,ut.jsx)("p",{className:"text-purple-700 dark:text-purple-300 text-sm",children:"Enable debug mode to run individual pipeline stages and view intermediate results. In normal mode, the complete V3 refactored analysis pipeline will be executed using conversion probability-based revenue estimation."})]}),o&&(0,ut.jsxs)("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsx)("h4",{className:"font-medium text-red-900 dark:text-red-200 mb-2",children:"Pipeline Error"}),(0,ut.jsx)("p",{className:"text-red-700 dark:text-red-300 text-sm",children:o})]})]})},TL=ze("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ML=ze("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),RL=e=>{var t,r,n,a,i;let{data:o}=e;const[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),[m,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null);let b=null;if(console.log("LifecycleRatesTable received data:",o),null!==o&&void 0!==o&&null!==(t=o.data)&&void 0!==t&&t.lifecycle_rates)b=o.data.lifecycle_rates,console.log("Using regular mode lifecycle_rates:",b);else if(null!==o&&void 0!==o&&null!==(r=o.data)&&void 0!==r&&null!==(n=r.structured_format)&&void 0!==n&&n.lifecycle_analysis)b=o.data.structured_format.lifecycle_analysis,console.log("Using debug mode structured_format.lifecycle_analysis:",b);else if(null!==o&&void 0!==o&&null!==(a=o.data)&&void 0!==a&&a.legacy_format){const e=o.data.legacy_format;console.log("Using debug mode legacy_format:",e),b={aggregate:{trial_to_outcome:{rates_by_day:e.lifecycle_rates||{},smoothing_method:e.smoothing_method||"none",smoothing_quality:e.smoothing_quality||"N/A",total_sample_size:e.total_sample_size||0}},per_product:{},metadata:{calculation_method:"legacy_format",message:"Data from legacy format"}}}else if(null!==o&&void 0!==o&&null!==(i=o.structured_format)&&void 0!==i&&i.lifecycle_analysis)b=o.structured_format.lifecycle_analysis,console.log("Using direct structured_format.lifecycle_analysis:",b);else if(null!==o&&void 0!==o&&o.legacy_format){const e=o.legacy_format;console.log("Using direct legacy_format:",e),b={aggregate:{trial_to_outcome:{rates_by_day:e.lifecycle_rates||{},smoothing_method:e.smoothing_method||"none",smoothing_quality:e.smoothing_quality||"N/A",total_sample_size:e.total_sample_size||0}},per_product:{},metadata:{calculation_method:"legacy_format",message:"Data from legacy format"}}}if(console.log("Final lifecycleData:",b),!b)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No lifecycle data available. Run an analysis to see results."})});const y=b.aggregate||{},v=b.per_product||{};console.log("Aggregate data:",y),console.log("Per product data:",v);const _=(e,t,r,n,a,s)=>{const i=e.total_sample_size||0,o=(e=>{if(!e)return null;const t=e.aggregate_rates,r=e.extension_info;if(t&&r){const e=t.extension_days_used||(null===r||void 0===r?void 0:r.extension_days_used)||0,n=t.total_sample_size||(null===r||void 0===r?void 0:r.total_sample_size)||0,a=t.extension_attempts||(null===r||void 0===r?void 0:r.attempts_made)||1,s=(null===r||void 0===r?void 0:r.per_product_info)||{};if(e>0&&Object.keys(s).length>0){let t={};return Object.values(s).forEach(e=>{const r=e.extension_days_used||0,n=e.final_sample_size||0;0===r?t[0]=(t[0]||0)+n:30===r?t[30]=(t[30]||0)+n:60===r&&(t[60]=(t[60]||0)+n)}),{extensionDays:e,totalSize:n,breakdown:t,attempts:a,perProductInfo:s}}}return null})(n);let l=0,c=!1;t&&n.rates_by_product&&n.rates_by_product[t]&&(l=n.rates_by_product[t].total_sample_size||0,c=l>0&&l<10);let d=0;return a&&t&&n.rates_by_product&&n.rates_by_product[t]?d=n.rates_by_product[t].extension_days_used||0:!a&&n.aggregate_rates&&(d=n.aggregate_rates.extension_days_used||0),(0,ut.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Based on ",(0,ut.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:i})," users",a&&(0,ut.jsxs)("span",{className:"ml-2 text-green-600 dark:text-green-400",children:["(Product: ",t,")"]}),s&&!c&&(0,ut.jsxs)("span",{className:"ml-2 text-orange-600 dark:text-orange-400",children:["(Aggregate data - ",t," has no data for this lifecycle)"]}),s&&c&&(0,ut.jsxs)("span",{className:"ml-2 text-orange-600 dark:text-orange-400",children:["(Aggregate data - ",t," has only ",l," users, minimum 10 required)"]}),!t&&(0,ut.jsx)("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:"(All Products - Aggregate)"})]}),(0,ut.jsx)("button",{onClick:()=>N(r,n),className:"ml-2 p-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"View detailed breakdown by product",children:(0,ut.jsx)(TL,{size:16})})]}),d>0&&(0,ut.jsxs)("div",{className:"mt-2 p-2 bg-yellow-50 dark:bg-yellow-900/30 rounded border border-yellow-200 dark:border-yellow-700",children:[(0,ut.jsxs)("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:[(0,ut.jsx)("strong",{children:"Lookback Applied:"})," Extended ",d," days to capture more starter events"]}),o&&o.breakdown&&(0,ut.jsx)("div",{className:"mt-1 text-xs text-yellow-700 dark:text-yellow-300",children:Object.entries(o.breakdown).map(e=>{let[t,r]=e;return(0,ut.jsxs)("span",{className:"mr-3",children:["0"===t?"Base period":"+".concat(t," days"),": ",r," users"]},t)})})]})]})},k=()=>{const e=new Set;return v&&Object.keys(v).length>0&&Object.keys(v).forEach(t=>{e.add(t)}),y&&"object"===typeof y&&Object.values(y).forEach(t=>{t&&t.rates_by_product&&Object.keys(t.rates_by_product).forEach(t=>{e.add(t)})}),Array.from(e).sort()},j=k(),w=()=>{p(null),u(!1)},N=(e,t)=>{x({title:e,rateCalculationData:t}),f(!0)},S=()=>{x(null),f(!1)},O=function(e,t){if(!t)return(0,ut.jsx)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e}),(0,ut.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No data available"})]})});const r=e.toLowerCase().includes("cancelled"),n=e.toLowerCase().includes("refund"),a=e.toLowerCase().includes("trial started");let s,i,o;console.log("renderLifecycleTable - title:",e,"ratesData:",t),t.aggregate_rates?(s=t.aggregate_rates,i=t.rates_by_product||{},o=t.extension_info||{}):(s=t,i={},o={});const c=e.toLowerCase().includes("trial started")?"trial_to_outcome":e.toLowerCase().includes("trial converted")&&e.toLowerCase().includes("cancelled")?"trial_converted_to_cancellation":e.toLowerCase().includes("trial converted")&&e.toLowerCase().includes("refund")?"trial_converted_to_refund":e.toLowerCase().includes("initial purchase")&&e.toLowerCase().includes("cancelled")?"initial_purchase_to_cancellation":e.toLowerCase().includes("initial purchase")&&e.toLowerCase().includes("refund")?"initial_purchase_to_refund":e.toLowerCase().includes("renewal")&&e.toLowerCase().includes("cancelled")?"renewal_to_cancellation":e.toLowerCase().includes("renewal")&&e.toLowerCase().includes("refund")?"renewal_to_refund":null;if(!t.aggregate_rates&&c&&Object.keys(v).forEach(e=>{v[e][c]&&(i[e]=v[e][c])}),!s||!s.rates_by_day||0===Object.keys(s.rates_by_day).length)return(0,ut.jsx)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e}),(0,ut.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No data available"})]})});let d=s,h=!1,m=!1;if(l)if(i&&i[l]){(i[l].total_sample_size||0)>=10?(d=i[l],h=!0):(d=s,m=!0)}else d=s,m=!0;const f=d.rates_by_day,g=Object.keys(f).map(Number).sort((e,t)=>e-t),x=d.total_sample_size||0;let b={extension_days_used:d.extension_days_used||0,total_sample_size:x,attempts_made:d.extension_attempts||1,per_product_info:{}};if(o&&Object.keys(o).length>0&&(b=o),l&&i[l]){const e=i[l];b.per_product_info[l]||(b.per_product_info[l]={extension_days_used:e.extension_days_used||0,final_sample_size:e.total_sample_size||0,attempts_made:e.extension_attempts||1,user_counts_by_step:e.user_counts_by_step||{}})}const y={aggregate_rates:d,rates_by_product:i,extension_info:b};let k=[];return a||r?k=[{metric:"Raw Daily Cancellation %",dataKey:"raw_daily_cancellation_rate",bgClass:"bg-red-50 dark:bg-red-900/20",textClass:"text-red-700 dark:text-red-300"},{metric:"Smoothed Daily Cancellation %",dataKey:"smoothed_daily_cancellation_rate",bgClass:"bg-red-100 dark:bg-red-900/30",textClass:"text-red-800 dark:text-red-200"},{metric:"Raw Cumulative Cancellation %",dataKey:"raw_cumulative_cancellation_rate",bgClass:"bg-red-150 dark:bg-red-900/40",textClass:"text-red-800 dark:text-red-200"},{metric:"Smoothed Cumulative Cancellation %",dataKey:"smoothed_cumulative_cancellation_rate",bgClass:"bg-red-200 dark:bg-red-900/50",textClass:"text-red-900 dark:text-red-100"}]:n&&(k=[{metric:"Raw Daily Refund %",dataKey:"raw_daily_refund_rate",bgClass:"bg-blue-50 dark:bg-blue-900/20",textClass:"text-blue-700 dark:text-blue-300"},{metric:"Smoothed Daily Refund %",dataKey:"smoothed_daily_refund_rate",bgClass:"bg-blue-100 dark:bg-blue-900/30",textClass:"text-blue-800 dark:text-blue-200"},{metric:"Raw Cumulative Refund %",dataKey:"raw_cumulative_refund_rate",bgClass:"bg-blue-150 dark:bg-blue-900/40",textClass:"text-blue-800 dark:text-blue-200"},{metric:"Smoothed Cumulative Refund %",dataKey:"smoothed_cumulative_refund_rate",bgClass:"bg-blue-200 dark:bg-blue-900/50",textClass:"text-blue-900 dark:text-blue-100"}]),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e}),(0,ut.jsxs)("button",{onClick:()=>((e,t)=>{p({title:e,ratesData:t}),u(!0)})(e,t),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors duration-200 flex items-center space-x-1",children:[(0,ut.jsx)(ML,{size:16}),(0,ut.jsx)("span",{children:"Chart"})]})]}),_(d,l,e,y,h,m),(0,ut.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[(0,ut.jsx)("h5",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Smoothing Method Information"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Method:"})," ",d.smoothing_method||"none"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Quality:"})," ",d.smoothing_quality||"N/A"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Sample Size:"})," ",x]})]}),d.smoothing_details&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{children:(0,ut.jsx)("strong",{children:"Data Characteristics:"})}),(0,ut.jsx)("ul",{className:"ml-4 mt-1",children:d.smoothing_details.cancellation&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("li",{children:["Early Concentration: ",d.smoothing_details.cancellation.early_concentration]}),(0,ut.jsxs)("li",{children:["Sparsity: ",d.smoothing_details.cancellation.sparsity]}),(0,ut.jsxs)("li",{children:["Max Rate: ",d.smoothing_details.cancellation.max_rate]})]})})]})]})]}),(0,ut.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:(0,ut.jsxs)("div",{className:"flex",children:[(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700",children:"Metric"}),k.map((e,t)=>(0,ut.jsx)("div",{className:"px-4 py-3 text-sm border-b border-gray-200 dark:border-gray-700 ".concat(e.bgClass," ").concat(e.textClass," font-medium"),children:e.metric},t))]}),(0,ut.jsx)("div",{className:"flex-1 overflow-x-auto",children:(0,ut.jsx)("div",{className:"flex",children:g.map(e=>{const t=e.toString(),r=f[t];return(0,ut.jsxs)("div",{className:"min-w-[100px] border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:[(0,ut.jsxs)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 font-medium text-gray-900 dark:text-white text-center border-b border-gray-200 dark:border-gray-700",children:["Day ",e]}),k.map((e,t)=>(0,ut.jsxs)("div",{className:"px-4 py-3 text-sm text-center border-b border-gray-200 dark:border-gray-700 ".concat(e.bgClass," ").concat(e.textClass),children:[r?(r[e.dataKey]||0).toFixed(2):"0.00","%"]},t))]},t)})})})]})})]})},C=()=>{if(!h)return null;const{title:e,ratesData:t}=h,r=e.toLowerCase().includes("cancelled"),n=e.toLowerCase().includes("refund"),a=e.toLowerCase().includes("trial started"),s=e=>{let{active:t,payload:r,label:n}=e;return t&&r&&r.length?(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg",children:[(0,ut.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Day ".concat(n)}),r.map((e,t)=>(0,ut.jsx)("p",{style:{color:e.color},className:"text-sm",children:"".concat(e.name,": ").concat(e.value.toFixed(2),"%")},t))]}):null},i=(()=>{console.log("Chart ratesData:",t);let e=null;if(t.aggregate_rates){const r=t.aggregate_rates,n=t.rates_by_product||{};if(l&&n[l]){e=(n[l].total_sample_size||0)>=10?n[l]:r}else e=r}else{if(!t.rates_by_day)return console.log("No valid rates structure found in:",t),[];e=t}if(!e||!e.rates_by_day)return console.log("No rates_by_day found in displayRates:",e),[];const s=e.rates_by_day,i=Object.keys(s).map(Number).sort((e,t)=>e-t);return console.log("Chart sortedDays:",i),console.log("Chart ratesByDay sample:",s[i[0]]),i.map(e=>{const t=s[e.toString()],i={day:e};return a?(i.rawDailyCancellation=(null===t||void 0===t?void 0:t.raw_daily_cancellation_rate)||0,i.smoothedDailyCancellation=(null===t||void 0===t?void 0:t.smoothed_daily_cancellation_rate)||0,i.rawCumulativeCancellation=(null===t||void 0===t?void 0:t.raw_cumulative_cancellation_rate)||0,i.smoothedCumulativeCancellation=(null===t||void 0===t?void 0:t.smoothed_cumulative_cancellation_rate)||0,i.conversionProbabilityFromDayOnward=100*((null===t||void 0===t?void 0:t.conversion_probability_from_day_onward)||0),i.survivalProbabilityThisDay=100*((null===t||void 0===t?void 0:t.survival_probability_this_day)||0)):r?(i.rawDailyCancellation=(null===t||void 0===t?void 0:t.raw_daily_cancellation_rate)||0,i.smoothedDailyCancellation=(null===t||void 0===t?void 0:t.smoothed_daily_cancellation_rate)||0,i.rawCumulativeCancellation=(null===t||void 0===t?void 0:t.raw_cumulative_cancellation_rate)||0,i.smoothedCumulativeCancellation=(null===t||void 0===t?void 0:t.smoothed_cumulative_cancellation_rate)||0):n&&(i.rawDailyRefund=(null===t||void 0===t?void 0:t.raw_daily_refund_rate)||0,i.smoothedDailyRefund=(null===t||void 0===t?void 0:t.smoothed_daily_refund_rate)||0,i.rawCumulativeRefund=(null===t||void 0===t?void 0:t.raw_cumulative_refund_rate)||0,i.smoothedCumulativeRefund=(null===t||void 0===t?void 0:t.smoothed_cumulative_refund_rate)||0,i.totalRefundProbability=100*((null===t||void 0===t?void 0:t.total_refund_probability)||0),i.noRefundProbability=100*((null===t||void 0===t?void 0:t.no_refund_probability)||0)),i})})(),o=a||r?[{dataKey:"rawDailyCancellation",name:"Raw Daily Cancellation",stroke:"#dc2626",strokeDasharray:"0"},{dataKey:"smoothedDailyCancellation",name:"Smoothed Daily Cancellation",stroke:"#dc2626",strokeDasharray:"5 5"},{dataKey:"rawCumulativeCancellation",name:"Raw Cumulative Cancellation",stroke:"#b91c1c",strokeDasharray:"0"},{dataKey:"smoothedCumulativeCancellation",name:"Smoothed Cumulative Cancellation",stroke:"#b91c1c",strokeDasharray:"5 5"}]:n?[{dataKey:"rawDailyRefund",name:"Raw Daily Refund",stroke:"#2563eb",strokeDasharray:"0"},{dataKey:"smoothedDailyRefund",name:"Smoothed Daily Refund",stroke:"#2563eb",strokeDasharray:"5 5"},{dataKey:"rawCumulativeRefund",name:"Raw Cumulative Refund",stroke:"#1d4ed8",strokeDasharray:"0"},{dataKey:"smoothedCumulativeRefund",name:"Smoothed Cumulative Refund",stroke:"#1d4ed8",strokeDasharray:"5 5"}]:[],c=a?[{dataKey:"conversionProbabilityFromDayOnward",name:"Conversion Probability from Day Onward",stroke:"#059669",strokeDasharray:"0",strokeWidth:3},{dataKey:"survivalProbabilityThisDay",name:"Daily Survival Probability",stroke:"#10b981",strokeDasharray:"5 5",strokeWidth:2}]:[],d=n?[{dataKey:"totalRefundProbability",name:"Total Refund Probability",stroke:"#dc2626",strokeDasharray:"0",strokeWidth:3},{dataKey:"noRefundProbability",name:"No Refund Probability (Retention)",stroke:"#059669",strokeDasharray:"5 5",strokeWidth:3}]:[];return(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,ut.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[e," - Lifecycle Charts"]}),(0,ut.jsx)("button",{onClick:w,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,ut.jsx)(Dt,{size:24})})]}),(0,ut.jsx)("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Current Filter: ",l||"All Products (Aggregate)"]}),(0,ut.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Use the main product toggle to change filter"})]})}),i.length>0?(0,ut.jsxs)("div",{className:"space-y-8",children:[a&&c.length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"\ud83c\udfaf Revenue Estimation: Conversion Probabilities"}),(0,ut.jsx)("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/30 rounded-lg",children:(0,ut.jsxs)("p",{className:"text-sm text-green-800 dark:text-green-200",children:[(0,ut.jsx)("strong",{children:"Conversion Probability from Day Onward:"})," Shows the likelihood that a user on day X will convert by the end of the trial. This is used in revenue estimation: ",(0,ut.jsx)("code",{children:"Expected Revenue = P_convert(x) \xd7 P_not_refunded \xd7 ARPU"})]})}),(0,ut.jsx)("div",{className:"h-80",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:i,children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"day",label:{value:"Trial Day",position:"insideBottom",offset:-5}}),(0,ut.jsx)(oN,{label:{value:"Probability (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),(0,ut.jsx)(Jo,{content:s}),(0,ut.jsx)(Sc,{}),c.map((e,t)=>(0,ut.jsx)(fw,{type:"monotone",dataKey:e.dataKey,stroke:e.stroke,strokeDasharray:e.strokeDasharray,name:e.name,strokeWidth:e.strokeWidth||2,dot:{r:4}},t))]})})})]}),n&&d.length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"\ud83d\udcb0 Revenue Estimation: Refund Probabilities"}),(0,ut.jsx)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:(0,ut.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,ut.jsx)("strong",{children:"Total Refund Probability:"})," The total likelihood of refunding within the refund window.",(0,ut.jsx)("strong",{children:" No Refund Probability:"})," Used in revenue estimation as the retention component."]})}),(0,ut.jsx)("div",{className:"h-80",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:i,children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"day",label:{value:"Days Since Conversion",position:"insideBottom",offset:-5}}),(0,ut.jsx)(oN,{label:{value:"Probability (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),(0,ut.jsx)(Jo,{content:s}),(0,ut.jsx)(Sc,{}),d.map((e,t)=>(0,ut.jsx)(fw,{type:"monotone",dataKey:e.dataKey,stroke:e.stroke,strokeDasharray:e.strokeDasharray,name:e.name,strokeWidth:e.strokeWidth||2,dot:{r:4}},t))]})})})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Daily Rates Chart"}),(0,ut.jsx)("div",{className:"h-80",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:i,children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"day",label:{value:"Days",position:"insideBottom",offset:-5}}),(0,ut.jsx)(oN,{label:{value:"Rate (%)",angle:-90,position:"insideLeft"}}),(0,ut.jsx)(Jo,{content:s}),(0,ut.jsx)(Sc,{}),o.filter(e=>e.dataKey.includes("Daily")||e.dataKey.includes("daily")).map((e,t)=>(0,ut.jsx)(fw,{type:"monotone",dataKey:e.dataKey,stroke:e.stroke,strokeDasharray:e.strokeDasharray,name:e.name,strokeWidth:2,dot:{r:3}},t))]})})})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Cumulative Rates Chart"}),(0,ut.jsx)("div",{className:"h-80",children:(0,ut.jsx)(Ki,{width:"100%",height:"100%",children:(0,ut.jsxs)(lN,{data:i,children:[(0,ut.jsx)(SN,{strokeDasharray:"3 3"}),(0,ut.jsx)(Xw,{dataKey:"day",label:{value:"Days",position:"insideBottom",offset:-5}}),(0,ut.jsx)(oN,{label:{value:"Rate (%)",angle:-90,position:"insideLeft"}}),(0,ut.jsx)(Jo,{content:s}),(0,ut.jsx)(Sc,{}),o.filter(e=>e.dataKey.includes("Cumulative")||e.dataKey.includes("cumulative")).map((e,t)=>(0,ut.jsx)(fw,{type:"monotone",dataKey:e.dataKey,stroke:e.stroke,strokeDasharray:e.strokeDasharray,name:e.name,strokeWidth:2,dot:{r:3}},t))]})})})]}),(0,ut.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[(0,ut.jsx)("h5",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Chart Information"}),(0,ut.jsxs)("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Solid lines:"})," Raw data points"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Dashed lines:"})," Smoothed data (when available)"]}),a&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Red colors:"})," Cancellation metrics (Trial Started \u2192 Cancelled)"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Green colors:"})," Conversion probabilities (used for revenue estimation)"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Thick green line:"})," Pre-calculated conversion probability from each day onward"]})]}),r&&(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Red colors:"})," Cancellation metrics"]}),n&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Blue colors:"})," Refund metrics"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Red/Green colors:"})," Refund probabilities (used for revenue estimation)"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Thick lines:"})," Pre-calculated total refund probabilities"]})]})]})]})]}):(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No chart data available for this lifecycle analysis."})})]})})})},E=()=>{if(!g)return null;const{title:e,rateCalculationData:t}=g,r=t.extension_info,n=(null===r||void 0===r?void 0:r.per_product_info)||{},a=t.aggregate_rates,s=t.rates_by_product||{},i=k();return(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,ut.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[e," - Product Breakdown"]}),(0,ut.jsx)("button",{onClick:S,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,ut.jsx)(Dt,{size:24})})]}),(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Aggregate Summary"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,ut.jsx)("strong",{children:"Total Users:"})," ",(null===a||void 0===a?void 0:a.total_sample_size)||0]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,ut.jsx)("strong",{children:"Extension Used:"})," ",(null===a||void 0===a?void 0:a.extension_days_used)||0," days"]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{className:"text-blue-700 dark:text-blue-300",children:[(0,ut.jsx)("strong",{children:"Products with Data:"})," ",Object.keys(s).length]})})]})]}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Per-Product Details (",i.length," products)"]}),i.map(e=>{const t=n[e]||{},r=s[e]||{},a=t.final_sample_size||r.total_sample_size||0,i=t.extension_days_used||r.extension_days_used||0,o=t.attempts_made||r.extension_attempts||1;let c="No Data",d="text-gray-500",u="bg-gray-50 dark:bg-gray-700";a>=10?(c="Sufficient Data",d="text-green-600 dark:text-green-400",u="bg-green-50 dark:bg-green-900/20"):a>0&&(c="Insufficient Data (<10 users)",d="text-orange-600 dark:text-orange-400",u="bg-orange-50 dark:bg-orange-900/20");let h="No lookback data available";if(void 0!==t.final_sample_size||void 0!==r.total_sample_size){const e=t.user_counts_by_step;if(e){const t=e.base||0,r=e["30_days"]||0,n=e["60_days"]||0;0===i?h="Base: ".concat(t):30===i?h="Base: ".concat(t,", +0-30: ").concat(r):60===i&&(h="Base: ".concat(t,", +0-30: ").concat(r,", +31-60: ").concat(n))}else 0===i?h="Base: ".concat(a):30===i?h="Base: ?, +0-30: ".concat(a," (final)"):60===i&&(h="Base: ?, +0-30: ?, +31-60: ".concat(a," (final)"))}return(0,ut.jsxs)("div",{className:"p-4 rounded-lg border ".concat(u," border-gray-200 dark:border-gray-600"),children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:e}),(0,ut.jsx)("span",{className:"text-sm font-medium ".concat(d),children:c})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Final Users:"})," ",a]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Extension:"})," ",i," days"]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Attempts:"})," ",o]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Used in Display:"})," ",l===e?a>=10?"Yes (Product-specific)":"No (Fallback to aggregate)":"N/A"]})})]}),(0,ut.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Lookback breakdown:"})," ",h]})})]},e)})]}),(0,ut.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsx)("h5",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"How This Works"}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Lookback Strategy:"})," Each product tries to reach 100+ users by extending lookback period (Base \u2192 +0-30 days \u2192 +31-60 days)"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Display Logic:"})," Product-specific data shown only if \u226510 users, otherwise falls back to aggregate"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Aggregate:"})," Combined data from all products that have sufficient data"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Current Filter:"})," ",l||"All Products (Aggregate)"]}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Note:"}),' Products with "No Data" for this lifecycle type don\'t participate in the aggregate calculation']})]})]})]})})})};if(!o)return(0,ut.jsx)("div",{className:"p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No lifecycle rate data available."})});return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsx)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-blue-800 dark:text-blue-200",children:"Lifecycle Analysis - Product Filter"}),(0,ut.jsx)("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:l?"Showing data for: ".concat(l):"Showing aggregate data across all products"}),(0,ut.jsx)("p",{className:"text-xs text-blue-500 dark:text-blue-400 mt-1",children:"Note: Product-specific data requires minimum 10 users per lifecycle type. Tables with fewer users will show aggregate data."})]}),(0,ut.jsxs)("select",{value:l||"",onChange:e=>c(e.target.value||null),className:"px-4 py-2 border border-blue-300 dark:border-blue-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"All Products (Aggregate)"}),j.map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]})]})}),(0,ut.jsx)("div",{className:"space-y-8",children:[{key:"trial_to_outcome",title:"Trial Started \u2192 Cancelled",dataKey:"trial_to_outcome"},{key:"trial_converted_to_cancellation",title:"Trial Converted \u2192 Cancelled",dataKey:"trial_converted_to_cancellation"},{key:"trial_converted_to_refund",title:"Trial Converted \u2192 Refunded",dataKey:"trial_converted_to_refund"},{key:"initial_purchase_to_cancellation",title:"Initial Purchase \u2192 Cancelled",dataKey:"initial_purchase_to_cancellation"},{key:"initial_purchase_to_refund",title:"Initial Purchase \u2192 Refunded",dataKey:"initial_purchase_to_refund"},{key:"renewal_to_cancellation",title:"Renewal \u2192 Cancelled",dataKey:"renewal_to_cancellation"},{key:"renewal_to_refund",title:"Renewal \u2192 Refunded",dataKey:"renewal_to_refund"}].map(e=>{const t=y&&y[e.dataKey]?y[e.dataKey]:null;return t?O(e.title,t):(0,ut.jsx)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,ut.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No data available"})]})},e.key)})}),d&&(0,ut.jsx)(C,{}),m&&(0,ut.jsx)(E,{})]})},DL=e=>{var t,r,n,a,i,o,l,c,d,u,h,p,m,f,g,x,b;let{data:y}=e;const[v,_]=(0,s.useState)(!1);console.log("ARPUDisplay received data:",y),console.log("Data structure:",{hasData:!!y,hasDataData:!(null===y||void 0===y||!y.data),dataKeys:y?Object.keys(y):[],dataDataKeys:null!==y&&void 0!==y&&y.data?Object.keys(y.data):[]});let k=null,j=null,w=null;var N,S,O,C;if(null!==y&&void 0!==y&&null!==(t=y.data)&&void 0!==t&&null!==(r=t.structured_format)&&void 0!==r&&r.arpu_analysis)console.log("Using structured_format.arpu_analysis"),k=y.data.structured_format.arpu_analysis,w=null===(N=y.data.structured_format.cohort_analysis)||void 0===N?void 0:N.cohort_breakdown,j=null===(S=y.data.structured_format)||void 0===S||null===(O=S.cohort_data)||void 0===O||null===(C=O.cleaned_cohort)||void 0===C?void 0:C.metadata,console.log("Structured format data:",{arpuData:k,extendedCohortInfo:w,cohortSummary:j});else if(null!==y&&void 0!==y&&null!==(n=y.data)&&void 0!==n&&n.legacy_format){var E;console.log("Using legacy_format");const e=y.data.legacy_format;k={cohort_wide:{arpu:e.arpu||0,total_revenue:0,paying_users:0,net_revenue:0},per_product:{},metadata:{calculation_method:"legacy_format",message:"Data from legacy format",lookback_days:(null===(E=e.metadata)||void 0===E?void 0:E.lookback_days_used)||0}},e.arpu_per_product&&Object.entries(e.arpu_per_product).forEach(e=>{let[t,r]=e;k.per_product[t]={arpu:r,total_revenue:0,paying_users:0,event_count:0,net_revenue:0}}),w={base_users:e.base_users||0,lookback_users:e.lookback_users||0,total_users:e.comprehensive_cohort_size||0,base_percentage:0,lookback_percentage:0},w.total_users>0&&(w.base_percentage=w.base_users/w.total_users*100,w.lookback_percentage=w.lookback_users/w.total_users*100),j={user_count:e.cohort_size||0,event_count:e.total_events||0},console.log("Legacy format data:",{arpuData:k,extendedCohortInfo:w,cohortSummary:j,legacyData:e})}else if(null!==y&&void 0!==y&&null!==(a=y.structured_format)&&void 0!==a&&a.arpu_analysis){var P,A,T,M;console.log("Using direct structured_format.arpu_analysis"),k=y.structured_format.arpu_analysis,w=null===(P=y.structured_format.cohort_analysis)||void 0===P?void 0:P.cohort_breakdown,j=null===(A=y.structured_format)||void 0===A||null===(T=A.cohort_data)||void 0===T||null===(M=T.cleaned_cohort)||void 0===M?void 0:M.metadata}else if(null!==y&&void 0!==y&&y.legacy_format){var R;console.log("Using direct legacy_format");const e=y.legacy_format;k={cohort_wide:{arpu:e.arpu||0,total_revenue:0,paying_users:0,net_revenue:0},per_product:{},metadata:{calculation_method:"legacy_format",message:"Data from legacy format",lookback_days:(null===(R=e.metadata)||void 0===R?void 0:R.lookback_days_used)||0}},e.arpu_per_product&&Object.entries(e.arpu_per_product).forEach(e=>{let[t,r]=e;k.per_product[t]={arpu:r,total_revenue:0,paying_users:0,event_count:0,net_revenue:0}}),w={base_users:e.base_users||0,lookback_users:e.lookback_users||0,total_users:e.comprehensive_cohort_size||0,base_percentage:0,lookback_percentage:0},w.total_users>0&&(w.base_percentage=w.base_users/w.total_users*100,w.lookback_percentage=w.lookback_users/w.total_users*100),j={user_count:e.cohort_size||0,event_count:e.total_events||0}}else null!==y&&void 0!==y&&null!==(i=y.data)&&void 0!==i&&i.arpu_data&&(console.log("Using regular arpu_data"),k=y.data.arpu_data,j=y.data.cohort_summary);if(console.log("FINAL EXTRACTED ARPU DATA:",{arpuData:k,extendedCohortInfo:w,cohortSummary:j,hasArpuData:!!k}),!k)return(0,ut.jsxs)("div",{className:"text-center py-8",children:[(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No ARPU data available. Run an analysis to see results."}),(0,ut.jsxs)("div",{className:"mt-4 text-xs text-gray-400",children:["Debug: ",JSON.stringify({hasData:!!y,hasDataData:!(null===y||void 0===y||!y.data),dataKeys:y?Object.keys(y):[],dataDataKeys:null!==y&&void 0!==y&&y.data?Object.keys(y.data):[]})]})]});const D=k.cohort_wide||{},I=k.per_product||{},L=k.metadata||{},F=L.base_revenue||0,B=L.lookback_revenue||0,U=F+B||D.total_revenue||0,z=L.base_contribution_pct||0,V=L.lookback_contribution_pct||0,H=L.lookback_days_used||L.lookback_days||(null===y||void 0===y||null===(o=y.data)||void 0===o||null===(l=o.structured_format)||void 0===l||null===(c=l.metadata)||void 0===c?void 0:c.lookback_days_used)||(null===y||void 0===y||null===(d=y.structured_format)||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.lookback_days_used)||0,W=e=>null===e||void 0===e||isNaN(e)?"$0.00":"$".concat(Number(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),q=e=>null===e||void 0===e||isNaN(e)?"0":Number(e).toLocaleString(),G=e=>null===e||void 0===e||isNaN(e)?"0.0%":"".concat(Number(e).toFixed(1),"%"),$=Object.entries(I).sort((e,t)=>{let[,r]=e,[,n]=t;return(n.arpu||0)-(r.arpu||0)}),K=Object.entries(I).filter(e=>{let[,t]=e;return 0===(t.arpu||0)}),Y=K.length>0,X=(()=>{const e=L.base_non_refunded_users||0,t=L.lookback_non_refunded_users||0,r=L.base_revenue||0,n=L.lookback_revenue||0,a=r-(L.base_refunds||0),s=n-(L.lookback_refunds||0);return{baseARPU:e>0?a/e:0,lookbackARPU:t>0?s/t:0,hasData:e>0||t>0,baseNetRevenue:a,lookbackNetRevenue:s}})();return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"mb-4",children:[(0,ut.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Cohort-Wide ARPU Analysis"}),(null===(h=w)||void 0===h?void 0:h.base_users)>0&&(null===(p=w)||void 0===p?void 0:p.lookback_users)>0&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:(0,ut.jsxs)("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[(0,ut.jsx)("strong",{children:"Extended Timeline Analysis:"})," This ARPU calculation includes data from an extended timeline.",(0,ut.jsxs)("div",{className:"mt-1 text-xs",children:["Total Users: ",null===(m=w)||void 0===m?void 0:m.total_users.toLocaleString()," (",null===(f=w)||void 0===f?void 0:f.base_users.toLocaleString()," base period + ",null===(g=w)||void 0===g?void 0:g.lookback_users.toLocaleString()," lookback period)",H>0&&" \u2022 Lookback: ".concat(H," days")]})]})}),X.hasData&&(0,ut.jsxs)("div",{className:"mb-4 p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg border border-indigo-200 dark:border-indigo-800",children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-indigo-800 dark:text-indigo-200 mb-2",children:"Quick ARPU Comparison by Period (Net Revenue \xf7 Non-Refunded Users):"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:W(X.baseARPU)}),(0,ut.jsx)("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"Base Period ARPU"}),(0,ut.jsxs)("div",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:[W(X.baseNetRevenue)," \xf7 ",q(L.base_non_refunded_users||0)," users"]})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:W(X.lookbackARPU)}),(0,ut.jsx)("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"Lookback Period ARPU"}),(0,ut.jsxs)("div",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:[W(X.lookbackNetRevenue)," \xf7 ",q(L.lookback_non_refunded_users||0)," users"]})]})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsx)("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:W(D.arpu)}),(0,ut.jsx)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"ARPU (Net Revenue \xf7 Non-Refunded Users)"}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:[q((L.base_non_refunded_users||0)+(L.lookback_non_refunded_users||0)||D.paying_users)," users, ",W(D.net_revenue||D.total_revenue)," net revenue"]}),(F>0||B>0)&&U>0&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Revenue Timeline Breakdown:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-blue-500 dark:text-blue-500",children:"Base Period:"}),(0,ut.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:[W(F)," (",z.toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-blue-500 dark:text-blue-500",children:"Lookback Period:"}),(0,ut.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:[W(B)," (",V.toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-blue-200 dark:border-blue-700 pt-1",children:[(0,ut.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:"Total:"}),(0,ut.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:W(U)})]})]})]})]}),(0,ut.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-300",children:W(D.total_revenue||U)}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Revenue"}),D.total_refunds>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[W(D.total_refunds)," refunded"]}),(F>0||B>0)&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Revenue Sources:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Base Period:"}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:W(F)})]}),L.base_refunds>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-500 dark:text-red-400",children:"Base Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:["-",W(L.base_refunds)]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Lookback Period:"}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:W(B)})]}),L.lookback_refunds>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-500 dark:text-red-400",children:"Lookback Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:["-",W(L.lookback_refunds)]})]}),D.total_refunds>0&&!(L.base_refunds>0)&&!(L.lookback_refunds>0)&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs text-red-600 dark:text-red-400",children:[(0,ut.jsx)("span",{children:"Total Refunds:"}),(0,ut.jsxs)("span",{children:["-",W(D.total_refunds)]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-gray-200 dark:border-gray-600 pt-1",children:[(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Net Revenue:"}),(0,ut.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:W(D.net_revenue||U)})]})]})]})]}),(0,ut.jsxs)("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-semibold text-gray-700 dark:text-gray-300",children:q(D.total_paying_users||D.paying_users)}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Paying Users"}),D.refund_users>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[q(D.refund_users)," refunded (",(D.refund_users/(D.total_paying_users||D.paying_users)*100).toFixed(1),"%)"]}),((L.base_paying_users||0)>0||(L.lookback_paying_users||0)>0)&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User Timeline Distribution:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Base Period:"}),(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[q(L.base_paying_users||0)," paying"]})]}),(L.base_refund_users||0)>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-500 dark:text-red-400",children:"Base Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:[q(L.base_refund_users)," users (",(L.base_refund_users/L.base_paying_users*100).toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Lookback Period:"}),(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[q(L.lookback_paying_users||0)," paying"]})]}),(L.lookback_refund_users||0)>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-500 dark:text-red-400",children:"Lookback Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:[q(L.lookback_refund_users)," users (",(L.lookback_refund_users/L.lookback_paying_users*100).toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-gray-200 dark:border-gray-600 pt-1",children:[(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Non-Refunded Users:"}),(0,ut.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:q((L.base_non_refunded_users||0)+(L.lookback_non_refunded_users||0))})]}),H>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Lookback: ",H," days"]})]})]}),!((L.base_paying_users||0)>0||(L.lookback_paying_users||0)>0)&&(null===(x=w)||void 0===x?void 0:x.base_users)>0&&(null===(b=w)||void 0===b?void 0:b.lookback_users)>0&&(0,ut.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"User Timeline Distribution:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Base Period:"}),(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[q(w.base_users)," (",w.base_percentage.toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:"Lookback Period:"}),(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[q(w.lookback_users)," (",w.lookback_percentage.toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-gray-200 dark:border-gray-600 pt-1",children:[(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Extended:"}),(0,ut.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:q(w.total_users)})]}),H>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Lookback: ",H," days"]})]})]})]})]}),L.calculation_method&&(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,ut.jsx)("span",{className:"px-3 py-1 text-sm rounded-full ".concat("standard"===L.calculation_method?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"extended_lookback"===L.calculation_method?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"),children:"standard"===L.calculation_method?"Standard Calculation - No Lookback Used":"extended_lookback"===L.calculation_method?"Extended Lookback - ".concat(L.lookback_days," Days"):"Fallback Method - Insufficient Data"}),L.lookback_days>0&&"extended_lookback"===L.calculation_method&&(0,ut.jsxs)("span",{className:"px-3 py-1 text-sm bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 rounded-full",children:["Extended by ",L.lookback_days," days for sufficient sample size"]})]})]}),$.length>0&&(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["ARPU by Product (",$.length," products",Y?" + ".concat(K.length," with $0 ARPU"):"",")"]}),(0,ut.jsxs)("button",{onClick:()=>_(!v),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:[v?"Hide":"Show"," calculation details"]})]}),Y&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:(0,ut.jsxs)("div",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[(0,ut.jsx)("strong",{children:"Note:"})," ",K.length," product",K.length>1?"s":""," with $0.00 ARPU ",K.length>1?"are":"is"," not displayed above.",(0,ut.jsx)("div",{className:"text-xs mt-1",children:K.length>5?"".concat(K.slice(0,5).map(e=>{let[t]=e;return t}).join(", ")," and ").concat(K.length-5," more..."):K.map(e=>{let[t]=e;return t}).join(", ")})]})}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:$.filter(e=>{let[,t]=e;return(t.arpu||0)>0}).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 hover:shadow-lg transition-all duration-200",children:[(0,ut.jsx)("div",{className:"mb-4",children:(0,ut.jsx)("h5",{className:"font-semibold text-gray-900 dark:text-white text-sm leading-tight",title:t,children:t.length>45?"".concat(t.substring(0,45),"..."):t})}),(0,ut.jsxs)("div",{className:"text-center mb-4 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:W(r.arpu)}),(0,ut.jsx)("div",{className:"text-xs text-blue-700 dark:text-blue-300 font-medium",children:"ARPU"})]}),(r.base_revenue>0||r.lookback_revenue>0)&&(r.base_non_refunded_users>0||r.lookback_non_refunded_users>0)&&(0,ut.jsxs)("div",{className:"mb-4 p-2 bg-indigo-50 dark:bg-indigo-900/20 rounded border border-indigo-200 dark:border-indigo-700",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-indigo-800 dark:text-indigo-300 mb-2",children:"Period ARPU (Net Revenue \xf7 Non-Refunded Users):"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:W(r.base_non_refunded_users>0?(r.base_revenue-(r.base_refunds||0))/r.base_non_refunded_users:0)}),(0,ut.jsx)("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"Base"}),(0,ut.jsxs)("div",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:[W((r.base_revenue||0)-(r.base_refunds||0))," \xf7 ",q(r.base_non_refunded_users||0)]})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:W(r.lookback_non_refunded_users>0?(r.lookback_revenue-(r.lookback_refunds||0))/r.lookback_non_refunded_users:0)}),(0,ut.jsx)("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"Lookback"}),(0,ut.jsxs)("div",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:[W((r.lookback_revenue||0)-(r.lookback_refunds||0))," \xf7 ",q(r.lookback_non_refunded_users||0)]})]})]})]}),(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-gray-700 rounded",children:[(0,ut.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:r.net_revenue?"Net Revenue":"Total Revenue"}),(0,ut.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[W(r.net_revenue||r.total_revenue),r.total_refunds>0&&(0,ut.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[W(r.total_revenue)," total - ",W(r.total_refunds)," refunded"]})]})]}),(r.base_revenue>0||r.lookback_revenue>0)&&(0,ut.jsxs)("div",{className:"py-2 px-3 bg-amber-50 dark:bg-amber-900/20 rounded border border-amber-200 dark:border-amber-700",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-amber-800 dark:text-amber-300 mb-2",children:"Revenue Timeline:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-amber-700 dark:text-amber-400",children:"Base Period:"}),(0,ut.jsx)("span",{className:"text-amber-800 dark:text-amber-300 font-medium",children:W(r.base_revenue||0)})]}),r.base_refunds>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Base Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-700 dark:text-red-400 font-medium",children:["-",W(r.base_refunds)]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-amber-700 dark:text-amber-400",children:"Lookback Period:"}),(0,ut.jsx)("span",{className:"text-amber-800 dark:text-amber-300 font-medium",children:W(r.lookback_revenue||0)})]}),r.lookback_refunds>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Lookback Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-700 dark:text-red-400 font-medium",children:["-",W(r.lookback_refunds)]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-amber-300 dark:border-amber-600 pt-1",children:[(0,ut.jsx)("span",{className:"text-amber-800 dark:text-amber-300",children:"Net Revenue:"}),(0,ut.jsx)("span",{className:"text-amber-900 dark:text-amber-200",children:W(r.net_revenue||r.base_revenue+r.lookback_revenue-(r.base_refunds||0)-(r.lookback_refunds||0))})]}),r.base_revenue>0&&r.lookback_revenue>0&&(0,ut.jsxs)("div",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1 pt-1 border-t border-amber-300 dark:border-amber-600",children:["Base: ",(r.base_revenue/(r.base_revenue+r.lookback_revenue)*100).toFixed(1),"% \u2022 Lookback: ",(r.lookback_revenue/(r.base_revenue+r.lookback_revenue)*100).toFixed(1),"%"]})]})]}),(0,ut.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-gray-700 rounded",children:[(0,ut.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Total Paying Users"}),(0,ut.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[q(r.paying_users),r.refund_users>0&&(0,ut.jsxs)("span",{className:"text-xs text-red-600 dark:text-red-400 ml-1",children:["(",q(r.refund_users)," refunded - ",(r.refund_users/r.paying_users*100).toFixed(1),"%)"]})]})]}),(r.base_non_refunded_users>0||r.lookback_non_refunded_users>0)&&(0,ut.jsxs)("div",{className:"py-2 px-3 bg-purple-50 dark:bg-purple-900/20 rounded border border-purple-200 dark:border-purple-700",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-purple-800 dark:text-purple-300 mb-2",children:"User Timeline (Used in ARPU):"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-400",children:"Base Period:"}),(0,ut.jsxs)("span",{className:"text-purple-800 dark:text-purple-300 font-medium",children:[q(r.base_paying_users||0)," paying"]})]}),(r.base_refund_users||0)>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Base Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-700 dark:text-red-400 font-medium",children:["-",q(r.base_refund_users)," users (",(r.base_refund_users/r.base_paying_users*100).toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsx)("span",{className:"text-purple-700 dark:text-purple-400",children:"Lookback Period:"}),(0,ut.jsxs)("span",{className:"text-purple-800 dark:text-purple-300 font-medium",children:[q(r.lookback_paying_users||0)," paying"]})]}),(r.lookback_refund_users||0)>0&&(0,ut.jsxs)("div",{className:"flex justify-between text-xs ml-2",children:[(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Lookback Refunds:"}),(0,ut.jsxs)("span",{className:"text-red-700 dark:text-red-400 font-medium",children:["-",q(r.lookback_refund_users)," users (",(r.lookback_refund_users/r.lookback_paying_users*100).toFixed(1),"%)"]})]}),(0,ut.jsxs)("div",{className:"flex justify-between text-xs font-medium border-t border-purple-300 dark:border-purple-600 pt-1",children:[(0,ut.jsx)("span",{className:"text-purple-800 dark:text-purple-300",children:"Non-Refunded Users:"}),(0,ut.jsx)("span",{className:"text-purple-900 dark:text-purple-200",children:q((r.base_non_refunded_users||0)+(r.lookback_non_refunded_users||0))})]}),(r.base_paying_users||0)>0&&(r.lookback_paying_users||0)>0&&(0,ut.jsxs)("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1 pt-1 border-t border-purple-300 dark:border-purple-600",children:["Base: ",((r.base_paying_users||0)/((r.base_paying_users||0)+(r.lookback_paying_users||0))*100).toFixed(1),"% \u2022 Lookback: ",((r.lookback_paying_users||0)/((r.base_paying_users||0)+(r.lookback_paying_users||0))*100).toFixed(1),"%"]})]})]})]})]},t)})}),v&&(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,ut.jsx)("h5",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Calculation Details"}),(0,ut.jsx)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,ut.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,ut.jsx)("strong",{children:"ARPU Calculation Method:"})," All ARPU values use ",(0,ut.jsx)("strong",{children:"Net Revenue \xf7 Non-Refunded Users"}),(0,ut.jsxs)("div",{className:"text-xs mt-1 text-blue-700 dark:text-blue-300",children:["\u2022 Base ARPU = (Base Revenue - Base Refunds) \xf7 Base Non-Refunded Users",(0,ut.jsx)("br",{}),"\u2022 Lookback ARPU = (Lookback Revenue - Lookback Refunds) \xf7 Lookback Non-Refunded Users",(0,ut.jsx)("br",{}),"\u2022 Combined ARPU = Total Net Revenue \xf7 Total Non-Refunded Users"]})]})}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm",children:[(0,ut.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-3 py-2 text-left text-gray-700 dark:text-gray-300",children:"Product ID"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Total Revenue"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Base Revenue"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Lookback Revenue"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Base Refunds"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Lookback Refunds"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Net Revenue"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Total Paying Users"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Refund %"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Non-Refunded Users"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Base ARPU"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Lookback ARPU"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"Combined ARPU"}),(0,ut.jsx)("th",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:"% of Net Revenue"})]})}),(0,ut.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:$.map(e=>{let[t,r]=e;const n=r.net_revenue||r.total_revenue,a=D.net_revenue||D.total_revenue,s=a>0?n/a*100:0,i=(r.base_non_refunded_users||0)+(r.lookback_non_refunded_users||0)||r.paying_users,o=r.paying_users>0?(r.refund_users||0)/r.paying_users*100:0,l=r.base_non_refunded_users>0?(r.base_revenue-(r.base_refunds||0))/r.base_non_refunded_users:0,c=r.lookback_non_refunded_users>0?(r.lookback_revenue-(r.lookback_refunds||0))/r.lookback_non_refunded_users:0;return(0,ut.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,ut.jsx)("td",{className:"px-3 py-2 text-gray-900 dark:text-white",children:(0,ut.jsx)("div",{className:"max-w-xs truncate",title:t,children:t})}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:W(r.total_revenue)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:W(r.base_revenue||0)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:W(r.lookback_revenue||0)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-red-600 dark:text-red-400",children:W(r.base_refunds||0)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-red-600 dark:text-red-400",children:W(r.lookback_refunds||0)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:W(r.net_revenue||r.total_revenue)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:q(r.paying_users)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-red-600 dark:text-red-400",children:G(o)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-purple-600 dark:text-purple-400 font-medium",children:q(i)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-indigo-600 dark:text-indigo-400",children:W(l)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-indigo-600 dark:text-indigo-400",children:W(c)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right font-semibold text-green-600 dark:text-green-400",children:W(r.arpu)}),(0,ut.jsx)("td",{className:"px-3 py-2 text-right text-gray-700 dark:text-gray-300",children:G(s)})]},t)})})]})})]})]})]})},IL=e=>{let{data:t,position:r,onClose:n,selectedUserId:a,selectedProductId:i}=e;const[o,l]=s.useState(!1),c=s.useRef(null);if(!t)return null;const d=t.value||0,u=t.breakdown||{},h=u.components||{},p=u.formula||"No formula available",m=u.calculation||"No calculation available";return(0,ut.jsxs)("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 max-w-md pointer-events-auto",style:{left:r.x,top:r.y,pointerEvents:"auto"},onMouseEnter:()=>{l(!0),c.current&&(clearTimeout(c.current),c.current=null)},onMouseLeave:()=>{l(!1),c.current=setTimeout(()=>{n()},300)},children:[(0,ut.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,ut.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:["Estimated Revenue: $",d.toFixed(2)]}),(0,ut.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 ml-2",children:"\xd7"})]}),(0,ut.jsxs)("div",{className:"space-y-3",children:[(()=>{const e=u.trial_converted||{},t=u.initial_purchase||{},r=e.actual_revenue>0,n=t.actual_revenue>0;return r||n?(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900 p-3 rounded-lg border border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\ud83c\udfaf Refund Rate Analysis"}),r&&(0,ut.jsxs)("div",{className:"mb-2",children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Trial Conversion Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-900 dark:text-blue-100",children:(()=>{const t=e.actual_revenue||0,r=e.estimated_refunds||0,n=t>0?r/t*100:0;return"".concat(r.toFixed(2)," / ").concat(t.toFixed(2)," = ").concat(n.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["$",(e.estimated_refunds||0).toFixed(2)," estimated refunds on $",(e.actual_revenue||0).toFixed(2)," revenue"]})]}),n&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Initial Purchase Refund Rate:"}),(0,ut.jsx)("div",{className:"text-sm font-bold text-blue-900 dark:text-blue-100",children:(()=>{const e=t.actual_revenue||0,r=t.estimated_refunds||0,n=e>0?r/e*100:0;return"".concat(r.toFixed(2)," / ").concat(e.toFixed(2)," = ").concat(n.toFixed(1),"%")})()}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["$",(t.estimated_refunds||0).toFixed(2)," estimated refunds on $",(t.actual_revenue||0).toFixed(2)," revenue"]})]})]}):null})(),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Formula:"}),(0,ut.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono bg-gray-50 dark:bg-gray-700 p-2 rounded",children:p})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Calculation:"}),(0,ut.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono bg-gray-50 dark:bg-gray-700 p-2 rounded",children:m})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Components:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(()=>{const e=u.components_order,t=h;return e&&Array.isArray(e)?e.map(e=>{const r=t[e];return void 0===r?null:(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[e,":"]}),(0,ut.jsx)("span",{className:"text-gray-900 dark:text-white font-medium",children:"string"===typeof r?r:"number"===typeof r?e.toLowerCase().includes("revenue")||e.toLowerCase().includes("arpu")?"$".concat(r.toFixed(2)):r.toString():r||"N/A"})]},e)}).filter(Boolean):Object.entries(t).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[t,":"]}),(0,ut.jsx)("span",{className:"text-gray-900 dark:text-white font-medium",children:"string"===typeof r?r:"number"===typeof r?t.toLowerCase().includes("revenue")||t.toLowerCase().includes("arpu")?"$".concat(r.toFixed(2)):r.toString():r||"N/A"})]},t)})})(),(()=>{const e=u.components_order,t=h;return e&&Array.isArray(e)&&0!==e.length||0!==Object.keys(t).length?null:(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No component data available"})})()]})]}),(a||i)&&(0,ut.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600",children:(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:[(0,ut.jsx)("strong",{children:"Note:"})," This calculation is specific to the filtered view",a&&" for user ".concat(a),i&&" for product ".concat(i),"."]})})]})]})},LL=e=>{var t,r,n,a,i,o,l,c,d,u;let{data:h,selectedUserId:p="",selectedProductId:m=""}=e;const[f,g]=(0,s.useState)(!1),[x,b]=(0,s.useState)(null),[y,v]=(0,s.useState)({x:0,y:0}),_=s.useRef(null);let k;s.useEffect(()=>()=>{_.current&&clearTimeout(_.current)},[]),console.log("[DEBUG] EventTimelineTable received data:",h),console.log("[DEBUG] Data structure check:",{hasData:!!h,hasDataData:!(null===h||void 0===h||!h.data),hasDailyMetrics:!(null===h||void 0===h||null===(t=h.data)||void 0===t||!t.daily_metrics),hasTimelineData:!(null===h||void 0===h||null===(r=h.data)||void 0===r||!r.timeline_data),hasStructuredFormat:!(null===h||void 0===h||null===(n=h.data)||void 0===n||!n.structured_format),hasTimelineAnalysis:!(null===h||void 0===h||null===(a=h.data)||void 0===a||null===(i=a.structured_format)||void 0===i||!i.timeline_analysis),dataKeys:h?Object.keys(h):[],dataDataKeys:null!==h&&void 0!==h&&h.data?Object.keys(h.data):[]}),console.log("[DEBUG] Raw data.data structure:",null===h||void 0===h?void 0:h.data),console.log("[DEBUG] Available keys in data.data:",null!==h&&void 0!==h&&h.data?Object.keys(h.data):[]),null!==h&&void 0!==h&&null!==(o=h.data)&&void 0!==o&&o.daily_metrics&&(console.log("[DEBUG] daily_metrics type:",typeof h.data.daily_metrics),console.log("[DEBUG] daily_metrics sample:",h.data.daily_metrics));let j=[],w={},N={},S={},O={};const C=!!(null!==h&&void 0!==h&&null!==(l=h.data)&&void 0!==l&&l.daily_metrics||null!==h&&void 0!==h&&null!==(c=h.data)&&void 0!==c&&c.timeline_data||null!==h&&void 0!==h&&null!==(d=h.data)&&void 0!==d&&null!==(u=d.structured_format)&&void 0!==u&&u.timeline_analysis||null!==h&&void 0!==h&&h.data);var E;C&&(null!==(E=h.data.structured_format)&&void 0!==E&&E.timeline_analysis?(k=h.data.structured_format.timeline_analysis,j=k.dates||[],w=k.daily_metrics||{},N=k.cumulative_metrics||{},S=k.user_timelines||{},O=k.user_daily_metrics||{},console.log("[DEBUG] Using unified pipeline format. Timeline data:",k),console.log("[DEBUG] Dates:",j),console.log("[DEBUG] Daily metrics keys:",Object.keys(w)),console.log("[DEBUG] User timelines available:",Object.keys(S).length),console.log("[DEBUG] User daily metrics available:",Object.keys(O).length)):h.data.timeline_data&&h.data.timeline_data.daily_metrics?(k=h.data.timeline_data,j=k.dates||[],w=k.daily_metrics||{},N=k.cumulative_metrics||{},S=k.user_timelines||{},O=k.user_daily_metrics||{}):h.data.daily_metrics&&"object"===typeof h.data.daily_metrics&&h.data.daily_metrics.dates?(k=h.data.daily_metrics,j=k.dates||[],k.event_rows&&j.forEach(e=>{w[e]={},Object.keys(k.event_rows).forEach(t=>{w[e][t]=k.event_rows[t][e]||0})}),O={}):h.data.daily_metrics&&(k=h.data,j=k.dates||[],w=k.daily_metrics||{},N=k.cumulative_metrics||{},S=k.user_timelines||{},O=k.user_daily_metrics||{}));const{availableUsers:P,availableProducts:A}=(0,s.useMemo)(()=>{const e=new Set,t=new Set;return Object.keys(O).forEach(t=>{e.add(t)}),Object.keys(S).forEach(r=>{var n;e.add(r);const a=S[r];a.events&&a.events.forEach(e=>{e.product_id&&t.add(e.product_id)}),null!==(n=a.summary)&&void 0!==n&&n.product_summaries&&Object.keys(a.summary.product_summaries).forEach(e=>{t.add(e)})}),Object.values(w).forEach(r=>{var n;null!==(n=r.estimated_revenue_breakdown)&&void 0!==n&&n.user_breakdowns&&Object.keys(r.estimated_revenue_breakdown.user_breakdowns).forEach(n=>{e.add(n);const a=r.estimated_revenue_breakdown.user_breakdowns[n];a.product_breakdowns&&Object.keys(a.product_breakdowns).forEach(e=>{t.add(e)})})}),{availableUsers:Array.from(e).sort(),availableProducts:Array.from(t).sort()}},[O,S,w]),T=(0,s.useMemo)(()=>{if(!p&&!m)return{dailyMetrics:w,cumulativeMetrics:N};const e={},t={};if(p&&!m){const r=O[p];if(r){let n={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0};j.forEach(a=>{const s=r[a];s?(e[a]=Ie(Ie({},s),{},{revenue_net:(s.revenue||0)-(s.refund||0)}),n.trial_started+=s.trial_started||0,n.trial_ended+=s.trial_ended||0,n.trial_converted+=s.trial_converted||0,n.trial_cancelled+=s.trial_cancelled||0,n.initial_purchase+=s.initial_purchase||0,n.subscription_cancelled+=s.subscription_cancelled||0,n.revenue+=s.revenue||0,n.refund+=s.refund||0,n.refund_count+=s.refund_count||0,t[a]={trial_pending:s.trial_pending||0,subscription_active:s.subscription_active||0,estimated_revenue:s.estimated_revenue||0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund}):(e[a]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[a]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund})})}else j.forEach(r=>{e[r]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[r]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:0,cumulative_trial_ended:0,cumulative_trial_converted:0,cumulative_trial_cancelled:0,cumulative_initial_purchase:0,cumulative_subscription_cancelled:0,cumulative_revenue:0,cumulative_refund:0,cumulative_refund_count:0,cumulative_revenue_net:0}})}else if(m&&!p)j.forEach(r=>{e[r]=Ie({},w[r]),t[r]=Ie({},N[r])});else if(p&&m){const r=O[p];if(r){let n={trial_started:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0};j.forEach(a=>{const s=r[a];s?(e[a]=Ie(Ie({},s),{},{revenue_net:(s.revenue||0)-(s.refund||0)}),n.trial_started+=s.trial_started||0,n.trial_ended+=s.trial_ended||0,n.trial_converted+=s.trial_converted||0,n.trial_cancelled+=s.trial_cancelled||0,n.initial_purchase+=s.initial_purchase||0,n.subscription_cancelled+=s.subscription_cancelled||0,n.revenue+=s.revenue||0,n.refund+=s.refund||0,n.refund_count+=s.refund_count||0,t[a]={trial_pending:s.trial_pending||0,subscription_active:s.subscription_active||0,estimated_revenue:s.estimated_revenue||0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund}):(e[a]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[a]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:n.trial_started,cumulative_trial_ended:n.trial_ended,cumulative_trial_converted:n.trial_converted,cumulative_trial_cancelled:n.trial_cancelled,cumulative_initial_purchase:n.initial_purchase,cumulative_subscription_cancelled:n.subscription_cancelled,cumulative_revenue:n.revenue,cumulative_refund:n.refund,cumulative_refund_count:n.refund_count,cumulative_revenue_net:n.revenue-n.refund})})}else j.forEach(r=>{e[r]={trial_started:0,trial_pending:0,trial_ended:0,trial_converted:0,trial_cancelled:0,initial_purchase:0,subscription_active:0,subscription_cancelled:0,revenue:0,refund:0,refund_count:0,estimated_revenue:0,revenue_net:0},t[r]={trial_pending:0,subscription_active:0,estimated_revenue:0,cumulative_trial_started:0,cumulative_trial_ended:0,cumulative_trial_converted:0,cumulative_trial_cancelled:0,cumulative_initial_purchase:0,cumulative_subscription_cancelled:0,cumulative_revenue:0,cumulative_refund:0,cumulative_refund_count:0,cumulative_revenue_net:0}})}return{dailyMetrics:e,cumulativeMetrics:t}},[p,m,w,N,O,j]);if(!C)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})});const M=e=>{if(null===e||void 0===e)return"$0";const t=Math.round(Number(e));return"$".concat(t.toLocaleString())},R=e=>null===e||void 0===e?"0":Number(e).toLocaleString(),D=(e,t)=>{if(!p)return null;const r="number"===typeof t?t:0;if(0===r)return null;console.log("[DEBUG] getEstimatedRevenueTooltipData called with:",{date:e,originalValue:t,safeValue:r,valueType:typeof t,selectedUserId:p,selectedProductId:m});const n=O[p];if(!n||!n[e])return console.warn("[WARN] No user metrics found for user ".concat(p," on date ").concat(e)),null;const a=n[e],s=a.tooltip_data;return console.log("[DEBUG] Backend tooltip data for ".concat(p," on ").concat(e,":"),{hasTooltipData:!!s,tooltipData:s,dayMetrics:a}),s?{value:r,breakdown:s.breakdown,result:"$".concat(r.toFixed(2))}:(console.warn("[WARN] No tooltip data found for user ".concat(p," on date ").concat(e)),null)},I=[{key:"daily_trial_started",label:"Trial Started",category:"daily_absolute",categoryLabel:"Daily Absolute Values",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_started)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_started)||0},format:R},{key:"daily_trial_pending",label:"Trial Pending",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_pending)||0},getCumulativeValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_pending)||0},format:R},{key:"daily_trial_ended",label:"Trial Ended",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_ended)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_ended)||0},format:R},{key:"daily_trial_cancelled",label:"Trial Cancelled",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_cancelled)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_cancelled)||0},format:R},{key:"daily_trial_converted",label:"Trial Converted",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.trial_converted)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_trial_converted)||0},format:R},{key:"daily_initial_purchase",label:"Initial Purchase",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.initial_purchase)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_initial_purchase)||0},format:R},{key:"daily_subscription_active",label:"Subscription Active",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.subscription_active)||0},getCumulativeValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.subscription_active)||0},format:R},{key:"daily_subscription_cancelled",label:"Subscription Cancelled",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.subscription_cancelled)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_subscription_cancelled)||0},format:R},{key:"daily_users",label:"Daily Users",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.daily_users)||0},getCumulativeValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.cumulative_users)||0},format:R},{key:"daily_refund_count",label:"Refunds",category:"daily_absolute",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.refund_count)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_refund_count)||0},format:R},{key:"daily_revenue",label:"Revenue",category:"revenue",categoryLabel:"Revenue Values",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.revenue)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_revenue)||0},format:M},{key:"daily_refund",label:"Refunds",category:"revenue",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.refund)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_refund)||0},format:M},{key:"daily_revenue_net",label:"Net Revenue",category:"revenue",getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.revenue_net)||0},getCumulativeValue:e=>{var t;return(null===(t=T.cumulativeMetrics[e])||void 0===t?void 0:t.cumulative_revenue_net)||0},format:M},{key:"daily_estimated_revenue",label:"Estimated Revenue",category:"revenue",isEstimatedRevenue:!0,getValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0},getCumulativeValue:e=>{var t;return(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0},format:M,getTooltipData:e=>{var t,r;const n=f?(null===(t=T.dailyMetrics[e])||void 0===t?void 0:t.estimated_revenue)||0:(null===(r=T.dailyMetrics[e])||void 0===r?void 0:r.estimated_revenue)||0;return D(e,n)}}],L=I.reduce((e,t)=>(e[t.category]||(e[t.category]={label:t.categoryLabel||t.category,metrics:[]}),e[t.category].metrics.push(t),e),{});return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"mb-8 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Event & Revenue Timeline"}),(0,ut.jsx)("div",{className:"flex gap-2",children:(0,ut.jsx)("button",{onClick:()=>g(!f),className:"px-3 py-1 text-sm rounded-full ".concat(f?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-white"),children:f?"Show Daily":"Show Cumulative"})})]}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full text-sm border dark:border-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-left text-gray-700 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-700 z-10 min-w-[200px]",children:"Metric"}),j.map(e=>(0,ut.jsx)("th",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white whitespace-nowrap min-w-[80px]",children:e},e))]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800",children:Object.entries(L).map(e=>{let[t,r]=e;return(0,ut.jsxs)(s.Fragment,{children:[(0,ut.jsx)("tr",{className:"bg-gray-100 dark:bg-gray-600",children:(0,ut.jsx)("td",{colSpan:j.length+1,className:"p-2 font-semibold text-gray-800 dark:text-white border-b dark:border-gray-600",children:r.label})}),r.metrics.map(e=>(0,ut.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 font-medium text-gray-700 dark:text-white sticky left-0 bg-white dark:bg-gray-800 z-10",children:e.label}),j.map(t=>{const r=f?e.getCumulativeValue(t):e.getValue(t);return(0,ut.jsx)("td",{className:"p-2 border-b dark:border-gray-600 text-center text-gray-700 dark:text-white ".concat(e.isEstimatedRevenue&&p?"cursor-help hover:bg-yellow-50 dark:hover:bg-yellow-900/20 relative":""),onMouseEnter:e.isEstimatedRevenue&&p?e=>{if(!p)return;_.current&&(clearTimeout(_.current),_.current=null);const n=setTimeout(()=>{const n=e.target.getBoundingClientRect(),a=D(t,r);if(a){b(a);const e=480,t=480,r=window.innerWidth-n.right,s=n.left;let i,o;i=r>=e+20?n.right+10:s>=e+20?n.left-e-10:Math.max(10,(window.innerWidth-e)/2);const l=n.top+n.height/2;o=Math.max(10,l-t),o=Math.min(o,window.innerHeight-t-10),v({x:i,y:o})}},150);_.current=n}:void 0,onMouseLeave:e.isEstimatedRevenue&&p?()=>{if(!p)return;_.current&&(clearTimeout(_.current),_.current=null);const e=setTimeout(()=>{b(null)},100);_.current=e}:void 0,children:e.format(r)},t)})]},e.key))]},t)})})]})}),0===j.length&&(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})})]}),(0,ut.jsx)(IL,{data:x,position:y,onClose:()=>b(null),selectedUserId:p,selectedProductId:m})]})},FL=e=>{var t,r,n,a;let{data:i}=e;const[o,l]=(0,s.useState)("daily");if(null===i||void 0===i||!i.data)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available for revenue charts. Run an analysis to see results."})});const c=i.data.timeline_data,d=i.data.arpu_data,u=(null===c||void 0===c||null===(t=c.dates)||void 0===t?void 0:t.map(e=>{var t,r,n,a,s,i;return{date:e,revenue:(null===(t=c.daily_metrics)||void 0===t||null===(r=t[e])||void 0===r?void 0:r.revenue)||0,trial_events:(null===(n=c.daily_metrics)||void 0===n||null===(a=n[e])||void 0===a?void 0:a.trial_events)||0,purchase_events:(null===(s=c.daily_metrics)||void 0===s||null===(i=s[e])||void 0===i?void 0:i.purchase_events)||0}}))||[],h=null!==d&&void 0!==d&&d.per_product?Object.entries(d.per_product).map(e=>{let[t,r]=e;return{productId:t.length>20?t.substring(0,20)+"...":t,fullProductId:t,arpu:r.arpu||0,totalRevenue:r.total_revenue||0,payingUsers:r.paying_users||0}}).sort((e,t)=>t.arpu-e.arpu):[],p=e=>null===e||void 0===e?"$0.00":"$".concat(Number(e).toFixed(2)),m=e=>{let{data:t,valueKey:r,labelKey:n,title:a,color:s="blue"}=e;if(!t||0===t.length)return null;const i=Math.max(...t.map(e=>e[r])),o={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",orange:"bg-orange-500"};return(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a}),(0,ut.jsx)("div",{className:"space-y-2",children:t.slice(0,10).map((e,t)=>{const a=i>0?e[r]/i*100:0;return(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("div",{className:"w-24 text-xs text-gray-600 dark:text-gray-400 truncate",children:e[n]}),(0,ut.jsxs)("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 relative",children:[(0,ut.jsx)("div",{className:"".concat(o[s]," h-6 rounded-full transition-all duration-300"),style:{width:"".concat(a,"%")}}),(0,ut.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-white",children:"revenue"===r||"arpu"===r||"totalRevenue"===r?p(e[r]):e[r]})]})]},t)})})]})},f=e=>{let{data:t,valueKey:r,title:n,color:a="blue"}=e;if(!t||0===t.length)return null;const s=Math.max(...t.map(e=>e[r])),i=Math.min(...t.map(e=>e[r])),o=s-i;return(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("svg",{width:"100%",height:"200",className:"overflow-visible",children:[[0,25,50,75,100].map(e=>(0,ut.jsx)("line",{x1:"0",y1:2*e,x2:"100%",y2:2*e,stroke:"#e5e7eb",strokeWidth:"1"},e)),(0,ut.jsx)("polyline",{fill:"none",stroke:"blue"===a?"#3b82f6":"green"===a?"#10b981":"purple"===a?"#8b5cf6":"#f59e0b",strokeWidth:"2",points:t.map((e,n)=>{const a=n/(t.length-1)*100,s=o>0?200-(e[r]-i)/o*180:100;return"".concat(a,"%,").concat(s)}).join(" ")}),t.map((e,n)=>{const s=n/(t.length-1)*100,l=o>0?200-(e[r]-i)/o*180:100;return(0,ut.jsx)("circle",{cx:"".concat(s,"%"),cy:l,r:"4",fill:"blue"===a?"#3b82f6":"green"===a?"#10b981":"purple"===a?"#8b5cf6":"#f59e0b",className:"hover:r-6 transition-all",children:(0,ut.jsx)("title",{children:"".concat(e.date,": ").concat("revenue"===r?p(e[r]):e[r])})},n)})]}),(0,ut.jsx)("div",{className:"flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400",children:t.filter((e,r)=>r%Math.ceil(t.length/5)===0).map((e,t)=>{return(0,ut.jsx)("span",{children:(r=e.date,new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}))},t);var r})})]})]})};return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsx)("div",{className:"flex space-x-4 border-b border-gray-200 dark:border-gray-700",children:[{id:"daily",label:"Daily Revenue"},{id:"arpu",label:"ARPU by Product"},{id:"events",label:"Event Trends"}].map(e=>(0,ut.jsx)("button",{onClick:()=>l(e.id),className:"px-4 py-2 text-sm font-medium border-b-2 transition-colors ".concat(o===e.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:e.label},e.id))}),(0,ut.jsxs)("div",{className:"min-h-96",children:["daily"===o&&(0,ut.jsx)(f,{data:u,valueKey:"revenue",title:"Daily Revenue Trend",color:"green"}),"arpu"===o&&(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,ut.jsx)(m,{data:h,valueKey:"arpu",labelKey:"productId",title:"ARPU by Product",color:"purple"}),(0,ut.jsx)(m,{data:h,valueKey:"totalRevenue",labelKey:"productId",title:"Total Revenue by Product",color:"green"})]}),"events"===o&&(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsx)(f,{data:u,valueKey:"trial_events",title:"Daily Trial Events",color:"blue"}),(0,ut.jsx)(f,{data:u,valueKey:"purchase_events",title:"Daily Purchase Events",color:"orange"})]})]}),(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Revenue Summary"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Total Revenue"}),(0,ut.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:p(null===d||void 0===d||null===(r=d.cohort_wide)||void 0===r?void 0:r.total_revenue)})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Average ARPU"}),(0,ut.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:p(null===d||void 0===d||null===(n=d.cohort_wide)||void 0===n?void 0:n.arpu)})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Paying Users"}),(0,ut.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:(null===d||void 0===d||null===(a=d.cohort_wide)||void 0===a?void 0:a.paying_users)||0})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Products"}),(0,ut.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:h.length})]})]})]})]})},BL=e=>{var t,r,n,a,i,o,l,c,d,u;let{data:h}=e;const[p,m]=(0,s.useState)(""),[f,g]=(0,s.useState)("all"),[x,b]=(0,s.useState)(new Set);if(console.log("[DEBUG] UserTimelineViewer received data:",h),console.log("[DEBUG] Data structure check:",{hasData:!!h,hasDataData:!(null===h||void 0===h||!h.data),hasUserTimelines:!(null===h||void 0===h||null===(t=h.data)||void 0===t||!t.user_timelines),hasTimelineData:!(null===h||void 0===h||null===(r=h.data)||void 0===r||!r.timeline_data),hasStructuredFormat:!(null===h||void 0===h||null===(n=h.data)||void 0===n||!n.structured_format),hasTimelineAnalysis:!(null===h||void 0===h||null===(a=h.data)||void 0===a||null===(i=a.structured_format)||void 0===i||!i.timeline_analysis),dataKeys:h?Object.keys(h):[],dataDataKeys:null!==h&&void 0!==h&&h.data?Object.keys(h.data):[]}),(null===h||void 0===h||null===(o=h.data)||void 0===o||!o.user_timelines)&&(null===h||void 0===h||null===(l=h.data)||void 0===l||!l.timeline_data)&&(null===h||void 0===h||null===(c=h.data)||void 0===c||null===(d=c.structured_format)||void 0===d||!d.timeline_analysis)&&(null===h||void 0===h||!h.data))return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})});let y,v={};if(null!==(u=h.data.structured_format)&&void 0!==u&&u.timeline_analysis)y=h.data.structured_format.timeline_analysis,v=y.user_timelines||{},console.log("[DEBUG] Using unified pipeline format. Timeline data:",y),console.log("[DEBUG] User timelines keys:",Object.keys(v)),console.log("[DEBUG] Sample user timeline:",Object.keys(v).slice(0,1).map(e=>({userId:e,data:v[e]})));else if(h.data.timeline_data&&h.data.timeline_data.user_timelines)y=h.data.timeline_data,v=y.user_timelines||{};else if(h.data.user_timelines&&"object"===typeof h.data.user_timelines&&h.data.user_timelines.users)y=h.data.user_timelines,y.users&&y.events&&y.users.forEach(e=>{v[e.id]={events:Object.values(y.events[e.user_product_key]||{}).flat()||[]}});else{if(!h.data.user_timelines)return(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No timeline data available. Run an analysis to see results."})});y=h.data,v=h.data.user_timelines||{}}const _=Object.keys(v),k=p&&v[p]&&v[p].events||[],j=k.filter(e=>{var t,r;return"all"===f||("trial"===f?null===(t=e.event_name)||void 0===t?void 0:t.toLowerCase().includes("trial"):"purchase"===f?null===(r=e.event_name)||void 0===r?void 0:r.toLowerCase().includes("purchase"):"revenue"!==f||e.revenue&&e.revenue>0)}),w=e=>null===e||void 0===e?"$0.00":"$".concat(Number(e).toFixed(2)),N=e=>new Date(e).toLocaleString(),S=p&&v[p]?{totalEvents:k.length,totalRevenue:k.reduce((e,t)=>e+(t.revenue||0),0),trialEvents:k.filter(e=>{var t;return null===(t=e.event_name)||void 0===t?void 0:t.toLowerCase().includes("trial")}).length,purchaseEvents:k.filter(e=>{var t;return null===(t=e.event_name)||void 0===t?void 0:t.toLowerCase().includes("purchase")}).length,firstEvent:k.length>0?k[0].timestamp:null,lastEvent:k.length>0?k[k.length-1].timestamp:null}:null;return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select User"}),(0,ut.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[(0,ut.jsx)("option",{value:"",children:"Choose a user..."}),_.slice(0,100).map(e=>(0,ut.jsx)("option",{value:e,children:e.length>30?e.substring(0,30)+"...":e},e))]}),(0,ut.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing first 100 users (",_.length," total)"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Event Filter"}),(0,ut.jsxs)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[(0,ut.jsx)("option",{value:"all",children:"All Events"}),(0,ut.jsx)("option",{value:"trial",children:"Trial Events"}),(0,ut.jsx)("option",{value:"purchase",children:"Purchase Events"}),(0,ut.jsx)("option",{value:"revenue",children:"Revenue Events"})]})]})]}),S&&(0,ut.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg p-6 border border-indigo-200 dark:border-indigo-800",children:[(0,ut.jsxs)("h3",{className:"text-xl font-semibold text-indigo-900 dark:text-indigo-200 mb-4",children:["User Summary: ",p]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:S.totalEvents}),(0,ut.jsx)("div",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:"Total Events"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:w(S.totalRevenue)}),(0,ut.jsx)("div",{className:"text-sm text-green-700 dark:text-green-300",children:"Total Revenue"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:S.trialEvents}),(0,ut.jsx)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Trial Events"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:S.purchaseEvents}),(0,ut.jsx)("div",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Purchase Events"})]})]}),S.firstEvent&&S.lastEvent&&(0,ut.jsxs)("div",{className:"mt-4 pt-4 border-t border-indigo-200 dark:border-indigo-700 text-sm text-indigo-700 dark:text-indigo-300",children:[(0,ut.jsx)("strong",{children:"Activity Period:"})," ",N(S.firstEvent)," \u2192 ",N(S.lastEvent)]})]}),p&&(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ut.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Event Timeline"}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",j.length," of ",k.length," events"]})]}),j.length>0?(0,ut.jsx)("div",{className:"space-y-3",children:j.map((e,t)=>{const r=x.has(t),n=(e=>{const t=(null===e||void 0===e?void 0:e.toLowerCase())||"";return t.includes("trial")?"blue":t.includes("purchase")?"green":t.includes("revenue")?"purple":"gray"})(e.event_name),a=(e=>{const t=(null===e||void 0===e?void 0:e.toLowerCase())||"";return t.includes("trial")?"\ud83d\udd04":t.includes("purchase")?"\ud83d\udcb0":t.includes("revenue")?"\ud83d\udcb5":"\ud83d\udcca"})(e.event_name);return(0,ut.jsxs)("div",{className:"border rounded-lg p-4 ".concat({blue:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-900/20",green:"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20",purple:"border-purple-200 bg-purple-50 dark:border-purple-800 dark:bg-purple-900/20",gray:"border-gray-200 bg-gray-50 dark:border-gray-600 dark:bg-gray-700"}[n]," transition-all duration-200"),children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>(e=>{const t=new Set(x);t.has(e)?t.delete(e):t.add(e),b(t)})(t),children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("span",{className:"text-lg",children:a}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.event_name||"Unknown Event"}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:N(e.timestamp)})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[e.revenue&&e.revenue>0&&(0,ut.jsx)("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:w(e.revenue)}),(0,ut.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r?"\u25bc":"\u25b6"})]})]}),r&&(0,ut.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.product_id&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Product ID:"}),(0,ut.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:e.product_id})]}),e.revenue&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Revenue:"}),(0,ut.jsx)("span",{className:"ml-2 text-green-600 dark:text-green-400",children:w(e.revenue)})]}),e.properties&&Object.keys(e.properties).length>0&&(0,ut.jsxs)("div",{className:"md:col-span-2",children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Properties:"}),(0,ut.jsx)("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 rounded p-2 text-xs",children:(0,ut.jsx)("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(e.properties,null,2)})})]})]})})]},t)})}):p?(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No events found for the selected filter."})}):null]}),!p&&(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc64"}),(0,ut.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a User"}),(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a user from the dropdown above to view their detailed event timeline."})]})]})},UL=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const r=await fetch("".concat("/api/v2/cohort").concat(e),Ie({headers:Ie({"Content-Type":"application/json"},t.headers)},t)),n=await r.json();if(!r.ok)throw new Error(n.error||"HTTP error! status: ".concat(r.status));return n}catch(r){throw console.error("API request failed for ".concat(e,":"),r),r}},zL={transformForCharts:e=>{var t;if(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.timeline_data)return null;const r=e.data.timeline_data,n=r.dates||[],a=r.daily_metrics||{};return n.map(e=>Ie({date:e},a[e]))},transformARPUData:e=>{var t;if(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.arpu_data)return null;const r=e.data.arpu_data;return{cohortWide:r.cohort_wide||{},perProduct:r.per_product||{}}},transformLifecycleRates:e=>{var t;if(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.lifecycle_rates)return null;const r=e.data.lifecycle_rates;return{aggregate:r.aggregate||{},perProduct:r.per_product||{}}},extractSummaryStats:e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.cohort_summary?e.data.cohort_summary:null}},VL={isValidationError:e=>e.message&&e.message.includes("validation"),isDatabaseError:e=>e.message&&e.message.includes("database"),getUserFriendlyMessage:e=>VL.isValidationError(e)?"Please check your input parameters and try again.":VL.isDatabaseError(e)?"Database connection issue. Please try again later.":e.message||"An unexpected error occurred."},HL=async e=>UL("/analyze",{method:"POST",body:JSON.stringify(e)}),WL=async e=>UL("/arpu-only",{method:"POST",body:JSON.stringify(e)}),qL=async e=>UL("/lifecycle-only",{method:"POST",body:JSON.stringify(e)}),GL=async e=>UL("/timeline",{method:"POST",body:JSON.stringify(e)}),$L=async e=>UL("/validate",{method:"POST",body:JSON.stringify(e)}),KL=async()=>UL("/performance",{method:"GET"}),YL=async()=>UL("/health",{method:"GET"}),XL={runToStage:async(e,t)=>UL("/analyze",{method:"POST",body:JSON.stringify(Ie(Ie({},e),{},{debug_mode:!0,debug_stage:t}))}),getStageResults:async(e,t)=>{const r=Ie(Ie({},e),{},{debug_mode:!0,debug_stage:t});return console.log("[API DEBUG] Calling /api/v2/cohort/analyze with debug payload:",r),console.log("[API DEBUG] debug_mode:",r.debug_mode),console.log("[API DEBUG] debug_stage:",r.debug_stage),UL("/analyze",{method:"POST",body:JSON.stringify(r)})}},JL=zL,QL=()=>{const e="cohort_pipeline_analysis_params",t={date_from:"2025-01-01",date_to:"2025-01-31",optional_filters:[],primary_user_filter:{property_name:"",property_values:[]},secondary_filters:[],config:{product_filter:{include_patterns:["gluten"],exclude_patterns:[],specific_product_ids:["prod_R7oYuL3bSUecnr"]},lifecycle:{trial_window_days:7,cancellation_window_days:30,smoothing_enabled:!0},timeline:{include_estimates:!0,include_confidence_intervals:!1},detailed_events:{user_id:""}}},[r,n]=(0,s.useState)(()=>{try{const i=localStorage.getItem(e);if(i){var r,n,a,s;const e=JSON.parse(i);return Ie(Ie(Ie({},t),e),{},{optional_filters:e.optional_filters||[],secondary_filters:e.secondary_filters||[],config:Ie(Ie(Ie({},t.config),e.config),{},{product_filter:Ie(Ie({},t.config.product_filter),null===(r=e.config)||void 0===r?void 0:r.product_filter),lifecycle:Ie(Ie({},t.config.lifecycle),null===(n=e.config)||void 0===n?void 0:n.lifecycle),timeline:Ie(Ie({},t.config.timeline),null===(a=e.config)||void 0===a?void 0:a.timeline),detailed_events:Ie(Ie({},t.config.detailed_events),null===(s=e.config)||void 0===s?void 0:s.detailed_events)})})}}catch(u){console.warn("Failed to load saved analysis parameters:",u)}return t}),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(t=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(u){console.warn("Failed to save analysis parameters:",u)}})(r),i(!0);const t=setTimeout(()=>i(!1),1e3);return()=>clearTimeout(t)},[r]);const{pipelineData:c,loading:d,error:u,runAnalysis:h,runStageAnalysis:p}=(()=>{const[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),c=(0,s.useCallback)(()=>{i(null)},[]),d=(0,s.useCallback)(async e=>{n(!0),i(null);try{console.log("Running full analysis with params:",e);const r=await HL(e);return console.log("Analysis result:",r),t(r),l(e),r}catch(r){console.error("Analysis failed:",r);const e=VL.getUserFriendlyMessage(r);throw i(e),r}finally{n(!1)}},[]),u=(0,s.useCallback)(async e=>{n(!0),i(null);try{console.log("Running ARPU analysis with params:",e);const r=await WL(e);return t(e=>{var t;return Ie(Ie({},e),{},{data:Ie(Ie({},null===e||void 0===e?void 0:e.data),{},{arpu_data:null===(t=r.data)||void 0===t?void 0:t.arpu_data})})}),r}catch(r){console.error("ARPU analysis failed:",r);const e=VL.getUserFriendlyMessage(r);throw i(e),r}finally{n(!1)}},[]),h=(0,s.useCallback)(async e=>{n(!0),i(null);try{console.log("Running lifecycle analysis with params:",e);const r=await qL(e);return t(e=>{var t;return Ie(Ie({},e),{},{data:Ie(Ie({},null===e||void 0===e?void 0:e.data),{},{lifecycle_rates:null===(t=r.data)||void 0===t?void 0:t.lifecycle_rates})})}),r}catch(r){console.error("Lifecycle analysis failed:",r);const e=VL.getUserFriendlyMessage(r);throw i(e),r}finally{n(!1)}},[]),p=(0,s.useCallback)(async e=>{n(!0),i(null);try{console.log("Generating timeline with params:",e);const r=await GL(e);return t(e=>{var t;return Ie(Ie({},e),{},{data:Ie(Ie({},null===e||void 0===e?void 0:e.data),{},{timeline_data:null===(t=r.data)||void 0===t?void 0:t.timeline_data})})}),r}catch(r){console.error("Timeline generation failed:",r);const e=VL.getUserFriendlyMessage(r);throw i(e),r}finally{n(!1)}},[]),m=(0,s.useCallback)(async(e,r)=>{n(!0),i(null);try{console.log("Running stage analysis for ".concat(r," with params:"),e);const n=await XL.getStageResults(e,r);return console.log("Stage ".concat(r," result:"),n),t(n),l(Ie(Ie({},e),{},{debug_stage:r})),n}catch(a){console.error("Stage ".concat(r," analysis failed:"),a);const e=VL.getUserFriendlyMessage(a);throw i(e),a}finally{n(!1)}},[]),f=(0,s.useCallback)(async e=>{try{console.log("Validating inputs:",e);const t=await $L(e);return console.log("Validation result:",t),t}catch(t){throw console.error("Input validation failed:",t),t}},[]),g=(0,s.useCallback)(async()=>{try{const e=await KL();return console.log("Performance report:",e),e}catch(e){throw console.error("Failed to get performance report:",e),e}},[]),x=(0,s.useCallback)(async()=>{try{const e=await YL();return console.log("Health check result:",e),e}catch(e){throw console.error("Health check failed:",e),e}},[]),b=(0,s.useCallback)(()=>{t(null),i(null),l(null)},[]),y=(0,s.useCallback)(()=>e?{charts:JL.transformForCharts(e),arpu:JL.transformARPUData(e),lifecycle:JL.transformLifecycleRates(e),summary:JL.extractSummaryStats(e)}:null,[e]);return{pipelineData:e,loading:r,error:a,lastAnalysisParams:o,runAnalysis:d,runARPUAnalysis:u,runLifecycleAnalysis:h,generateTimeline:p,runStageAnalysis:m,validateInputs:f,getPerformanceReport:g,healthCheck:x,resetData:b,clearError:c,transformedData:y(),isValidationError:!!a&&VL.isValidationError({message:a}),isDatabaseError:!!a&&VL.isDatabaseError({message:a})}})(),{debugMode:m,debugStage:f,setDebugMode:g,setDebugStage:x}=EL();return(0,ut.jsx)("div",{className:"cohort-pipeline-page min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Cohort Pipeline Debug & Analysis"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Advanced cohort analysis with modular pipeline architecture and debug capabilities"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-green-600 dark:text-green-400 text-sm",children:[(0,ut.jsx)("span",{children:"\ud83d\udcbe"}),(0,ut.jsx)("span",{children:"Saved"})]}),(0,ut.jsx)("button",{onClick:()=>{n(t),localStorage.removeItem(e)},className:"px-3 py-2 text-sm bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors",title:"Reset all settings to defaults",children:"Reset to Defaults"}),(0,ut.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to clear all saved settings and debug state? This cannot be undone.")&&(localStorage.removeItem(e),localStorage.removeItem("cohort_pipeline_debug_mode"),n(t),g(!1),x(null))},className:"px-3 py-2 text-sm bg-red-200 hover:bg-red-300 dark:bg-red-700 dark:hover:bg-red-600 text-red-700 dark:text-red-300 rounded-lg transition-colors",title:"Clear all saved data including debug state",children:"Clear All Data"}),(0,ut.jsx)("button",{onClick:()=>{const e={analysisParams:r,debugState:{debugMode:m,debugStage:f},exportedAt:(new Date).toISOString(),version:"1.0"},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download="cohort_analysis_settings_".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)},className:"px-3 py-2 text-sm bg-blue-200 hover:bg-blue-300 dark:bg-blue-700 dark:hover:bg-blue-600 text-blue-700 dark:text-blue-300 rounded-lg transition-colors",title:"Export current settings to JSON file",children:"Export Settings"}),(0,ut.jsxs)("label",{className:"px-3 py-2 text-sm bg-green-200 hover:bg-green-300 dark:bg-green-700 dark:hover:bg-green-600 text-green-700 dark:text-green-300 rounded-lg transition-colors cursor-pointer",children:["Import Settings",(0,ut.jsx)("input",{type:"file",accept:".json",onChange:e=>{const r=e.target.files[0];if(r){const e=new FileReader;e.onload=e=>{try{const r=JSON.parse(e.target.result);if(r.analysisParams){const e=Ie(Ie(Ie({},t),r.analysisParams),{},{secondary_filters:r.analysisParams.secondary_filters||[],config:Ie(Ie({},t.config),r.analysisParams.config)});n(e),r.debugState&&(g(r.debugState.debugMode||!1),x(r.debugState.debugStage||null))}else{const e=Ie(Ie(Ie({},t),r),{},{secondary_filters:r.secondary_filters||[],config:Ie(Ie({},t.config),r.config)});n(e)}alert("Settings imported successfully!")}catch(u){alert("Failed to import settings: Invalid JSON file")}},e.readAsText(r)}e.target.value=""},className:"hidden"})]})]})]}),(0,ut.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,ut.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\ud83d\udcbe Settings are automatically saved and will persist across page reloads"}),(0,ut.jsxs)("button",{onClick:()=>l(!o),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:[o?"Hide":"Show"," saved data"]})]}),o&&(0,ut.jsxs)("div",{className:"mt-4 bg-gray-100 dark:bg-gray-800 rounded-lg p-4 border",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Currently Saved Data"}),(0,ut.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Analysis Parameters:"}),(0,ut.jsx)("div",{className:"mt-1 bg-white dark:bg-gray-900 rounded p-2 overflow-auto max-h-32",children:(0,ut.jsx)("pre",{className:"text-gray-600 dark:text-gray-400",children:JSON.stringify(r,null,2)})})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Debug State:"}),(0,ut.jsx)("div",{className:"mt-1 bg-white dark:bg-gray-900 rounded p-2",children:(0,ut.jsx)("pre",{className:"text-gray-600 dark:text-gray-400",children:JSON.stringify({debugMode:m,debugStage:f,lastSaved:(new Date).toLocaleString()},null,2)})})]}),(0,ut.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:["Storage keys: ",(0,ut.jsx)("code",{children:"cohort_pipeline_analysis_params"}),", ",(0,ut.jsx)("code",{children:"cohort_pipeline_debug_mode"})]})]})]})]}),(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsx)(AL,{debugMode:m,debugStage:f,onDebugModeChange:g,onDebugStageChange:x,onRunAnalysis:()=>{m&&f?p(r,f):h(r)},loading:d,error:u})}),(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsx)(dL,{config:r.config,analysisParams:r,onConfigChange:e=>{n(e)}})}),d&&(0,ut.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,ut.jsx)("span",{className:"ml-3 text-lg text-gray-600 dark:text-gray-400",children:"Running analysis..."})]}),u&&(0,ut.jsxs)("div",{className:"mb-8 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200 mb-2",children:"Analysis Error"}),(0,ut.jsx)("p",{className:"text-red-600 dark:text-red-300",children:u})]}),c&&!d&&(0,ut.jsxs)("div",{className:"space-y-8",children:[(0,ut.jsx)(fL,{data:c}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"ARPU Analysis"}),(0,ut.jsx)(DL,{data:c})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Lifecycle Rates"}),(0,ut.jsx)(RL,{data:c})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Event Timeline"}),(0,ut.jsx)(LL,{data:c})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Individual User Timeline"}),(0,ut.jsx)(BL,{data:c})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Revenue Visualizations"}),(0,ut.jsx)(FL,{data:c})]}),m&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,ut.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Debug Data"}),(0,ut.jsx)(uL,{data:c,debugStage:f})]})]})]})})},ZL=e=>{let{error:t,success:r,onClearError:n,onClearSuccess:a}=e;return(0,ut.jsxs)(ut.Fragment,{children:[t&&(0,ut.jsx)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(gL,{className:"h-5 w-5 text-red-400 mr-3"}),(0,ut.jsx)("div",{className:"flex-1",children:(0,ut.jsx)("p",{className:"text-red-800 dark:text-red-200",children:t})}),(0,ut.jsx)("button",{onClick:n,className:"text-red-400 hover:text-red-600",children:(0,ut.jsx)(Dt,{className:"h-5 w-5"})})]})}),r&&(0,ut.jsx)("div",{className:"mb-6 bg-green-50 dark:bg-green-900/50 border border-green-200 dark:border-green-800 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(Bt,{className:"h-5 w-5 text-green-400 mr-3"}),(0,ut.jsx)("div",{className:"flex-1",children:(0,ut.jsx)("p",{className:"text-green-800 dark:text-green-200",children:r})}),(0,ut.jsx)("button",{onClick:a,className:"text-green-400 hover:text-green-600",children:(0,ut.jsx)(Dt,{className:"h-5 w-5"})})]})})]})},eF=[{value:"all",label:"All Time",description:"Analyze all historical data"},{value:"1month",label:"Last 1 Month",description:"Last 30 days"},{value:"3months",label:"Last 3 Months",description:"Last 90 days"},{value:"6months",label:"Last 6 Months",description:"Last 180 days"},{value:"1year",label:"Last 1 Year",description:"Last 365 days"}],tF=e=>{if("all"===e)return{start:null,end:null};const t=new Date;return{start:new Date("2024-01-01").toISOString().split("T")[0],end:t.toISOString().split("T")[0]}},rF=e=>"".concat((100*e).toFixed(2),"%"),nF=e=>({APP_STORE:"App Store",PLAY_STORE:"Play Store",STRIPE:"Stripe"}[e]||e),aF=e=>e?e.length<=8?e:"".concat(e.slice(0,4),"...").concat(e.slice(-4)):"No ID",sF=e=>{if(!e)return{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200",darkBg:"dark:bg-gray-900",darkText:"dark:text-gray-200",darkBorder:"dark:border-gray-700"};let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}const r=[{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-200",darkBg:"dark:bg-blue-900",darkText:"dark:text-blue-200",darkBorder:"dark:border-blue-700"},{bg:"bg-green-100",text:"text-green-800",border:"border-green-200",darkBg:"dark:bg-green-900",darkText:"dark:text-green-200",darkBorder:"dark:border-green-700"},{bg:"bg-purple-100",text:"text-purple-800",border:"border-purple-200",darkBg:"dark:bg-purple-900",darkText:"dark:text-purple-200",darkBorder:"dark:border-purple-700"},{bg:"bg-red-100",text:"text-red-800",border:"border-red-200",darkBg:"dark:bg-red-900",darkText:"dark:text-red-200",darkBorder:"dark:border-red-700"},{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200",darkBg:"dark:bg-yellow-900",darkText:"dark:text-yellow-200",darkBorder:"dark:border-yellow-700"},{bg:"bg-indigo-100",text:"text-indigo-800",border:"border-indigo-200",darkBg:"dark:bg-indigo-900",darkText:"dark:text-indigo-200",darkBorder:"dark:border-indigo-700"},{bg:"bg-pink-100",text:"text-pink-800",border:"border-pink-200",darkBg:"dark:bg-pink-900",darkText:"dark:text-pink-200",darkBorder:"dark:border-pink-700"},{bg:"bg-cyan-100",text:"text-cyan-800",border:"border-cyan-200",darkBg:"dark:bg-cyan-900",darkText:"dark:text-cyan-200",darkBorder:"dark:border-cyan-700"},{bg:"bg-emerald-100",text:"text-emerald-800",border:"border-emerald-200",darkBg:"dark:bg-emerald-900",darkText:"dark:text-emerald-200",darkBorder:"dark:border-emerald-700"},{bg:"bg-orange-100",text:"text-orange-800",border:"border-orange-200",darkBg:"dark:bg-orange-900",darkText:"dark:text-orange-200",darkBorder:"dark:border-orange-700"}];return r[Math.abs(t)%r.length]},iF=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Segment ID";const r=sF(e);return(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text," ").concat(r.darkBg," ").concat(r.darkText," ").concat(r.border," ").concat(r.darkBorder," border"),children:[(0,ut.jsxs)("span",{className:"mr-1",children:[t,":"]}),(0,ut.jsx)("span",{className:"font-mono",children:aF(e)})]})},oF=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Target";const r=sF(e);return(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text," ").concat(r.darkBg," ").concat(r.darkText," ").concat(r.border," ").concat(r.darkBorder," border"),children:[(0,ut.jsxs)("span",{className:"mr-1",children:["\u2192 ",t,":"]}),(0,ut.jsx)("span",{className:"font-mono",children:aF(e)})]})},lF=function(e,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e)return(0,ut.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"\u2705 PASSES"});let n=r;if(!n&&t&&(t.rollupReasons&&t.rollupReasons.length>0?n=t.rollupReasons[0]:t.rollupTarget&&(n=t.rollupTarget)),!n||""===n.trim())return(0,ut.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"\u274c INSUFFICIENT DATA"});let a=n;a=n.includes("Country-wide")?n:n.includes("Tier 1")||n.includes("tier1")?"Tier 1":n.includes("Tier 2")||n.includes("tier2")?"Tier 2":n.includes("Tier 3")||n.includes("tier3")?"Tier 3":n.includes("Tier 4")||n.includes("tier4")?"Tier 4":n.includes("$")&&n.includes("-")?n:n||"Unknown Target";const s=t?(0,ut.jsxs)("div",{className:"text-xs",children:[(0,ut.jsx)("div",{className:"font-medium mb-1",children:"Rollup Details:"}),(0,ut.jsxs)("div",{children:["\u2022 Final destination: ",n]}),t.finalUserCount&&(0,ut.jsxs)("div",{children:["\u2022 Final user count: ",t.finalUserCount.toLocaleString()]}),t.propertiesDropped&&t.propertiesDropped.length>0&&(0,ut.jsxs)("div",{children:["\u2022 Properties dropped: ",t.propertiesDropped.join(", ")]}),t.rollupReasons&&t.rollupReasons.length>0&&(0,ut.jsxs)("div",{children:["\u2022 Reason: ",t.rollupReasons[0]]})]}):null;return(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200 cursor-help",children:["\u2192 ",a]}),s&&(0,ut.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10 whitespace-nowrap max-w-xs",children:[s,(0,ut.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900 dark:border-t-gray-100"})]})]})},cF=(e,t)=>{const r={tier1_high_income:["US","CA","AU","NZ","GB","IE","DE","FR","NL","BE","AT","CH","LU","DK","SE","NO","FI","IS","IL","SG","HK","QA","AE","KW","BH","OM","SA","MC","LI","AD","MT","CY","IM","JE","GG","GI","BM","SM","KY","VI","AW","TC","VG","BQ","SX","MF","PM","AX","CW","MQ","GP","RE","FO","GL"],tier2_upper_middle:["JP","KR","TW","MO","IT","ES","PT","GR","SI","CZ","SK","EE","LV","LT","HR","HU","PL","RO","BG","MT","UY","CR","PA","PR","BN","MV","SC","MU","BB","BS","TT"],tier3_emerging:["BR","MX","AR","CL","CO","PE","EC","DO","JM","PY","GT","SV","HN","NI","BZ","VE","BO","GY","SR","CN","TH","MY","RU","TR","KZ","AZ","GE","AM","BY","UZ","KG","TJ","MN","FJ","TO","VU","PG","TL","ZA","NA","BW","MU","SC","RS","ME","MK","AL","BA","MD","UA","XK","LC","GD","KN","AG","DM"],tier4_developing:["IN","PK","BD","LK","NP","BT","AF","MV","ID","PH","VN","MM","KH","LA","EG","MA","TN","DZ","LY","SD","LB","JO","PS","SY","IQ","IR","YE","NG","KE","GH","TZ","UG","ET","RW","ZM","ZW","MW","MZ","AO","CM","CI","SN","ML","BF","NE","TD","CF","CD","CG","GA","GQ","ST","CV","GM","GW","SL","LR","BJ","TG","GH","BI","DJ","SO","ER","SS","MR","MG","KM","MU","SZ","LS","HT","CU","NC","PF","AS","GU","FM","MH","PW","NR","TV","KI","SB","WS","ST","CV"]},n=e=>{const t=Object.keys(e).sort().map(t=>"".concat(t,":").concat(e[t]||"null")).join("|");let r=0;for(let a=0;a<t.length;a++){r=(r<<5)-r+t.charCodeAt(a),r&=r}const n=Math.abs(r).toString(16).padStart(8,"0");return"".concat(n.slice(0,4),"-").concat(n.slice(4,8),"-seg-").concat(Date.now().toString().slice(-4))},a={};return e.forEach(e=>{const t=e.product_id,s=e.app_store||"Unknown Store",i=e.price_bucket,o=e.country||"Unknown",l=e.region,c=e.user_count,d=e.has_sufficient_data,u=e.properties_dropped||[],h=e.rollup_description||"",p=e.rollup_target||null,m=e.final_user_count||c,f=e.accuracy_score||"very_high",g=e.segment_id||n({product_id:t,app_store:s,price_bucket:i,country:o,region:l}),x=(e=>{for(const[t,n]of Object.entries(r))if(n.includes(e))return"Tier ".concat(t.split("_")[0].replace("tier",""));return"Tier 4"})(o),b="".concat(t,"|").concat(s,"|").concat(i);if(!a[b]){const e=n({product_id:t,app_store:s,price_bucket:i});a[b]={productId:t,appStore:s,priceRange:i,segmentId:e,totalUsers:0,passesThreshold:!1,rollupInfo:{hasRollups:!1,rolledUpSegments:0,totalSegments:0,rollupReasons:new Set,propertiesDropped:new Set,finalUserCount:0,rollupTarget:null,rollupTargetSegmentId:null},economicTiers:{}}}a[b].totalUsers+=c,a[b].rollupInfo.totalSegments+=1,a[b].rollupInfo.finalUserCount+=m,(!d||u.length>0)&&(a[b].rollupInfo.hasRollups=!0,a[b].rollupInfo.rolledUpSegments+=1,h&&a[b].rollupInfo.rollupReasons.add(h),p&&(a[b].rollupInfo.rollupTarget=p),u.forEach(e=>a[b].rollupInfo.propertiesDropped.add(e)));"".concat(b,"|").concat(x);if(!a[b].economicTiers[x]){const e=n({product_id:t,app_store:s,price_bucket:i,economic_tier:x});a[b].economicTiers[x]={tierName:x,segmentId:e,totalUsers:0,passesThreshold:!1,rollupInfo:{hasRollups:!1,rolledUpSegments:0,totalSegments:0,rollupReasons:new Set,propertiesDropped:new Set,finalUserCount:0,rollupTarget:null,rollupTargetSegmentId:null},countries:{}}}if(a[b].economicTiers[x].totalUsers+=c,a[b].economicTiers[x].rollupInfo.totalSegments+=1,a[b].economicTiers[x].rollupInfo.finalUserCount+=m,(!d||u.length>0)&&(a[b].economicTiers[x].rollupInfo.hasRollups=!0,a[b].economicTiers[x].rollupInfo.rolledUpSegments+=1,h&&a[b].economicTiers[x].rollupInfo.rollupReasons.add(h),p&&(a[b].economicTiers[x].rollupInfo.rollupTarget=p),u.forEach(e=>a[b].economicTiers[x].rollupInfo.propertiesDropped.add(e))),!a[b].economicTiers[x].countries[o]){const e=n({product_id:t,app_store:s,price_bucket:i,economic_tier:x,country:o});a[b].economicTiers[x].countries[o]={countryName:o,segmentId:e,totalUsers:0,passesThreshold:!1,rollupInfo:{hasRollups:!1,rolledUpSegments:0,totalSegments:0,rollupReasons:new Set,propertiesDropped:new Set,finalUserCount:0,rollupTarget:null,rollupTargetSegmentId:null},regions:[]}}if(a[b].economicTiers[x].countries[o].totalUsers+=c,a[b].economicTiers[x].countries[o].rollupInfo.totalSegments+=1,a[b].economicTiers[x].countries[o].rollupInfo.finalUserCount+=m,(!d||u.length>0)&&(a[b].economicTiers[x].countries[o].rollupInfo.hasRollups=!0,a[b].economicTiers[x].countries[o].rollupInfo.rolledUpSegments+=1,h&&a[b].economicTiers[x].countries[o].rollupInfo.rollupReasons.add(h),p&&(a[b].economicTiers[x].countries[o].rollupInfo.rollupTarget=p),u.forEach(e=>a[b].economicTiers[x].countries[o].rollupInfo.propertiesDropped.add(e))),l){const e=g;let t=null;(!d||u.length>0)&&(t=p&&p.includes("Country-wide")?a[b].economicTiers[x].countries[o].segmentId:p&&(p.includes("Tier")||p.includes("tier"))?a[b].economicTiers[x].segmentId:a[b].segmentId),a[b].economicTiers[x].countries[o].regions.push({name:l,segmentId:e,rollupTargetSegmentId:t,users:c,passes:d&&0===u.length,rollupTarget:p,rollupReason:h,accuracyScore:f,finalUserCount:m,originalUserCount:c,propertiesDropped:u})}}),Object.keys(a).forEach(e=>{const r=a[e];r.passesThreshold=r.totalUsers>=t,r.rollupInfo.rollupReasons=Array.from(r.rollupInfo.rollupReasons),r.rollupInfo.propertiesDropped=Array.from(r.rollupInfo.propertiesDropped),r.passesThreshold||(r.rollupInfo.rollupTargetSegmentId=null),Object.keys(r.economicTiers).forEach(e=>{const n=r.economicTiers[e];n.passesThreshold=n.totalUsers>=t,n.rollupInfo.rollupReasons=Array.from(n.rollupInfo.rollupReasons),n.rollupInfo.propertiesDropped=Array.from(n.rollupInfo.propertiesDropped),n.passesThreshold||(n.rollupInfo.rollupTargetSegmentId=r.segmentId),Object.keys(n.countries).forEach(e=>{const r=n.countries[e];r.passesThreshold=r.totalUsers>=t,r.rollupInfo.rollupReasons=Array.from(r.rollupInfo.rollupReasons),r.rollupInfo.propertiesDropped=Array.from(r.rollupInfo.propertiesDropped),r.passesThreshold||(r.rollupInfo.rollupTargetSegmentId=n.segmentId)})})}),a},dF=e=>{let{config:t,onConfigChange:r,onAnalyzeProperties:n,onStartAnalysis:a,onRunNewHierarchicalAnalysis:s,isAnalyzingProperties:i,isAnalyzing:o,isRunningNewAnalysis:l,propertyAnalysis:c}=e;const d=eF.find(e=>e.value===t.timeframe)||eF[0];return(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Step 1: Configure Analysis Parameters"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Set the time period and minimum group size for your analysis. These settings determine which data to analyze and how to group users."}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,ut.jsx)(Tt,{className:"inline h-4 w-4 mr-1"}),"Time Period"]}),(0,ut.jsx)("select",{value:t.timeframe,onChange:e=>r(Ie(Ie({},t),{},{timeframe:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",children:eF.map(e=>(0,ut.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:d.description})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,ut.jsx)(Qe,{className:"inline h-4 w-4 mr-1"}),"Minimum Group Size"]}),(0,ut.jsx)("input",{type:"number",min:"10",max:"1000",value:t.min_cohort_size,onChange:e=>r(Ie(Ie({},t),{},{min_cohort_size:parseInt(e.target.value)||50})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Minimum number of users required in each group for reliable statistics"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,ut.jsx)(Je,{className:"inline h-4 w-4 mr-1"}),"Minimum Price Samples"]}),(0,ut.jsx)("input",{type:"number",min:"10",max:"1000",value:t.min_price_samples,onChange:e=>r(Ie(Ie({},t),{},{min_price_samples:parseInt(e.target.value)||100})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Minimum price samples required per product for reliable price bucketing"})]})]}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 mb-6",children:(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,ut.jsx)(qe,{className:"inline h-4 w-4 mr-1"}),"Force Recalculation"]}),(0,ut.jsxs)("div",{className:"flex items-center mt-2",children:[(0,ut.jsx)("input",{type:"checkbox",checked:t.force_recalculate,onChange:e=>r(Ie(Ie({},t),{},{force_recalculate:e.target.checked})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,ut.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Recalculate even if cached results exist"})]}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Check this to ignore previously calculated results and run fresh analysis"})]})}),(0,ut.jsxs)("div",{className:"mb-6 p-4 border-2 border-emerald-200 dark:border-emerald-700 rounded-lg bg-emerald-50 dark:bg-emerald-900/20",children:[(0,ut.jsxs)("h3",{className:"text-lg font-semibold text-emerald-800 dark:text-emerald-200 mb-2 flex items-center",children:[(0,ut.jsx)(Lt,{className:"h-5 w-5 mr-2"}),"NEW: Enhanced Hierarchical Analysis"]}),(0,ut.jsx)("p",{className:"text-sm text-emerald-700 dark:text-emerald-300 mb-4",children:"Try our new 5-stage hierarchical pipeline with improved rollup methodology, better validation, and more accurate results."}),(0,ut.jsxs)("button",{onClick:s,disabled:l||o||i,className:"inline-flex items-center px-8 py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l?(0,ut.jsx)(qe,{className:"animate-spin h-5 w-5 mr-2"}):(0,ut.jsx)(Lt,{className:"h-5 w-5 mr-2"}),l?"Running New Analysis...":"Run New Conversion Analysis"]}),(0,ut.jsx)("div",{className:"mt-3 text-xs text-emerald-600 dark:text-emerald-400",children:"\u2728 Features: 5-stage validation \u2022 Tree-based rollup \u2022 Levels 3-6 only \u2022 Enhanced accuracy scoring"})]}),(0,ut.jsxs)("div",{className:"mb-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,ut.jsx)("h3",{className:"text-md font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Legacy Analysis System"}),(0,ut.jsxs)("div",{className:"flex gap-3",children:[(0,ut.jsxs)("button",{onClick:n,disabled:i||l,className:"inline-flex items-center px-6 py-3 border border-indigo-300 dark:border-indigo-600 rounded-md shadow-sm text-sm font-medium text-indigo-700 dark:text-indigo-300 bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?(0,ut.jsx)(qe,{className:"animate-spin h-5 w-5 mr-2"}):(0,ut.jsx)(Ye,{className:"h-5 w-5 mr-2"}),i?"Discovering...":"Discover Data Structure"]}),(0,ut.jsxs)("button",{onClick:a,disabled:o||i||l,className:"inline-flex items-center px-6 py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?(0,ut.jsx)(qe,{className:"animate-spin h-5 w-5 mr-2"}):(0,ut.jsx)(Je,{className:"h-5 w-5 mr-2"}),o?"Analyzing...":"Run Legacy Analysis"]})]})]}),!c&&(0,ut.jsx)("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(We,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mr-2"}),(0,ut.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,ut.jsx)("strong",{children:"Recommendation:"}),' Try the new hierarchical analysis above for better results, or use the legacy system below. You can optionally "Discover Data Structure" first to preview what will be analyzed.']})]})})]})})},uF=e=>{var t,r,n,a,i,o,l,c;let{propertyAnalysis:d,expandedSections:u,onToggleSection:h,config:p}=e;const[m,f]=(0,s.useState)({}),[g,x]=(0,s.useState)(!1),b=e=>{f(t=>Ie(Ie({},t),{},{[e]:!t[e]}))};if(!d)return null;const y=[];d.user_segments&&Object.values(d.user_segments).forEach(e=>{Array.isArray(e)&&y.push(...e)});const v=cF(y,p.min_cohort_size);return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[(0,ut.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,ut.jsxs)("button",{onClick:()=>h("propertyAnalysis"),className:"flex items-center justify-between w-full text-left",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Step 2: Data Structure Discovery Results"}),(0,ut.jsx)("span",{className:"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"\u2713 Complete"})]}),u.propertyAnalysis?(0,ut.jsx)(He,{className:"h-5 w-5 text-gray-500"}):(0,ut.jsx)(rt,{className:"h-5 w-5 text-gray-500"})]})}),u.propertyAnalysis&&(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[(0,ut.jsxs)("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-200 mb-2 flex items-center",children:[(0,ut.jsx)(Bt,{className:"h-4 w-4 mr-2"}),"What This Analysis Discovered"]}),(0,ut.jsx)("p",{className:"text-sm text-green-800 dark:text-green-300 mb-3",children:"We analyzed your actual users and grouped them into meaningful segments. Here's what we found:"}),(0,ut.jsxs)("ul",{className:"text-sm text-green-800 dark:text-green-300 space-y-1 list-disc list-inside",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsxs)("strong",{children:[d.products_analyzed," products"]})," with sufficient data for analysis (at least ",d.min_price_samples_used||100," price samples each)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsxs)("strong",{children:[d.total_combinations.toLocaleString()," viable user segments"]})," based on actual user data"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsxs)("strong",{children:[(null===(t=d.user_analysis)||void 0===t||null===(r=t.total_users_analyzed)||void 0===r?void 0:r.toLocaleString())||0," total users"]})," analyzed across all segments"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Geographic coverage:"})," ",(null===(n=d.user_analysis)||void 0===n?void 0:n.total_countries_found)||0," countries and ",(null===(a=d.user_analysis)||void 0===a?void 0:a.total_regions_found)||0," regions with active users"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"App stores:"})," ",(null===(i=d.user_analysis)||void 0===i||null===(o=i.app_stores)||void 0===o?void 0:o.length)||0," different stores"]})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,ut.jsxs)("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:d.products_analyzed}),(0,ut.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-medium",children:"Products Found"}),(0,ut.jsx)("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Products with enough data for reliable analysis"})]}),(0,ut.jsxs)("div",{className:"text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:Object.values(d.price_buckets||{}).reduce((e,t)=>e+t.length,0)}),(0,ut.jsx)("div",{className:"text-sm text-purple-800 dark:text-purple-300 font-medium",children:"Price Groups"}),(0,ut.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:"Intelligent price ranges created for analysis"})]}),(0,ut.jsxs)("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:(null===(l=d.user_analysis)||void 0===l?void 0:l.total_countries_found)||0}),(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300 font-medium",children:"Countries"}),(0,ut.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Countries with active users"})]}),(0,ut.jsxs)("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:d.total_combinations.toLocaleString()}),(0,ut.jsx)("div",{className:"text-sm text-orange-800 dark:text-orange-300 font-medium",children:"User Segments"}),(0,ut.jsx)("div",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"Viable segments found in your data"})]})]}),(null===(c=d.user_analysis)||void 0===c?void 0:c.geographic_structure)&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,ut.jsx)(kL,{className:"h-5 w-5 mr-2"}),"Global Market Overview"]}),(()=>{const e=d.user_analysis.geographic_structure,t=Object.entries(e).map(e=>{let[t,r]=e;return{name:t,users:r.total_users,regions:Object.keys(r.regions).length,viableRegions:Object.values(r.regions).filter(e=>e.user_count>=50).length}}).sort((e,t)=>t.users-e.users),r=t.slice(0,10),n=t.reduce((e,t)=>e+t.users,0),a=t.reduce((e,t)=>e+t.regions,0),s=t.reduce((e,t)=>e+t.viableRegions,0);return(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.length}),(0,ut.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:"Total Countries"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:a}),(0,ut.jsx)("div",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:"Total Regions"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:s}),(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300",children:"Viable Regions"}),(0,ut.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400",children:"\u226550 users each"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsxs)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[Math.round(s/a*100),"%"]}),(0,ut.jsx)("div",{className:"text-sm text-purple-800 dark:text-purple-300",children:"Data Coverage"}),(0,ut.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Regions with sufficient data"})]})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[(0,ut.jsx)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-600",children:(0,ut.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Top Markets by User Count"})}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Country"}),(0,ut.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Users"}),(0,ut.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Market Share"}),(0,ut.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Regions"}),(0,ut.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Data Quality"})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600",children:r.map((e,t)=>(0,ut.jsxs)("tr",{className:t%2===0?"bg-white dark:bg-gray-700":"bg-gray-50 dark:bg-gray-800",children:[(0,ut.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t<3&&(0,ut.jsxs)("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:["Top ",t+1]})]})}),(0,ut.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-white font-medium",children:e.users.toLocaleString()}),(0,ut.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-2 mr-2",children:(0,ut.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.users/n*100,"%")}})}),(0,ut.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Math.round(e.users/n*100),"%"]})]})}),(0,ut.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400",children:[e.regions," total"]}),(0,ut.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,ut.jsx)("div",{className:"flex items-center",children:(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(e.viableRegions/e.regions>=.5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":e.viableRegions/e.regions>=.25?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:[e.viableRegions,"/",e.regions," viable"]})})})]},e.name))})]})}),t.length>10&&(0,ut.jsxs)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-600 text-sm text-gray-500 dark:text-gray-400",children:["Showing top 10 of ",t.length," countries. ",t.length-10," additional countries with smaller user bases."]})]})]})})()]}),d.user_segments&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,ut.jsx)(_L,{className:"h-5 w-5 mr-2"}),"Product Segment Analysis - Hierarchical View"]}),(()=>{const e=Object.entries(d.user_segments),t=e.reduce((e,t)=>{let[r,n]=t;return e+n.length},0),r=e.reduce((e,t)=>{let[r,n]=t;return e+n.filter(e=>e.has_sufficient_data).length},0);return(0,ut.jsxs)("div",{className:"space-y-6",children:[d.rollup_stats&&(0,ut.jsxs)("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("h5",{className:"text-lg font-semibold text-green-900 dark:text-green-200 mb-3 flex items-center",children:[(0,ut.jsx)(Ge,{className:"h-5 w-5 mr-2"}),"Intelligent Rollup Efficiency"]}),(0,ut.jsxs)("div",{className:"mb-3 text-sm text-green-800 dark:text-green-300",children:[(0,ut.jsx)("strong",{children:"How it works:"})," When user segments have too few people for reliable statistics, we intelligently combine them with similar segments (same price range, similar economic regions) to reach the minimum group size of ",p.min_cohort_size," users. This ensures all analysis results are statistically meaningful."]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:d.rollup_stats.total_segments}),(0,ut.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Original Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:d.rollup_stats.viable_segments}),(0,ut.jsx)("div",{className:"text-sm text-green-700 dark:text-green-300",children:"Viable Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:d.rollup_stats.rolled_up_segments}),(0,ut.jsx)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Rolled Up"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:d.rollup_stats.rolled_up_segments>0?"".concat((d.rollup_stats.rolled_up_segments/d.rollup_stats.total_segments*100).toFixed(1),"%"):"0%"}),(0,ut.jsx)("div",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Segments Optimized"}),(0,ut.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:d.rollup_stats.rolled_up_segments>0?"".concat(d.rollup_stats.rolled_up_segments," segments combined for efficiency"):"All segments had sufficient data"})]})]}),d.rollup_stats.accuracy_distribution&&(0,ut.jsxs)("div",{className:"mt-4 pt-4 border-t border-green-200 dark:border-green-700",children:[(0,ut.jsx)("h6",{className:"text-sm font-medium text-green-800 dark:text-green-200 mb-2",children:"Accuracy Score Distribution:"}),(0,ut.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs",children:["very_high","high","medium","low","very_low"].map(e=>{const t=d.rollup_stats.accuracy_distribution[e]||0;return(0,ut.jsxs)("div",{className:"text-center p-2 bg-white dark:bg-gray-800 rounded border",children:[(0,ut.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:t}),(0,ut.jsx)("div",{className:"text-gray-600 dark:text-gray-400 capitalize",children:e.replace("_"," ")})]},e)})})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:e.length}),(0,ut.jsx)("div",{className:"text-sm text-purple-800 dark:text-purple-300",children:"Products Analyzed"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-pink-600 dark:text-pink-400",children:t}),(0,ut.jsx)("div",{className:"text-sm text-pink-800 dark:text-pink-300",children:"Total Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:r}),(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300",children:"Ready for Analysis"}),(0,ut.jsxs)("div",{className:"text-xs text-green-600 dark:text-green-400",children:["\u2265",p.min_cohort_size," users each"]})]})]}),(0,ut.jsxs)("div",{className:"space-y-8",children:[(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Understanding the Hierarchy View"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h6",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Status Indicators:"}),(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 mr-2",children:"\u2705 PASSES"}),(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["Has enough users (\u2265",p.min_cohort_size,") for reliable analysis"]})]}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2",children:"\u26a0\ufe0f HAS ROLLUPS"}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Contains segments that roll up to broader categories (hover for details)"})]}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"px-1 py-0.5 rounded text-xs bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 mr-2",children:"\u274c COMBINES"}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Entire level needs to combine with others (hover for details)"})]}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("span",{className:"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 mr-2",children:"\u2192 Target"}),(0,ut.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Rollup target destination (hover for details)"})]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h6",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"4-Level Hierarchy & Rollup Strategy:"}),(0,ut.jsxs)("div",{className:"space-y-1 text-gray-600 dark:text-gray-400",children:[(0,ut.jsxs)("div",{children:["1. ",(0,ut.jsx)("strong",{children:"\ud83c\udfe2\ud83d\udcf1\ud83d\udcb0 Product+Store+Price"})," (Level 1)"]}),(0,ut.jsxs)("div",{children:["2. ",(0,ut.jsx)("strong",{children:"\ud83c\udf0d Economic Tier"})," (+ Economic grouping)"]}),(0,ut.jsxs)("div",{children:["3. ",(0,ut.jsx)("strong",{children:"\ud83c\udfc1 Country"})," (+ Specific country)"]}),(0,ut.jsxs)("div",{children:["4. ",(0,ut.jsx)("strong",{children:"\ud83d\udccd Region"})," (+ Regional detail)"]}),(0,ut.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-300 dark:border-gray-600",children:[(0,ut.jsx)("strong",{children:"Rollup ceiling:"})," Cannot roll up beyond Product+Store+Price level. Even if Level 1 fails, everything rolls up to that specific Product+Store+Price combination."]}),(0,ut.jsx)("div",{className:"mt-2 text-xs italic",children:"\ud83d\udca1 Hover over any status indicator for detailed rollup information"})]})]})]})]}),e.map(e=>{var t;let[r,n]=e;const a=cF(n,p.min_cohort_size);null===(t=d.price_buckets)||void 0===t||t[r];return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[(0,ut.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 border-b border-gray-200 dark:border-gray-600",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(_L,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-3"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h5",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Complete rollup hierarchy showing what passes and what combines"})]})]}),(0,ut.jsxs)("div",{className:"text-right",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:n.reduce((e,t)=>e+t.user_count,0).toLocaleString()}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Users"})]})]})}),(0,ut.jsx)("div",{className:"p-6",children:Object.entries(a).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"mb-8 last:mb-0",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded mr-3"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["\ud83c\udfe2 ",r.productId," | \ud83d\udcf1 ",nF(r.appStore)," | \ud83d\udcb0 ",r.priceRange]}),r.segmentId&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[iF(r.segmentId,"ID"),r.rollupTargetSegmentId&&oF(r.rollupTargetSegmentId)]})]})]}),(0,ut.jsxs)("div",{className:"ml-auto flex items-center space-x-4",children:[(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.totalUsers.toLocaleString()," users"]}),lF(r.passesThreshold,r.rollupInfo,"product_store_price",r.rollupInfo.rollupTarget)]})]}),(0,ut.jsx)("div",{className:"ml-6 space-y-4",children:Object.entries(r.economicTiers).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center mb-3",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-indigo-500 rounded mr-3"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-md font-medium text-gray-700 dark:text-gray-300",children:["\ud83c\udf0d ",t]}),r.segmentId&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[iF(r.segmentId,"ID"),r.rollupTargetSegmentId&&oF(r.rollupTargetSegmentId)]})]})]}),(0,ut.jsxs)("div",{className:"ml-auto flex items-center space-x-3",children:[(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.totalUsers.toLocaleString()," users"]}),lF(r.passesThreshold,r.rollupInfo,"economic_tier",r.rollupInfo.rollupTarget)]})]}),(0,ut.jsx)("div",{className:"ml-6 space-y-3",children:Object.entries(r.countries).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-500 rounded mr-3"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["\ud83c\udfc1 ",t]}),r.segmentId&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[iF(r.segmentId,"ID"),r.rollupTargetSegmentId&&oF(r.rollupTargetSegmentId)]})]})]}),(0,ut.jsxs)("div",{className:"ml-auto flex items-center space-x-3",children:[(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.totalUsers.toLocaleString()," users"]}),lF(r.passesThreshold,r.rollupInfo,"country",r.rollupInfo.rollupTarget)]})]}),r.regions.length>0&&(0,ut.jsx)("div",{className:"ml-6 space-y-1",children:r.regions.map((e,t)=>(0,ut.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded mr-2"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\ud83d\udccd ",e.name]}),e.segmentId&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[iF(e.segmentId,"ID"),e.rollupTargetSegmentId&&oF(e.rollupTargetSegmentId)]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:[e.users.toLocaleString()," users"]}),e.passes?(0,ut.jsx)("span",{className:"px-1 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",children:"\u2705 PASSES"}):(0,ut.jsxs)("div",{className:"relative group",children:[(0,ut.jsxs)("span",{className:"px-1 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 cursor-help",children:["\u2192 ",e.rollupTarget]}),(0,ut.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10 whitespace-nowrap max-w-xs",children:[(0,ut.jsxs)("div",{className:"text-xs",children:[(0,ut.jsx)("div",{className:"font-medium mb-1",children:"Rollup Details:"}),(0,ut.jsxs)("div",{children:["\u2022 Target: ",e.rollupTarget]}),e.rollupReason&&(0,ut.jsxs)("div",{children:["\u2022 Reason: ",e.rollupReason]}),e.propertiesDropped&&e.propertiesDropped.length>0&&(0,ut.jsxs)("div",{children:["\u2022 Properties dropped: ",e.propertiesDropped.join(", ")]}),e.finalUserCount&&e.finalUserCount!==e.originalUserCount&&(0,ut.jsxs)("div",{children:["\u2022 Final user count: ",e.finalUserCount.toLocaleString()]}),e.rollupTargetSegmentId&&(0,ut.jsxs)("div",{children:["\u2022 Target Segment ID: ",aF(e.rollupTargetSegmentId)]})]}),(0,ut.jsx)("div",{className:"absolute top-full right-4 transform border-4 border-transparent border-t-gray-900 dark:border-t-gray-100"})]})]})]})]},t))})]},t)})})]},t)})})]},t)})})]},r)})]})]})})()]}),d.rollup_stats&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,ut.jsx)(_L,{className:"h-5 w-5 mr-2"}),"Segment Optimization Summary"]}),(0,ut.jsx)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:d.rollup_stats.total_segments}),(0,ut.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Original Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:d.rollup_stats.viable_segments}),(0,ut.jsx)("div",{className:"text-sm text-green-700 dark:text-green-300",children:"Viable Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:d.rollup_stats.rolled_up_segments}),(0,ut.jsx)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Rolled Up"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:d.rollup_stats.rolled_up_segments>0?"".concat((d.rollup_stats.rolled_up_segments/d.rollup_stats.total_segments*100).toFixed(1),"%"):"0%"}),(0,ut.jsx)("div",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Segments Optimized"})]})]})})]}),(0,ut.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[(0,ut.jsxs)("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-2 flex items-center",children:[(0,ut.jsx)(Ft,{className:"h-4 w-4 mr-2"}),"Analysis Methodology"]}),(0,ut.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-300 space-y-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"User-Centric Analysis:"})," Instead of generating theoretical combinations, we analyze your actual users and group them based on their real properties (product purchases, geographic location, app store). This ensures every segment represents real user behavior."]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Intelligent Grouping:"})," When segments have insufficient users, we use a smart rollup strategy that combines related segments while preserving meaningful distinctions."]}),d.bucketing_methodology&&(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Price Bucketing:"})," ",d.bucketing_methodology.description]})]})]}),(0,ut.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Hierarchical Rollup Analysis"}),(0,ut.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Shows how segments are grouped and rolled up when they don't meet the minimum threshold of ",p.min_cohort_size," users"]}),(0,ut.jsx)("button",{onClick:()=>x(!g),className:"px-3 py-1 text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:g?"Hide Details":"Show Full Details"})]}),(0,ut.jsx)("div",{className:"space-y-4",children:Object.entries(v).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,ut.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-t-lg",children:(0,ut.jsxs)("button",{onClick:()=>b(t),className:"flex items-center justify-between w-full text-left",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(m[t]?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white",children:[r.productId," \u2022 ",r.appStore," \u2022 ",r.priceRange]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.totalUsers.toLocaleString()," total users across ",r.rollupInfo.totalSegments," segments"]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[lF(r.passesThreshold,r.rollupInfo,"product",r.rollupInfo.rollupTarget),(0,ut.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.rollupInfo.rolledUpSegments>0&&"".concat(r.rollupInfo.rolledUpSegments," rolled up")})]})]})}),m[t]&&(0,ut.jsx)("div",{className:"p-3 space-y-3",children:Object.entries(r.economicTiers).map(e=>{let[r,n]=e;return(0,ut.jsxs)("div",{className:"border-l-2 border-gray-300 dark:border-gray-600 pl-4",children:[(0,ut.jsxs)("button",{onClick:()=>b("".concat(t,"-").concat(r)),className:"flex items-center justify-between w-full text-left mb-2",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)("svg",{className:"w-3 h-3 transform transition-transform ".concat(m["".concat(t,"-").concat(r)]?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"font-medium text-gray-800 dark:text-gray-200",children:r}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.totalUsers.toLocaleString()," users across ",Object.keys(n.countries).length," countries"]})]})]}),(0,ut.jsx)("div",{className:"flex items-center space-x-2",children:lF(n.passesThreshold,n.rollupInfo,"tier",n.rollupInfo.rollupTarget)})]}),m["".concat(t,"-").concat(r)]&&(0,ut.jsx)("div",{className:"space-y-2 ml-4",children:Object.entries(n.countries).map(e=>{let[n,a]=e;return(0,ut.jsxs)("div",{className:"border-l border-gray-200 dark:border-gray-600 pl-3",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300 text-sm",children:n}),(0,ut.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",a.totalUsers.toLocaleString()," users)"]})]}),(0,ut.jsx)("div",{className:"flex items-center space-x-2",children:lF(a.passesThreshold,a.rollupInfo,"country",a.rollupInfo.rollupTarget)})]}),g&&a.regions.length>0&&(0,ut.jsx)("div",{className:"ml-4 mt-1 space-y-1",children:a.regions.map((e,t)=>(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs py-1",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["\ud83d\udccd ",e.name]}),(0,ut.jsxs)("span",{className:"text-gray-500 dark:text-gray-500",children:["(",e.users.toLocaleString()," users)"]})]}),(0,ut.jsx)("div",{className:"flex items-center space-x-1",children:lF(e.passes,{rollupTarget:e.rollupTarget,rollupReasons:e.rollupReason?[e.rollupReason]:[],finalUserCount:e.finalUserCount,propertiesDropped:e.propertiesDropped},"region",e.rollupTarget)})]},t))})]},"".concat(t,"-").concat(r,"-").concat(n))})})]},"".concat(t,"-").concat(r))})})]},t)})}),(0,ut.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Rollup Summary"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Total Product Combinations"}),(0,ut.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:Object.keys(v).length})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Segments Meeting Threshold"}),(0,ut.jsx)("div",{className:"font-medium text-green-600 dark:text-green-400",children:Object.values(v).filter(e=>e.passesThreshold).length})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Segments Requiring Rollup"}),(0,ut.jsx)("div",{className:"font-medium text-orange-600 dark:text-orange-400",children:Object.values(v).filter(e=>!e.passesThreshold).length})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Total Users Analyzed"}),(0,ut.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:Object.values(v).reduce((e,t)=>e+t.totalUsers,0).toLocaleString()})]})]})]})]})]})]})},hF=e=>{var t,r,n,a,s,i,o;let{analysisProgress:l,isAnalyzing:c}=e;return c&&l?(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Step 3: Running Conversion Analysis"}),(0,ut.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["Calculating conversion rates for each user segment. This process analyzes ",(null===(t=l.total_combinations)||void 0===t?void 0:t.toLocaleString())||0," different combinations of user properties."]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-2",children:[(0,ut.jsx)("span",{children:"Overall Progress"}),(0,ut.jsxs)("span",{children:[(null===(r=l.percentage_complete)||void 0===r?void 0:r.toFixed(1))||0,"% Complete"]})]}),(0,ut.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,ut.jsx)("div",{className:"bg-indigo-600 h-3 rounded-full transition-all duration-300 relative",style:{width:"".concat(l.percentage_complete||0,"%")},children:(0,ut.jsx)("div",{className:"absolute inset-0 bg-indigo-400 rounded-full animate-pulse opacity-50"})})})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-medium",children:"Segments Processed"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:(null===(n=l.completed_combinations)||void 0===n?void 0:n.toLocaleString())||0}),(0,ut.jsxs)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["of ",(null===(a=l.total_combinations)||void 0===a?void 0:a.toLocaleString())||0," total"]})]}),(0,ut.jsxs)("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300 font-medium",children:"Valid Groups Found"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:(null===(s=l.valid_cohorts_found)||void 0===s?void 0:s.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Groups with enough users for analysis"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-red-800 dark:text-red-300 font-medium",children:"Skipped Groups"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:(null===(i=l.invalid_cohorts_found)||void 0===i?void 0:i.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Groups with insufficient data"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 font-medium",children:"Expanded Groups"}),(0,ut.jsx)("div",{className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:(null===(o=l.cohorts_with_dropped_properties)||void 0===o?void 0:o.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Groups broadened to include more users"})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-purple-800 dark:text-purple-300 font-medium",children:"Processing Rate"}),(0,ut.jsxs)("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:[l.combinations_per_minute?l.combinations_per_minute.toFixed(1):"0"," per minute"]}),(0,ut.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Current analysis speed"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-indigo-800 dark:text-indigo-300 font-medium",children:"Current Step"}),(0,ut.jsx)("div",{className:"text-sm font-medium text-indigo-600 dark:text-indigo-400",children:l.current_step||"Initializing..."}),(0,ut.jsx)("div",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:"What's happening now"})]})]}),l.current_combination&&(0,ut.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,ut.jsxs)("div",{className:"text-sm text-gray-800 dark:text-gray-300 font-medium mb-2 flex items-center",children:[(0,ut.jsx)(qe,{className:"h-4 w-4 mr-2 animate-spin"}),"Currently Processing"]}),(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,ut.jsx)("span",{className:"font-medium",children:"Product:"})," ",l.current_combination.product_id||"N/A"," \u2022",(0,ut.jsx)("span",{className:"font-medium ml-2",children:"Price:"})," ",l.current_combination.price_bucket||"N/A"," \u2022",(0,ut.jsx)("span",{className:"font-medium ml-2",children:"Location:"})," ",l.current_combination.country||"Any"," / ",l.current_combination.region||"Any"," \u2022",(0,ut.jsx)("span",{className:"font-medium ml-2",children:"Store:"})," ",l.current_combination.app_store||"Any"]})]}),l.estimated_time_remaining&&(0,ut.jsx)("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,ut.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,ut.jsx)("strong",{children:"Estimated time remaining:"})," ",Math.ceil(l.estimated_time_remaining)," minutes"]})})]})}):null},pF=e=>{var t,r,n,a,s,i,o,l,c,d,u,h,p;let{analysisResults:m}=e;return m?(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Step 3: Conversion Analysis Complete"}),(0,ut.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["Analysis finished! We found conversion patterns across ",(null===(t=m.summary)||void 0===t||null===(r=t.valid_cohorts)||void 0===r?void 0:r.toLocaleString())||0," user segments. Use the search below to explore specific segments and their conversion rates."]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300 font-medium",children:"Successful Analyses"}),(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:(null===(n=m.summary)||void 0===n||null===(a=n.valid_cohorts)||void 0===a?void 0:a.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400",children:"User segments with reliable conversion data"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-red-800 dark:text-red-300 font-medium",children:"Insufficient Data"}),(0,ut.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:(null===(s=m.summary)||void 0===s||null===(i=s.invalid_cohorts)||void 0===i?void 0:i.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Segments with too few users"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 font-medium",children:"Expanded Segments"}),(0,ut.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:(null===(o=m.summary)||void 0===o||null===(l=o.cohorts_with_dropped_properties)||void 0===l?void 0:l.toLocaleString())||0}),(0,ut.jsx)("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Segments broadened to include more users"})]}),(0,ut.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,ut.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-300 font-medium",children:"Analysis Date"}),(0,ut.jsx)("div",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:m.last_updated?(f=m.last_updated,new Date(f).toLocaleDateString()):"N/A"}),(0,ut.jsx)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"When this analysis was completed"})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ut.jsx)(Bt,{className:"h-5 w-5 text-green-600 dark:text-green-400 mr-2"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-200",children:"Analysis Quality"})]}),(0,ut.jsxs)("div",{className:"text-sm text-green-800 dark:text-green-300 space-y-1",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Success Rate:"})," ",null!==(c=m.summary)&&void 0!==c&&c.valid_cohorts&&null!==(d=m.summary)&&void 0!==d&&d.total_combinations_attempted?(m.summary.valid_cohorts/m.summary.total_combinations_attempted*100).toFixed(1):0,"% of segments produced reliable results"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Data Coverage:"})," ",(null===(u=m.summary)||void 0===u||null===(h=u.total_users_analyzed)||void 0===h?void 0:h.toLocaleString())||0," users analyzed across all segments"]})]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ut.jsx)(Ge,{className:"h-5 w-5 text-purple-600 dark:text-purple-400 mr-2"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-purple-900 dark:text-purple-200",children:"Statistical Reliability"})]}),(0,ut.jsxs)("div",{className:"text-sm text-purple-800 dark:text-purple-300 space-y-1",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Confidence Intervals:"})," Available for all valid segments"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("strong",{children:"Minimum Cohort Size:"})," ",(null===(p=m.analysis_parameters)||void 0===p?void 0:p.min_cohort_size)||"N/A"," users per segment"]})]})]})]}),m.warnings&&m.warnings.length>0&&(0,ut.jsxs)("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ut.jsx)(We,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mr-2"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-yellow-900 dark:text-yellow-200",children:"Analysis Warnings"})]}),(0,ut.jsxs)("div",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:[(0,ut.jsx)("div",{className:"mb-2",children:(0,ut.jsxs)("strong",{children:[m.warnings.length," warning",1!==m.warnings.length?"s":""," occurred during analysis:"]})}),(0,ut.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[m.warnings.slice(0,3).map((e,t)=>(0,ut.jsx)("li",{children:e.message||e},t)),m.warnings.length>3&&(0,ut.jsxs)("li",{className:"text-yellow-600 dark:text-yellow-400",children:["... and ",m.warnings.length-3," more warnings"]})]})]})]}),(0,ut.jsxs)("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ut.jsx)(Qe,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2"}),(0,ut.jsx)("h4",{className:"text-sm font-semibold text-indigo-900 dark:text-indigo-200",children:"Next Steps"})]}),(0,ut.jsxs)("div",{className:"text-sm text-indigo-800 dark:text-indigo-300 space-y-1",children:[(0,ut.jsx)("div",{children:"\u2713 Use the search filters below to explore specific products, regions, or price ranges"}),(0,ut.jsx)("div",{children:"\u2713 Look for segments with high conversion rates and large user counts for optimization opportunities"}),(0,ut.jsx)("div",{children:"\u2713 Pay attention to confidence intervals - segments with wider intervals may need more data"}),(0,ut.jsx)("div",{children:'\u2713 Click "Rollup Details" on expanded segments to understand how they were optimized'})]})]})]})}):null;var f},mF=ze("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),fF=e=>{let{analysisResults:t,expandedSections:r,onToggleSection:n}=e;const a=e=>{if(!e)return null;const t=(e=>{if(!e)return"#6B7280";let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);const r=Math.abs(t)%360;return"hsl(".concat(r,", 65%, 50%)")})(e),r=(e=>!e||e.length<=8?e:"".concat(e.substring(0,4),"...").concat(e.substring(e.length-4)))(e);return(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-mono mx-1",style:{backgroundColor:"".concat(t,"20"),color:t,border:"1px solid ".concat(t,"40")},children:["ID: ",r]})};if(!t)return(0,ut.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No analysis results available"});const s={};let i=0,o=0;t.conversion_probabilities&&Object.entries(t.conversion_probabilities).forEach(e=>{let[t,r]=e;const n=r.cohort||{},a=r.metrics||{},l=n.product_id,c=n.app_store||"Unknown",d=n.price_bucket,u=n.economic_tier||"",h=n.country||"",p=n.region||"";if(!l||!d)return;const m=n.properties_dropped&&n.properties_dropped.length>0,f=!m;f&&i++,m&&o++;let g="region";p||(g="country"),h||(g="tier"),u||(g="price");"".concat(l,"|").concat(c,"|").concat(d,"|").concat(u,"|").concat(h,"|").concat(p);const x=Ie(Ie(Ie({},n),a),{},{segment_id:n.segment_id||t,is_viable:f,trial_conversion_rate:a.trial_conversion_rate||0,trial_converted_count:a.trial_converted_count||0,trial_started_count:a.trial_started_count||0,rollup_target_segment_id:n.rollup_target_segment_id,rollup_reason:n.rollup_reason,hierarchy_level:g});s[l]||(s[l]={stores:{},totalUsers:0,viableSegments:0,rollupSegments:0}),s[l].stores[c]||(s[l].stores[c]={prices:{},totalUsers:0,viableSegments:0,rollupSegments:0}),s[l].stores[c].prices[d]||(s[l].stores[c].prices[d]={tiers:{},totalUsers:0,viableSegments:0,rollupSegments:0,segment:"price"===g?x:null}),s[l].stores[c].prices[d].tiers[u||"Unknown"]||(s[l].stores[c].prices[d].tiers[u||"Unknown"]={countries:{},totalUsers:0,viableSegments:0,rollupSegments:0,segment:"tier"===g?x:null}),s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"]||(s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"]={regions:{},totalUsers:0,viableSegments:0,rollupSegments:0,segment:"country"===g?x:null}),"region"===g&&(s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"].regions[p||"Unknown"]=x);const b=n.cohort_size||0;s[l].totalUsers+=b,s[l].stores[c].totalUsers+=b,s[l].stores[c].prices[d].totalUsers+=b,s[l].stores[c].prices[d].tiers[u||"Unknown"].totalUsers+=b,s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"].totalUsers+=b,f&&(s[l].viableSegments++,s[l].stores[c].viableSegments++,s[l].stores[c].prices[d].viableSegments++,s[l].stores[c].prices[d].tiers[u||"Unknown"].viableSegments++,s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"].viableSegments++),m&&(s[l].rollupSegments++,s[l].stores[c].rollupSegments++,s[l].stores[c].prices[d].rollupSegments++,s[l].stores[c].prices[d].tiers[u||"Unknown"].rollupSegments++,s[l].stores[c].prices[d].tiers[u||"Unknown"].countries[h||"Unknown"].rollupSegments++)});const l=function(e,t,r,n,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const l={marginLeft:"".concat(24*i,"px")};return(0,ut.jsxs)("div",{className:"flex items-center justify-between py-1 px-3 hover:bg-gray-50 dark:hover:bg-gray-700/30 ".concat(i%2===0?"bg-gray-25 dark:bg-gray-800/20":"bg-white dark:bg-gray-800"),style:l,children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e,(0,ut.jsx)("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:t}),o&&o.segment_id&&a(o.segment_id),o&&(0,ut.jsx)(ut.Fragment,{children:o.is_viable?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("span",{className:"text-green-600 dark:text-green-400 text-sm font-medium",children:["\ud83c\udfaf ",rF(o.trial_conversion_rate)]}),(0,ut.jsxs)("span",{className:"text-blue-600 dark:text-blue-400 text-sm",children:["\u2192 ",o.trial_converted_count||0,"/",o.trial_started_count||0]})]}):(0,ut.jsxs)(ut.Fragment,{children:[o.rollup_target_segment_id&&(0,ut.jsxs)("span",{className:"text-red-600 dark:text-red-400 text-sm",children:["\u2192 ",a(o.rollup_target_segment_id)]}),o.rollup_reason&&(0,ut.jsxs)("span",{className:"text-red-500 dark:text-red-400 text-xs italic",children:["(",o.rollup_reason,")"]}),o.properties_dropped&&o.properties_dropped.length>0&&(0,ut.jsxs)("span",{className:"text-orange-500 dark:text-orange-400 text-xs",children:["Dropped: [",o.properties_dropped.join(", "),"]"]}),o.rollup_description&&(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:o.rollup_description})]})})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-4 text-sm font-medium",children:[(0,ut.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[r.toLocaleString()," users"]}),void 0!==n&&void 0!==s&&(0,ut.jsxs)("div",{className:"flex items-center gap-2",children:[n>0&&(0,ut.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:[n," viable"]}),s>0&&(0,ut.jsxs)("span",{className:"text-orange-600 dark:text-orange-400",children:[s," rollup"]})]}),o&&(0,ut.jsx)("div",{children:o.is_viable?(0,ut.jsx)("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 px-2 py-1 rounded-full text-xs font-medium",children:"\u2705 VIABLE"}):(0,ut.jsx)("span",{className:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200 px-2 py-1 rounded-full text-xs font-medium",children:"\u274c ROLLUP"})})]})]})};return(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[(0,ut.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)(Je,{className:"h-6 w-6"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h2",{className:"text-xl font-bold",children:"Hierarchical Analysis Results"}),(0,ut.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Tree-based segment hierarchy with conversion metrics and rollup information"})]})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-6 text-sm",children:[(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:i}),(0,ut.jsx)("div",{className:"text-blue-100",children:"Viable Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold",children:o}),(0,ut.jsx)("div",{className:"text-blue-100",children:"Rollup Segments"})]}),(0,ut.jsxs)("div",{className:"text-center",children:[(0,ut.jsxs)("div",{className:"text-2xl font-bold",children:[i+o>0?Math.round(i/(i+o)*100):0,"%"]}),(0,ut.jsx)("div",{className:"text-blue-100",children:"Coverage"})]})]})]})}),(0,ut.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:Object.entries(s).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[l((0,ut.jsx)(_L,{className:"h-5 w-5 text-purple-600"}),"\ud83c\udfe2 ".concat(t),r.totalUsers,r.viableSegments,r.rollupSegments,0),Object.entries(r.stores).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[l((0,ut.jsx)(mF,{className:"h-4 w-4 text-blue-600"}),"\ud83d\udcf1 ".concat(nF(t)),r.totalUsers,r.viableSegments,r.rollupSegments,1),Object.entries(r.prices).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[l((0,ut.jsx)(Xe,{className:"h-4 w-4 text-green-600"}),"\ud83d\udcb0 ".concat(t),r.totalUsers,r.viableSegments,r.rollupSegments,2,r.segment),Object.entries(r.tiers).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[l((0,ut.jsx)(Ge,{className:"h-4 w-4 text-yellow-600"}),"\ud83c\udf0d ".concat(t),r.totalUsers,r.viableSegments,r.rollupSegments,3,r.segment),Object.entries(r.countries).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{children:[l((0,ut.jsx)(kL,{className:"h-4 w-4 text-orange-600"}),"\ud83c\udfc1 ".concat(t),r.totalUsers,r.viableSegments,r.rollupSegments,4,r.segment),Object.entries(r.regions).map(e=>{let[t,r]=e;return r?l(r.is_viable?(0,ut.jsx)(Bt,{className:"h-4 w-4 text-green-500"}):(0,ut.jsx)(We,{className:"h-4 w-4 text-red-500"}),"\ud83d\udccd ".concat(t),r.cohort_size||0,void 0,void 0,5,r):null})]},t)})]},t)})]},t)})]},t)})]},t)})})]})},gF=()=>{const e=(()=>{try{const e=localStorage.getItem("conversionProbability_config"),t=localStorage.getItem("conversionProbability_expandedSections");return{config:e?JSON.parse(e):{timeframe:"all",min_cohort_size:50,force_recalculate:!1,min_price_samples:100},expandedSections:t?JSON.parse(t):{propertyAnalysis:!1,analysisHierarchy:!0}}}catch(e){return console.error("Error loading saved state:",e),{config:{timeframe:"all",min_cohort_size:50,force_recalculate:!1,min_price_samples:100},expandedSections:{propertyAnalysis:!1,analysisHierarchy:!0}}}})(),[t,r]=(0,s.useState)(Ie(Ie({},e.config),{},{min_price_samples:e.config.min_price_samples||100})),[n,a]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[m,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[b,y]=(0,s.useState)(null),[v,_]=(0,s.useState)(null),[k,j]=(0,s.useState)(Ie(Ie({},e.expandedSections),{},{analysisHierarchy:!0})),[w,N]=(0,s.useState)([]);(0,s.useEffect)(()=>{localStorage.setItem("conversionProbability_config",JSON.stringify(t))},[t]),(0,s.useEffect)(()=>{localStorage.setItem("conversionProbability_expandedSections",JSON.stringify(k))},[k]);const S=async e=>{try{const t=await fetch("/api/conversion-probability/results/".concat(e)),r=await t.json();r.success?(c(r.data),j(e=>Ie(Ie({},e),{},{analysisHierarchy:!0})),O()):y(r.error||"Failed to load analysis results")}catch(t){y("Error loading analysis results: "+t.message)}},O=async()=>{try{const e=await fetch("/api/conversion-probability/analyses"),t=await e.json();t.success&&N(t.data.files)}catch(e){console.error("Error loading available analyses:",e)}};(0,s.useEffect)(()=>{let e;return n&&d&&(e=setInterval(async()=>{try{const e=await fetch("/api/conversion-probability/progress/".concat(n)),t=await e.json();t.success&&(o(t.data.progress),"completed"!==t.data.status&&"failed"!==t.data.status||(u(!1),"completed"===t.data.status?(_("Analysis completed successfully!"),S(n)):y("Analysis failed. Please try again.")))}catch(e){console.error("Error polling progress:",e)}},2e3)),()=>{e&&clearInterval(e)}},[n,d]),(0,s.useEffect)(()=>{O()},[]);const C=async()=>{try{const e=await fetch("/api/conversion-probability/results/latest");let t=await e.json();if(!t.success){const e=await fetch("/api/conversion-probability/analyses"),r=await e.json();if(r.success&&r.data.files.length>0){const e=r.data.files[0];t=await(await fetch("/api/conversion-probability/results/".concat(e.analysis_id))).json()}}t.success&&(c(t.data),O())}catch(e){console.error("Error loading latest analysis results:",e),setTimeout(()=>{window.location.reload()},1e3)}};return{config:t,currentAnalysis:n,analysisProgress:i,analysisResults:l,isAnalyzing:d,isRunningNewAnalysis:h,propertyAnalysis:m,isAnalyzingProperties:g,error:b,success:v,expandedSections:k,availableAnalyses:w,setConfig:r,setError:y,setSuccess:_,analyzeProperties:async()=>{x(!0),y(null);try{const e=tF(t.timeframe),r=await fetch("/api/conversion-probability/analyze-properties",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({timeframe_start:e.start,timeframe_end:e.end,sample_limit:1e4,min_price_samples:t.min_price_samples,min_cohort_size:t.min_cohort_size})}),n=await r.json();n.success?(f(n.data),_("Property analysis completed successfully!"),j(e=>Ie(Ie({},e),{},{propertyAnalysis:!1}))):y(n.error||"Property analysis failed")}catch(e){y("Error analyzing properties: "+e.message)}finally{x(!1)}},startAnalysis:async()=>{u(!0),y(null),o(null);try{const e=tF(t.timeframe),r={timeframe_start:e.start,timeframe_end:e.end,min_cohort_size:t.min_cohort_size,force_recalculate:t.force_recalculate};m&&(r.existing_property_analysis=m);const n=await fetch("/api/conversion-probability/start-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await n.json();s.success?(a(s.data.analysis_id),s.data.cached?(u(!1),_("Using cached analysis results!"),S(s.data.analysis_id)):_("Analysis started! Estimated duration: ".concat(s.data.estimated_duration_minutes," minutes"))):(y(s.error||"Failed to start analysis"),u(!1))}catch(e){y("Error starting analysis: "+e.message),u(!1)}},runNewHierarchicalAnalysis:async()=>{p(!0),y(null),c(null);try{const e={},t=await fetch("/api/conversion-probability/run-new-hierarchical-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();r.success?(_("\u2728 New hierarchical analysis completed! ".concat(r.data.timeframe_description," - Processed ").concat(r.data.total_combinations," segments with ").concat(r.data.rollup_percentage.toFixed(1),"% rollup rate.")),await C(),j(e=>Ie(Ie({},e),{},{analysisHierarchy:!0}))):y(r.error||"New hierarchical analysis failed")}catch(e){y("Error running new hierarchical analysis: "+e.message)}finally{p(!1)}},toggleSection:e=>{j(t=>Ie(Ie({},t),{},{[e]:!t[e]}))}}},xF=()=>{const{config:e,analysisProgress:t,analysisResults:r,isAnalyzing:n,isRunningNewAnalysis:a,propertyAnalysis:s,isAnalyzingProperties:i,error:o,success:l,expandedSections:c,setConfig:d,setError:u,setSuccess:h,analyzeProperties:p,startAnalysis:m,runNewHierarchicalAnalysis:f,toggleSection:g}=gF();return(0,ut.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Conversion Probability Analysis"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Analyze conversion probabilities for different user cohorts based on product, price, region, country, and app store properties."}),(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsxs)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-2 flex items-center",children:[(0,ut.jsx)(Ft,{className:"h-4 w-4 mr-2"}),"How This Analysis Works"]}),(0,ut.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-300 space-y-1",children:[(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"NEW:"}),' Try "Run New Conversion Analysis" for enhanced 5-stage hierarchical analysis']}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Legacy:"}),' Use "Discover Data Structure" to preview segments, then "Run Legacy Analysis"']}),(0,ut.jsxs)("p",{children:[(0,ut.jsx)("strong",{children:"Results:"})," Review conversion rates in the hierarchical view with rollup information"]})]})]})]}),(0,ut.jsx)(ZL,{error:o,success:l,onClearError:()=>u(null),onClearSuccess:()=>h(null)}),!s&&!r&&!a&&(0,ut.jsx)("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-6 mb-6",children:(0,ut.jsxs)("div",{className:"flex items-start",children:[(0,ut.jsx)("div",{className:"flex-shrink-0",children:(0,ut.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-md bg-indigo-500 text-white",children:(0,ut.jsx)(Je,{className:"h-6 w-6"})})}),(0,ut.jsxs)("div",{className:"ml-4 flex-1",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-indigo-900 dark:text-indigo-200 mb-2",children:"Welcome to Conversion Probability Analysis"}),(0,ut.jsx)("p",{className:"text-indigo-800 dark:text-indigo-300 mb-4",children:"This powerful tool analyzes your user data to identify conversion patterns across different user segments. You'll discover how conversion rates vary by product, price range, geographic location, and app store."}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-indigo-900/30 rounded-lg border border-indigo-200 dark:border-indigo-700",children:[(0,ut.jsx)("h4",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-2",children:"New Enhanced Analysis:"}),(0,ut.jsxs)("ul",{className:"text-sm text-indigo-800 dark:text-indigo-300 space-y-1",children:[(0,ut.jsx)("li",{children:"\u2022 5-stage validation pipeline"}),(0,ut.jsx)("li",{children:"\u2022 Tree-based rollup methodology"}),(0,ut.jsx)("li",{children:"\u2022 Levels 3-6 only (Price \u2192 Region)"}),(0,ut.jsx)("li",{children:"\u2022 Enhanced accuracy scoring"})]})]}),(0,ut.jsxs)("div",{className:"p-3 bg-white dark:bg-indigo-900/30 rounded-lg border border-indigo-200 dark:border-indigo-700",children:[(0,ut.jsx)("h4",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-2",children:"What You'll Discover:"}),(0,ut.jsxs)("ul",{className:"text-sm text-indigo-800 dark:text-indigo-300 space-y-1",children:[(0,ut.jsx)("li",{children:"\u2022 Trial-to-paid conversion rates by segment"}),(0,ut.jsx)("li",{children:"\u2022 Refund patterns across different user groups"}),(0,ut.jsx)("li",{children:"\u2022 Geographic and pricing insights"}),(0,ut.jsx)("li",{children:"\u2022 Statistical confidence for all metrics"})]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[(0,ut.jsx)(We,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mr-2 flex-shrink-0"}),(0,ut.jsxs)("div",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[(0,ut.jsx)("strong",{children:"Ready to start?"}),' Configure your analysis parameters below, then click "Run New Conversion Analysis" for the best results, or try the legacy system if you need the old methodology.']})]})]})]})}),(0,ut.jsx)(dF,{config:e,onConfigChange:d,onAnalyzeProperties:p,onStartAnalysis:m,onRunNewHierarchicalAnalysis:f,isAnalyzingProperties:i,isAnalyzing:n,isRunningNewAnalysis:a,propertyAnalysis:s}),(0,ut.jsx)(uF,{propertyAnalysis:s,expandedSections:c,onToggleSection:g,config:e}),(0,ut.jsx)(hF,{analysisProgress:t,isAnalyzing:n}),(0,ut.jsx)(pF,{analysisResults:r}),(0,ut.jsx)(fF,{analysisResults:r,expandedSections:c,onToggleSection:g})]})},bF=()=>{var e,t,r,n,a,i,o;const[l,c]=(0,s.useState)([]),[d,u]=(0,s.useState)([]),[h,p]=(0,s.useState)("1.0.0"),[m,f]=(0,s.useState)({}),[g,x]=(0,s.useState)({}),[b,y]=(0,s.useState)(!0),[v,_]=(0,s.useState)(null),[k,j]=(0,s.useState)(""),[w,N]=(0,s.useState)(new Set),[S,O]=(0,s.useState)(new Set),[C,E]=(0,s.useState)(!1),[P,A]=(0,s.useState)(null),[T,M]=(0,s.useState)(null),[R,D]=(0,s.useState)([]),[I,L]=(0,s.useState)([]),[F,B]=(0,s.useState)(null),[U,z]=(0,s.useState)(null),[V,H]=(0,s.useState)({}),[W,q]=(0,s.useState)(!1),[G,$]=(0,s.useState)({rule_id:"",product_id:"",price_usd:"",start_date:"",countries:[]}),[K,Y]=(0,s.useState)({product_id:"",price_usd:"",start_date:"",countries:[]}),[X,J]=(0,s.useState)(null),[Q,Z]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(!1),[re,ne]=(0,s.useState)({}),[ae,se]=(0,s.useState)(null);(0,s.useEffect)(()=>{ie(),oe()},[]),(0,s.useEffect)(()=>{(l.length>0||d.length>0)&&ce()},[l,d]),(0,s.useEffect)(()=>{if(Object.keys(m).length>0){if(k){const e=Object.keys(m).filter(e=>e.toLowerCase().includes(k.toLowerCase()));N(new Set(e))}else N(new Set);O(new Set)}},[m,k]),(0,s.useEffect)(()=>{I.length>0&&te(K.countries.length===I.length&&K.countries.length>0)},[K.countries,I]);const ie=async()=>{try{y(!0);const e=await fetch("/api/pricing/rules"),t=await e.json();t.success?(c(t.data.rules||[]),t.data.missing_products&&u(t.data.missing_products),t.data.schema_version&&p(t.data.schema_version),t.data.products&&x(t.data.products),t.data.trial_activity_data&&ne(t.data.trial_activity_data),t.data.auto_repair_count&&t.data.auto_repair_count>0&&(se({type:"success",message:"\u2705 Auto-repaired ".concat(t.data.auto_repair_count," pricing rules with missing end dates"),timestamp:Date.now()}),setTimeout(()=>{se(null)},8e3))):_(t.error||"Failed to load pricing rules")}catch(e){_("Network error loading pricing rules"),console.error("Error loading pricing rules:",e)}finally{y(!1)}},oe=async()=>{try{const[e,t]=await Promise.all([fetch("/api/pricing/products"),fetch("/api/pricing/countries")]),[r,n]=await Promise.all([e.json(),t.json()]);if(r.success&&r.data&&r.data.products){const e=r.data.products.map(e=>e.product_id);D(e)}if(n.success&&n.data&&n.data.countries){const e=n.data.countries.map(e=>e.country_code);L(e)}}catch(e){console.error("Error loading dropdown data:",e),D([]),L([])}},le=async e=>{try{const t=await fetch("/api/pricing/rules/".concat(e,"/provenance")),r=await t.json();r.success?B({ruleId:e,data:r.data}):console.error("Failed to load data provenance:",r.error)}catch(t){console.error("Error loading data provenance:",t)}},ce=()=>{const e={};l.forEach(t=>{const r=t.product_id;e[r]||(e[r]={totalRules:0,countries:{},allCountries:[],mostRecentPricingUpdate:null,hasMissingRules:!1}),e[r].totalRules++;const n=new Date(t.start_date);(!e[r].mostRecentPricingUpdate||n>e[r].mostRecentPricingUpdate)&&(e[r].mostRecentPricingUpdate=n),t.countries.forEach(n=>{e[r].countries[n]||(e[r].countries[n]={rules:[],priceRange:{min:1/0,max:-1/0},hasActive:!1,hasFuture:!1,hasHistorical:!1},e[r].allCountries.push(n));const a=e[r].countries[n];a.rules.push(t),a.priceRange.min=Math.min(a.priceRange.min,t.price_usd),a.priceRange.max=Math.max(a.priceRange.max,t.price_usd);const s=new Date,i=new Date(t.start_date),o=t.end_date?new Date(t.end_date):null;o&&s>o?a.hasHistorical=!0:s>=i&&(!o||s<=o)?a.hasActive=!0:a.hasFuture=!0})}),d.forEach(t=>{const r=t.product_id,n=new Date(t.last_trial||t.last_conversion);e[r]?(e[r].hasMissingRules=!0,e[r].missingProductInfo=t,(!e[r].mostRecentTrialActivity||n>e[r].mostRecentTrialActivity)&&(e[r].mostRecentTrialActivity=n),(!e[r].mostRecentPricingUpdate||n>e[r].mostRecentPricingUpdate)&&(e[r].mostRecentPricingUpdate=n)):e[r]={totalRules:0,countries:{},allCountries:[],mostRecentPricingUpdate:n,mostRecentTrialActivity:n,hasMissingRules:!0,missingProductInfo:t}}),Object.keys(e).forEach(t=>{if(re[t]){const r=re[t],n=new Date(r.most_recent_activity);e[t].mostRecentTrialActivity=n,e[t].totalTrialEvents=r.total_events,0===e[t].totalRules&&(e[t].mostRecentPricingUpdate=n)}}),Object.values(e).forEach(e=>{!e.mostRecentTrialActivity&&e.mostRecentPricingUpdate&&(e.mostRecentTrialActivity=e.mostRecentPricingUpdate)}),Object.values(e).forEach(e=>{Object.values(e.countries).forEach(e=>{e.priceRange.min===1/0&&(e.priceRange.min=0),e.priceRange.max===-1/0&&(e.priceRange.max=0)})}),f(e)},de=async e=>{if(e){Z(!0);try{const t=await fetch("/api/pricing/products/".concat(e,"/most-recent-conversion-price")),r=await t.json();if(r.success){const e=(e=>{const t=5*Math.round(e/5)-.01;return Math.max(4.99,t)})(r.data.suggested_price);J(Ie(Ie({},r.data),{},{suggested_price:e,original_price:r.data.suggested_price,note:"Rounded from $".concat(r.data.suggested_price," to $").concat(e," (").concat(r.data.note,")")})),Y(t=>Ie(Ie({},t),{},{price_usd:e.toString()}))}else J(null)}catch(t){console.error("Error fetching suggested price:",t),J(null)}finally{Z(!1)}}},ue=e=>0===l.filter(t=>t.product_id===e).length?"2024-01-01":"",he=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=e?ue(e):"";Y({product_id:e,price_usd:"",start_date:t,countries:[...I]}),J(null),te(!0),e&&de(e),E(!0)},pe=e=>e?new Date(e).toLocaleDateString():"Ongoing",me=e=>e.priceRange.min===e.priceRange.max?"$".concat(e.priceRange.min):"$".concat(e.priceRange.min," - $").concat(e.priceRange.max),fe=(e,t)=>{console.log("\ud83d\udd0d sortCountriesByRecentActivity called with:",{countriesCount:e.length,firstFewCountries:e.slice(0,5),hasProductCountries:!!t,productCountriesKeys:Object.keys(t||{}).slice(0,5)});const r=e.sort((e,r)=>{const n=t[e],a=t[r],s=e=>e&&e.rules&&0!==e.rules.length?new Date(e.rules[0].start_date):null,i=s(n),o=s(a);if(i&&o){const e=o-i;if(0!==e)return e}return i&&!o?-1:!i&&o?1:e.localeCompare(r)});if(e.includes("US")){console.log("\ud83c\udfaf Final sorted countries (first 10):",r.slice(0,10));const e=r.indexOf("US"),n=r.indexOf("AD"),a=r.indexOf("AE");console.log("\ud83d\udccd Positions - US: ".concat(e+1,", AD: ").concat(n+1,", AE: ").concat(a+1)),t.US&&t.US.rules&&t.US.rules[0]&&console.log("\ud83c\uddfa\ud83c\uddf8 US most recent rule:",t.US.rules[0].start_date,"$".concat(t.US.rules[0].price_usd)),t.AD&&t.AD.rules&&t.AD.rules[0]&&console.log("\ud83c\udde6\ud83c\udde9 AD most recent rule:",t.AD.rules[0].start_date,"$".concat(t.AD.rules[0].price_usd))}return r},ge=Object.keys(m).filter(e=>e.toLowerCase().includes(k.toLowerCase())).sort((e,t)=>{const r=m[e],n=m[t],a=(null===r||void 0===r?void 0:r.hasMissingRules)||!1,s=(null===n||void 0===n?void 0:n.hasMissingRules)||!1;if(a&&!s)return 1;if(!a&&s)return-1;const i=null===r||void 0===r?void 0:r.mostRecentTrialActivity,o=null===n||void 0===n?void 0:n.mostRecentTrialActivity;return i||o?i?o?o-i:-1:1:e.localeCompare(t)});return b?(0,ut.jsx)("div",{className:"container mx-auto p-6",children:(0,ut.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,ut.jsx)("div",{className:"text-lg",children:"Loading pricing rules..."})})}):(0,ut.jsxs)("div",{className:"container mx-auto p-6",children:[(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Pricing Management"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage product pricing across different countries and time periods"})]}),(0,ut.jsxs)("div",{className:"text-right",children:[(0,ut.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat("2.0.0"===h?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200":"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200"),children:["Schema v",h]}),"2.0.0"===h&&d.length>0&&(0,ut.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:"Enhanced with missing product detection"})]})]})}),ae&&(0,ut.jsx)("div",{className:"bg-emerald-50 border border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200 px-4 py-3 rounded-xl mb-4 shadow-sm",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ut.jsx)("div",{className:"w-8 h-8 rounded-full bg-emerald-500 flex items-center justify-center",children:(0,ut.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{className:"font-semibold",children:ae.message}),(0,ut.jsx)("p",{className:"text-sm opacity-80",children:"End dates have been automatically calculated based on newer rules"})]})]}),(0,ut.jsx)("button",{onClick:()=>se(null),className:"text-emerald-600 hover:text-emerald-800 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors",children:(0,ut.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),v&&(0,ut.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[v,(0,ut.jsx)("button",{onClick:()=>_(null),className:"float-right text-red-700 hover:text-red-900",children:"\xd7"})]}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6",children:(0,ut.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,ut.jsx)("div",{className:"flex-1 min-w-64",children:(0,ut.jsx)("input",{type:"text",placeholder:"Search by product ID...",value:k,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700"})}),(0,ut.jsxs)("div",{className:"flex gap-2",children:[(0,ut.jsx)("button",{onClick:()=>he(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"Create Rule"}),(0,ut.jsx)("button",{onClick:async()=>{try{y(!0);const e=await fetch("/api/pricing/repair-rules",{method:"POST"}),t=await e.json();t.success?(se({type:"success",message:"\ud83d\udd27 ".concat(t.message),timestamp:Date.now()}),setTimeout(()=>{ie()},1e3)):_(t.error||"Failed to repair rules")}catch(e){_("Network error during rule repair"),console.error("Error repairing rules:",e)}finally{y(!1)}},className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md",disabled:b,children:'\ud83d\udd27 Fix "Ongoing" Rules'}),(0,ut.jsx)("button",{onClick:ie,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md",children:"Refresh"})]})]})}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:ge.length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Products"})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600",children:ge.reduce((e,t)=>{var r;return e+((null===(r=m[t])||void 0===r?void 0:r.totalRules)||0)},0)}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Rules"})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold ".concat(ge.filter(e=>{var t;return null===(t=m[e])||void 0===t?void 0:t.hasMissingRules}).length>0?"text-red-600":"text-gray-400"),children:ge.filter(e=>{var t;return null===(t=m[e])||void 0===t?void 0:t.hasMissingRules}).length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Missing Rules"})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:[...new Set(ge.flatMap(e=>{var t;return(null===(t=m[e])||void 0===t?void 0:t.allCountries)||[]}))].length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Countries"})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:(()=>{const e=new Date;return e.setDate(e.getDate()-30),ge.filter(t=>{var r;const n=null===(r=m[t])||void 0===r?void 0:r.mostRecentPricingUpdate;return n&&n>e}).length})()}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recent Updates"})]}),(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:ge.filter(e=>w.has(e)).length}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expanded"})]})]}),(0,ut.jsx)("div",{className:"space-y-4",children:0===ge.length?(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center text-gray-500 dark:text-gray-400",children:0===Object.keys(m).length?"No pricing rules found":"No products match your search criteria"}):ge.map(e=>{var t;const r=m[e],n=w.has(e);return(0,ut.jsxs)("div",{className:"group relative overflow-hidden transition-all duration-300 ease-out ".concat(r.hasMissingRules?"bg-gradient-to-br from-rose-50 to-red-50 dark:from-red-950/30 dark:to-red-900/20 border-2 border-rose-200 dark:border-red-800/50 shadow-lg shadow-red-100/50 dark:shadow-red-900/20":"bg-white dark:bg-slate-900 border border-slate-200/60 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/30 dark:hover:shadow-slate-900/30"," rounded-2xl backdrop-blur-sm"),children:[(0,ut.jsxs)("div",{className:"relative p-6 border-b cursor-pointer transition-all duration-200 ".concat(r.hasMissingRules?"border-rose-200/70 dark:border-red-800/40 hover:bg-gradient-to-br hover:from-rose-100 hover:to-red-100 dark:hover:from-red-950/40 dark:hover:to-red-900/30":"border-slate-200/60 dark:border-slate-700/50 hover:bg-slate-50/70 dark:hover:bg-slate-800/50"),onClick:()=>(e=>{const t=new Set(w);t.has(e)?t.delete(e):t.add(e),N(t)})(e),children:[r.hasMissingRules&&(0,ut.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-rose-500 to-red-500 text-white text-xs font-semibold px-4 py-2 flex items-center gap-2",children:[(0,ut.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,ut.jsx)("span",{children:"MISSING PRICING RULES \u2014 URGENT ACTION REQUIRED"})]}),(0,ut.jsxs)("div",{className:"".concat(r.hasMissingRules?"mt-8":""," flex items-center justify-between"),children:[(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,ut.jsx)("h3",{className:"text-2xl font-bold tracking-tight ".concat(r.hasMissingRules?"text-red-900 dark:text-red-100":"text-slate-900 dark:text-slate-100"),children:e}),(0,ut.jsx)("div",{className:"flex items-center gap-2",children:(0,ut.jsx)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold transition-all ".concat(r.hasMissingRules?"bg-red-500 text-white shadow-md":"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300"),children:r.hasMissingRules?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Missing Rules"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Active Rules"]})})})]}),r.hasMissingRules&&r.missingProductInfo?(0,ut.jsx)("div",{className:"mb-4 p-4 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-red-200/50 dark:border-red-800/50 rounded-xl shadow-sm",children:(0,ut.jsx)("div",{className:"space-y-2",children:(0,ut.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ut.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{className:"text-sm font-semibold text-red-900 dark:text-red-100 mb-1",children:"Active trials without pricing rules detected"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-red-800 dark:text-red-200",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:r.missingProductInfo.trial_count})," trial events"]}),(0,ut.jsxs)("div",{children:["First: ",(0,ut.jsx)("span",{className:"font-medium",children:pe(r.missingProductInfo.first_trial)})]}),(0,ut.jsxs)("div",{children:["Latest: ",(0,ut.jsx)("span",{className:"font-medium",children:pe(r.missingProductInfo.last_trial)})]}),(0,ut.jsx)("div",{className:"col-span-2 mt-1 text-red-700 dark:text-red-300 font-medium",children:"\u26a0\ufe0f Revenue analysis incomplete without pricing rules"})]})]})]})})}):(0,ut.jsxs)("div",{className:"flex items-center gap-6 mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ut.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,ut.jsxs)("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[(0,ut.jsx)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:r.totalRules})," rules"]})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ut.jsx)("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),(0,ut.jsxs)("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[(0,ut.jsx)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:r.allCountries.length})," countries"]})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ut.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,ut.jsxs)("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Last activity: ",(0,ut.jsx)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:pe(null===(t=r.mostRecentTrialActivity)||void 0===t?void 0:t.toISOString().split("T")[0])})]})]})]}),!r.hasMissingRules&&r.allCountries.length>0&&(0,ut.jsxs)("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[fe([...r.allCountries],r.countries).slice(0,12).map(e=>(0,ut.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200/50 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800/50 transition-colors hover:bg-blue-100 dark:hover:bg-blue-900/50",children:e},e)),r.allCountries.length>12&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200/50 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700",children:["+",r.allCountries.length-12," more"]})]}),!r.hasMissingRules&&(()=>{const e=(e=>{if(!e||!e.countries||0===Object.keys(e.countries).length)return[];const t=[];Object.values(e.countries).forEach(e=>{t.push(...e.rules)});const r=t.filter((e,t,r)=>t===r.findIndex(t=>t.rule_id===e.rule_id)),n=r.sort((e,t)=>new Date(e.start_date)-new Date(t.start_date)),a=[];let s=null;return n.forEach(e=>{e.price_usd!==s&&(a.push({price:e.price_usd,date:e.start_date,ruleId:e.rule_id}),s=e.price_usd)}),a})(r);return e.length>0&&(0,ut.jsxs)("div",{className:"p-4 bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-800/50 dark:to-slate-900/50 rounded-xl border border-slate-200/50 dark:border-slate-700/50 backdrop-blur-sm",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ut.jsx)("div",{className:"w-6 h-6 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center",children:(0,ut.jsx)("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,ut.jsx)("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:"Price Evolution"})]}),(0,ut.jsx)("div",{className:"flex-1"}),(0,ut.jsxs)("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/70 dark:bg-slate-800/70 px-2 py-1 rounded-md",children:[e.length," changes"]})]}),(0,ut.jsx)("div",{className:"flex items-center gap-3 overflow-x-auto pb-2",style:{scrollbarWidth:"thin"},children:e.map((t,r)=>(0,ut.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,ut.jsx)("div",{className:"text-center group",children:(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("div",{className:"text-xl font-black text-emerald-700 dark:text-emerald-400 mb-0.5 group-hover:scale-105 transition-transform",children:["$",t.price]}),(0,ut.jsx)("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-0.5 rounded-md shadow-sm",children:pe(t.date)})]})}),r<e.length-1&&(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"w-8 h-0.5 bg-gradient-to-r from-slate-300 to-slate-400 dark:from-slate-600 dark:to-slate-500 rounded-full"}),(0,ut.jsx)("svg",{className:"w-3 h-3 text-slate-400 dark:text-slate-500 -ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]},t.ruleId))})]})})()]}),(0,ut.jsxs)("div",{className:"flex items-center gap-3 ml-6",children:[(0,ut.jsx)("button",{onClick:t=>{t.stopPropagation(),he(e)},className:"group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-lg ".concat(r.hasMissingRules?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-red-200 dark:shadow-red-900/30":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/30"),children:(0,ut.jsxs)("div",{className:"relative z-10 flex items-center gap-2",children:[(0,ut.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),r.hasMissingRules?"Create First Rule":"Add Rule"]})}),!r.hasMissingRules&&(0,ut.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{try{const t=await fetch("/api/pricing/rules/".concat(e,"/history")),r=await t.json();r.success?z({productId:e,data:r.data}):console.error("Failed to load rule history:",r.error)}catch(t){console.error("Error loading rule history:",t)}})(e)},className:"group relative overflow-hidden px-5 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white shadow-lg shadow-slate-200 dark:shadow-slate-900/30",children:(0,ut.jsxs)("div",{className:"relative z-10 flex items-center gap-2",children:[(0,ut.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"History"]})}),(0,ut.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-xl bg-slate-100 dark:bg-slate-800 group-hover:bg-slate-200 dark:group-hover:bg-slate-700 transition-colors",children:(0,ut.jsx)("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-400 transform transition-transform duration-200 ".concat(n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),n&&(0,ut.jsx)("div",{className:"p-6 bg-gradient-to-br from-slate-50/50 to-white dark:from-slate-800/50 dark:to-slate-900/50",children:(0,ut.jsx)("div",{className:"space-y-6",children:fe([...r.allCountries],r.countries).map(e=>{const t=r.countries[e];return(0,ut.jsxs)("div",{className:"group relative overflow-hidden bg-white dark:bg-slate-800/90 border border-slate-200/60 dark:border-slate-700/50 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 backdrop-blur-sm",children:[(0,ut.jsx)("div",{className:"relative p-6 bg-gradient-to-r from-slate-50 via-white to-slate-50 dark:from-slate-800/80 dark:via-slate-800/60 dark:to-slate-800/80 border-b border-slate-200/60 dark:border-slate-700/50",children:(0,ut.jsx)("div",{className:"flex items-center justify-between",children:(0,ut.jsxs)("div",{className:"flex items-center gap-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ut.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-200/50 dark:shadow-blue-900/30",children:(0,ut.jsx)("span",{className:"text-white font-bold text-lg",children:e.slice(0,2).toUpperCase()})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:e}),(0,ut.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Pricing timeline"})]})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm rounded-xl border border-slate-200/50 dark:border-slate-700/50 shadow-sm",children:[(0,ut.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,ut.jsxs)("span",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:[t.rules.length," rules"]})]}),(0,ut.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/30 dark:to-green-900/30 backdrop-blur-sm rounded-xl border border-emerald-200/50 dark:border-emerald-800/50 shadow-sm",children:[(0,ut.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,ut.jsx)("span",{className:"text-lg font-black text-emerald-700 dark:text-emerald-400",children:me(t)})]})]})]})})}),(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,ut.jsx)("div",{className:"w-8 h-8 rounded-xl bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center shadow-md",children:(0,ut.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,ut.jsx)("h5",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:"Chronological Pricing History"}),(0,ut.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent dark:from-slate-700"})]}),(0,ut.jsx)("div",{className:"relative",children:(0,ut.jsx)("div",{className:"flex gap-6 overflow-x-auto pb-4 scrollbar-hide",style:{scrollbarWidth:"none"},children:t.rules.map((e,r)=>{const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=new Date,n=new Date(e.start_date);let a=e.end_date?new Date(e.end_date):null;if(!a&&t&&Array.isArray(t)){const r=t.filter(t=>t.rule_id!==e.rule_id).sort((e,t)=>new Date(e.start_date)-new Date(t.start_date)),s=r.find(e=>new Date(e.start_date)>n);if(s){const e=new Date(s.start_date);a=new Date(e.getTime()-864e5)}}return a&&r>a?"Historical":r>=n&&(!a||r<=a)?"Active":"Future"}(e,t.rules),a="Active"===n,s="Future"===n,i="Historical"===n;return(0,ut.jsxs)("div",{className:"relative flex-shrink-0 w-80 group/card transition-all duration-300 hover:scale-105",children:[r<t.rules.length-1&&(0,ut.jsx)("div",{className:"absolute top-1/2 -right-3 z-10 w-6 h-px bg-gradient-to-r from-slate-300 via-slate-400 to-slate-300 dark:from-slate-600 dark:via-slate-500 dark:to-slate-600"}),(0,ut.jsxs)("div",{className:"relative overflow-hidden rounded-2xl shadow-lg transition-all duration-300 group-hover/card:shadow-xl ".concat(a?"bg-gradient-to-br from-emerald-50 via-green-50 to-emerald-100 dark:from-emerald-950/50 dark:via-emerald-900/30 dark:to-green-900/40 border-2 border-emerald-300/60 dark:border-emerald-700/50 shadow-emerald-200/50 dark:shadow-emerald-900/30":s?"bg-gradient-to-br from-blue-50 via-sky-50 to-blue-100 dark:from-blue-950/50 dark:via-blue-900/30 dark:to-sky-900/40 border-2 border-blue-300/60 dark:border-blue-700/50 shadow-blue-200/50 dark:shadow-blue-900/30":"bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 dark:from-slate-800/50 dark:via-slate-900/30 dark:to-slate-800/40 border-2 border-slate-300/60 dark:border-slate-700/50 shadow-slate-200/50 dark:shadow-slate-900/30"),children:[(0,ut.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-current to-transparent opacity-60"}),(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ".concat(a?"bg-emerald-500 text-white":s?"bg-blue-500 text-white":"bg-slate-500 text-white"),children:[a&&(0,ut.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),s&&(0,ut.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),i&&(0,ut.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),n.toUpperCase()]}),(0,ut.jsx)("div",{className:"text-xs font-mono text-slate-500 dark:text-slate-400 bg-white/80 dark:bg-slate-800/80 px-2 py-1 rounded-lg",children:e.rule_id.slice(-8)})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"text-4xl font-black text-slate-900 dark:text-slate-100 mb-2 tracking-tight",children:["$",e.price_usd]}),(0,ut.jsxs)("div",{className:"text-sm font-semibold ".concat(a?"text-emerald-700 dark:text-emerald-300":s?"text-blue-700 dark:text-blue-300":"text-slate-600 dark:text-slate-400"),children:[pe(e.start_date),(0,ut.jsx)("span",{className:"mx-2 opacity-60",children:"\u2192"}),pe(e.end_date)||(0,ut.jsxs)("span",{className:"inline-flex items-center gap-1 ".concat(a?"text-emerald-600":"text-slate-500"),children:[a&&(0,ut.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),"Ongoing"]})]})]}),(0,ut.jsx)("button",{onClick:t=>{t.stopPropagation(),le(e.rule_id)},className:"w-full group/btn relative overflow-hidden px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg ".concat(a?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-200 dark:shadow-emerald-900/50":s?"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200 dark:shadow-blue-900/50":"bg-slate-600 hover:bg-slate-700 text-white shadow-slate-200 dark:shadow-slate-900/50"),children:(0,ut.jsxs)("div",{className:"relative z-10 flex items-center justify-center gap-2",children:[(0,ut.jsx)("svg",{className:"w-4 h-4 transition-transform group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Data Source"]})})]})]})]},e.rule_id)})})})]})]},e)})})})]},e)})}),(0,ut.jsxs)("div",{className:"mt-6 text-sm text-gray-500 dark:text-gray-400 text-center",children:["Pricing rules are organized by product and country for easy market management.",(0,ut.jsx)("br",{}),(0,ut.jsxs)("span",{className:"inline-flex items-center gap-4 mt-2",children:[(0,ut.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-green-100 border border-green-300 rounded"}),"Active"]}),(0,ut.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-blue-100 border border-blue-300 rounded"}),"Future"]}),(0,ut.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ut.jsx)("div",{className:"w-3 h-3 bg-gray-100 border border-gray-300 rounded"}),"Historical"]})]})]}),C&&(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,ut.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"\u2795 Create New Pricing Rule"}),(0,ut.jsx)("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,ut.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Create a new pricing rule for a product and countries"})]}),(0,ut.jsx)("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:(0,ut.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("/api/pricing/rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:K.product_id,price_usd:parseFloat(K.price_usd),start_date:K.start_date,countries:K.countries})}),t=await e.json();t.success?(E(!1),Y({product_id:"",price_usd:"",start_date:"",countries:[]}),ie()):_(t.error||"Failed to create rule")}catch(t){_("Network error creating rule"),console.error("Error creating rule:",t)}},className:"space-y-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Product ID *"}),(0,ut.jsxs)("select",{value:K.product_id,onChange:e=>{const t=e.target.value;Y(Ie(Ie({},K),{},{product_id:t,start_date:ue(t)})),t?de(t):J(null)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[(0,ut.jsx)("option",{value:"",children:"Select a product..."}),R.map(e=>(0,ut.jsx)("option",{value:e,children:e},e))]}),K.product_id&&(null===(e=m[K.product_id])||void 0===e?void 0:e.hasMissingRules)&&(0,ut.jsxs)("div",{className:"mt-2 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 text-amber-800 dark:text-amber-200 text-sm",children:[(0,ut.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,ut.jsx)("span",{className:"font-medium",children:"First pricing rule for this product!"})]}),(null===(t=m[K.product_id])||void 0===t?void 0:t.missingProductInfo)&&(0,ut.jsxs)("div",{className:"mt-1 text-xs text-amber-700 dark:text-amber-300",children:["This product has ",m[K.product_id].missingProductInfo.trial_count," trial events but no pricing rules yet."]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Price (USD) *"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"$"})}),(0,ut.jsx)("input",{type:"number",step:"0.01",min:"0",value:K.price_usd,onChange:e=>Y(Ie(Ie({},K),{},{price_usd:e.target.value})),className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"29.99",required:!0}),Q&&(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ut.jsxs)("svg",{className:"animate-spin h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[(0,ut.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,ut.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),X&&(0,ut.jsxs)("div",{className:"mt-2 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-2 text-green-800 dark:text-green-200 text-sm",children:[(0,ut.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,ut.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,ut.jsxs)("span",{className:"font-medium",children:["Suggested: $",X.suggested_price," from most recent conversion"]})]}),(0,ut.jsx)("button",{type:"button",onClick:()=>Y(Ie(Ie({},K),{},{price_usd:X.suggested_price.toString()})),className:"text-xs bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded",children:"Use This"})]}),(0,ut.jsx)("div",{className:"mt-1 text-xs text-green-700 dark:text-green-300",children:X.note})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Date *"}),(0,ut.jsx)("input",{type:"date",value:K.start_date,onChange:e=>Y(Ie(Ie({},K),{},{start_date:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),K.product_id&&(0,ut.jsx)("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:0===l.filter(e=>e.product_id===K.product_id).length?"\ud83d\udca1 First rule for this product - defaulted to Jan 1, 2024":"\ud83d\udcc5 Additional rule - choose when this pricing takes effect"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Countries *"}),(0,ut.jsxs)("button",{type:"button",onClick:()=>{ee?(Y(Ie(Ie({},K),{},{countries:[]})),te(!1)):(Y(Ie(Ie({},K),{},{countries:[...I]})),te(!0))},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:[ee?"Deselect All":"Select All"," (",I.length,")"]})]}),(0,ut.jsx)("div",{className:"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2",children:I.map(e=>(0,ut.jsxs)("label",{className:"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer",children:[(0,ut.jsx)("input",{type:"checkbox",checked:K.countries.includes(e),onChange:t=>{if(t.target.checked){const t=[...K.countries,e];Y(Ie(Ie({},K),{},{countries:t})),te(t.length===I.length)}else{const t=K.countries.filter(t=>t!==e);Y(Ie(Ie({},K),{},{countries:t})),te(!1)}},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"}),(0,ut.jsx)("span",{className:"text-gray-900 dark:text-gray-100 font-medium",children:e})]},e))}),(0,ut.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:[K.countries.length," of ",I.length," countries selected"]}),K.countries.length>0&&(0,ut.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"\u2713 Ready to create rule"})]})]}),(0,ut.jsxs)("div",{className:"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("button",{type:"submit",disabled:!K.product_id||!K.price_usd||!K.start_date||0===K.countries.length,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl",children:"Create Pricing Rule"}),(0,ut.jsx)("button",{type:"button",onClick:()=>E(!1),className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Cancel"})]})]})})]})}),W&&P&&(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,ut.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"\u270f\ufe0f Edit Pricing Rule"}),(0,ut.jsx)("button",{onClick:()=>{q(!1),A(null)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,ut.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,ut.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Modify pricing rule for ",G.product_id," \u2022 Rule ID: ",G.rule_id]})]}),(0,ut.jsx)("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:(0,ut.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("/api/pricing/rules/".concat(G.rule_id,"?simple_edit=true"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:G.product_id,price_usd:parseFloat(G.price_usd),start_date:G.start_date,countries:G.countries})}),t=await e.json();t.success?(q(!1),A(null),$({rule_id:"",product_id:"",price_usd:"",start_date:"",countries:[]}),ie(),_(null)):_(t.error||"Failed to update rule")}catch(t){_("Network error updating rule"),console.error("Error updating rule:",t)}},className:"space-y-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rule ID (Read-only)"}),(0,ut.jsx)("input",{type:"text",value:G.rule_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Product ID (Read-only)"}),(0,ut.jsx)("input",{type:"text",value:G.product_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400"}),(0,ut.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Product ID cannot be changed to maintain data integrity"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Price (USD) *"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"$"})}),(0,ut.jsx)("input",{type:"number",step:"0.01",min:"0",value:G.price_usd,onChange:e=>$(Ie(Ie({},G),{},{price_usd:e.target.value})),className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),P&&G.price_usd!==P.price_usd.toString()&&(0,ut.jsxs)("div",{className:"mt-2 text-sm text-amber-600 dark:text-amber-400",children:["\u26a0\ufe0f Changing from $",P.price_usd," to $",G.price_usd]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Date *"}),(0,ut.jsx)("input",{type:"date",value:G.start_date,onChange:e=>$(Ie(Ie({},G),{},{start_date:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),P&&G.start_date!==P.start_date&&(0,ut.jsxs)("div",{className:"mt-2 text-sm text-amber-600 dark:text-amber-400",children:["\u26a0\ufe0f Changing from ",pe(P.start_date)," to ",pe(G.start_date)]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Countries *"}),(0,ut.jsxs)("button",{type:"button",onClick:()=>{G.countries.length===I.length?$(Ie(Ie({},G),{},{countries:[]})):$(Ie(Ie({},G),{},{countries:[...I]}))},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:[G.countries.length===I.length?"Deselect All":"Select All"," (",I.length,")"]})]}),(0,ut.jsx)("div",{className:"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-700 space-y-2",children:I.map(e=>(0,ut.jsxs)("label",{className:"flex items-center space-x-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 p-1 rounded cursor-pointer",children:[(0,ut.jsx)("input",{type:"checkbox",checked:G.countries.includes(e),onChange:t=>{t.target.checked?$(Ie(Ie({},G),{},{countries:[...G.countries,e]})):$(Ie(Ie({},G),{},{countries:G.countries.filter(t=>t!==e)}))},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,ut.jsx)("span",{className:"text-gray-900 dark:text-gray-100 font-medium",children:e})]},e))}),(0,ut.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs",children:[(0,ut.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:[G.countries.length," of ",I.length," countries selected"]}),P&&JSON.stringify(G.countries.sort())!==JSON.stringify(P.countries.sort())&&(0,ut.jsx)("span",{className:"text-amber-600 dark:text-amber-400 font-medium",children:"\u26a0\ufe0f Countries modified"})]})]}),P&&(G.price_usd!==P.price_usd.toString()||G.start_date!==P.start_date||JSON.stringify(G.countries.sort())!==JSON.stringify(P.countries.sort()))&&(0,ut.jsxs)("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[(0,ut.jsx)("h4",{className:"font-medium text-amber-800 dark:text-amber-200 mb-2",children:"\ud83d\udcdd Changes Summary"}),(0,ut.jsxs)("div",{className:"text-sm text-amber-700 dark:text-amber-300 space-y-1",children:[G.price_usd!==P.price_usd.toString()&&(0,ut.jsxs)("div",{children:["\u2022 Price: $",P.price_usd," \u2192 $",G.price_usd]}),G.start_date!==P.start_date&&(0,ut.jsxs)("div",{children:["\u2022 Start Date: ",pe(P.start_date)," \u2192 ",pe(G.start_date)]}),JSON.stringify(G.countries.sort())!==JSON.stringify(P.countries.sort())&&(0,ut.jsxs)("div",{children:["\u2022 Countries: ",P.countries.length," \u2192 ",G.countries.length," selected"]})]})]}),(0,ut.jsxs)("div",{className:"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("button",{type:"submit",disabled:!G.price_usd||!G.start_date||0===G.countries.length,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-lg hover:shadow-xl",children:"\ud83d\udcbe Save Changes"}),(0,ut.jsx)("button",{type:"button",onClick:()=>{q(!1),A(null)},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Cancel"})]})]})})]})}),F&&(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl max-h-[80vh] overflow-hidden",children:[(0,ut.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["\ud83d\udcca Data Provenance: Rule ",F.ruleId]}),(0,ut.jsx)("button",{onClick:()=>B(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,ut.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"This shows the underlying data that led to the creation of this pricing rule"})]}),(0,ut.jsx)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:F.data?(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[(0,ut.jsx)("h4",{className:"font-semibold text-blue-900 dark:text-blue-200 mb-2",children:"Rule Summary"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Product:"})," ",F.data.product_id]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Countries:"})," ",null===(r=F.data.countries)||void 0===r?void 0:r.join(", ")]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"USD Price:"})," $",F.data.price_usd]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Date Range:"})," ",F.data.start_date," \u2192 ",F.data.end_date||"ongoing"]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:["\ud83d\udd0d Underlying Events (",F.data.events_analyzed||0," events)"]}),(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4",children:[(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"These are the actual pricing events from your database that led to this rule:"}),(0,ut.jsx)("div",{className:"overflow-x-auto",children:(0,ut.jsxs)("table",{className:"w-full text-xs",children:[(0,ut.jsx)("thead",{children:(0,ut.jsxs)("tr",{className:"bg-gray-200 dark:bg-gray-700",children:[(0,ut.jsx)("th",{className:"p-2 text-left",children:"Trial Start"}),(0,ut.jsx)("th",{className:"p-2 text-left",children:"Conversion"}),(0,ut.jsx)("th",{className:"p-2 text-left",children:"Actual Price"}),(0,ut.jsx)("th",{className:"p-2 text-left",children:"Country"}),(0,ut.jsx)("th",{className:"p-2 text-left",children:"User ID"})]})}),(0,ut.jsx)("tbody",{children:(F.data.sample_events||[]).map((e,t)=>{var r;return(0,ut.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[(0,ut.jsx)("td",{className:"p-2",children:e.trial_start_date}),(0,ut.jsx)("td",{className:"p-2",children:e.conversion_date}),(0,ut.jsxs)("td",{className:"p-2 font-mono",children:["$",e.actual_price]}),(0,ut.jsx)("td",{className:"p-2",children:e.country}),(0,ut.jsxs)("td",{className:"p-2 font-mono text-xs",children:[null===(r=e.user_id)||void 0===r?void 0:r.substring(0,8),"..."]})]},t)})})]})})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"\ud83d\udcb0 Price Analysis"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ut.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[(0,ut.jsx)("h5",{className:"font-medium text-green-900 dark:text-green-200 mb-2",children:"Actual Prices Charged"}),(0,ut.jsx)("div",{className:"text-sm space-y-1",children:(F.data.actual_prices||[]).map((e,t)=>{var r;return(0,ut.jsxs)("div",{className:"flex justify-between",children:[(0,ut.jsxs)("span",{className:"font-mono",children:["$",e]}),(0,ut.jsxs)("span",{className:"text-xs text-gray-500",children:[(null===(r=F.data.price_counts)||void 0===r?void 0:r[e])||0," events"]})]},t)})})]}),(0,ut.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4",children:[(0,ut.jsx)("h5",{className:"font-medium text-yellow-900 dark:text-yellow-200 mb-2",children:"USD Clustering"}),(0,ut.jsxs)("div",{className:"text-sm space-y-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Target USD:"})," $",F.data.price_usd]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Price Range:"})," $",(null===(n=F.data.price_range)||void 0===n?void 0:n.min)||0," - $",(null===(a=F.data.price_range)||void 0===a?void 0:a.max)||0]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Variance:"})," ",F.data.price_variance||0,"%"]}),(0,ut.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Prices were clustered within 15% tolerance to account for FX fluctuations and rounding"})]})]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"\ud83d\udd2c Detection Logic"}),(0,ut.jsx)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"text-sm space-y-2",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Method:"})," ",F.data.detection_method||"USD price clustering"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Confidence:"})," ",F.data.confidence_score||"High"]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"font-medium",children:"Notes:"})," ",F.data.notes||"Auto-generated from conversion events"]})]})})]})]}):(0,ut.jsx)("div",{className:"text-center py-8",children:(0,ut.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading data provenance information..."})})}),(0,ut.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:(0,ut.jsx)("div",{className:"flex justify-end",children:(0,ut.jsx)("button",{onClick:()=>B(null),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md",children:"Close"})})})]})}),U&&(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[(0,ut.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["\ud83d\udcdc Rule History: ",U.productId]}),(0,ut.jsx)("button",{onClick:()=>z(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,ut.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Complete chronological history of pricing rule changes (newest first)"})]}),(0,ut.jsx)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:null!==(i=U.data)&&void 0!==i&&i.history&&U.data.history.length>0?(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,ut.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:U.data.history.filter(e=>"created"===e.action).length}),(0,ut.jsx)("div",{className:"text-sm text-green-800 dark:text-green-300",children:"Rules Created"})]}),(0,ut.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:U.data.history.filter(e=>"updated"===e.action).length}),(0,ut.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:"Rules Updated"})]}),(0,ut.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 text-center",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:U.data.history.filter(e=>"deleted"===e.action).length}),(0,ut.jsx)("div",{className:"text-sm text-red-800 dark:text-red-300",children:"Rules Deleted"})]})]}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"\ud83d\udcc5 Chronological History (Newest First)"}),U.data.history.map((e,t)=>{var r,n,a;const s=l.find(t=>t.rule_id===e.rule_data.rule_id),i="deleted"!==e.action&&s;return(0,ut.jsxs)("div",{className:"relative p-6 rounded-xl border-l-4 shadow-lg ".concat("created"===e.action?"bg-green-50 border-green-400 dark:bg-green-900/20":"updated"===e.action?"bg-blue-50 border-blue-400 dark:bg-blue-900/20":"bg-red-50 border-red-400 dark:bg-red-900/20"),children:[t<U.data.history.length-1&&(0,ut.jsx)("div",{className:"absolute left-0 bottom-0 w-1 h-6 bg-gray-300 transform translate-y-full"}),(0,ut.jsxs)("div",{className:"flex items-start justify-between",children:[(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,ut.jsx)("span",{className:"px-3 py-1 text-sm font-bold rounded-full ".concat("created"===e.action?"bg-green-100 text-green-800":"updated"===e.action?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:"created"===e.action?"\u2705 CREATED":"updated"===e.action?"\ud83d\udcdd UPDATED":"\ud83d\uddd1\ufe0f DELETED"}),(0,ut.jsxs)("div",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["$",e.rule_data.price_usd]}),(0,ut.jsxs)("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full",children:[null===(r=e.rule_data.countries)||void 0===r?void 0:r.length," countries"]}),(0,ut.jsx)("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded font-mono",children:e.rule_data.rule_id})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date Range"}),(0,ut.jsxs)("div",{className:"text-base text-gray-900 dark:text-gray-100",children:[pe(e.rule_data.start_date)," \u2192 ",pe(e.rule_data.end_date)||"Ongoing"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Countries Applied"}),(0,ut.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[null===(n=e.rule_data.countries)||void 0===n?void 0:n.slice(0,3).join(", "),(null===(a=e.rule_data.countries)||void 0===a?void 0:a.length)>3&&" +".concat(e.rule_data.countries.length-3," more")]})]})]}),e.user_notes&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-600 mb-4",children:[(0,ut.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.user_notes})]}),(0,ut.jsxs)("div",{className:"flex gap-3",children:[i&&(0,ut.jsx)("button",{onClick:()=>{var e;z(null),$({rule_id:(e=s).rule_id,product_id:e.product_id,price_usd:e.price_usd.toString(),start_date:e.start_date,countries:[...e.countries]}),A(e),q(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm",children:"\u270f\ufe0f Edit This Rule"}),(0,ut.jsx)("button",{onClick:()=>{z(null),le(e.rule_data.rule_id)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm",children:"\ud83d\udcca View Data Source"}),i&&(0,ut.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete rule ".concat(e.rule_data.rule_id,"?"))&&((async e=>{if(window.confirm("Are you sure you want to delete this pricing rule?"))try{const t=await fetch("/api/pricing/rules/".concat(e,"?hard_delete=true"),{method:"DELETE"}),r=await t.json();r.success?(c(l.filter(t=>t.rule_id!==e)),ie()):_(r.error||"Failed to delete rule")}catch(t){_("Network error deleting rule"),console.error("Error deleting rule:",t)}})(e.rule_data.rule_id),z(null))},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm",children:"\ud83d\uddd1\ufe0f Delete Rule"})]})]}),(0,ut.jsxs)("div",{className:"text-right text-sm text-gray-500 dark:text-gray-400 ml-6",children:[(0,ut.jsx)("div",{className:"font-medium",children:new Date(e.timestamp).toLocaleDateString()}),(0,ut.jsx)("div",{children:new Date(e.timestamp).toLocaleTimeString()}),!i&&"deleted"!==e.action&&(0,ut.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"Rule no longer exists"})]})]})]},e.entry_id)})]})]}):(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcdc"}),(0,ut.jsx)("div",{className:"text-xl font-medium text-gray-600 dark:text-gray-400 mb-2",children:"No Rule History Yet"}),(0,ut.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Create your first pricing rule to start tracking changes"})]})}),(0,ut.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(null===(o=U.data)||void 0===o?void 0:o.total_count)||0," total changes tracked"]}),(0,ut.jsx)("button",{onClick:()=>z(null),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium",children:"Close History"})]})})]})})]})},yF=ze("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),vF=ze("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),_F=ze("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),kF=Object.create(null);kF.open="0",kF.close="1",kF.ping="2",kF.pong="3",kF.message="4",kF.upgrade="5",kF.noop="6";const jF=Object.create(null);Object.keys(kF).forEach(e=>{jF[kF[e]]=e});const wF={type:"error",data:"parser error"},NF="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),SF="function"===typeof ArrayBuffer,OF=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,CF=(e,t,r)=>{let{type:n,data:a}=e;return NF&&a instanceof Blob?t?r(a):EF(a,r):SF&&(a instanceof ArrayBuffer||OF(a))?t?r(a):EF(new Blob([a]),r):r(kF[n]+(a||""))},EF=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};function PF(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let AF;const TF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",MF="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let r=0;r<64;r++)MF[TF.charCodeAt(r)]=r;const RF="function"===typeof ArrayBuffer,DF=(e,t)=>{if("string"!==typeof e)return{type:"message",data:LF(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:IF(e.substring(1),t)};return jF[r]?e.length>1?{type:jF[r],data:e.substring(1)}:{type:jF[r]}:wF},IF=(e,t)=>{if(RF){const r=(e=>{let t,r,n,a,s,i=.75*e.length,o=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);const c=new ArrayBuffer(i),d=new Uint8Array(c);for(t=0;t<o;t+=4)r=MF[e.charCodeAt(t)],n=MF[e.charCodeAt(t+1)],a=MF[e.charCodeAt(t+2)],s=MF[e.charCodeAt(t+3)],d[l++]=r<<2|n>>4,d[l++]=(15&n)<<4|a>>2,d[l++]=(3&a)<<6|63&s;return c})(e);return LF(r,t)}return{base64:!0,data:e}},LF=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,FF=String.fromCharCode(30);function BF(){return new TransformStream({transform(e,t){!function(e,t){NF&&e.data instanceof Blob?e.data.arrayBuffer().then(PF).then(t):SF&&(e.data instanceof ArrayBuffer||OF(e.data))?t(PF(e.data)):CF(e,!1,e=>{AF||(AF=new TextEncoder),t(AF.encode(e))})}(e,r=>{const n=r.length;let a;if(n<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,n);else if(n<65536){a=new Uint8Array(3);const e=new DataView(a.buffer);e.setUint8(0,126),e.setUint16(1,n)}else{a=new Uint8Array(9);const e=new DataView(a.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(n))}e.data&&"string"!==typeof e.data&&(a[0]|=128),t.enqueue(a),t.enqueue(r)})}})}let UF;function zF(e){return e.reduce((e,t)=>e+t.length,0)}function VF(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let a=0;a<t;a++)r[a]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function HF(e){if(e)return function(e){for(var t in HF.prototype)e[t]=HF.prototype[t];return e}(e)}HF.prototype.on=HF.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},HF.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},HF.prototype.off=HF.prototype.removeListener=HF.prototype.removeAllListeners=HF.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a=0;a<n.length;a++)if((r=n[a])===t||r.fn===t){n.splice(a,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},HF.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var a=(r=r.slice(0)).length;n<a;++n)r[n].apply(this,t)}return this},HF.prototype.emitReserved=HF.prototype.emit,HF.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},HF.prototype.hasListeners=function(e){return!!this.listeners(e).length};const WF="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),qF="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function GF(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}const $F=qF.setTimeout,KF=qF.clearTimeout;function YF(e,t){t.useNativeTimers?(e.setTimeoutFn=$F.bind(qF),e.clearTimeoutFn=KF.bind(qF)):(e.setTimeoutFn=qF.setTimeout.bind(qF),e.clearTimeoutFn=qF.clearTimeout.bind(qF))}function XF(e){return"string"===typeof e?function(e){let t=0,r=0;for(let n=0,a=e.length;n<a;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(e):Math.ceil(1.33*(e.byteLength||e.size))}function JF(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class QF extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class ZF extends HF{constructor(e){super(),this.writable=!1,YF(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new QF(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=DF(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}class eB extends ZF{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const r=e.split(FF),n=[];for(let a=0;a<r.length;a++){const e=DF(r[a],t);if(n.push(e),"error"===e.type)break}return n})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let a=0;e.forEach((e,s)=>{CF(e,!1,e=>{n[s]=e,++a===r&&t(n.join(FF))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=JF()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let tB=!1;try{tB="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(uU){}const rB=tB;function nB(){}class aB extends eB{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class sB extends HF{constructor(e,t,r){super(),this.createRequest=e,YF(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var e;const t=GF(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(dU){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(dU){}try{r.setRequestHeader("Accept","*/*")}catch(dU){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof r.status?r.status:0)},0))},r.send(this._data)}catch(dU){return void this.setTimeoutFn(()=>{this._onError(dU)},0)}"undefined"!==typeof document&&(this._index=sB.requestsCount++,sB.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=nB,e)try{this._xhr.abort()}catch(dU){}"undefined"!==typeof document&&delete sB.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(sB.requestsCount=0,sB.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",iB);else if("function"===typeof addEventListener){addEventListener("onpagehide"in qF?"pagehide":"unload",iB,!1)}function iB(){for(let e in sB.requests)sB.requests.hasOwnProperty(e)&&sB.requests[e].abort()}const oB=function(){const e=lB({xdomain:!1});return e&&null!==e.responseType}();function lB(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||rB))return new XMLHttpRequest}catch(dU){}if(!t)try{return new(qF[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(dU){}}const cB="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class dB extends ZF{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,r=cB?{}:GF(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(uU){return this.emitReserved("error",uU)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;CF(r,this.supportsBinary,e=>{try{this.doWrite(r,e)}catch(dU){}n&&WF(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=JF()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const uB=qF.WebSocket||qF.MozWebSocket;const hB={websocket:class extends dB{createSocket(e,t,r){return cB?new uB(e,t,r):t?new uB(e,t):new uB(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends ZF{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(uU){return this.emitReserved("error",uU)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){UF||(UF=new TextDecoder);const r=[];let n=0,a=-1,s=!1;return new TransformStream({transform(i,o){for(r.push(i);;){if(0===n){if(zF(r)<1)break;const e=VF(r,1);s=128===(128&e[0]),a=127&e[0],n=a<126?3:126===a?1:2}else if(1===n){if(zF(r)<2)break;const e=VF(r,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),n=3}else if(2===n){if(zF(r)<8)break;const e=VF(r,8),t=new DataView(e.buffer,e.byteOffset,e.length),s=t.getUint32(0);if(s>Math.pow(2,21)-1){o.enqueue(wF);break}a=s*Math.pow(2,32)+t.getUint32(4),n=3}else{if(zF(r)<a)break;const e=VF(r,a);o.enqueue(DF(s?e:UF.decode(e),t)),n=0}if(0===a||a>e){o.enqueue(wF);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),n=BF();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const a=()=>{r.read().then(e=>{let{done:t,value:r}=e;t||(this.onPacket(r),a())}).catch(e=>{})};a();const s={type:"open"};this.query.sid&&(s.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(s).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;this._writer.write(r).then(()=>{n&&WF(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends aB{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=oB&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new sB(lB,this.uri(),e)}}},pB=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,mB=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function fB(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let a=pB.exec(e||""),s={},i=14;for(;i--;)s[mB[i]]=a[i]||"";return-1!=r&&-1!=n&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,s.path),s.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(r[t]=n)}),r}(0,s.query),s}const gB="function"===typeof addEventListener&&"function"===typeof removeEventListener,xB=[];gB&&addEventListener("offline",()=>{xB.forEach(e=>e())},!1);class bB extends HF{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const r=fB(e);t.hostname=r.host,t.secure="https"===r.protocol||"wss"===r.protocol,t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=fB(t.host).host);YF(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let n=0,a=r.length;n<a;n++){let e=r[n].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),gB&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},xB.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&bB.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",bB.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const r=this.writeBuffer[t].data;if(r&&(e+=XF(r)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,WF(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const a={type:e,data:t,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(bB.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),gB&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=xB.indexOf(this._offlineEventListener);-1!==e&&xB.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}bB.protocol=4;class yB extends bB{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;bB.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;bB.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{r||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function a(){r||(r=!0,c(),t.close(),t=null)}const s=e=>{const r=new Error("probe error: "+e);r.transport=t.name,a(),this.emitReserved("upgradeError",r)};function i(){s("transport closed")}function o(){s("socket closed")}function l(e){t&&e.name!==t.name&&a()}const c=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",i),this.off("close",o),this.off("upgrading",l)};t.once("open",n),t.once("error",s),t.once("close",i),this.once("close",o),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}class vB extends yB{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>hB[e]).filter(e=>!!e)),super(e,t)}}const _B="function"===typeof ArrayBuffer,kB=Object.prototype.toString,jB="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===kB.call(Blob),wB="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===kB.call(File);function NB(e){return _B&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||jB&&e instanceof Blob||wB&&e instanceof File}function SB(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(SB(e[t]))return!0;return!1}if(NB(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return SB(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&SB(e[r]))return!0;return!1}function OB(e){const t=[],r=e.data,n=e;return n.data=CB(r,t),n.attachments=t.length,{packet:n,buffers:t}}function CB(e,t){if(!e)return e;if(NB(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=CB(e[n],t);return r}if("object"===typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=CB(e[n],t));return r}return e}function EB(e,t){return e.data=PB(e.data,t),delete e.attachments,e}function PB(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=PB(e[r],t);else if("object"===typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=PB(e[r],t));return e}const AB=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],TB=5;var MB;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(MB||(MB={}));class RB{constructor(e){this.replacer=e}encode(e){return e.type!==MB.EVENT&&e.type!==MB.ACK||!SB(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===MB.EVENT?MB.BINARY_EVENT:MB.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==MB.BINARY_EVENT&&e.type!==MB.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=OB(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}function DB(e){return"[object Object]"===Object.prototype.toString.call(e)}class IB extends HF{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===MB.BINARY_EVENT;r||t.type===MB.BINARY_ACK?(t.type=r?MB.EVENT:MB.ACK,this.reconstructor=new LB(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!NB(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===MB[r.type])throw new Error("unknown packet type "+r.type);if(r.type===MB.BINARY_EVENT||r.type===MB.BINARY_ACK){const n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const a=e.substring(n,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(a)}if("/"===e.charAt(t+1)){const n=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;for(;++t;){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!IB.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(dU){return!1}}static isPayloadValid(e,t){switch(e){case MB.CONNECT:return DB(t);case MB.DISCONNECT:return void 0===t;case MB.CONNECT_ERROR:return"string"===typeof t||DB(t);case MB.EVENT:case MB.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===AB.indexOf(t[0]));case MB.ACK:case MB.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class LB{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=EB(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function FB(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const BB=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class UB extends HF{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[FB(e,"open",this.onopen.bind(this)),FB(e,"packet",this.onpacket.bind(this)),FB(e,"error",this.onerror.bind(this)),FB(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,r,n;if(BB.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const o={type:MB.EVENT,data:s,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"===typeof s[s.length-1]){const e=this.ids++,t=s.pop();this._registerAckCallback(e,t),o.id=e}const l=null===(r=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===r?void 0:r.writable,c=this.connected&&!(null===(n=this.io.engine)||void 0===n?void 0:n._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var r,n=this;const a=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===a)return void(this.acks[e]=t);const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},a),i=function(){n.io.clearTimeoutFn(s);for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];t.apply(n,r)};i.withError=!0,this.acks[e]=i}emitWithAck(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new Promise((t,n)=>{const a=(e,r)=>e?n(e):t(r);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){var t=this;let r;"function"===typeof e[e.length-1]&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){if(n!==t._queue[0])return;if(null!==e)n.tryCount>t._opts.retries&&(t._queue.shift(),r&&r(e));else if(t._queue.shift(),r){for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];r(null,...s)}return n.pending=!1,t._drainQueue()}),this._queue.push(n),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:MB.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case MB.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case MB.EVENT:case MB.BINARY_EVENT:this.onevent(e);break;case MB.ACK:case MB.BINARY_ACK:this.onack(e);break;case MB.DISCONNECT:this.ondisconnect();break;case MB.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];t.packet({type:MB.ACK,id:e,data:a})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:MB.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function zB(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}zB.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},zB.prototype.reset=function(){this.attempts=0},zB.prototype.setMin=function(e){this.ms=e},zB.prototype.setMax=function(e){this.max=e},zB.prototype.setJitter=function(e){this.jitter=e};class VB extends HF{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,YF(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new zB({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const a=t.parser||n;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new vB(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=FB(t,"open",function(){r.onopen(),e&&e()}),a=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=FB(t,"error",a);if(!1!==this._timeout){const e=this._timeout,r=this.setTimeoutFn(()=>{n(),a(new Error("timeout")),t.close()},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(FB(e,"ping",this.onping.bind(this)),FB(e,"data",this.ondata.bind(this)),FB(e,"error",this.onerror.bind(this)),FB(e,"close",this.onclose.bind(this)),FB(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(dU){this.onclose("parse error",dU)}}ondecoded(e){WF(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new UB(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t){if(this.nsps[r].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),null===(r=this.engine)||void 0===r||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const HB={};function WB(e,t){"object"===typeof e&&(t=e,e=void 0);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=e;r=r||"undefined"!==typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof r?r.protocol+"//"+e:"https://"+e),n=fB(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),n=r.source,a=r.id,s=r.path,i=HB[a]&&s in HB[a].nsps;let o;return t.forceNew||t["force new connection"]||!1===t.multiplex||i?o=new VB(n,t):(HB[a]||(HB[a]=new VB(n,t)),o=HB[a]),r.query&&!t.query&&(t.query=r.queryKey),o.socket(r.path,t)}Object.assign(WB,{Manager:VB,Socket:UB,io:WB,connect:WB});const qB=()=>{var e;const[t,r]=(0,s.useState)("idle"),[n,a]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(0),[h,p]=(0,s.useState)(0),[m,f]=(0,s.useState)(""),[g,x]=(0,s.useState)(""),[b,y]=(0,s.useState)(null),[v,_]=(0,s.useState)({}),[k,j]=(0,s.useState)(null),[w,N]=(0,s.useState)(!0),[S,O]=(0,s.useState)({}),C=(0,s.useRef)(null),E=(0,s.useRef)(null),P="master_pipeline",A=[{id:"\ud83d\udcca Mixpanel - Download & Update Data",name:"Download Data"},{id:"\ud83d\udcca Mixpanel - Setup Database",name:"Setup Database"},{id:"\ud83d\udcca Mixpanel - Ingest Data",name:"Ingest Data"},{id:"\ud83d\udcca Mixpanel - Assign Product Information",name:"Product Info"},{id:"\ud83d\udcca Mixpanel - Set ABI Attribution",name:"ABI Attribution"},{id:"\ud83d\udcca Mixpanel - Validate Event Lifecycle",name:"Validate Events"},{id:"\ud83d\udcca Mixpanel - Assign Economic Tier",name:"Economic Tier"},{id:"\u2699\ufe0f Pre-processing - Assign Credited Date",name:"Credited Date"},{id:"\u2699\ufe0f Pre-processing - Assign Price Bucket",name:"Price Bucket"},{id:"\u2699\ufe0f Pre-processing - Assign Conversion Rates",name:"Conversion Rates"},{id:"\u2699\ufe0f Pre-processing - Estimate Values",name:"Estimate Values"},{id:"\ud83d\udd2e Meta - Update Data",name:"Meta Data"}];(0,s.useEffect)(()=>(C.current=WB({reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:10,timeout:2e4}),C.current.on("connect",()=>{console.log("\u2705 Connected to server"),U("Connected to server","success")}),C.current.on("disconnect",e=>{console.log("\u274c Disconnected from server:",e),U("Disconnected from server - attempting to reconnect...","warning")}),C.current.on("reconnect",e=>{console.log("\ud83d\udd04 Reconnected to server (attempt ".concat(e,")")),U("Reconnected to server","success")}),C.current.on("reconnect_error",e=>{console.log("\u274c Reconnection failed:",e)}),C.current.on("status_update",e=>{e.pipeline===P&&L(e)}),C.current.on("pipeline_reset",e=>{e.pipeline===P&&I(e)}),()=>{C.current&&C.current.disconnect()}),[]),(0,s.useEffect)(()=>(T(),()=>{E.current&&clearTimeout(E.current)}),[]),(0,s.useEffect)(()=>{const e=setTimeout(()=>{N(!1),setTimeout(()=>{G()},1e3)},100);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{!w&&("idle"!==t||Object.keys(v).length>0)&&R()},[w,t,v,k,h]);const T=()=>{const e=localStorage.getItem("masterPipelineData");if(e)try{const t=JSON.parse(e);if(console.log("\ud83d\udcc2 Loading saved pipeline data:",t),a(t.lastSuccessfulRun?new Date(t.lastSuccessfulRun):null),o(t.lastRunDuration||null),u(t.retryCount||0),p(t.retryAttempts||0),r(t.status||"idle"),_(t.moduleStates||{}),j(t.currentModule||null),y(t.currentRunStart?new Date(t.currentRunStart):null),c(t.estimatedCompletion?new Date(t.estimatedCompletion):null),t.moduleTimestamps){const e={};Object.entries(t.moduleTimestamps).forEach(t=>{let[r,n]=t;e[r]=new Date(n)}),O(e)}if(console.log("\ud83d\udd04 Scheduling backend sync check..."),setTimeout(()=>{G(t.moduleStates)},1e3),"running"===t.status&&t.currentRunStart){const e=new Date(t.currentRunStart);(Date.now()-e.getTime())/36e5>6&&(console.warn("\u26a0\ufe0f Detected stale running state (>6 hours), clearing..."),localStorage.removeItem("masterPipelineData"),r("idle"),_({}),j(null),y(null),c(null))}}catch(dU){console.warn("Failed to parse saved pipeline data:",dU),localStorage.removeItem("masterPipelineData")}},M=e=>{const t=JSON.parse(localStorage.getItem("masterPipelineData")||"{}"),r=Ie(Ie(Ie({},t),e),{},{moduleStates:e.moduleStates||t.moduleStates||{},lastRunDuration:e.lastRunDuration||t.lastRunDuration||null});localStorage.setItem("masterPipelineData",JSON.stringify(r))},R=()=>{const e={lastSuccessfulRun:null===n||void 0===n?void 0:n.toISOString(),lastRunDuration:i,status:t,retryCount:d,retryAttempts:h,moduleStates:v,currentModule:k,currentRunStart:null===b||void 0===b?void 0:b.toISOString(),estimatedCompletion:null===l||void 0===l?void 0:l.toISOString(),moduleTimestamps:Object.fromEntries(Object.entries(S).map(e=>{let[t,r]=e;return[t,r.toISOString()]}))};(e.status&&"idle"!==e.status||Object.keys(e.moduleStates||{}).length>0||e.lastSuccessfulRun)&&M(e)},D=async()=>{if("running"===t)return console.log("\u26a0\ufe0f Pipeline is already running, skipping duplicate request"),void U("Pipeline is already running","warning");if("success"===t&&Object.keys(v).length>0){if(Object.values(v).every(e=>"complete"===e))return console.log("\u26a0\ufe0f Pipeline is already complete, use restart to run again"),void U("Pipeline is already complete. Use the restart button to run again.","warning")}console.log("\ud83d\ude80 Starting master pipeline..."),r("running"),f(""),y(new Date);const e={};if(A.forEach(t=>{e[t.id]="pending"}),console.log("\ud83d\udccb Initialized module states:",e),_(e),j(null),i){const e=new Date(Date.now()+i);c(e)}try{const e=await fetch("/api/run/".concat(P),{method:"POST"}),t=await e.json();t.success?(console.log("\u2705 Pipeline started successfully"),U("Pipeline started successfully","success")):(console.error("\u274c Pipeline failed to start:",t.message),r("failed"),U("Error: ".concat(t.message),"error"),B())}catch(n){console.error("\u274c Pipeline start error:",n),r("failed"),U("Error starting pipeline","error"),B()}},I=e=>{console.log("\ud83d\udd04 WebSocket pipeline reset received:",e),r("idle"),_({}),j(null),c(null),p(0),O({}),y(null),localStorage.removeItem("masterPipelineData"),localStorage.removeItem("pipelineLastTrigger"),U(e.message||"Pipeline reset completed","success"),console.log("\u2705 Pipeline reset completed - all state cleared")},L=e=>{if(console.log("\ud83d\udce1 WebSocket status update received:",e),e.pipeline===P){if(e.step&&e.status){const t=e.step;if(!(e=>{const t=A.some(t=>t.id===e);return t||(console.warn('\u26a0\ufe0f WebSocket step ID not found in MASTER_MODULES: "'.concat(e,'"')),console.warn("Available module IDs:",A.map(e=>e.id))),t})(t))return void console.error('\u274c Received update for unknown step ID: "'.concat(t,'"'));let r;switch(e.status){case"running":r="running";break;case"success":r="complete";break;case"failed":r="failed";break;case"cancelled":r="cancelled";break;default:r=e.status}if(console.log("\ud83d\udd04 Updating module ".concat(t," to status: ").concat(r)),_(e=>{const n=Ie(Ie({},e),{},{[t]:r});console.log("\ud83d\udcca Updated module states:",n);const a=Object.values(n).filter(e=>"complete"===e).length,s=Object.values(n).filter(e=>"failed"===e).length,i=Object.values(n).filter(e=>"cancelled"===e).length;return console.log("\ud83d\udcc8 Progress check: ".concat(a,"/").concat(A.length," complete, ").concat(s," failed, ").concat(i," cancelled")),a===A.length&&0===s&&0===i&&(console.log("\ud83c\udf89 All modules complete! Triggering pipeline completion..."),setTimeout(()=>{F()},100)),n}),"complete"===r&&e.timestamp&&(console.log("\u23f0 Storing completion timestamp for ".concat(t,": ").concat(e.timestamp)),O(r=>{const n=Ie(Ie({},r),{},{[t]:new Date(e.timestamp)});return console.log("\ud83d\udcc5 Updated module timestamps:",n),setTimeout(()=>{R()},100),n})),"running"===r)console.log("\u25b6\ufe0f  Setting current module to: ".concat(t)),j(t);else if("complete"===r||"failed"===r){if(j(e=>e===t?null:e),"failed"===r)return void B(t);if("cancelled"===r)return void console.log("\ud83d\uded1 Module cancelled, pipeline may have been cancelled")}}}else console.log("\u23ed\ufe0f  Ignoring update for pipeline:",e.pipeline)},F=()=>{const e=new Date,t=b?e-b:null;r("success"),a(e),o(t),u(0),p(0),j(null),c(null);const n={};A.forEach(e=>{n[e.id]="complete"}),_(n),E.current&&(clearTimeout(E.current),E.current=null),localStorage.removeItem("pipelineLastTrigger"),M({lastSuccessfulRun:e.toISOString(),lastRunDuration:t,status:"success",retryCount:0,retryAttempts:0,moduleStates:n,currentModule:null,currentRunStart:null,estimatedCompletion:null}),U("Pipeline completed successfully! Database updated.","success")},B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=h+1;p(t),r("failed"),j(null),c(null);let n=v;if(e){const t=A.find(t=>t.id.includes(e)||e.includes(t.name)||t.id===e);t&&(n=Ie(Ie({},v),{},{[t.id]:"failed"}),_(n))}if(M({status:"failed",retryAttempts:t,moduleStates:n,currentModule:null,estimatedCompletion:null}),t<5){const r=new Date(Date.now()+18e5),n=e?"Pipeline failed at: ".concat(e,". Retry ").concat(t,"/").concat(5," scheduled for ").concat(r.toLocaleTimeString()):"Pipeline failed. Retry ".concat(t,"/").concat(5," scheduled for ").concat(r.toLocaleTimeString());U(n,"warning"),E.current=setTimeout(()=>{console.log("\ud83d\udd04 Automatic retry ".concat(t," triggered")),D()},18e5)}else{const t=e?"Pipeline failed at: ".concat(e," after ").concat(5," attempts. Manual intervention required."):"Pipeline failed after ".concat(5," attempts. Manual intervention required.");U(t,"error"),p(0),M({retryAttempts:0})}},U=(e,t)=>{f(e),x(t),setTimeout(()=>{f(""),x("")},8e3)},z=()=>{const e=A.length,t=Object.values(v).filter(e=>"complete"===e).length,r=Object.values(v).filter(e=>"failed"===e).length,n=Object.values(v).filter(e=>"running"===e).length,a=Object.values(v).filter(e=>"cancelled"===e).length;return{total:e,completed:t,failed:r,running:n,cancelled:a,pending:e-t-r-n-a,percentage:Math.round(t/e*100)}},V=()=>{if(!b||!i||"running"!==t)return null;const e=z(),r=Date.now()-b,n=e.completed/e.total;if(n>0){const e=r/n-r;if(e>0){const t=Math.ceil(e/6e4);return"~".concat(t,"m remaining")}}const a=i/A.length,s=(e.total-e.completed)*a;if(s>0){const e=Math.ceil(s/6e4);return"~".concat(e,"m remaining")}return null},H=e=>{const t=new Date-e,r=Math.floor(t/6e4),n=Math.floor(r/60),a=Math.floor(n/24);return a>0?"".concat(a," day").concat(a>1?"s":""," ago"):n>0?"".concat(n," hour").concat(n>1?"s":""," ago"):r>0?"".concat(r," minute").concat(r>1?"s":""," ago"):"just now"},W=e=>{switch(e){case"complete":return(0,ut.jsx)(Bt,{className:"h-4 w-4 text-green-600"});case"running":return(0,ut.jsx)(CN,{className:"h-4 w-4 text-blue-600 animate-spin"});case"failed":return(0,ut.jsx)(We,{className:"h-4 w-4 text-red-600"});case"cancelled":return(0,ut.jsx)(Dt,{className:"h-4 w-4 text-orange-600"});default:return(0,ut.jsx)(yF,{className:"h-4 w-4 text-gray-400"})}},q=(()=>{var e;const r=z();switch(t){case"running":const t=k?null===(e=A.find(e=>e.id===k))||void 0===e?void 0:e.name:null,n=V();let a="".concat(r.completed,"/").concat(r.total," modules complete");return t&&(a="Processing: ".concat(t," \u2022 ").concat(a)),n&&(a+=" \u2022 ".concat(n)),{icon:(0,ut.jsx)(qe,{className:"h-8 w-8 text-blue-600 animate-spin"}),title:"Pipeline Running",description:a,color:"border-blue-500 bg-blue-50 dark:bg-blue-900/20"};case"success":const s=i?"All ".concat(r.total," modules completed in ").concat(Math.round(i/6e4)," minutes"):"All data processing completed successfully";return{icon:(0,ut.jsx)(Bt,{className:"h-8 w-8 text-green-600"}),title:"Pipeline Complete",description:s,color:"border-green-500 bg-green-50 dark:bg-green-900/20"};case"failed":const o=r.failed,l=h>0?"Retry ".concat(h,"/").concat(5," - ").concat(o," module").concat(1!==o?"s":""," failed"):o>0?"".concat(o," module").concat(1!==o?"s":""," failed - manual intervention required"):"Manual intervention required";return{icon:(0,ut.jsx)(We,{className:"h-8 w-8 text-red-600"}),title:"Pipeline Failed",description:l,color:"border-red-500 bg-red-50 dark:bg-red-900/20"};default:return{icon:(0,ut.jsx)(Ze,{className:"h-8 w-8 text-gray-600"}),title:"Pipeline Ready",description:"Ready to run when triggered",color:"border-gray-300 bg-gray-50 dark:bg-gray-800"}}})(),G=async function(){try{console.log("\ud83d\udd0d Checking pipeline completion status...");const n=await fetch("/api/pipelines");if(!n.ok)return void console.warn("Failed to fetch pipeline status from backend");const s=(await n.json()).find(e=>e.name===P);if(!s)return void console.warn("Master pipeline not found in backend response");if(console.log("\ud83d\udcca Backend pipeline status:",s.status),s.status&&Object.keys(s.status).length>0){const n=A.map(e=>e.id);if(n.every(e=>s.status[e]&&"success"===s.status[e].status)){var e,t;console.log("\ud83c\udf89 Pipeline is actually complete! Updating frontend...");let i=null,l=null;n.forEach(e=>{const t=s.status[e];if(t&&t.timestamp){const e=new Date(t.timestamp);(!i||e>i)&&(i=e),(!l||e<l)&&(l=e)}});let d=null;i&&b?d=i-b:i&&l&&(d=i-l),console.log("\ud83d\udcc5 Actual completion time:",null===(e=i)||void 0===e?void 0:e.toISOString()),console.log("\u23f1\ufe0f Actual duration:",d?"".concat(Math.round(d/6e4)," minutes"):"unknown");const h={},m={};A.forEach(e=>{h[e.id]="complete";const t=s.status[e.id];t&&t.timestamp&&(m[e.id]=new Date(t.timestamp))}),_(h),O(m),r("success"),i&&a(i),d&&o(d),u(0),p(0),j(null),c(null),E.current&&(clearTimeout(E.current),E.current=null),localStorage.removeItem("pipelineLastTrigger"),M({lastSuccessfulRun:null===(t=i)||void 0===t?void 0:t.toISOString(),lastRunDuration:d,status:"success",retryCount:0,retryAttempts:0,moduleStates:h,moduleTimestamps:Object.fromEntries(Object.entries(m).map(e=>{let[t,r]=e;return[t,r.toISOString()]})),currentModule:null,currentRunStart:null,estimatedCompletion:null}),U("Pipeline completed successfully! Database updated.","success")}else console.log("\u274c Not all modules complete yet. Status check:"),n.forEach(e=>{const t=s.status[e];console.log("  ".concat(e,": ").concat(t?t.status:"not found"))})}}catch(n){console.warn("Error checking pipeline completion:",n)}};return(0,ut.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:[(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Data Pipeline"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Automated data processing and updates"})]}),(0,ut.jsx)("div",{className:"flex items-center space-x-4",children:(0,ut.jsx)(Ee,{to:"/data-pipeline/debug",className:"inline-flex items-center p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",title:"Debug Mode",children:(0,ut.jsx)(Ve,{className:"h-5 w-5"})})})]})}),(0,ut.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border-l-4 ".concat(q.color," p-6"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[q.icon,(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:q.title}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:q.description})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:["running"===t&&(0,ut.jsxs)("button",{onClick:async()=>{console.log("\ud83d\uded1 Cancelling master pipeline...");try{const e=await fetch("/api/cancel/".concat(P),{method:"POST"}),t=await e.json();if(t.success){console.log("\u2705 Pipeline cancelled successfully"),r("idle"),j(null),c(null);const e={};A.forEach(t=>{const r=v[t.id]||"pending";e[t.id]="running"===r?"cancelled":r}),_(e),U(t.message||"Pipeline cancelled successfully","success")}else console.error("\u274c Pipeline cancel failed:",t.message),U("Cancel failed: ".concat(t.message),"error")}catch(e){console.error("\u274c Pipeline cancel error:",e),U("Error cancelling pipeline","error")}},className:"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 dark:border-red-600 dark:text-red-300 dark:bg-red-900/20 dark:hover:bg-red-900/40 transition-colors",children:[(0,ut.jsx)(Dt,{className:"mr-2 h-4 w-4"}),"Cancel Pipeline"]}),(0,ut.jsxs)("button",{onClick:()=>{Object.keys(v).length>0&&"running"!==t?(async()=>{console.log("\ud83d\udd04 Restarting master pipeline...");const e={};A.forEach(t=>{e[t.id]="pending"}),r("idle"),_(e),j(null),c(null),p(0),M({status:"idle",moduleStates:e,currentModule:null,estimatedCompletion:null,retryAttempts:0}),U("Pipeline reset, starting fresh run...","success"),setTimeout(()=>{D()},1e3)})():D()},disabled:"running"===t,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md transition-colors ".concat("running"===t?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,ut.jsx)(vF,{className:"mr-2 h-5 w-5"}),"running"===t?"Running Pipeline...":"success"===t&&Object.keys(v).length>0?"Restart Pipeline":"Run Pipeline"]}),(0,ut.jsxs)("button",{onClick:async()=>{console.log("\ud83d\udd04 RESET ALL: Resetting all steps in pipeline '".concat(P,"'"));const e="running"===t&&Object.keys(v).length>0,n=e?"The pipeline appears to be stuck in a running state.\n\nThis will:\n\u2022 Force cancel any stuck processes\n\u2022 Reset all step statuses to pending\n\u2022 Clear all cached state\n\u2022 Fix synchronization issues\n\nThis should resolve the stuck state. Continue?":"Are you sure you want to reset ALL steps in the master pipeline?\n\nThis will:\n\u2022 Cancel any running steps\n\u2022 Reset all step statuses to pending\n\u2022 Clear all progress and error states\n\nThis action cannot be undone.";if(window.confirm(n)){e&&U("Forcing reset of stuck pipeline state...","warning");try{console.log("\ud83e\uddf9 RESET ALL: Clearing all local state immediately"),r("idle"),_({}),j(null),c(null),p(0),O({}),y(null),localStorage.removeItem("masterPipelineData"),localStorage.removeItem("pipelineLastTrigger");const e=await fetch("/api/reset-all/".concat(P),{method:"POST"}),t=await e.json();if(console.log("\ud83d\udd04 RESET ALL: Reset response:",t),t.success){U(t.message,"success"),console.log("\u2705 RESET ALL: Successfully reset all steps in pipeline '".concat(P,"'"));const e={};A.forEach(t=>{e[t.id]="pending"}),_(e),M({status:"idle",moduleStates:e,currentModule:null,estimatedCompletion:null,retryAttempts:0,moduleTimestamps:{},currentRunStart:null}),C.current&&(console.log("\ud83d\udd0c RESET ALL: Forcing WebSocket reconnection for clean state"),C.current.disconnect(),setTimeout(()=>{C.current.connect()},1e3))}else U("Reset all failed: ".concat(t.message),"error"),console.log("\u274c RESET ALL: Failed to reset all steps in pipeline '".concat(P,"': ").concat(t.message))}catch(a){console.error("\u274c RESET ALL: Error resetting all steps in pipeline '".concat(P,"':"),a),U("Error resetting all steps: ".concat(a.message),"error"),U("Local state cleared - page refresh may be needed if issues persist","warning")}}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md transition-colors text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",title:"Reset all pipeline steps to pending status - Always available to fix stuck states",children:[(0,ut.jsx)(_F,{className:"mr-2 h-4 w-4"}),"Reset All"]})]})]})}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)(et,{className:"h-8 w-8 text-green-600"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Database Updated"}),(0,ut.jsx)("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mt-1",children:n?n.toLocaleDateString()+" "+n.toLocaleTimeString():"Never"}),h>0&&(0,ut.jsxs)("p",{className:"text-sm text-orange-600 dark:text-orange-400 mt-1",children:[h," failed attempt",h>1?"s":""]})]})]})}),(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsx)(qe,{className:"h-8 w-8 text-purple-600"}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Pipeline Type"}),(0,ut.jsx)("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mt-1",children:"Master Pipeline"}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Full data processing"})]})]})})]}),("running"===t||Object.keys(v).length>0)&&(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Pipeline Progress"}),"running"===t&&(0,ut.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:V()||"Calculating..."})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ut.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[z().completed," of ",z().total," modules complete"]}),(0,ut.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[z().percentage,"%"]})]}),(0,ut.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,ut.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(z().percentage,"%")}})})]}),k&&"running"===t&&(0,ut.jsx)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)(CN,{className:"h-4 w-4 text-blue-600 animate-spin"}),(0,ut.jsxs)("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["Currently running: ",(null===(e=A.find(e=>e.id===k))||void 0===e?void 0:e.name)||k]})]})}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:A.map(e=>{const t=v[e.id]||"pending",r=k===e.id,n=S&&S[e.id];return(0,ut.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg border transition-all ".concat(r?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"complete"===t?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"failed"===t?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"cancelled"===t?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"),children:[W(t),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsx)("p",{className:"text-sm font-medium truncate ".concat("complete"===t?"text-green-800 dark:text-green-200":"failed"===t?"text-red-800 dark:text-red-200":"running"===t?"text-blue-800 dark:text-blue-200":"cancelled"===t?"text-orange-800 dark:text-orange-200":"text-gray-700 dark:text-gray-300"),children:e.name}),"complete"===t&&n&&(0,ut.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Completed ",H(n)]})]}),(0,ut.jsx)("div",{className:"text-xs px-2 py-1 rounded-full ".concat("complete"===t?"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-200":"failed"===t?"bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-200":"running"===t?"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200":"cancelled"===t?"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-200":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),children:"pending"===t?"Pending":"running"===t?"Running":"complete"===t?n?n.toLocaleTimeString():"Done":"failed"===t?"Failed":"cancelled"===t?"Cancelled":t})]},e.id)})})]}),m&&(0,ut.jsx)("div",{className:"p-4 rounded-lg border ".concat("success"===g?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800":"warning"===g?"bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 border-orange-200 dark:border-orange-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-200 dark:border-red-800"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:["success"===g&&(0,ut.jsx)(Bt,{className:"h-5 w-5"}),"warning"===g&&(0,ut.jsx)(Ze,{className:"h-5 w-5"}),"error"===g&&(0,ut.jsx)(We,{className:"h-5 w-5"}),(0,ut.jsx)("span",{className:"font-medium",children:m})]})})]})]})})},GB=ze("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),$B=()=>{const[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(null),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),c=(0,s.useRef)(null);(0,s.useEffect)(()=>(c.current=WB(),c.current.on("connect",()=>{console.log("Connected to server")}),c.current.on("status_update",e=>{h(e)}),()=>{c.current&&c.current.disconnect()}),[]),(0,s.useEffect)(()=>{d()},[]);const d=async()=>{try{const e=await fetch("/api/pipelines"),r=await e.json();t(r),u(r)}catch(e){console.error("Error loading pipelines:",e)}},u=e=>{const t=localStorage.getItem("selectedPipeline");if(t){const r=e.find(e=>e.name===t);r?(n(r),console.log("Restored selection: ".concat(t)),setTimeout(()=>{p("Restored previous selection: ".concat(t),"success")},500)):(localStorage.removeItem("selectedPipeline"),console.log("Pipeline '".concat(t,"' no longer exists, cleared selection")))}},h=e=>{console.log("\ud83d\udce1 DEBUG PAGE: WebSocket status update received:",e),t(t=>t.map(t=>{if(t.name===e.pipeline){const r=Ie({},t);return r.status||(r.status={}),r.status[e.step]={status:e.status,timestamp:e.timestamp,error_message:e.error_message},r}return t})),r&&r.name===e.pipeline&&n(t=>{if(!t)return t;const r=Ie({},t);return r.status||(r.status={}),r.status[e.step]={status:e.status,timestamp:e.timestamp,error_message:e.error_message},r})},p=(e,t)=>{i(e),l(t),setTimeout(()=>{i(""),l("")},5e3)},m=(e,t)=>{const a=t.status||"pending",s=e.tested;let i="\u25cb",o="",l="";"running"===a?(i="\u25cf",o="RUNNING...",l="text-blue-600 dark:text-blue-400 font-semibold"):"success"===a?(i="\u2713",o="SUCCESS",l="text-green-600 dark:text-green-400 font-semibold"):"failed"===a?(i="\u2717",o="FAILED",l="text-red-600 dark:text-red-400 font-semibold"):"cancelled"===a&&(i="\ud83d\uded1",o="CANCELLED",l="text-orange-600 dark:text-orange-400 font-semibold");let c="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4 transition-all hover:shadow-md ";return"pending"===a?c+="border-l-4 border-l-gray-300 dark:border-l-gray-500":"running"===a?c+="border-l-4 border-l-blue-500 bg-blue-50/50 dark:bg-blue-900/10":"success"===a?c+="border-l-4 border-l-green-500 bg-green-50/50 dark:bg-green-900/10":"failed"===a?c+="border-l-4 border-l-red-500 bg-red-50/50 dark:bg-red-900/10":"cancelled"===a&&(c+="border-l-4 border-l-orange-500 bg-orange-50/50 dark:bg-orange-900/10"),(0,ut.jsx)("div",{className:c,children:(0,ut.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,ut.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold text-white mt-1 ".concat("pending"===a?"bg-gray-400 dark:bg-gray-500":"running"===a?"bg-blue-500 animate-pulse":"success"===a?"bg-green-500":"failed"===a?"bg-red-500":"cancelled"===a?"bg-orange-500":"bg-gray-400"),children:i}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,ut.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:e.name||e.id}),o&&(0,ut.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat("running"===a?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"success"===a?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"failed"===a?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"cancelled"===a?"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:o})]}),(0,ut.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono mb-2 bg-gray-50 dark:bg-gray-800 px-2 py-1 rounded",children:e.file}),t.error_message&&(0,ut.jsxs)("div",{className:"text-xs text-red-700 dark:text-red-300 mt-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-md border border-red-200 dark:border-red-800",children:[(0,ut.jsx)("strong",{children:"Error:"})," ",t.error_message]}),"success"===a&&t.timestamp&&(0,ut.jsxs)("div",{className:"text-xs text-green-600 dark:text-green-400 mt-2",children:["Completed: ",new Date(t.timestamp).toLocaleTimeString()]})]}),(0,ut.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[(0,ut.jsx)("button",{onClick:()=>(async(e,t,r)=>{try{const a=await fetch("/api/mark_tested/".concat(e,"/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tested:r})}),s=await a.json();s.success?(n(e=>{if(!e)return e;const n=Ie({},e),a=n.steps.find(e=>e.id===t);return a&&(a.tested=r),n}),p(s.message,"success")):p("Error: ".concat(s.message),"error")}catch(a){p("Error updating step status","error")}})(r.name,e.id,!s),className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-md border transition-colors ".concat(s?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border-green-300 dark:border-green-700 hover:bg-green-200 dark:hover:bg-green-900/50":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600"),children:s?"\u2713 Tested":"Mark Tested"}),(0,ut.jsx)("button",{onClick:()=>(async(e,t)=>{try{const r=await fetch("/api/run/".concat(e,"/").concat(t),{method:"POST"}),n=await r.json();n.success?p("Step '".concat(t,"' started successfully"),"success"):p("Error: ".concat(n.message),"error")}catch(r){p("Error starting step","error")}})(r.name,e.id),disabled:"running"===a,className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-md border transition-colors ".concat("running"===a?"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 border-gray-300 dark:border-gray-600 cursor-not-allowed":"bg-blue-600 text-white border-blue-600 hover:bg-blue-700 hover:border-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:"running"===a?"\u23f3 Running...":"\u25b6\ufe0f Run"}),"running"===a&&(0,ut.jsx)("button",{onClick:()=>(async(e,t)=>{console.log("\ud83d\uded1 CLIENT: Attempting to cancel step '".concat(t,"' in pipeline '").concat(e,"'"));try{const r=await fetch("/api/cancel/".concat(e,"/").concat(t),{method:"POST"}),n=await r.json();console.log("\ud83d\uded1 CLIENT: Cancel response:",n),n.success?(p(n.message,"success"),console.log("\u2705 CLIENT: Successfully cancelled step '".concat(t,"'"))):(p("Cancel failed: ".concat(n.message),"error"),console.log("\u274c CLIENT: Failed to cancel step '".concat(t,"': ").concat(n.message))),console.log("\ud83d\udd04 CLIENT: Refreshing pipeline view after cancel attempt"),d()}catch(r){console.error("\u274c CLIENT: Error cancelling step '".concat(t,"':"),r),p("Error cancelling step: ".concat(r.message),"error")}})(r.name,e.id),className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-md border bg-red-600 text-white border-red-600 hover:bg-red-700 hover:border-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",children:"\ud83d\uded1 Cancel"}),("cancelled"===a||"failed"===a||"success"===a)&&(0,ut.jsx)("button",{onClick:()=>(async(e,t)=>{console.log("\ud83d\udd04 RESET STEP: Resetting step '".concat(t,"' in pipeline '").concat(e,"'"));try{const r=await fetch("/api/reset/".concat(e,"/").concat(t),{method:"POST"}),n=await r.json();console.log("\ud83d\udd04 RESET STEP: Reset response:",n),n.success?(p(n.message,"success"),console.log("\u2705 RESET STEP: Successfully reset step '".concat(t,"'")),d()):(p("Reset failed: ".concat(n.message),"error"),console.log("\u274c RESET STEP: Failed to reset step '".concat(t,"': ").concat(n.message)))}catch(r){console.error("\u274c RESET STEP: Error resetting step '".concat(t,"':"),r),p("Error resetting step: ".concat(r.message),"error")}})(r.name,e.id),className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-md border bg-gray-600 text-white border-gray-600 hover:bg-gray-700 hover:border-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors",children:"\ud83d\udd04 Reset"})]})]})},e.id)},f=!!r&&r.steps.every(e=>e.tested);return(0,ut.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,ut.jsxs)("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:[(0,ut.jsx)("div",{className:"mb-8",children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Data Pipeline"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Manage and execute data processing pipelines"})]}),(0,ut.jsx)("div",{className:"flex items-center space-x-4",children:(0,ut.jsxs)("button",{onClick:async()=>{try{await fetch("/api/refresh",{method:"POST"}),await d(),p("Pipelines refreshed successfully","success")}catch(e){p("Error refreshing pipelines","error")}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,ut.jsx)(qe,{className:"mr-2 h-4 w-4"}),"Refresh"]})})]})}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,ut.jsx)("div",{className:"lg:col-span-1",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,ut.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Available Pipelines"})}),(0,ut.jsx)("div",{className:"p-4 space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>(0,ut.jsxs)("div",{onClick:()=>function(e){n(e),localStorage.setItem("selectedPipeline",e.name),console.log("Selected and saved pipeline: ".concat(e.name))}(e),className:"p-3 rounded-lg border cursor-pointer transition-all ".concat((null===r||void 0===r?void 0:r.name)===e.name?"bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100 border-blue-200 dark:border-blue-800":"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 hover:border-blue-300 dark:hover:border-blue-600"),children:[(0,ut.jsx)("div",{className:"font-medium text-sm mb-1",children:e.name}),(0,ut.jsx)("div",{className:"text-xs ".concat((null===r||void 0===r?void 0:r.name)===e.name?"text-blue-600 dark:text-blue-300":"text-gray-500 dark:text-gray-400"),children:e.description})]},e.name))})]})}),(0,ut.jsx)("div",{className:"lg:col-span-3",children:r?(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,ut.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:r.name}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:r.description}),(0,ut.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,ut.jsx)("button",{onClick:()=>(async e=>{try{const t=await fetch("/api/run/".concat(e),{method:"POST"}),r=await t.json();r.success?p("Pipeline started successfully","success"):p("Error: ".concat(r.message),"error")}catch(t){p("Error starting pipeline","error")}})(r.name),disabled:!f,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md ".concat(f?"text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500":"text-gray-500 bg-gray-200 dark:bg-gray-600 dark:text-gray-400 cursor-not-allowed"),children:"Run Pipeline"}),(0,ut.jsx)("button",{onClick:()=>(async e=>{if(console.log("\ud83d\udd04 RESET ALL: Resetting all steps in pipeline '".concat(e,"'")),window.confirm("Are you sure you want to reset ALL steps in pipeline '".concat(e,"'?\n\nThis will:\n\u2022 Cancel any running steps\n\u2022 Reset all step statuses to pending\n\u2022 Clear all progress and error states\n\nThis action cannot be undone.")))try{const t=await fetch("/api/reset-all/".concat(e),{method:"POST"}),r=await t.json();console.log("\ud83d\udd04 RESET ALL: Reset response:",r),r.success?(p(r.message,"success"),console.log("\u2705 RESET ALL: Successfully reset all steps in pipeline '".concat(e,"'")),d()):(p("Reset all failed: ".concat(r.message),"error"),console.log("\u274c RESET ALL: Failed to reset all steps in pipeline '".concat(e,"': ").concat(r.message)))}catch(t){console.error("\u274c RESET ALL: Error resetting all steps in pipeline '".concat(e,"':"),t),p("Error resetting all steps: ".concat(t.message),"error")}})(r.name),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",title:"Reset all steps to pending status",children:"\ud83d\udd04 Reset All"}),!f&&(0,ut.jsx)("div",{className:"flex items-center text-orange-600 dark:text-orange-400 text-sm",children:(0,ut.jsx)("span",{children:"All steps must be tested before running"})})]})]}),(0,ut.jsx)("div",{className:"p-6 space-y-4",children:r.steps.map(e=>m(e,r.status[e.id]||{}))}),a&&(0,ut.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700",children:(0,ut.jsx)("div",{className:"p-4 rounded-lg ".concat("success"===o?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800"),children:a})})]}):(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8 text-center",children:[(0,ut.jsx)("div",{className:"text-gray-400 dark:text-gray-500 mb-4",children:(0,ut.jsx)(GB,{className:"mx-auto h-12 w-12"})}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Select a pipeline to view details"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Choose a pipeline from the sidebar to see its steps and run it."})]})})]})]})})},KB=()=>(0,ut.jsx)("div",{className:"p-6 max-w-7xl mx-auto",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Pipeline Debug Tools"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Debug and analyze different stages of the processing pipeline."})]}),(0,ut.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:"conversion-rates",title:"Conversion Rates Debug",description:"Debug and analyze conversion rate calculations from the pipeline",icon:"\ud83d\udd0d",path:"/debug/conversion-rates",status:"ready"},{id:"price-bucket",title:"Price Bucket Debug",description:"Debug and analyze price bucket assignments from the pipeline",icon:"\ud83d\udcb0",path:"/debug/price-bucket",status:"ready"},{id:"value-estimation",title:"Value Estimation Debug",description:"Debug and analyze value estimation calculations from the pipeline",icon:"\ud83d\udcca",path:"/debug/value-estimation",status:"ready"}].map(e=>(0,ut.jsxs)(Ee,{to:e.path,className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors duration-200 group",children:[(0,ut.jsxs)("div",{className:"flex items-center mb-4",children:[(0,ut.jsx)("div",{className:"text-3xl mr-3",children:e.icon}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400",children:e.title}),(0,ut.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded-full ".concat("ready"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"),children:"ready"===e.status?"Ready":"In Development"})]})]}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:e.description}),(0,ut.jsxs)("div",{className:"mt-4 flex items-center text-blue-600 dark:text-blue-400 text-sm",children:[(0,ut.jsx)("span",{children:"Open Debug Tool"}),(0,ut.jsx)("svg",{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,ut.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.id))}),(0,ut.jsxs)("div",{className:"mt-8 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-blue-800 dark:text-blue-200 font-medium mb-2",children:"\ud83d\udcdd Debug Tools Overview"}),(0,ut.jsxs)("ul",{className:"text-blue-600 dark:text-blue-300 text-sm space-y-1",children:[(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Conversion Rates:"})," Analyze how conversion rates are calculated and assigned to user cohorts"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Price Bucket:"})," Debug price bucket assignments and validate data integrity"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Value Estimation:"})," Examine value estimation calculations and timeline data"]})]})]})]})}),YB=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const r=await fetch("".concat("/api/debug").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("HTTP error! status: ".concat(r.status));return await r.json()}catch(r){throw console.error("API call failed:",r),r}},XB={loadOverview:()=>YB("/conversion-rates/overview"),loadCohortTree:()=>YB("/conversion-rates/cohort-tree"),validateData:()=>YB("/conversion-rates/validate"),searchCohorts:e=>YB("/conversion-rates/search",e)},JB={loadOverview:()=>YB("/price-bucket/overview"),searchData:e=>YB("/price-bucket/search",e)},QB={loadOverview:()=>YB("/value-estimation/overview"),loadExamples:()=>YB("/value-estimation/examples"),refreshStatus:(e,t)=>YB("/value-estimation/examples/refresh",{status_type:e,status_value:t}),validateCalculations:()=>YB("/value-estimation/validate")},ZB=e=>{let{title:t,value:r,icon:n,color:a="blue",subtitle:s=null}=e;return(0,ut.jsx)("div",{className:"border rounded-lg p-4 ".concat({blue:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200",green:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200",yellow:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200",red:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200",purple:"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800 text-purple-800 dark:text-purple-200",orange:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800 text-orange-800 dark:text-orange-200"}[a]),children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{className:"text-sm font-medium opacity-75",children:t}),(0,ut.jsx)("p",{className:"text-2xl font-bold",children:(null===r||void 0===r?void 0:r.toLocaleString())||0}),s&&(0,ut.jsx)("p",{className:"text-xs opacity-60 mt-1",children:s})]}),(0,ut.jsx)("div",{className:"text-3xl opacity-75",children:n})]})})},eU=e=>{let{filters:t,onFilterChange:r,onApplyFilters:n,onReset:a,loading:s}=e;return(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filter Controls"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product ID"}),(0,ut.jsx)("input",{type:"text",value:t.product_id,onChange:e=>r("product_id",e.target.value),placeholder:"Filter by product ID...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Min Users"}),(0,ut.jsx)("input",{type:"number",value:t.min_users,onChange:e=>r("min_users",e.target.value),placeholder:"Min user count...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Users"}),(0,ut.jsx)("input",{type:"number",value:t.max_users,onChange:e=>r("max_users",e.target.value),placeholder:"Max user count...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("input",{type:"checkbox",id:"show_errors_only",checked:t.show_errors_only,onChange:e=>r("show_errors_only",e.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),(0,ut.jsx)("label",{htmlFor:"show_errors_only",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Show validation errors only"})]}),(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("input",{type:"checkbox",id:"show_viable_only",checked:t.show_viable_only,onChange:e=>r("show_viable_only",e.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),(0,ut.jsx)("label",{htmlFor:"show_viable_only",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Show viable segments only (\u226512 users)"})]})]}),(0,ut.jsxs)("div",{className:"flex gap-2",children:[(0,ut.jsx)("button",{onClick:n,disabled:s,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-md font-medium",children:s?"Applying...":"Apply Filters"}),(0,ut.jsx)("button",{onClick:a,disabled:s,className:"bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-md font-medium",children:"Reset"})]})]})},tU=e=>{let{hierarchyTree:t=[],expandedNodes:r,onToggleNode:n}=e;const a=e=>null===e||void 0===e?"N/A":(100*e).toFixed(2)+"%";return t&&0!==t.length?(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:[(0,ut.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 px-2 py-3 border-b border-gray-200 dark:border-gray-600",children:(0,ut.jsxs)("div",{className:"flex items-center font-semibold text-xs text-gray-700 dark:text-gray-300",children:[(0,ut.jsx)("div",{style:{minWidth:"400px"},children:"Property Hierarchy"}),(0,ut.jsx)("div",{className:"w-20 text-center",children:"Level"}),(0,ut.jsx)("div",{className:"w-24 text-center",children:"Status"}),(0,ut.jsx)("div",{className:"w-24 text-center",children:"Total Users"}),(0,ut.jsx)("div",{className:"w-24 text-center",children:"Cohort Users"}),(0,ut.jsx)("div",{className:"w-20 text-center",children:"Trial Conv"}),(0,ut.jsx)("div",{className:"w-20 text-center",children:"Trial Ref"}),(0,ut.jsx)("div",{className:"w-20 text-center",children:"Purch Ref"}),(0,ut.jsx)("div",{className:"w-16 text-center",children:"Viable"}),(0,ut.jsx)("div",{className:"w-12 text-center",children:"Error"})]})}),(0,ut.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:t.map((e,t)=>((e,t)=>{var s;const i="".concat(e.level,"_").concat(e.value,"_").concat(t),o=r.has(i);let l="text-gray-600 dark:text-gray-400",c="default";return e.rates&&e.is_leaf&&(e.rates_consistent?(e.cohort_user_count||0)<12?(l="text-yellow-600 dark:text-yellow-400",c="small cohort"):e.uses_default?(l="text-orange-600 dark:text-orange-400",c="default"):e.is_viable?(l="text-green-600 dark:text-green-400",c=a(e.rates.trial_conversion_rate)):(l="text-yellow-600 dark:text-yellow-400",c="small cohort"):(l="text-red-600 dark:text-red-400 font-bold",c="ERROR")),(0,ut.jsxs)("div",{className:"font-mono text-sm",children:[(0,ut.jsxs)("div",{className:"flex items-center py-1 px-2 hover:bg-gray-50 dark:hover:bg-gray-700/30 cursor-pointer ".concat(e.rates_consistent?"":"bg-red-50 dark:bg-red-900/20"),onClick:()=>n(i),children:[(0,ut.jsxs)("div",{className:"flex items-center min-w-0",style:{minWidth:"400px"},children:[(0,ut.jsx)("span",{className:"text-gray-400 dark:text-gray-500",children:(d=e.level,["","\u251c\u2500\u2500 ","\u2502   \u251c\u2500\u2500 ","\u2502   \u2502   \u251c\u2500\u2500 ","\u2502   \u2502   \u2502   \u251c\u2500\u2500 ","\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 "][d]||"\u2502   ".repeat(d)+"\u251c\u2500\u2500 ")}),(0,ut.jsx)("span",{className:"text-gray-900 dark:text-white font-medium truncate",children:e.value}),e.has_children&&(0,ut.jsx)("span",{className:"ml-2 text-gray-400",children:o?"\u25bc":"\u25b6"})]}),(0,ut.jsxs)("div",{className:"w-20 text-center text-gray-500 dark:text-gray-400 text-xs",children:["level ",e.level]}),(0,ut.jsx)("div",{className:"w-24 text-center ".concat(l," font-medium text-xs"),children:c}),(0,ut.jsx)("div",{className:"w-24 text-center text-gray-700 dark:text-gray-300 font-medium",children:e.user_count.toLocaleString()}),(0,ut.jsx)("div",{className:"w-24 text-center font-medium ".concat(e.cohort_user_count>=12?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:(null===(s=e.cohort_user_count)||void 0===s?void 0:s.toLocaleString())||0}),(0,ut.jsx)("div",{className:"w-20 text-center text-blue-600 dark:text-blue-400 text-xs",children:e.rates&&e.is_leaf?a(e.rates.trial_conversion_rate):"-"}),(0,ut.jsx)("div",{className:"w-20 text-center text-green-600 dark:text-green-400 text-xs",children:e.rates&&e.is_leaf?a(e.rates.trial_converted_to_refund_rate):"-"}),(0,ut.jsx)("div",{className:"w-20 text-center text-purple-600 dark:text-purple-400 text-xs",children:e.rates&&e.is_leaf?a(e.rates.initial_purchase_to_refund_rate):"-"}),(0,ut.jsx)("div",{className:"w-16 text-center",children:e.is_leaf&&(0,ut.jsx)("span",{className:"text-xs font-bold ".concat((e.cohort_user_count||0)>=12?e.is_viable?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"),children:(e.cohort_user_count||0)>=12?e.is_viable?"\u2713":"\u2717":"-"})}),(0,ut.jsx)("div",{className:"w-12 text-center",children:!e.rates_consistent&&(0,ut.jsx)("span",{className:"text-red-600 dark:text-red-400 text-xs font-bold",children:"\u26a0\ufe0f"})})]}),o&&e.is_leaf&&e.users&&e.users.length>0&&(0,ut.jsxs)("div",{className:"ml-8 mt-1 mb-2 bg-gray-50 dark:bg-gray-800 rounded p-2",children:[(0,ut.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:["Individual Users (",e.users.length,"):",e.rate_errors&&e.rate_errors.length>0&&(0,ut.jsxs)("span",{className:"ml-2 text-red-600 dark:text-red-400 font-bold",children:["\u26a0\ufe0f ",e.rate_errors.length," rate inconsistencies detected"]})]}),(0,ut.jsxs)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:[e.users.slice(0,20).map((t,r)=>{const n=new Date,s=new Date(n.getTime()-45792e5),i=new Date(n.getTime()-6912e5),o=new Date(t.credited_date+"T00:00:00"),l=o>=s&&o<=i,c=e.rate_errors&&e.rate_errors.some(e=>e.user_id===t.distinct_id);return(0,ut.jsxs)("div",{className:"text-xs flex justify-between ".concat(c?"text-red-700 dark:text-red-300 bg-red-100 dark:bg-red-900/30 px-1 rounded":l?"text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20 px-1 rounded":"text-gray-700 dark:text-gray-300"),children:[(0,ut.jsx)("span",{className:"font-mono",children:t.distinct_id}),(0,ut.jsxs)("span",{children:[a(t.trial_conversion_rate)," |",a(t.trial_converted_to_refund_rate)," |",a(t.initial_purchase_to_refund_rate)," |",t.accuracy_score,c&&(0,ut.jsx)("span",{className:"ml-1 text-red-600 dark:text-red-400",children:"\u26a0\ufe0f"}),l&&(0,ut.jsx)("span",{className:"ml-1 text-green-600 dark:text-green-400",children:"\ud83d\udcc5"})]})]},r)}),e.users.length>20&&(0,ut.jsxs)("div",{className:"text-xs text-gray-500 italic",children:["... and ",e.users.length-20," more users"]})]}),(0,ut.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[(0,ut.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"\ud83d\udcc5 = In cohort window (used for rates)"}),e.rate_errors&&e.rate_errors.length>0&&(0,ut.jsx)("span",{className:"ml-3 text-red-600 dark:text-red-400",children:"\u26a0\ufe0f = Rate inconsistency"})]})]})]},i);var d})(e,t))})]}):(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83c\udf33"}),(0,ut.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Hierarchy Data Found"}),(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Load the overview data to see the conversion rates hierarchy."})]})},rU=()=>{var e,t,r,n,a,i,o,l,c,d;const[u,h]=(0,s.useState)(!1),[p,m]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[x,b]=(0,s.useState)([]),[y,v]=(0,s.useState)([]),[_,k]=(0,s.useState)(null),[j,w]=(0,s.useState)(new Set),[N,S]=(0,s.useState)({product_id:"",min_users:"",max_users:"",show_errors_only:!1,show_viable_only:!1});(0,s.useEffect)(()=>{O()},[]);const O=async()=>{h(!0),k(null);try{const e=await XB.loadOverview();if(e.success){g(e.data.statistics),b(e.data.hierarchy_tree),v(e.data.validation_errors);const t=new Set;e.data.hierarchy_tree.slice(0,10).forEach((e,r)=>{e.level<2&&t.add("".concat(e.level,"_").concat(e.value,"_").concat(r))}),w(t)}else k(e.error||"Failed to load conversion rates data")}catch(uU){k("Failed to load conversion rates data: "+uU.message)}finally{h(!1)}};return(0,ut.jsx)("div",{className:"p-6 max-w-7xl mx-auto",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"\ud83d\udd0d Conversion Rates Debug"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Debug and analyze the hierarchical cohort matching system. Each line shows the actual property values with their conversion rates, user counts, and validation status in a clean tree format."})]}),(0,ut.jsxs)("div",{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsxs)("h2",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-3 flex items-center",children:[(0,ut.jsx)("span",{className:"mr-2",children:"\u2139\ufe0f"}),"Tree Structure: product_id \u2192 price \u2192 store \u2192 economic_tier \u2192 country \u2192 region"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\ud83c\udfaf How to Read the Tree"}),(0,ut.jsxs)("ul",{className:"space-y-1 text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Actual Values:"})," Shows real data (US, CA, $9.99, app_store, etc.)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Level:"})," Depth in hierarchy (0=product, 5=region)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Status:"}),' conversion_rate, "default", "small cohort", or "ERROR"']}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Users:"})," Total user count for this path"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Viable:"})," \u2713 if \u226512 users, \u2717 if not viable"]})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\u26a0\ufe0f Error Detection"}),(0,ut.jsxs)("ul",{className:"space-y-1 text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Red Background:"})," Inconsistent rates within same segment"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"\u26a0\ufe0f Icon:"})," Rate validation error detected"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"ERROR Status:"})," Users have different conversion rates"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Click to Expand:"})," View individual user details"]})]})]})]})]}),_&&(0,ut.jsxs)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-red-800 dark:text-red-200 font-medium",children:"Error"}),(0,ut.jsx)("p",{className:"text-red-600 dark:text-red-300",children:_})]}),y&&y.length>0&&(0,ut.jsxs)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsxs)("h3",{className:"text-red-800 dark:text-red-200 font-medium mb-2",children:["\u26a0\ufe0f Validation Errors Found (",y.length,")"]}),(0,ut.jsxs)("div",{className:"max-h-32 overflow-y-auto space-y-2",children:[y.slice(0,5).map((e,t)=>(0,ut.jsxs)("div",{className:"text-sm text-red-600 dark:text-red-300",children:[(0,ut.jsxs)("strong",{children:[e.path,":"]})," ",e.message," (Users: ",e.user_count,")"]},t)),y.length>5&&(0,ut.jsxs)("div",{className:"text-sm text-red-500 italic",children:["... and ",y.length-5," more validation errors"]})]})]}),f&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"\ud83d\udcca Hierarchy Statistics"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,ut.jsx)(ZB,{title:"Total Users",value:f.total_users,icon:"\ud83d\udc65",color:"blue"}),(0,ut.jsx)(ZB,{title:"Cohort Window Users",value:(null===(e=f.cohort_window_info)||void 0===e?void 0:e.total_cohort_users)||0,icon:"\ud83d\udcc5",color:"purple",subtitle:"".concat(null===(t=f.cohort_window_info)||void 0===t?void 0:t.start_date," to ").concat(null===(r=f.cohort_window_info)||void 0===r?void 0:r.end_date)}),(0,ut.jsx)(ZB,{title:"Total Segments",value:f.total_segments,icon:"\ud83c\udff7\ufe0f",color:"orange"}),(0,ut.jsx)(ZB,{title:"Valid Segments",value:f.valid_segments,icon:"\u2705",color:"green",subtitle:"Consistent rates"})]}),(0,ut.jsxs)("div",{className:"mb-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-yellow-800 dark:text-yellow-200 font-medium mb-2",children:"\u26a0\ufe0f Important: Cohort Window Filtering"}),(0,ut.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:["Rate calculations only use users whose ",(0,ut.jsx)("strong",{children:"credited_date"})," falls within the 45-day cohort window (",null===(n=f.cohort_window_info)||void 0===n?void 0:n.start_date," to ",null===(a=f.cohort_window_info)||void 0===a?void 0:a.end_date,"). If a segment has 13 total users but only 8 cohort window users, it will use default rates since 8 < 12."]})]}),(0,ut.jsx)("div",{className:"mb-4",children:(()=>{const e=f.valid_segments+f.invalid_segments,t=e===f.total_segments;return(0,ut.jsxs)("div",{className:"text-sm px-3 py-2 rounded-md ".concat(t?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800"),children:[(0,ut.jsx)("span",{className:"font-medium",children:t?"\u2705 Segment Math Check: ":"\u274c Segment Math Error: "}),"Valid (",f.valid_segments.toLocaleString(),") + Invalid (",f.invalid_segments.toLocaleString(),") = ",e.toLocaleString()," / Total Segments: ",f.total_segments.toLocaleString(),!t&&" (These should match!)"]})})()}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"\ud83d\udc65 User Accuracy Distribution"}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Distribution of users by accuracy level (should add up to total users):"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,ut.jsx)(ZB,{title:"Very High Accuracy",value:f.accuracy_breakdown.very_high,icon:"\ud83c\udfaf",color:"green",subtitle:"Using all 6 properties including store"}),(0,ut.jsx)(ZB,{title:"High Accuracy",value:f.accuracy_breakdown.high,icon:"\ud83d\udd35",color:"blue",subtitle:"Using 5 properties including store"}),(0,ut.jsx)(ZB,{title:"Medium Accuracy",value:f.accuracy_breakdown.medium,icon:"\ud83d\udfe1",color:"yellow",subtitle:"Using 4 properties including store"}),(0,ut.jsx)(ZB,{title:"Low Accuracy",value:f.accuracy_breakdown.low,icon:"\ud83d\udfe0",color:"orange",subtitle:"Using core 3 properties including store"}),(0,ut.jsx)(ZB,{title:"Default Fallback",value:f.accuracy_breakdown.default,icon:"\u2699\ufe0f",color:"red",subtitle:"Fallback rates when cohort too small"})]}),(0,ut.jsx)("div",{className:"mt-3 text-center",children:(()=>{const e=Object.values(f.accuracy_breakdown).reduce((e,t)=>e+t,0),t=e===f.total_users;return(0,ut.jsxs)("div",{className:"text-sm px-3 py-2 rounded-md ".concat(t?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800"),children:[(0,ut.jsx)("span",{className:"font-medium",children:t?"\u2705 User Math Check: ":"\u274c User Math Error: "}),"User accuracy sum: ",e.toLocaleString()," / Total users: ",f.total_users.toLocaleString(),!t&&" (These should match!)"]})})()})]}),(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"\ud83c\udff7\ufe0f Segment Accuracy Distribution"}),(0,ut.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Distribution of segments by accuracy level (should add up to total segments):"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,ut.jsx)(ZB,{title:"Very High Accuracy",value:(null===(i=f.segment_accuracy_breakdown)||void 0===i?void 0:i.very_high)||0,icon:"\ud83c\udfaf",color:"green",subtitle:"Segments using all 6 properties"}),(0,ut.jsx)(ZB,{title:"High Accuracy",value:(null===(o=f.segment_accuracy_breakdown)||void 0===o?void 0:o.high)||0,icon:"\ud83d\udd35",color:"blue",subtitle:"Segments using 5 properties"}),(0,ut.jsx)(ZB,{title:"Medium Accuracy",value:(null===(l=f.segment_accuracy_breakdown)||void 0===l?void 0:l.medium)||0,icon:"\ud83d\udfe1",color:"yellow",subtitle:"Segments using 4 properties"}),(0,ut.jsx)(ZB,{title:"Low Accuracy",value:(null===(c=f.segment_accuracy_breakdown)||void 0===c?void 0:c.low)||0,icon:"\ud83d\udfe0",color:"orange",subtitle:"Segments using 3 properties"}),(0,ut.jsx)(ZB,{title:"Default Fallback",value:(null===(d=f.segment_accuracy_breakdown)||void 0===d?void 0:d.default)||0,icon:"\u2699\ufe0f",color:"red",subtitle:"Segments with fallback rates"})]}),(0,ut.jsx)("div",{className:"mt-3 text-center",children:(()=>{const e=f.segment_accuracy_breakdown?Object.values(f.segment_accuracy_breakdown).reduce((e,t)=>e+t,0):0,t=e===f.total_segments;return(0,ut.jsxs)("div",{className:"text-sm px-3 py-2 rounded-md ".concat(t?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border border-red-200 dark:border-red-800"),children:[(0,ut.jsx)("span",{className:"font-medium",children:t?"\u2705 Segment Math Check: ":"\u274c Segment Math Error: "}),"Segment accuracy sum: ",e.toLocaleString()," / Total segments: ",f.total_segments.toLocaleString(),!t&&" (These should match!)"]})})()})]})]}),(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsx)(eU,{filters:N,onFilterChange:(e,t)=>{S(r=>Ie(Ie({},r),{},{[e]:t}))},onApplyFilters:async()=>{m(!0),k(null);try{const e={};Object.keys(N).forEach(t=>{""!==N[t]&&!1!==N[t]&&(e[t]=N[t])});const t=await XB.loadCohortTree({filters:e});t.success?b(t.data.hierarchy_tree):k(t.error||"Failed to filter conversion rates data")}catch(uU){k("Failed to filter conversion rates data: "+uU.message)}finally{m(!1)}},onReset:()=>{S({product_id:"",min_users:"",max_users:"",show_errors_only:!1,show_viable_only:!1}),O()},loading:p})}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\ud83c\udf33 Conversion Rates Hierarchy Tree"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[x.length.toLocaleString()," nodes shown"]}),!u&&(0,ut.jsx)("button",{onClick:O,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium text-sm",children:"Refresh Data"})]})]}),u?(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Loading conversion rates hierarchy..."})]}):(0,ut.jsx)(tU,{hierarchyTree:x,expandedNodes:j,onToggleNode:e=>{const t=new Set(j);t.has(e)?t.delete(e):t.add(e),w(t)}})]})]})})},nU=e=>{let{title:t,value:r,icon:n,color:a="blue"}=e;return(0,ut.jsx)("div",{className:"border rounded-lg p-4 ".concat({blue:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200",green:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200",yellow:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200",red:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200",purple:"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800 text-purple-800 dark:text-purple-200"}[a]),children:(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("p",{className:"text-sm font-medium opacity-75",children:t}),(0,ut.jsx)("p",{className:"text-2xl font-bold",children:(null===r||void 0===r?void 0:r.toLocaleString())||0})]}),(0,ut.jsx)("div",{className:"text-3xl opacity-75",children:n})]})})},aU=e=>{let{filters:t,onFilterChange:r,onSearch:n,onReset:a,loading:s}=e;return(0,ut.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-4",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filter Controls"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product ID"}),(0,ut.jsx)("input",{type:"text",value:t.product_id,onChange:e=>r("product_id",e.target.value),placeholder:"Filter by product ID...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Country"}),(0,ut.jsx)("input",{type:"text",value:t.country,onChange:e=>r("country",e.target.value),placeholder:"Filter by country...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Min Price Bucket"}),(0,ut.jsx)("input",{type:"number",step:"0.01",value:t.min_bucket,onChange:e=>r("min_bucket",e.target.value),placeholder:"Min bucket value...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Price Bucket"}),(0,ut.jsx)("input",{type:"number",step:"0.01",value:t.max_bucket,onChange:e=>r("max_bucket",e.target.value),placeholder:"Max bucket value...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Min Users"}),(0,ut.jsx)("input",{type:"number",value:t.min_users,onChange:e=>r("min_users",e.target.value),placeholder:"Min user count...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Users"}),(0,ut.jsx)("input",{type:"number",value:t.max_users,onChange:e=>r("max_users",e.target.value),placeholder:"Max user count...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]}),(0,ut.jsxs)("div",{className:"flex gap-2",children:[(0,ut.jsx)("button",{onClick:n,disabled:s,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-md font-medium",children:s?"Searching...":"Search"}),(0,ut.jsx)("button",{onClick:a,disabled:s,className:"bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-md font-medium",children:"Reset"})]})]})},sU=e=>{let{data:t,onSort:r,sortConfig:n}=e;const a=e=>n.key!==e?(0,ut.jsx)("span",{className:"text-gray-400",children:"\u2195\ufe0f"}):"asc"===n.direction?(0,ut.jsx)("span",{className:"text-blue-600",children:"\u2191"}):(0,ut.jsx)("span",{className:"text-blue-600",children:"\u2193"}),s=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e);return(0,ut.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:(0,ut.jsxs)("div",{className:"overflow-x-auto",children:[(0,ut.jsxs)("table",{className:"w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,ut.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,ut.jsxs)("tr",{children:[(0,ut.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/6",onClick:()=>r("product_id"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Product ID"}),a("product_id")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/12",onClick:()=>r("country"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Country"}),a("country")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/8",onClick:()=>r("event_type"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Event Type"}),a("event_type")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/8",onClick:()=>r("price_bucket"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Price Bucket"}),a("price_bucket")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/8",onClick:()=>r("user_count"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Total Users"}),a("user_count")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/8",onClick:()=>r("properly_sorted_count"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Properly Sorted"}),a("properly_sorted_count")]})}),(0,ut.jsx)("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 w-1/8",onClick:()=>r("inherited_count"),children:(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)("span",{children:"Inherited"}),a("inherited_count")]})})]})}),(0,ut.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map((e,t)=>(0,ut.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,ut.jsx)("td",{className:"px-3 py-3 text-sm font-medium text-gray-900 dark:text-white break-words",children:e.product_id}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.country}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:"RC Initial purchase"===e.event_type?(0,ut.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"RC Initial purchase"}):"RC Trial converted"===e.event_type?(0,ut.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"RC Trial converted"}):(0,ut.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"No Conversion"})}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:0===e.price_bucket?(0,ut.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"$0.00"}):(0,ut.jsx)("span",{className:"font-medium text-green-600 dark:text-green-400",children:s(e.price_bucket)})}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:(0,ut.jsx)("span",{className:"font-medium",children:e.user_count.toLocaleString()})}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:(0,ut.jsx)("span",{className:"font-medium text-green-600 dark:text-green-400",children:e.properly_sorted_count.toLocaleString()})}),(0,ut.jsx)("td",{className:"px-2 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:(0,ut.jsx)("span",{className:"font-medium text-yellow-600 dark:text-yellow-400",children:e.inherited_count.toLocaleString()})})]},t))})]}),0===t.length&&(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83d\udcca"}),(0,ut.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Data Found"}),(0,ut.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Try adjusting your filters or load the overview data."})]})]})})},iU=()=>{const[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(null),[p,m]=(0,s.useState)(!1),[f,g]=(0,s.useState)({product_id:"",country:"",min_bucket:"",max_bucket:"",min_users:"",max_users:""}),[x,b]=(0,s.useState)({key:"product_id",direction:"asc"});(0,s.useEffect)(()=>{y()},[]);const y=async()=>{t(!0),h(null);try{const e=await JB.loadOverview();e.success?(i(e.data.statistics),l(e.data.table_data),d(e.data.table_data),m(!1)):h(e.error||"Failed to load price bucket data")}catch(uU){h("Failed to load price bucket data: "+uU.message)}finally{t(!1)}},v=(0,s.useMemo)(()=>c?[...c].sort((e,t)=>{let r=e[x.key],n=t[x.key];return"price_bucket"!==x.key&&"user_count"!==x.key&&"properly_sorted_count"!==x.key&&"inherited_count"!==x.key||(r=Number(r),n=Number(n)),"product_id"!==x.key&&"country"!==x.key&&"event_type"!==x.key||(r=String(r),n=String(n)),r<n?"asc"===x.direction?-1:1:r>n?"asc"===x.direction?1:-1:0}):[],[c,x]);return(0,ut.jsx)("div",{className:"p-6 max-w-7xl mx-auto",children:(0,ut.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"\ud83d\udcb0 Price Bucket Debug"}),(0,ut.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Debug and analyze price bucket assignments from the pipeline. View statistics and explore detailed bucket assignments."})]}),(0,ut.jsxs)("div",{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,ut.jsxs)("h2",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-3 flex items-center",children:[(0,ut.jsx)("span",{className:"mr-2",children:"\u2139\ufe0f"}),"Price Bucket Assignment Algorithm (v3 - Iterative Bucketing)"]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\ud83c\udfaf Assignment Process (Two-Pass System)"}),(0,ut.jsxs)("ul",{className:"space-y-1 text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Pass 1:"})," Direct conversions + strict backward inheritance"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Pass 2:"})," Closest-time conversion inheritance for remaining users"]}),(0,ut.jsx)("li",{children:"Buckets created using iterative merge algorithm with thresholds"}),(0,ut.jsx)("li",{children:"Groups similar prices: 17.5% difference OR $5.00 absolute difference"})]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\ud83d\udcca Assignment Types Explained"}),(0,ut.jsxs)("ul",{className:"space-y-1 text-blue-700 dark:text-blue-300",children:[(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Properly Sorted:"})," Users with direct conversions (RC Initial purchase, RC Trial converted)"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Inherited:"})," Trial users who inherited bucket from prior/closest conversions"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Zero Bucket ($0.00):"})," No conversion events OR events found but price didn't fit any bucket"]}),(0,ut.jsxs)("li",{children:[(0,ut.jsx)("strong",{children:"Properly Sorted vs Inherited:"})," Shows breakdown of direct conversions vs inherited buckets"]})]})]})]}),(0,ut.jsxs)("div",{className:"mt-4 pt-3 border-t border-blue-200 dark:border-blue-700",children:[(0,ut.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"\u26a0\ufe0f Important Notes"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300",children:[(0,ut.jsx)("div",{children:(0,ut.jsxs)("ul",{className:"space-y-1",children:[(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Country-Specific:"})," Buckets are created per country-product-event combination"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Event-Specific:"}),' Different buckets for "RC Initial purchase" vs "RC Trial converted"']}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Inheritance Priority:"})," Prior trial conversions \u2192 closest conversion (any type)"]})]})}),(0,ut.jsx)("div",{children:(0,ut.jsxs)("ul",{className:"space-y-1",children:[(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Zero Values ($0.00):"})," No conversion/trial events found OR conversion price outside all bucket ranges"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Valid Lifecycle:"})," Only users with valid_lifecycle=1 and valid_user=1 are included"]}),(0,ut.jsxs)("li",{children:["\u2022 ",(0,ut.jsx)("strong",{children:"Bucket Calculation:"})," Uses average price of all conversions in the bucket"]})]})})]})]})]}),u&&(0,ut.jsxs)("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,ut.jsx)("h3",{className:"text-red-800 dark:text-red-200 font-medium",children:"Error"}),(0,ut.jsx)("p",{className:"text-red-600 dark:text-red-300",children:u})]}),a&&(0,ut.jsxs)("div",{className:"mb-6",children:[(0,ut.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"\ud83d\udcca Bucket Assignment Statistics"}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,ut.jsx)(nU,{title:"Total User-Product Pairs",value:a.total_user_product_pairs,icon:"\ud83d\udcca",color:"blue"}),(0,ut.jsx)(nU,{title:"Valid Lifecycle Users",value:a.total_users,icon:"\u2705",color:"green"}),(0,ut.jsx)(nU,{title:"Properly Sorted",value:a.properly_sorted,icon:"\ud83c\udfaf",color:"green"})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,ut.jsx)(nU,{title:"Inherited Buckets",value:a.inherited,icon:"\u2b06\ufe0f",color:"yellow"}),(0,ut.jsx)(nU,{title:"Zero Buckets ($0.00)",value:a.zero_bucket,icon:"0\ufe0f\u20e3",color:"red"}),(0,ut.jsx)(nU,{title:"Unique Buckets",value:a.unique_buckets,icon:"\ud83d\udd22",color:"purple"})]})]}),(0,ut.jsx)("div",{className:"mb-6",children:(0,ut.jsx)(aU,{filters:f,onFilterChange:(e,t)=>{g(r=>Ie(Ie({},r),{},{[e]:t}))},onSearch:async()=>{n(!0),h(null);try{const e={};Object.keys(f).forEach(t=>{""!==f[t]&&(e[t]=f[t])});const t=await JB.searchData(e);t.success?(d(t.data.filtered_data),m(!0)):h(t.error||"Failed to search price bucket data")}catch(uU){h("Failed to search price bucket data: "+uU.message)}finally{n(!1)}},onReset:()=>{g({product_id:"",country:"",min_bucket:"",max_bucket:"",min_users:"",max_users:""}),d(o),m(!1)},loading:r})}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["\ud83d\udccb Price Bucket Data ",p&&"(Filtered)"]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ut.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",v.length.toLocaleString()," rows"]}),!e&&(0,ut.jsx)("button",{onClick:y,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium text-sm",children:"Refresh Data"})]})]}),e?(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ut.jsx)("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Loading price bucket data..."})]}):(0,ut.jsx)(sU,{data:v,onSort:e=>{let t="asc";x.key===e&&"asc"===x.direction&&(t="desc"),b({key:e,direction:t})},sortConfig:x})]})]})})},oU=()=>{const[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(null),[a,i]=(0,s.useState)(!0),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{u()},[]);const u=async()=>{try{i(!0);const[e,r]=await Promise.all([QB.loadOverview(),QB.loadExamples()]);e.success&&t(e),r.success&&n(r),l(null)}catch(uU){l(uU.message)}finally{i(!1)}},h=async(e,t)=>{const r="".concat(e,"-").concat(t);d(r);try{console.log("Refreshing status:",e,t);const r=await QB.refreshStatus(e,t);console.log("Refresh response:",r),r.success?(console.log("Updating examples data with:",r.examples),n(n=>{const a=Ie(Ie({},n),{},{["".concat(e,"_examples")]:Ie(Ie({},n["".concat(e,"_examples")]),{},{[t]:r.examples})});return console.log("New examples data:",a),a})):console.error("Refresh failed:",r)}catch(uU){console.error("Error refreshing status examples:",uU)}finally{d(null)}},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e),m=e=>new Intl.NumberFormat("en-US").format(e),f=e=>{let{status:t,count:r,percentage:n,isLast:a}=e;return(0,ut.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 ".concat(a?"":"border-b border-gray-700"," hover:bg-gray-700 transition-colors"),children:[(0,ut.jsx)("div",{className:"flex flex-col",children:(0,ut.jsx)("span",{className:"font-medium text-blue-300",children:t.replace(/_/g," ")})}),(0,ut.jsxs)("div",{className:"text-right",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-white",children:m(r)}),(0,ut.jsxs)("div",{className:"text-sm text-gray-400",children:[n,"% of total"]})]})]})},g=e=>{let{range:t,count:r,percentage:n,isLast:a}=e;return(0,ut.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 ".concat(a?"":"border-b border-gray-700"," hover:bg-gray-700 transition-colors"),children:[(0,ut.jsx)("div",{className:"flex flex-col",children:(0,ut.jsx)("span",{className:"font-medium text-green-300",children:t})}),(0,ut.jsxs)("div",{className:"text-right",children:[(0,ut.jsx)("div",{className:"text-lg font-bold text-white",children:m(r)}),(0,ut.jsxs)("div",{className:"text-sm text-gray-400",children:[n,"% of total"]})]})]})},x=e=>{let{user:t,index:r}=e;return(0,ut.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"User ID:"}),(0,ut.jsxs)("span",{className:"text-white ml-2 font-mono",children:[t.distinct_id.substring(0,8),"..."]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Value:"}),(0,ut.jsx)("span",{className:"text-green-300 ml-2 font-bold",children:p(t.current_value)})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Product:"}),(0,ut.jsx)("span",{className:"text-white ml-2",children:t.product_id})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Country:"}),(0,ut.jsx)("span",{className:"text-white ml-2",children:t.country||"N/A"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Region:"}),(0,ut.jsx)("span",{className:"text-white ml-2",children:t.region||"N/A"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Start:"}),(0,ut.jsx)("span",{className:"text-white ml-2",children:t.credited_date||"N/A"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Days:"}),(0,ut.jsx)("span",{className:"text-white ml-2",children:t.days_since_start||"N/A"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Accuracy:"}),(0,ut.jsx)("span",{className:"text-yellow-300 ml-2 capitalize",children:t.accuracy_score||"unknown"})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Price Bucket:"}),(0,ut.jsx)("span",{className:"text-green-300 ml-2 font-semibold",children:p(t.price_bucket)})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Trial Conv:"}),(0,ut.jsxs)("span",{className:"text-red-300 ml-2 font-semibold",children:[(100*t.trial_conversion_rate).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Trial Refund:"}),(0,ut.jsxs)("span",{className:"text-red-300 ml-2 font-semibold",children:[(100*t.trial_refund_rate).toFixed(1),"%"]})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("span",{className:"text-gray-400",children:"Purchase Refund:"}),(0,ut.jsxs)("span",{className:"text-red-300 ml-2 font-semibold",children:[(100*t.purchase_refund_rate).toFixed(1),"%"]})]})]})})};return a?(0,ut.jsx)("div",{className:"p-6 bg-gray-900 min-h-screen",children:(0,ut.jsxs)("div",{className:"animate-pulse",children:[(0,ut.jsx)("div",{className:"h-8 bg-gray-700 rounded w-1/4 mb-6"}),(0,ut.jsxs)("div",{className:"space-y-4",children:[(0,ut.jsx)("div",{className:"h-32 bg-gray-800 rounded"}),(0,ut.jsx)("div",{className:"h-64 bg-gray-800 rounded"}),(0,ut.jsx)("div",{className:"h-64 bg-gray-800 rounded"})]})]})}):o?(0,ut.jsx)("div",{className:"p-6 bg-gray-900 min-h-screen",children:(0,ut.jsxs)("div",{className:"bg-red-900 border border-red-700 rounded-lg p-4",children:[(0,ut.jsx)("h2",{className:"text-red-300 font-bold mb-2",children:"Error Loading Data"}),(0,ut.jsx)("p",{className:"text-red-200",children:o}),(0,ut.jsx)("button",{onClick:u,className:"mt-4 bg-red-700 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors",children:"Retry"})]})}):(0,ut.jsxs)("div",{className:"p-6 bg-gray-900 min-h-screen text-white",children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,ut.jsx)("h1",{className:"text-3xl font-bold text-white",children:"\ud83d\udcb0 Value Estimation Debug"}),(0,ut.jsx)("button",{onClick:u,className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg transition-colors",children:"Refresh Data"})]}),e&&(0,ut.jsxs)("div",{className:"mb-8",children:[(0,ut.jsx)("h2",{className:"text-xl font-bold mb-4 text-blue-300",children:"\ud83d\udcca Overview Statistics"}),(0,ut.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:[(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-white",children:m(e.statistics.total_user_product_pairs)}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"Total Pairs"})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-green-400",children:m(e.statistics.processed_pairs)}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"Processed"})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:m(e.statistics.pairs_with_values)}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"With Values"})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:p(e.statistics.avg_value)}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"Avg Value"})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:p(e.statistics.total_estimated_value)}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"Total Value"})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[(0,ut.jsxs)("div",{className:"text-2xl font-bold text-orange-400",children:[e.statistics.processing_rate,"%"]}),(0,ut.jsx)("div",{className:"text-sm text-gray-400",children:"Processing Rate"})]})]}),(0,ut.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,ut.jsx)("h3",{className:"text-lg font-bold text-blue-300",children:"\ud83d\udd04 Current Status Breakdown"}),(0,ut.jsx)("p",{className:"text-sm text-gray-400",children:"Chronological user lifecycle progression"})]}),(0,ut.jsx)("div",{className:"max-h-96 overflow-y-auto",children:e.status_breakdown.map((t,r)=>(0,ut.jsx)(f,{status:t.status,count:t.count,percentage:t.percentage,isLast:r===e.status_breakdown.length-1},t.status))})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,ut.jsx)("h3",{className:"text-lg font-bold text-green-300",children:"\ud83d\udc8e Value Status Breakdown"}),(0,ut.jsx)("p",{className:"text-sm text-gray-400",children:"Value calculation stages"})]}),(0,ut.jsx)("div",{className:"max-h-96 overflow-y-auto",children:e.value_status_breakdown.map((t,r)=>(0,ut.jsx)(f,{status:t.status,count:t.count,percentage:t.percentage,isLast:r===e.value_status_breakdown.length-1},t.status))})]}),(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,ut.jsx)("h3",{className:"text-lg font-bold text-purple-300",children:"\ud83d\udcb0 Current Value Distribution"}),(0,ut.jsx)("p",{className:"text-sm text-gray-400",children:"Value ranges in $20 increments up to $120+"})]}),(0,ut.jsx)("div",{className:"max-h-96 overflow-y-auto",children:e.value_distribution.map((t,r)=>(0,ut.jsx)(g,{range:t.range,count:t.count,percentage:t.percentage,isLast:r===e.value_distribution.length-1},t.range))})]})]})]}),r&&(0,ut.jsxs)("div",{className:"space-y-8",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h2",{className:"text-xl font-bold mb-4 text-blue-300",children:"\ud83d\udccb Current Status Examples"}),(0,ut.jsx)("p",{className:"text-gray-400 mb-4",children:"Sample users for each current status"}),(0,ut.jsx)("div",{className:"space-y-6",children:Object.entries(r.current_status_examples||{}).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium text-blue-300",children:[t.replace(/_/g," ")," (",r.length," examples)"]}),(0,ut.jsxs)("button",{onClick:()=>h("current_status",t),disabled:c==="current_status-".concat(t),className:"bg-blue-600 hover:bg-blue-500 disabled:bg-blue-800 text-white px-3 py-1 rounded text-sm transition-colors",children:[c==="current_status-".concat(t)?"\u27f3":"\u21bb"," Refresh"]})]}),r.length>0?(0,ut.jsx)("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((e,t)=>(0,ut.jsx)(x,{user:e,index:t},"".concat(e.distinct_id,"-").concat(t)))}):(0,ut.jsx)("div",{className:"p-4",children:(0,ut.jsxs)("div",{className:"bg-gray-700 border border-gray-600 rounded-lg p-4 text-center",children:[(0,ut.jsx)("div",{className:"text-gray-400 text-lg mb-2",children:"\u26a0\ufe0f No Examples Available"}),(0,ut.jsx)("div",{className:"text-gray-500 text-sm",children:"This status exists in the system but currently has no user examples."}),(0,ut.jsx)("div",{className:"text-gray-600 text-xs mt-2",children:"Try refreshing to see if new examples become available."})]})})]},t)})})]}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h2",{className:"text-xl font-bold mb-4 text-green-300",children:"\ud83c\udfaf Value Status Examples"}),(0,ut.jsx)("p",{className:"text-gray-400 mb-4",children:"Sample users for each value status"}),(0,ut.jsx)("div",{className:"space-y-6",children:Object.entries(r.value_status_examples||{}).map(e=>{let[t,r]=e;return(0,ut.jsxs)("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[(0,ut.jsxs)("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[(0,ut.jsxs)("h3",{className:"text-lg font-medium text-green-300",children:[t.replace(/_/g," ")," (",r.length," examples)"]}),(0,ut.jsxs)("button",{onClick:()=>h("value_status",t),disabled:c==="value_status-".concat(t),className:"bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-white px-3 py-1 rounded text-sm transition-colors",children:[c==="value_status-".concat(t)?"\u27f3":"\u21bb"," Refresh"]})]}),r.length>0?(0,ut.jsx)("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((e,t)=>(0,ut.jsx)(x,{user:e,index:t},"".concat(e.distinct_id,"-").concat(t)))}):(0,ut.jsx)("div",{className:"p-4",children:(0,ut.jsxs)("div",{className:"bg-gray-700 border border-gray-600 rounded-lg p-4 text-center",children:[(0,ut.jsx)("div",{className:"text-gray-400 text-lg mb-2",children:"\u26a0\ufe0f No Examples Available"}),(0,ut.jsx)("div",{className:"text-gray-500 text-sm",children:"This status exists in the system but currently has no user examples."}),(0,ut.jsx)("div",{className:"text-gray-600 text-xs mt-2",children:"Try refreshing to see if new examples become available."})]})})]},t)})})]})]})]})};const lU=function(){const[e,t]=(0,s.useState)(!1);return(0,ut.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200",children:[(0,ut.jsx)("nav",{className:"bg-white dark:bg-gray-800 shadow-md p-4",children:(0,ut.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,ut.jsx)(Ee,{to:"/",className:"text-xl font-bold hover:text-blue-500 transition-colors",children:"Ads Dashboard"}),(0,ut.jsx)("div",{className:"flex items-center space-x-4",children:(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("button",{onClick:()=>t(!e),className:"flex items-center space-x-1 px-3 py-2 text-gray-600 dark:text-gray-300 hover:text-blue-500 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Debug Tools",children:[(0,ut.jsx)(Ve,{className:"h-4 w-4"}),(0,ut.jsx)(He,{className:"h-3 w-3 transition-transform ".concat(e?"rotate-180":"")})]}),e&&(0,ut.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:(0,ut.jsxs)("div",{className:"py-1",children:[(0,ut.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide border-b border-gray-200 dark:border-gray-700",children:"Debug Tools"}),[{path:"/data-pipeline",label:"Data Pipeline",icon:"\ud83d\udd27"},{path:"/debug/conversion-rates",label:"Conversion Rates Debug",icon:"\ud83d\udcc8"},{path:"/debug/price-bucket",label:"Price Bucket Debug",icon:"\ud83d\udcb0"},{path:"/debug/value-estimation",label:"Value Estimation Debug",icon:"\ud83d\udcca"},{path:"/debug",label:"Mixpanel Debugger",icon:"\ud83d\udd0d"},{path:"/meta-debug",label:"Meta Debugger",icon:"\ud83c\udfaf"}].map(e=>(0,ut.jsxs)(Ee,{to:e.path,onClick:()=>t(!1),className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-500 transition-colors",children:[(0,ut.jsx)("span",{className:"text-base",children:e.icon}),(0,ut.jsx)("span",{children:e.label})]},e.path))]})})]})})]})}),e&&(0,ut.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>t(!1)}),(0,ut.jsx)("div",{className:"w-full",children:(0,ut.jsxs)(ve,{children:[(0,ut.jsx)(be,{path:"/",element:(0,ut.jsx)(Vt,{})}),(0,ut.jsx)(be,{path:"/cohort-analyzer",element:(0,ut.jsx)(cL,{})}),(0,ut.jsx)(be,{path:"/cohort-analyzer-v3",element:(0,ut.jsx)(PL,{})}),(0,ut.jsx)(be,{path:"/conversion-probability",element:(0,ut.jsx)(xF,{})}),(0,ut.jsx)(be,{path:"/pricing-management",element:(0,ut.jsx)(bF,{})}),(0,ut.jsx)(be,{path:"/cohort-pipeline",element:(0,ut.jsx)(QL,{})}),(0,ut.jsx)(be,{path:"/data-pipeline",element:(0,ut.jsx)(qB,{})}),(0,ut.jsx)(be,{path:"/data-pipeline/debug",element:(0,ut.jsx)($B,{})}),(0,ut.jsx)(be,{path:"/pipeline-debug",element:(0,ut.jsx)(KB,{})}),(0,ut.jsx)(be,{path:"/debug/conversion-rates",element:(0,ut.jsx)(rU,{})}),(0,ut.jsx)(be,{path:"/debug/price-bucket",element:(0,ut.jsx)(iU,{})}),(0,ut.jsx)(be,{path:"/debug/value-estimation",element:(0,ut.jsx)(oU,{})}),(0,ut.jsx)(be,{path:"/debug",element:(0,ut.jsx)(rs,{})}),(0,ut.jsx)(be,{path:"/meta-debug",element:(0,ut.jsx)(Fs,{})})]})})]})},cU=e=>{e&&e instanceof Function&&r.e(453).then(r.bind(r,6453)).then(t=>{let{getCLS:r,getFID:n,getFCP:a,getLCP:s,getTTFB:i}=t;r(e),n(e),a(e),s(e),i(e)})};o.createRoot(document.getElementById("root")).render((0,ut.jsx)(Se,{children:(0,ut.jsx)(lU,{})})),cU()})()})();
//# sourceMappingURL=main.cbd626d6.js.map